{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "d7afa921-907e-4c42-87ca-e67aecd47310",
            "version": "KqlParameterItem/1.0",
            "name": "Help",
            "label": "üîé Getting Started",
            "type": 10,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "jsonData": "[\r\n    {\"value\": \"Yes\", \"label\": \"Yes\", \"selected\":true},\r\n    {\"value\": \"No\", \"label\": \"No\"}\r\n]",
            "value": "No"
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "DefaultSubscription_Internal",
            "type": 1,
            "isRequired": true,
            "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| take 1\r\n| project subscriptionId",
            "isHiddenWhenLocked": true,
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "id": "43d364e3-978a-4385-8840-9e079d957863"
          },
          {
            "id": "e6ded9a1-a83c-4762-938d-5bf8ff3d3d38",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 6,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "summarize by subscriptionId\r\n| project value = strcat(\"/subscriptions/\", subscriptionId), label = subscriptionId, selected = iff(subscriptionId =~ '{DefaultSubscription_Internal}', true, false)",
            "crossComponentResources": [
              "value::selected"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "e3225ed0-6210-40a1-b2d0-66e42ffa71d6",
            "version": "KqlParameterItem/1.0",
            "name": "Workspace",
            "type": 5,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "resources\r\n| where type =~ 'microsoft.operationalinsights/workspaces'\r\n| order by name asc\r\n| summarize Selected = makelist(id, 10), All = makelist(id, 1000)\r\n| mvexpand All limit 100\r\n| project value = tostring(All), label = tostring(All), selected = iff(Selected contains All, true, false)",
            "crossComponentResources": [
              "value::all"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "15b2c181-7397-43c1-900a-28e175ae8a6f",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "label": "‚è±Ô∏è Time Range",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 2592000000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "pills",
        "queryType": 1,
        "resourceType": "microsoft.resourcegraph/resources"
      },
      "name": "Parameter Selectors"
    },
    {
      "type": 1,
      "content": {
        "json": "<svg viewBox=\"0 0 19 19\" width=\"20\" class=\"fxt-escapeShadow\" role=\"presentation\" focusable=\"false\" xmlns:svg=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" aria-hidden=\"true\"><g><path fill=\"#1b93eb\" d=\"M16.82 8.886c0 4.81-5.752 8.574-7.006 9.411a.477.477 0 01-.523 0C8.036 17.565 2.18 13.7 2.18 8.886V3.135a.451.451 0 01.42-.419C7.2 2.612 6.154.625 9.5.625s2.3 1.987 6.8 2.091a.479.479 0 01.523.419z\"></path><path fill=\"url(#0024423711759027356)\" d=\"M16.192 8.99c0 4.392-5.333 7.947-6.483 8.575a.319.319 0 01-.418 0c-1.15-.732-6.483-4.183-6.483-8.575V3.762a.575.575 0 01.313-.523C7.2 3.135 6.258 1.357 9.4 1.357s2.2 1.882 6.274 1.882a.45.45 0 01.419.418z\"></path><path d=\"M9.219 5.378a.313.313 0 01.562 0l.875 1.772a.314.314 0 00.236.172l1.957.284a.314.314 0 01.174.535l-1.416 1.38a.312.312 0 00-.09.278l.334 1.949a.313.313 0 01-.455.33l-1.75-.92a.314.314 0 00-.292 0l-1.75.92a.313.313 0 01-.455-.33L7.483 9.8a.312.312 0 00-.09-.278L5.977 8.141a.314.314 0 01.174-.535l1.957-.284a.314.314 0 00.236-.172z\" class=\"msportalfx-svg-c01\"></path></g></svg>&nbsp;<span style=\"font-family: Open Sans; font-weight: 620; font-size: 14px;font-style: bold;margin:-10px 0px 0px 0px;position: relative;top:-3px;left:-4px;\"> Please take time to answer a quick survey,\r\n</span>[<span style=\"font-family: Open Sans; font-weight: 620; font-size: 14px;font-style: bold;margin:-10px 0px 0px 0px;position: relative;top:-3px;left:-4px;\"> click here. </span>](https://forms.office.com/r/hK7zcBDNp8)"
      },
      "name": "Survey"
    },
    {
      "type": 1,
      "content": {
        "json": "# Cybersecurity Maturity Model Certification (CMMC) 2.0 \n---\n\nWelcome to the Microsoft Sentinel: Cybersecurity Maturity Model Certification (CMMC) 2.0 Solution. CMMC model consists of maturity processes and cybersecurity best practices from multiple cybersecurity standards, frameworks, and other references, as well as inputs from the Defense Industrial Base (DIB) and Department of Defense (DoD stakeholders. \"CMMC 2.0 is the next iteration of the Department‚Äôs CMMC cybersecurity model. It streamlines requirements to three levels of cybersecurity ‚Äì Foundational, Advanced and Expert ‚Äì and aligns the requirements at each level with well-known and widely accepted NIST cybersecurity standards.\" For more information, see theüí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html).\n\nThe Microsoft Sentinel CMMC 2.0 Solution demonstrates best practice guidance, but Microsoft does not guarantee nor imply compliance. The workbook outlines controls across Levels 1-2. All accreditation requirements and decisions are governed by the üí°¬†[CMMC Accreditation Body](https://www.cmmcab.org/c3pao-lp). This solution provides visibility and situational awareness for control requirements delivered with Microsoft technologies in predominantly cloud-based environments. Customer experience will vary by user and some panels may require additional configurations and query modification for operation. Recommendations should be considered a starting point for planning full or partial coverage of respective control requirements. \n"
      },
      "customWidth": "79",
      "name": "Workbook Overview"
    },
    {
      "type": 1,
      "content": {
        "json": "![Image Name](https://azure.microsoft.com/svghandler/azure-sentinel?width=600&height=315) "
      },
      "customWidth": "20",
      "name": "Microsoft Sentinel Logo"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Section\\\": \\\"Access Control\\\", \\\"tab\\\": \\\"AC\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Awareness & Training\\\", \\\"tab\\\": \\\"AT\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Audit & Accountability\\\", \\\"tab\\\": \\\"AU\\\" },\\r\\n    { \\\"Section\\\": \\\"Configuration Management\\\", \\\"tab\\\": \\\"CM\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Identification & Authentication\\\", \\\"tab\\\": \\\"IA\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Incident Response\\\", \\\"tab\\\": \\\"IR\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Maintenance\\\", \\\"tab\\\": \\\"MA\\\" }\\r\\n]\",\"transformers\":null}",
        "size": 3,
        "title": "Control Family ",
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "tab",
            "parameterName": "Tab",
            "parameterType": 1
          }
        ],
        "queryType": 8,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "tab",
              "formatter": 5
            }
          ]
        }
      },
      "customWidth": "30",
      "name": "Control Family ",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "7b682fc9-cb6b-4475-a24c-41dcb43d0cef",
            "version": "KqlParameterItem/1.0",
            "name": "isACVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "AC",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "c01e6494-1f74-4194-88b3-c98bbabdf84f",
            "version": "KqlParameterItem/1.0",
            "name": "isAUVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "AU",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "696bf441-12c0-45db-918c-215a1170f18e",
            "version": "KqlParameterItem/1.0",
            "name": "isATVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "AT",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isCMVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "CM",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "02596750-83d0-48ad-b9e0-2897e262ab29"
          },
          {
            "id": "a932ee8a-1039-4482-9fc8-ed79fe6f2ebb",
            "version": "KqlParameterItem/1.0",
            "name": "isIAVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "IA",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "2822f61e-a9f8-4419-87b6-f7b06a032cc2",
            "version": "KqlParameterItem/1.0",
            "name": "isIRVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "IR",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "bf0d48ca-a190-4545-a5db-0ba94598632b",
            "version": "KqlParameterItem/1.0",
            "name": "isMAVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "MA",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "customWidth": "5",
      "name": "Hidden Parameters Selectors"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Section\\\": \\\"Media Protection\\\", \\\"tab\\\": \\\"MP\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Personnel Security\\\", \\\"tab\\\": \\\"PS\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Physical Protection\\\", \\\"tab\\\": \\\"PE\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Risk Assessment\\\", \\\"tab\\\": \\\"RM\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Security Assessment\\\", \\\"tab\\\": \\\"CA\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"System & Communications Protection\\\", \\\"tab\\\": \\\"SC\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"System & Information Integrity\\\", \\\"tab\\\": \\\"SI\\\" }\\r\\n]\",\"transformers\":null}",
        "size": 3,
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "tab",
            "parameterName": "Tab",
            "parameterType": 1
          }
        ],
        "queryType": 8,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "tab",
              "formatter": 5
            }
          ]
        }
      },
      "customWidth": "30",
      "name": "Control Family  - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "308bde5a-386f-4674-a712-26e31436b12e",
            "version": "KqlParameterItem/1.0",
            "name": "isMPVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "MP",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "e18bc9ef-6479-4eda-807a-b47f58f5f2f1",
            "version": "KqlParameterItem/1.0",
            "name": "isPSVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "PS",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "401a85db-1c90-45b4-86d2-3e5439784818",
            "version": "KqlParameterItem/1.0",
            "name": "isPEVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "PE",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isRMVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "RM",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "0af0cea9-8f28-4850-b48e-93a195efa02b"
          },
          {
            "id": "e9fdb883-980a-4147-b494-43f7137f7131",
            "version": "KqlParameterItem/1.0",
            "name": "isCAVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "CA",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "c16d4f92-ce1a-4ff0-9576-23b39836e95d",
            "version": "KqlParameterItem/1.0",
            "name": "isSCVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SC",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isSIVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SI",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "9637281c-861a-4ba6-90cd-6650f187f00c"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "customWidth": "5",
      "name": "Hidden Parameters Selectors - Copy"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Section\\\": \\\"Assessment\\\", \\\"tab\\\": \\\"AS\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Level 1: Foundational\\\", \\\"tab\\\": \\\"ML1\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Level 2: Advanced\\\", \\\"tab\\\": \\\"ML2\\\" }\\r\\n]\",\"transformers\":null}",
        "size": 3,
        "title": "Level",
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "tab",
            "parameterName": "Tab",
            "parameterType": 1
          }
        ],
        "queryType": 8,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "tab",
              "formatter": 5
            }
          ]
        }
      },
      "customWidth": "25",
      "name": "Level",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "43dec56c-837a-448a-883c-7fb77d265ae0",
            "version": "KqlParameterItem/1.0",
            "name": "isASVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "AS",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "0f8e02ef-c3db-4938-80ac-238929482156",
            "version": "KqlParameterItem/1.0",
            "name": "isML1Visible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "ML1",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isML2Visible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "ML2",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "0b94fcd8-d50f-4d94-a6d0-978630b1a05c"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "customWidth": "5",
      "name": "Hidden Parameters Selectors for ML"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## Getting Started\r\nThis solution is designed to augment staffing through automation, query/alerting generation, and visualizations, and alerting. This solution leverages Azure Policy, Azure Resource Graph, and Azure Log Analytics to align with Cybersecurity Maturity Model Certification 2.0 control requirements. A filter set is available for custom reporting by guides, subscriptions, workspaces, time-filtering, control family, and maturity level. This offering telemetry from 50+ Microsoft Security products, while only Microsoft Sentinel/Microsoft Defender for Cloud are required to get started, each offering provides additional enrichment for aligning with control requirements. Each CMMC control includes a Control Card detailing an overiew of requirements, primary/secondary controls, deep-links to referenced product pages/portals, recommendations, implementation guides, compliance cross-walks and tooling telemetry for building situational awareness of cloud workloads. <br>\r\nüí° [Planning: Review Microsoft Product Placemat for CMMC 2.0](https://aka.ms/cmmc/productplacemat)<br>\r\nüí° [Onboard Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/quickstart-onboard)<br>\r\nüí° [Onboard Microsoft Defender for Cloud](https://docs.microsoft.com/azure/security-center/security-center-get-started)<br>\r\nüí° [Add the Microsoft Defender for Cloud: NIST SP 800 171 R2 Assessment to Your Dashboard](https://docs.microsoft.com/azure/security-center/update-regulatory-compliance-packages#add-a-regulatory-standard-to-your-dashboard)<br>\r\nüí° [Continuously Export Security Center Data to Log Analytics Workspace](https://docs.microsoft.com/azure/security-center/continuous-export)<br>\r\nüí° [Extend Microsoft Sentinel Across Workspaces and Tenants](https://docs.microsoft.com/azure/sentinel/extend-sentinel-across-workspaces-tenants)<br>",
              "style": "info"
            },
            "name": "Help"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "Help",
        "comparison": "isEqualTo",
        "value": "Yes"
      },
      "customWidth": "66",
      "name": "group - 30"
    },
    {
      "type": 1,
      "content": {
        "json": "![Image Name](https://www.acq.osd.mil/cmmc/imgs/cmmc2-levels-st.png) \r\nFor more information, see theüí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
      },
      "conditionalVisibility": {
        "parameterName": "Help",
        "comparison": "isEqualTo",
        "value": "Yes"
      },
      "customWidth": "33",
      "name": "text - 29"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Assessment\r\n---\r\n\r\nThe Assessment section provides a mechanism to find, fix, and resolve CMMC recommendations aligned to NIST SP 800-171. A selector provides capability to filter by all, specific, or groups of  control ids. Upon selection, subordinate panels will summarize CMMC recommendations by control family, status over time, recommendations, and resources identified. These panels are helpful for identifying the CMMC control areas of interest, status over time, and which resources are most impacted by these vulnerabilties. The CMMC Recommendation details provides a mechanism to identify specific recommendation details with deep-links to pivot to Microsoft Defender for Cloud: Regulatory Compliance for remediation."
            },
            "customWidth": "49",
            "name": "NS Guide"
          },
          {
            "type": 1,
            "content": {
              "json": ""
            },
            "customWidth": "5",
            "name": "text - 11"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "parameters": [
                {
                  "id": "99a47f97-1aa4-4840-91ee-119aad6d6217",
                  "version": "KqlParameterItem/1.0",
                  "name": "Level",
                  "label": "CMMC 2.0 Level",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "SecurityRegulatoryCompliance\r\n| where ComplianceStandard == \"NIST-SP-800-171-R2\"\r\n| extend Level=iff(ComplianceControl in (\"3.1.1\",\"3.1.2\",\"3.1.20\",\"3.1.22\",\"3.4.1\",\"3.5.2\",\"3.5.2\",\"3.8.3\",\"3.13.1\",\"3.13.5\",\"3.14.1\",\"3.14.2\",\"3.14.4\",\"3.14.5\"), \"Level 1: Foundational\",\"Level 2: Advanced\")\r\n| summarize count() by Level\r\n| project-away count_\r\n| sort by Level asc",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "value": [
                    "Level 1: Foundational"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 2592000000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "40",
            "name": "parameters - 26"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRegulatoryCompliance\r\n| where ComplianceStandard == \"NIST-SP-800-171-R2\"\r\n| extend Level=iff(ComplianceControl in (\"3.1.1\",\"3.1.2\",\"3.1.20\",\"3.1.22\",\"3.4.1\",\"3.5.2\",\"3.5.2\",\"3.8.3\",\"3.13.1\",\"3.13.5\",\"3.14.1\",\"3.14.2\",\"3.14.4\",\"3.14.5\"), \"Level 1: Foundational\",\"Level 2: Advanced\")\r\n| where Level in ({Level})\r\n| summarize arg_max(TimeGenerated, *) by RecommendationName, AssessedResourceId, Level\r\n|‚ÄØsummarize‚ÄØFailed‚ÄØ=‚ÄØcountif(State‚ÄØ==‚ÄØ\"Failed\"),‚ÄØPassed‚ÄØ=‚ÄØcountif(State‚ÄØ==‚ÄØ\"Passed\"),‚ÄØTotal‚ÄØ=‚ÄØcountif(State‚ÄØ==‚ÄØ\"Passed\" or State == \"Failed\") by Level\r\n|‚ÄØextend‚ÄØPassedControls‚ÄØ= (Passed/todouble(Total))*100\r\n| project Level, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "üîÄ Recommendations by Level",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "timeContext": {
                "durationMs": 2592000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Total",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "[\"Passed\"]/[\"Total\"]",
                        "columnSettings": [
                          {
                            "columnName": "Passed",
                            "color": "green"
                          },
                          {
                            "columnName": "Failed",
                            "color": "redBright"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "PassedControls",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 1,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true,
                        "minimumIntegerDigits": 2,
                        "minimumFractionDigits": 2,
                        "maximumFractionDigits": 2,
                        "minimumSignificantDigits": 2,
                        "maximumSignificantDigits": 4
                      }
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "yellowOrangeRed"
                    }
                  },
                  {
                    "columnMatch": "total_controls_curr",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "[\"Passed\"]/[\"Failed\"]",
                        "columnSettings": [
                          {
                            "columnName": "Passed",
                            "color": "green"
                          },
                          {
                            "columnName": "Failed",
                            "color": "redBright"
                          }
                        ]
                      }
                    }
                  }
                ],
                "filter": true
              }
            },
            "customWidth": "50",
            "name": "query - 6"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRegulatoryCompliance\r\n| where ComplianceStandard == \"NIST-SP-800-171-R2\"\r\n| extend Level=iff(ComplianceControl in (\"3.1.1\",\"3.1.2\",\"3.1.20\",\"3.1.22\",\"3.4.1\",\"3.5.2\",\"3.5.2\",\"3.8.3\",\"3.13.1\",\"3.13.5\",\"3.14.1\",\"3.14.2\",\"3.14.4\",\"3.14.5\"), \"Level 1: Foundational\",\"Level 2: Advanced\")\r\n| where Level in ({Level})\r\n| summarize arg_max(TimeGenerated, *) by RecommendationName, AssessedResourceId\r\n|‚ÄØsummarize‚ÄØFailed‚ÄØ=‚ÄØcountif(State‚ÄØ==‚ÄØ\"Failed\"),‚ÄØPassed‚ÄØ=‚ÄØcountif(State‚ÄØ==‚ÄØ\"Passed\"),‚ÄØTotal‚ÄØ=‚ÄØcountif(State‚ÄØ==‚ÄØ\"Passed\" or State == \"Failed\") by RecommendationName\r\n|‚ÄØextend‚ÄØPassedControls‚ÄØ= (Passed/todouble(Total))*100\r\n| project RecommendationName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
              "size": 0,
              "showAnalytics": true,
              "title": "üîÄ Recommendations by Count",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Total",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "[\"Passed\"]/[\"Total\"]",
                        "columnSettings": [
                          {
                            "columnName": "Passed",
                            "color": "green"
                          },
                          {
                            "columnName": "Failed",
                            "color": "redBright"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "PassedControls",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 1,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true,
                        "minimumIntegerDigits": 2,
                        "minimumFractionDigits": 2,
                        "maximumFractionDigits": 2,
                        "minimumSignificantDigits": 2,
                        "maximumSignificantDigits": 4
                      }
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "yellowOrangeRed"
                    }
                  },
                  {
                    "columnMatch": "total_controls_curr",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "[\"Passed\"]/[\"Failed\"]",
                        "columnSettings": [
                          {
                            "columnName": "Passed",
                            "color": "green"
                          },
                          {
                            "columnName": "Failed",
                            "color": "redBright"
                          }
                        ]
                      }
                    }
                  }
                ],
                "filter": true
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 6 - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRegulatoryCompliance\r\n| where ComplianceStandard == \"NIST-SP-800-171-R2\"\r\n| extend Level=iff(ComplianceControl in (\"3.1.1\",\"3.1.2\",\"3.1.20\",\"3.1.22\",\"3.4.1\",\"3.5.2\",\"3.5.2\",\"3.8.3\",\"3.13.1\",\"3.13.5\",\"3.14.1\",\"3.14.2\",\"3.14.4\",\"3.14.5\"), \"Level 1: Foundational\",\"Level 2: Advanced\")\r\n| where Level in ({Level})\r\n| join kind=inner(SecurityRecommendation) on RecommendationName\r\n| extend ResourceID=tolower(AssessedResourceId1)\r\n| summarize arg_max(TimeGenerated, *) by RecommendationName, ResourceID\r\n| where State == \"Failed\"\r\n| summarize count() by ResourceID\r\n| sort by count_ desc\r\n| limit 250",
              "size": 0,
              "showAnalytics": true,
              "title": " üîÄ Recommendations by Asset",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "count_",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "yellowOrangeRed"
                    }
                  },
                  {
                    "columnMatch": "RecommendationDisplayName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "warning",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "State",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "ControlID",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Recommendation",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to Recommendation >"
                    }
                  }
                ],
                "filter": true
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 8"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRegulatoryCompliance\r\n| where ComplianceStandard == \"NIST-SP-800-171-R2\"\r\n| extend Level=iff(ComplianceControl in (\"3.1.1\",\"3.1.2\",\"3.1.20\",\"3.1.22\",\"3.4.1\",\"3.5.2\",\"3.5.2\",\"3.8.3\",\"3.13.1\",\"3.13.5\",\"3.14.1\",\"3.14.2\",\"3.14.4\",\"3.14.5\"), \"Level 1: Foundational\",\"Level 2: Advanced\")\r\n| where Level in ({Level})\r\n| where State == \"Failed\"\r\n| make-series count() default=0 on TimeGenerated from startofday({TimeRange:start}) to startofday({TimeRange:end}) step 1d by Level\r\n| render timechart",
              "size": 0,
              "showAnalytics": true,
              "title": "üîÄ Posture over Time",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "timeContext": {
                "durationMs": 2592000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "RecommendationDisplayName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "warning",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "State",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "ControlID",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Recommendation",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to Recommendation >"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "query - 7"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRegulatoryCompliance\r\n| where ComplianceStandard == \"NIST-SP-800-171-R2\"\r\n| extend Level=iff(ComplianceControl in (\"3.1.1\",\"3.1.2\",\"3.1.20\",\"3.1.22\",\"3.4.1\",\"3.5.2\",\"3.5.2\",\"3.8.3\",\"3.13.1\",\"3.13.5\",\"3.14.1\",\"3.14.2\",\"3.14.4\",\"3.14.5\"), \"Level 1: Foundational\",\"Level 2: Advanced\")\r\n| where Level in ({Level})\r\n| join kind=inner(SecurityRecommendation) on RecommendationName\r\n| extend ResourceID=tolower(AssessedResourceId1)\r\n| summarize arg_max(TimeGenerated, *) by RecommendationName, ResourceID\r\n| extend RemediationLink = RecommendationLink\r\n| where State == \"Failed\"\r\n| project RecommendationDisplayName, Level, ResourceID, State, RecommendationSeverity, RemediationLink, FirstEvaluationDate, TimeGenerated\r\n| limit 250",
              "size": 0,
              "showAnalytics": true,
              "title": " üîÄ  Recommendation Details",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "RecommendationDisplayName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "warning",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "State",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "RemediationLink",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Quick Fix >>"
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "yellowOrangeRed"
                    }
                  },
                  {
                    "columnMatch": "ControlID",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Recommendation",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to Recommendation >"
                    }
                  }
                ],
                "filter": true
              }
            },
            "name": "query - 9"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isASVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Assessment"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Access Control \r\n---\r\nAccess Control is the process of authorizing users, groups, and computers to access objects on a network, asset, and/or cloud. Key concepts that make up access control are permissions, ownership of objects, inheritance of permissions, user rights, and object auditing.¬†For more information, see the üí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 1: Foundational",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "The Department views Level 1 (‚ÄúFoundational‚Äù) as an opportunity to engage its contractors in developing and strengthening their approach to cybersecurity. Because Level 1 does not involve sensitive national security information, DoD intends for this Level to allow companies to assess their own cybersecurity and begin adopting practices that will thwart cyber-attacks. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 2"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "AC.L1-3.1.1",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L1-3.1.1) Authorized Access Control",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "AC.L1-3.1.2",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L1-3.1.2) Transaction & Function Control",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "AC.L1-3.1.20",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L1-3.1.20) External Connections",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "AC.L1-3.1.22",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L1-3.1.22) Control Public Information",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML1 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AC.L1-3.1.1) Authorized Access Control](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#limit-information-system-access-to-authorized-users-processes-acting-on-behalf-of-authorized-users-and-devices-including-other-information-systems)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è[Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Customer Lockbox](https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview)   üîÄ[Customer Lockbox](https://portal.azure.com/#blade/Microsoft_Azure_Lockbox/LockboxMenu/Overview)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs \r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-2, AC-3, AC-17](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| where ResultType == 0\r\n| summarize count() by UserPrincipalName, UserProfile\r\n| project UserPrincipalName, count_, UserProfile\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "AAD User Profiles",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to User Profile >"
                                }
                              },
                              {
                                "columnMatch": "UserRoles",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Roles >"
                                }
                              },
                              {
                                "columnMatch": "AdminRoles",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to AdminRoles >"
                                }
                              },
                              {
                                "columnMatch": "Groups",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Groups >"
                                }
                              },
                              {
                                "columnMatch": "Applications",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Apps >"
                                }
                              },
                              {
                                "columnMatch": "Licenses",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Licenses >"
                                }
                              },
                              {
                                "columnMatch": "Devices",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Devices >"
                                }
                              },
                              {
                                "columnMatch": "AzureRoles",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to AzureRoles >"
                                }
                              },
                              {
                                "columnMatch": "SignIns",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to SignIns >"
                                }
                              },
                              {
                                "columnMatch": "AuditLogs",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to AuditLogs >"
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "AzureActiveDirectoryProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to AAD Profile >"
                                }
                              },
                              {
                                "columnMatch": "IncidentCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "AlertCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "orange"
                                }
                              },
                              {
                                "columnMatch": "AnomalyCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "yellow"
                                }
                              }
                            ],
                            "rowLimit": 1000,
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 5"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L1-3.1.1",
                  "styleSettings": {
                    "margin": "3",
                    "padding": "3",
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AC.L1-3.1.2) Transaction & Function Control)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#limit-information-system-access-to-the-types-of-transactions-and-functions-that-authorized-users-are-permitted-to-execute)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-2, AC-3, AC-17](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AuditLogs\r\n| extend UserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize Runs = count(), Success = countif(Result == 'success'), Fails = countif(Result != 'success') by UserPrincipalName, OperationName, UserProfile // Summarize the total, successful and failed operations by name\r\n| extend SuccessRate = (Success * 100 / Runs) // Calculate the percentage of succesful operations against the total\r\n| summarize count() by UserPrincipalName, UserProfile, OperationName, Runs, SuccessRate, Fails\r\n| where UserPrincipalName <> \"\"\r\n| sort by Runs desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "User Actions",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "OperationName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Runs",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "SuccessRate",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "green"
                                }
                              },
                              {
                                "columnMatch": "Fails",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "red"
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "UserId",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "OfficeWorkload",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": []
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L1-3.1.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AC.L1-3.1.20) External Connections](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#verify-and-controllimit-connections-to-and-use-of-external-information-systems)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.20](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-20, AC-20(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where Location <> \"\"\r\n| where ResultType == 0\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| extend latitude_ = tostring(parse_json(tostring(LocationDetails.geoCoordinates)).latitude)\r\n| extend longitude_ = tostring(parse_json(tostring(LocationDetails.geoCoordinates)).longitude)\r\n| extend City = tostring(LocationDetails.city)\r\n| summarize count() by UserPrincipalName, City, Location, UserProfile\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "User Sign-In Location Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "City",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Location",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4 - Copy"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where Location <> \"\"\r\n| where ResultType == 0\r\n| extend latitude_ = tostring(parse_json(tostring(LocationDetails.geoCoordinates)).latitude)\r\n| extend longitude_ = tostring(parse_json(tostring(LocationDetails.geoCoordinates)).longitude)\r\n| extend city_ = tostring(LocationDetails.city)\r\n",
                          "size": 2,
                          "title": "User Sign-Ins by Geolocation",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "map",
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 12,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot",
                              "heatmapMax": 100
                            },
                            "numberFormatSettings": {
                              "unit": 0,
                              "options": {
                                "style": "decimal",
                                "useGrouping": false
                              }
                            }
                          }
                        },
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "AC.L1-3.1.20",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AC.L1-3.1.22) Control Public Information\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.22](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-22](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| distinct UserId_s, LabelName_s, ApplicationName_s_s, Operation_s_s, Protected_b_s, Platform_s_s, Activity_s_s, ProtectionOwner_s, TimeGenerated_s\r\n| sort by TimeGenerated_s desc\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Azure Information Protection Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserId_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| extend Href_ = tostring(parse_json(ExtendedLinks)[0].Href)\r\n| extend UserPrincipalName = UPN\r\n| distinct UserPrincipalName, AlertName, ProductName, Status, AlertLink, Tactics, TimeGenerated\r\n| where AlertName contains \"sensitive\" or AlertName contains \"data\" or AlertName contains \"leak\" or Tactics contains \"exfil\" or AlertName contains \"theft\" or AlertName contains \"steal\" or AlertName contains \"PII\" or AlertName contains \"intellectual\" or AlertName contains \"confidential\" or AlertName contains \"spill\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                          "size": 0,
                          "title": "Sensitive Data Leaks Alert Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-S",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": ""
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "name": "AC.L1-3.1.22",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 1: Foundational"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "AC.L2-3.1.3",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.3) Control CUI Flow",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "AC.L2-3.1.4",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.4) Separation of Duties",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "AC.L2-3.1.5",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.5) Least Privilege",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "AC.L2-3.1.6",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.6) Non-Privileged Account Use",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "4d1f48b7-288c-45e0-a5ae-c97f985f70df",
                        "cellValue": "AC.L2-3.1.7",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.7) Privileged Functions",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "0e930a4d-5f98-482e-8f40-1a6d7fe76624",
                        "cellValue": "AC.L2-3.1.8",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.8) Unsuccessful Logon Attempts",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "6b993013-ec61-4240-9ff3-9b40202600a5",
                        "cellValue": "AC.L2-3.1.9",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.9) Privacy & Security Notices",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "746b1e32-83d7-43f1-a5d0-736dc395da72",
                        "cellValue": "AC.L2-3.1.10",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.10) Session Lock",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "63abaa8d-ff61-466d-a7b2-831c762f815f",
                        "cellValue": "AC.L2-3.1.11",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.11) Session Termination",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "821f90c8-c8b9-4e44-8c36-6ef941067414",
                        "cellValue": "AC.L2-3.1.12",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.12) Control Remote Access",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "fadab5cc-f1af-4e14-9b12-5f89d0f9019d",
                        "cellValue": "AC.L2-3.1.13",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.13) Remote Access Confidentiality",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7457ace-577b-431d-96ff-e20f1ccc96d2",
                        "cellValue": "AC.L2-3.1.14",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.14) Remote Access Routing",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "6692d0f2-780b-49eb-bb36-820d2deba69b",
                        "cellValue": "AC.L2-3.1.15",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.15) Privileged Remote Access",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "0cfbbeec-14fd-46fb-b0f9-ecd9684fff55",
                        "cellValue": "AC.L2-3.1.16",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.16) Wireless Access Authorization",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "383e7847-f3c0-4eb1-83ae-b543e0d6517a",
                        "cellValue": "AC.L2-3.1.17",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.17) Wireless Access Protection",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "3aa3e366-4e87-43c5-a659-d57efa973982",
                        "cellValue": "AC.L2-3.1.18",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.18) Mobile Device Connection",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "a43a2e61-68f8-4def-8d3c-876c02cecbf4",
                        "cellValue": "AC.L2-3.1.19",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.19) Encrypt CUI on Mobile",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "8e98f555-d83c-482d-8976-80336dacc81e",
                        "cellValue": "AC.L2-3.1.21",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AC.L2-3.1.21) Portable Storage Use",
                        "preText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AC.L2-3.1.3) Control CUI Flow](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#control-the-flow-of-cui-in-accordance-with-approved-authorizations)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Microsoft Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Microsoft 365 Compliance Manager](https://compliance.microsoft.com/informationprotection)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-4](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| limit 250\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Azure Information Protection Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserId_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.3",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AC.L2-3.1.4) Separation of Duties](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#separate-the-duties-of-individuals-to-reduce-the-risk-of-malevolent-activity-without-collusion)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"member\" or RecommendationDisplayName contains \"owner\" or RecommendationDisplayName contains \"group\"\r\n| where RecommendationDisplayName !contains \"security group\"\r\n| where RecommendationDisplayName !contains \"Email\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.4",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AC.L2-3.1.5) Least Privilege](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#employ-the-principle-of-least-privilege-including-for-specific-security-functions-and-privileged-accounts)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-6, AC-6(1), AC-6(5)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AuditLogs\r\n| where OperationName contains \"PIM\"\r\n| distinct OperationName, Identity, AADOperationType, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Privileged Identity Management (PIM) Actions",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "GrantedTo",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD Profile >"
                                }
                              },
                              {
                                "columnMatch": "OperationName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "pending",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.5",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AC.L2-3.1.6) Non-Privileged Account Use](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#use-non-privileged-accounts-or-roles-when-accessing-nonsecurity-functions)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-6(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"user\" or RecommendationDisplayName contains \"account\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.6",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AC.L2-3.1.7) Privileged Functions](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#prevent-non-privileged-users-from-executing-privileged-functions-and-capture-the-execution-of-such-functions-in-audit-logs)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.7](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-6(9), AC-6(10)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"audit\" or RecommendationDisplayName contains \"priv\" or RecommendationDisplayName contains \"log\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.7",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AC.L2-3.1.8) Unsuccessful Logon Attempts\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Password Protection for Azure AD](https://docs.microsoft.com/azure/active-directory/authentication/howto-password-ban-bad-on-premises-deploy)   üîÄ[Azure AD Password Protection](https://portal.azure.com/#blade/Microsoft_AAD_IAM/PasswordProtectionBlade)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.8](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-7](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let¬†data¬†=¬†SigninLogs\r\n|where¬†AppDisplayName¬†in¬†('*')¬†or¬†'*'¬†in¬†('*')\r\n|where¬†UserDisplayName¬†in¬†('*')¬†or¬†'*'¬†in¬†('*')\r\n|extend¬†errorCode¬†=¬†Status.errorCode\r\n|extend¬†SigninStatus¬†=¬†case(errorCode¬†==¬†0,¬†\"Success\",¬†errorCode¬†==¬†50058,¬†\"Pending¬†user¬†action\",errorCode¬†==¬†50140,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†51006,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50059,¬†\"Pending¬†user¬†action\",errorCode¬†==¬†65001,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†52004,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50055,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50144,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50072,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50074,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†16000,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†16001,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†16003,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50127,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50125,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50129,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50143,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†81010,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†81014,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†81012¬†,\"Pending¬†user¬†action\",¬†\"Failure\");\r\ndata\r\n|¬†summarize¬†Count¬†=¬†count()¬†by¬†SigninStatus\r\n|¬†join¬†kind¬†=¬†fullouter¬†(datatable(SigninStatus:string)['Success',¬†'Pending¬†action¬†(Interrupts)',¬†'Failure'])¬†on¬†SigninStatus\r\n|¬†project¬†SigninStatus¬†=¬†iff(SigninStatus¬†==¬†'',¬†SigninStatus1,¬†SigninStatus),¬†Count¬†=¬†iff(SigninStatus¬†==¬†'',¬†0,¬†Count)\r\n|¬†join¬†kind¬†=¬†inner¬†(data\r\n|¬†make-series¬†Trend¬†=¬†count()¬†default¬†=¬†0¬†on¬†TimeGenerated¬†from¬†ago(14d)¬†to¬†now()¬†step¬†6h¬†by¬†SigninStatus)\r\n¬†¬†¬†¬†on¬†SigninStatus\r\n|¬†project-away¬†SigninStatus1,¬†TimeGenerated\r\n|¬†extend¬†Status¬†=¬†SigninStatus\r\n|¬†union¬†(\r\n¬†¬†¬†¬†data¬†\r\n|¬†summarize¬†Count¬†=¬†count()¬†\r\n|¬†extend¬†jkey¬†=¬†1\r\n|¬†join¬†kind=inner¬†(data\r\n|¬†make-series¬†Trend¬†=¬†count()¬†default¬†=¬†0¬†on¬†TimeGenerated¬†from¬†ago(14d)¬†to¬†now()¬†step¬†6h\r\n|¬†extend¬†jkey¬†=¬†1)¬†on¬†jkey\r\n|¬†extend¬†SigninStatus¬†=¬†'All¬†Sign-ins',¬†Status¬†=¬†'*'¬†¬†¬†¬†\r\n)\r\n|¬†order¬†by¬†Count¬†desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Login Status Codes by Count",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| extend Alert_Link = tostring(parse_json(ExtendedLinks)[1].Href)\r\n| extend UserPrincipalName = UPN\r\n| distinct Name, AlertName, ProductName, Status, Alert_Link, Tactics, TimeGenerated\r\n| where AlertName contains \"brute\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Sign-In: Brute Force Alerts",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Name",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "is Empty",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Alert_Link",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": ""
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": ""
                                }
                              },
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.8",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AC.L2-3.1.9) Privacy & Security Notices\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Recommended Configuration\r\nüí° [Add Terms of Use](https://docs.microsoft.com/azure/active-directory/conditional-access/terms-of-use#add-terms-of-use)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.9](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-8](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "//Configure Azure Active Direcotry Terms of Use: https://docs.microsoft.com/azure/active-directory/conditional-access/terms-of-use#add-terms-of-use\r\nlet nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n|extend CAStatus = case(ConditionalAccessStatus == \"failure\", \"Failed\",                                     \r\n                    ConditionalAccessStatus == \"notApplied\", \"Not applied\",                                     \r\n                    isempty(ConditionalAccessStatus), \"Not applied\", \r\n                    \"Disabled\")\r\n|mvexpand ConditionalAccessPolicies\r\n|extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0])\r\n|extend CAGrantControl = case(CAGrantControlName contains \"Terms of Use\", \"Require Terms of Use\", \r\n                            CAGrantControlName contains \"Privacy\", \"Require Privacy Statement\",\r\n                            \"Other\");\r\ndata\r\n| where CAGrantControlName <> \"\"\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize count() by UserPrincipalName, UserProfile, AppDisplayName, CAGrantControlName, ConditionalAccessStatus\r\n| where CAGrantControlName contains \"Privacy\" or CAGrantControlName contains \"Term\"\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "User Terms of Use and/or Privacy Statements (Not Applied) to Sign-In",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "ConditionalAccessStatus",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.9",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AC.L2-3.1.10) Session Lock\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Recommended Configuration\r\nüí° [Configure screen lock settings using Intune](https://docs.microsoft.com/mem/intune/configuration/device-restrictions-windows-10#locked-screen-experience)<br>\r\nüí° [Grant access to resources if devices are marked as compliant](https://docs.microsoft.com/azure/active-directory/conditional-access/require-managed-devices#require-device-to-be-marked-as-compliant)<br>\r\nüí° [Conceal Passwords with Password Box](https://docs.microsoft.com/windows/uwp/design/controls-and-patterns/password-box)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.10](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-11, AC-11(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where DeviceDetail.isCompliant <> \"true\"\r\n| where DeviceDetail.isManaged == \"true\"\r\n| extend isCompliant = tostring(DeviceDetail.isCompliant)\r\n| extend isManaged = tostring(DeviceDetail.isManaged)\r\n| extend deviceId = tostring(DeviceDetail.deviceId)\r\n| extend trustType = tostring(DeviceDetail.trustType)\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize count() by UserPrincipalName, UserProfile, isCompliant, isManaged, deviceId, trustType\r\n| sort by count_ desc\r\n\r\n\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Configure Screen Lock and Monitor Managed Device Compliance",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "ConditionalAccessStatus",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.10",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AC.L2-3.1.11) Session Termination\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Application Gateway](https://azure.microsoft.com/services/application-gateway/)   üîÄ [Application Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks) <br>\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AADUserRiskEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/aaduserriskevents) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.11](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-12](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AADUserRiskEvents\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| extend countryOrRegion_ = tostring(Location.countryOrRegion)\r\n| extend city_ = tostring(Location.city)\r\n| extend state_ = tostring(Location.state)\r\n| extend latitude_ = tostring(parse_json(tostring(Location.geoCoordinates)).latitude)\r\n| extend longitude_ = tostring(parse_json(tostring(Location.geoCoordinates)).longitude)\r\n| summarize count() by UserPrincipalName, UserProfile, RiskLevel, RiskEventType, city_, countryOrRegion_, state_, latitude_, longitude_, IpAddress\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 3,
                          "showAnalytics": true,
                          "title": "AAD Identity Protection: Sign-in Risk by Geolocation",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "map",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UncommonActionVolume",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "UncommonAction",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "green"
                                }
                              },
                              {
                                "columnMatch": "FirstTimeUserAction",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "FirstTimeDeviceLogon",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "yellow"
                                }
                              },
                              {
                                "columnMatch": "IncidentCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "AlertCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "orange"
                                }
                              },
                              {
                                "columnMatch": "AnomalyCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "yellow"
                                }
                              }
                            ]
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "countryOrRegion_",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "countryOrRegion_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "countryOrRegion_",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "countryOrRegion_",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "redBright"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AADUserRiskEvents\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| extend countryOrRegion_ = tostring(Location.countryOrRegion)\r\n| extend city_ = tostring(Location.city)\r\n| extend state_ = tostring(Location.state)\r\n| extend latitude_ = tostring(parse_json(tostring(Location.geoCoordinates)).latitude)\r\n| extend longitude_ = tostring(parse_json(tostring(Location.geoCoordinates)).longitude)\r\n| summarize count() by UserPrincipalName, UserProfile, RiskLevel, RiskEventType, city_, countryOrRegion_, state_, latitude_, longitude_, IpAddress\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "AAD Identity Protection: User Sign-in Risk Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "RiskLevel",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "high",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "countryOrRegion_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "purpleDark"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "name": "query - 14"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.11",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AC.L2-3.1.12) Control Remote Access](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#monitor-and-control-remote-access-sessions)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/)   üîÄ[ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.12](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-17(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where Location <> \"\"\r\n| where ResultType == 0\r\n| extend latitude_ = tostring(parse_json(tostring(LocationDetails.geoCoordinates)).latitude)\r\n| extend longitude_ = tostring(parse_json(tostring(LocationDetails.geoCoordinates)).longitude)\r\n| extend city_ = tostring(LocationDetails.city)\r\n",
                          "size": 3,
                          "showAnalytics": true,
                          "title": "User Sign-Ins by Geolocation",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "map",
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 10,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            },
                            "numberFormatSettings": {
                              "unit": 0,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.12",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AC.L2-3.1.13) Remote Access Confidentiality\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Multi-Factor Authentication](https://azure.microsoft.com/services/active-directory/)    üîÄ[Multi-Factor Authentication](https://portal.azure.com/#blade/Microsoft_AAD_IAM/MultifactorAuthenticationMenuBlade/GettingStarted)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.13](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-17(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"crypt\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.13",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AC.L2-3.1.14) Privileged Remote Access](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#route-remote-access-via-managed-access-control-points)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)   üîÄ[Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/)   üîÄ[ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits)<br>\r\n‚ú≥Ô∏è [Named Locations](https://docs.microsoft.com/azure/active-directory/conditional-access/location-condition)   üîÄ[Azure AD Named Locations](https://portal.azure.com/#blade/Microsoft_AAD_IAM/NamedNetworksWithCountryBlade)<br>\r\n‚ú≥Ô∏è [Azure Front Door](https://azure.microsoft.com/services/frontdoor/)   üîÄ[Front Doors](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/frontdoors)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\n\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.14](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-17(3)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "where type contains \"network\" \r\n| project id,type,resourceGroup\r\n| order by type asc\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Network Assets",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Rule",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "yellowOrangeRed"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.14",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AC.L2-3.1.15) Privileged Remote Access](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#authorize-remote-execution-of-privileged-commands-and-remote-access-to-security-relevant-information)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Named Locations](https://docs.microsoft.com/azure/active-directory/conditional-access/location-condition)   üîÄ[Azure AD Named Locations](https://portal.azure.com/#blade/Microsoft_AAD_IAM/NamedNetworksWithCountryBlade)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [IdentityInfo](https://docs.microsoft.com/azure/azure-monitor/reference/tables/identityinfo)üî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.15](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-17(4)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "IdentityInfo\r\n| extend Roles = strcat(AssignedRoles)\r\n| extend Groups = strcat(GroupMembership)\r\n| where Roles contains \"security\" or Groups contains \"security\" or Roles contains \"admin\" or Groups contains \"admin\"\r\n| extend UserPrincipalName = MailAddress\r\n| join (SigninLogs) on UserPrincipalName\r\n// where Location <> \"US\" // Exempt Non Remote Locations\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| distinct UserPrincipalName, UserProfile, Roles, Groups, UserType, Location, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Security/Admin Users by Location",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile > "
                                }
                              },
                              {
                                "columnMatch": "Location",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.15",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AC.L2-3.1.16) Wireless Access Authorization\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Recommended Configuration\r\nüí° [Network Access Control (NAC)](https://docs.microsoft.com/mem/intune/protect/network-access-control-integrate)<br>\r\nüí° [Grant access to resources if devices are marked as compliant](https://docs.microsoft.com/azure/active-directory/conditional-access/)<br>\r\nüí° [Conditional Access with Intune](https://docs.microsoft.com/mem/intune/protect/conditional-access-intune-common-ways-use)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.16](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-18](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where DeviceDetail.isCompliant <> \"true\"\r\n| where DeviceDetail.isManaged == \"true\"\r\n| extend isCompliant = tostring(DeviceDetail.isCompliant)\r\n| extend isManaged = tostring(DeviceDetail.isManaged)\r\n| extend deviceId = tostring(DeviceDetail.deviceId)\r\n| extend trustType = tostring(DeviceDetail.trustType)\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize count() by UserPrincipalName, UserProfile, isCompliant, isManaged, deviceId, trustType\r\n| sort by count_ desc\r\n\r\n\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Configure Network Access Control and Monitor Managed Device Compliance",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "ConditionalAccessStatus",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.16",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AC.L2-3.1.17) Wireless Access Protection\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Recommended Configuration\r\nüí° [Use a Custom Device Profile to Create a WiFi Profile with a Pre-Shared Key in Intune](https://docs.microsoft.com/mem/intune/configuration/wi-fi-profile-shared-key)<br>\r\nüí° [Using NAC with Conditional Access & Intune](https://docs.microsoft.com/mem/intune/protect/conditional-access-intune-common-ways-use)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.17](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-18(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where DeviceDetail.isCompliant <> \"true\"\r\n| where DeviceDetail.isManaged == \"true\"\r\n| extend isCompliant = tostring(DeviceDetail.isCompliant)\r\n| extend isManaged = tostring(DeviceDetail.isManaged)\r\n| extend deviceId = tostring(DeviceDetail.deviceId)\r\n| extend trustType = tostring(DeviceDetail.trustType)\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize count() by UserPrincipalName, UserProfile, isCompliant, isManaged, deviceId, trustType\r\n| sort by count_ desc\r\n\r\n\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Configure Network Access Control and Monitor Managed Device Compliance",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "ConditionalAccessStatus",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.17",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AC.L2-3.1.18) Mobile Device Connection\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.18](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-19](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| extend OperatingSystem = tostring(DeviceDetail.operatingSystem)\r\n| extend Browser = tostring(DeviceDetail.browser)\r\n| where OperatingSystem contains \"Android\" or OperatingSystem contains \"iOS\"\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize count() by UserPrincipalName, UserProfile, OperatingSystem, Browser, AppDisplayName, IPAddress, Location\r\n| sort by count_ desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Mobile Device Access",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile > "
                                }
                              },
                              {
                                "columnMatch": "Location",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.18",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AC.L2-3.1.19) Encrypt CUI on Mobile\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Recommended Configurations\r\nüí° [How to Create and Assign App Protection Policies](https://docs.microsoft.com/mem/intune/apps/app-protection-policies)<br>\r\nüí° [App Protection Policies Overview](https://docs.microsoft.com/mem/intune/apps/app-protection-policy)<br> \r\nüí° [Microsoft Intune Protected Apps](https://docs.microsoft.com/mem/intune/apps/apps-supported-intune-apps)<br> \r\nüí° [Data Protection Framework Using App Protection Policies](https://docs.microsoft.com/mem/intune/apps/app-protection-framework)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.19](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-19(5)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "//Configure Azure Active Direcotry Terms of Use: https://docs.microsoft.com/azure/active-directory/conditional-access/terms-of-use#add-terms-of-use\r\nlet nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n|extend CAStatus = case(ConditionalAccessStatus == \"failure\", \"Failed\",                                     \r\n                    ConditionalAccessStatus == \"notApplied\", \"Not applied\",                                     \r\n                    isempty(ConditionalAccessStatus), \"Not applied\", \r\n                    \"Disabled\")\r\n|mvexpand ConditionalAccessPolicies\r\n| extend Conditional_AccessPolicies = strcat(ConditionalAccessPolicies.displayName)\r\n|extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0]);\r\ndata\r\n| where CAGrantControlName <> \"\"\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize count() by UserPrincipalName, UserProfile, AppDisplayName, Conditional_AccessPolicies, ConditionalAccessStatus\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Configure App Protection Policy and Monitor Conditional Access Policies",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "ConditionalAccessStatus",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.19",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AC.L2-3.1.21) Portable Storage Use\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Named Locations](https://docs.microsoft.com/azure/active-directory/conditional-access/location-condition)   üîÄ[Azure AD Named Locations](https://portal.azure.com/#blade/Microsoft_AAD_IAM/NamedNetworksWithCountryBlade)<br>\r\n\r\n## Recommended Configuration\r\nüí° [How to Control USB Devices and Other Removable Media Using Microsoft Intune](https://docs.microsoft.com/windows/security/threat-protection/device-control/control-usb-devices-using-intune)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.21](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-20(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "DeviceEvents\r\n| where InitiatingProcessFolderPath <> \"\" \r\n| where InitiatingProcessFolderPath !contains \"c:\" or ActionType contains \"usb\"\r\n| summarize count() by DeviceName, ActionType, AccountName, InitiatingProcessFolderPath\r\n| sort by count_ desc\r\n| limit 250\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Monitor Portable Storage Devices",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "DeviceName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AccountName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "is Empty",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "yellow"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AC.L2-3.1.21",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isACVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Access Control Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Awareness & Training\r\n---\r\nAwareness & Training is focused on controlling human access to systems, networks, and assets. Personnel Security includes considerations for screening individuals with access to Controlled Unclassified Information (CUI) and protection of such data after personnel actions such as terminations or transfers.¬†For more information, see the üí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security."
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "AT.2.056 > AT.3.058",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AT.L2-3.2.1) Role-Based Risk Awareness",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "3e97829b-9622-49ce-8991-efc8e4d0ce47",
                        "cellValue": "AT.2.056 > AT.3.058",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AT.L2-3.2.2) Role-Based Training",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "68d97a98-0320-42d5-93c0-2746fd2848c4",
                        "cellValue": "AT.2.056 > AT.3.058",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AT.L2-3.2.3) Insider Threat Awareness",
                        "preText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## (AT.L2-3.2.1) Role-Based Risk Awareness <br>\r\n## (AT.L2-3.2.2) Role-Based Training <br>\r\n## (AT.L2-3.2.3) Insider Threat Awareness <br>\r\n\r\n## Recommended Resources\r\nüí° [Microsoft Certified: Security Operations Analyst Associate](https://docs.microsoft.com/learn/certifications/security-operations-analyst)<br>\r\nüí° [Learn Microsoft Sentinel on Microsoft Learn](https://techcommunity.microsoft.com/t5/itops-talk-blog/learn-azure-sentinel-on-microsoft-learn/ba-p/2006346)<br>\r\nüí° [Microsoft Sentinel Ninja Training Knowledge Check](https://techcommunity.microsoft.com/t5/azure-sentinel/what-s-new-azure-sentinel-ninja-training-knowledge-check/ba-p/2677696)<br>\r\nüí° [Manage Insider Risk](https://docs.microsoft.com/learn/modules/m365-compliance-insider-manage-insider-risk/)<br>\r\nüí° [Get Started Using Attack Simulation Training](https://docs.microsoft.com/microsoft-365/security/office-365-security/attack-simulation-training-get-started)<br>\r\nüí° [SimuLand: Understand adversary tradecraft and improve detection strategies](https://www.microsoft.com/security/blog/2021/05/20/simuland-understand-adversary-tradecraft-and-improve-detection-strategies/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)<br>\r\n## NIST SP 800-171 Mapping\r\n[3.2.1, 3.2.2, 3.2.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AT-2, AT-2(2), AT-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Leverage Microsoft Learn for Role-Based Training for Security Professionals \r\n![Image¬†Name](https://docs.microsoft.com/media/learn/home/hero_background_light.svg?branch=main)¬†\r\n[Go To: Microsoft Learn >](https://docs.microsoft.com/learn/)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AT.L2-3.2.1",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isATVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Awareness & Training Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Audit & Accountability\r\n---\r\nAudit & Accountability involves the evaluation of configurable security and logging options to help identify gaps in security policies and mechanisms. For more information, see the üí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "AU.L2-3.3.1",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AU.L2-3.3.1) System Auditing",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "AU.L2-3.3.2",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AU.L2-3.3.2) User Accountability",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "AU.L2-3.3.3",
                        "linkTarget": "step",
                        "linkLabel": " ‚ú≥Ô∏è (AU.L2-3.3.3) Event Review",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "2330d01a-9cdd-4486-a148-156a24d62535",
                        "cellValue": "AU.L2-3.3.4",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AU.L2-3.3.4) Audit Failure Alerting",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "a1cb27d3-1fc8-45be-8a67-d253368869cb",
                        "cellValue": "AU.L2-3.3.5",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AU.L2-3.3.5) Audit Correlation",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "58ab732e-ca0f-4f13-875b-a7ea41eaf347",
                        "cellValue": "AU.L2-3.3.6",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AU.L2-3.3.6) Reduction & Reporting",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "d67fe4ab-25ad-43d8-89db-aeafe0ea81a9",
                        "cellValue": "AU.L2-3.3.7",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AU.L2-3.3.7) Authoritative Time Source",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "86b54b81-210b-4f01-8cec-929d1b3615e0",
                        "cellValue": "AU.L2-3.3.8",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AU.L2-3.3.8) Audit Protection",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "a669d2e2-de0b-40c5-8d93-e521c8191510",
                        "cellValue": "AU.L2-3.3.9",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (AU.L2-3.3.9) Audit Management",
                        "preText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AU.L2-3.3.1) System Auditing](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#create-and-retain-system-audit-logs-and-records-to-the-extent-needed-to-enable-the-monitoring-analysis-investigation-and-reporting-of-unlawful-or-unauthorized-system-activity)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Datatable](https://docs.microsoft.com/azure/data-explorer/kusto/query/datatableoperator?pivots=azuremonitor) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-2, AU-3, AU-3(1), AU-6, AU-11, AU-12](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "union withsource=_TableName *\r\n| summarize Entries = count(), Size = sum(_BilledSize), last_log = datetime_diff(\"second\",now(), max(TimeGenerated)), estimate  = sumif(_BilledSize, _IsBillable==true)  by _TableName, _IsBillable\r\n| project ['Table Name'] = _TableName, ['Table Size'] = Size, ['Table Entries'] = Entries,\r\n          ['Size per Entry'] = 1.0 * Size / Entries, ['IsBillable'] = _IsBillable\r\n| order by ['Table Size']  desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Log Table Management",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Microsoft Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Microsoft Defender for Cloud Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Table Name",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Table Size",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "purple"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false
                                  }
                                }
                              },
                              {
                                "columnMatch": "Table Entries",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "turquoise"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false
                                  }
                                }
                              },
                              {
                                "columnMatch": "Size per Entry",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false
                                  }
                                }
                              },
                              {
                                "columnMatch": "IsBillable",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "True",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "False",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Important",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true,
                            "sortBy": [
                              {
                                "itemKey": "$gen_thresholds_IsBillable_4",
                                "sortOrder": 2
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_thresholds_IsBillable_4",
                              "sortOrder": 2
                            }
                          ],
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "DataType",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3 - Copy - Copy",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AU.L2-3.3.1",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AU.L2-3.3.2) User Accountability](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#ensure-that-the-actions-of-individual-system-users-can-be-uniquely-traced-to-those-users-so-they-can-be-held-accountable-for-their-actions)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-2, AU-3, AU-3(1), AU-6, AU-11, AU-12](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AzureActivity\r\n| where Caller <> \"\"\r\n| extend UserPrincipalName = Caller\r\n| join (SigninLogs) on UserPrincipalName\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| summarize count() by UserPrincipalName, UserProfile\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Azure User Activity by Action Count",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AU.L2-3.3.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AU.L2-3.3.3) Event Review\r\n\r\n## Primary Services\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Recommended Configurations\r\nüí° [Connect Data Sources](https://docs.microsoft.com/azure/sentinel/connect-data-sources)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-2(3)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Usage\r\n| summarize¬†count()¬†by¬†DataType\r\n| sort¬†by¬†count_¬†desc\r\n| limit 100",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Log Events Count by Log Type",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "gridSettings": {
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "DataType",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AU.L2-3.3.3",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AU.L2-3.3.4) Audit Failure Alerting](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#alert-in-the-event-of-an-audit-logging-process-failure)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Datatable](https://docs.microsoft.com/azure/data-explorer/kusto/query/datatableoperator?pivots=azuremonitor) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "union withsource = _TableName *\r\n| summarize last_log = datetime_diff(\"second\",now(), max(TimeGenerated)) by _TableName\r\n| where last_log > 0\r\n| project ['Table Name'] = _TableName, ['Last Record Received'] = last_log\r\n| order by ['Last Record Received'] desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Monitor Log Source Health ",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.                   ‚Ä¢    Confirm Log Source is Onboarded to Microsoft Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust Query Time Thresholds for a Larger Data-Set",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Last Record Received",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "orangeRed"
                                },
                                "numberFormat": {
                                  "unit": 24,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "Table Name",
                                "label": "Table name"
                              },
                              {
                                "columnId": "Last Record Received",
                                "label": "Last record recieved",
                                "comment": "When did the last record arrive?"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AU.L2-3.3.4",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AU.L2-3.3.5) Audit Correlation\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [BehaviorAnalytics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/behavioranalytics) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-6(3)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let AnomalousSigninActivity = BehaviorAnalytics\r\n    | where ActionType == \"Sign-in\"\r\n    | where (UsersInsights.NewAccount == True or UsersInsights.DormantAccount == True) and (\r\n        ActivityInsights.FirstTimeUserAccessedResource == True and ActivityInsights.ResourceUncommonlyAccessedAmongPeers == True\r\n        or ActivityInsights.FirstTimeUserUsedApp == True and ActivityInsights.AppUncommonlyUsedAmongPeers == False)\r\n    | join (\r\n        SigninLogs | where Status.errorCode == 0 or Status.errorCode == 0 and RiskDetail != \"none\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Successful Sign-in with one or more of the following indications: sign by new or recently dormant accounts and sign in with resource for the first time (while none of their peers did) or to an app for the first time (while none of their peers did) or performed by a user with Risk indicaiton from AAD\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet critical = dynamic(['9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3', 'c4e39bd9-1100-46d3-8c65-fb160da0071f', '158c047a-c907-4556-b7ef-446551a6b5f7', '62e90394-69f5-4237-9190-012177145e10', 'd29b2b05-8046-44ba-8758-1e26182fcf32', '729827e3-9c14-49f7-bb1b-9608f156bbb8', '966707d0-3269-4727-9be2-8c3a10f19b9d', '194ae4cb-b126-40b2-bd5b-6091b380977d', 'fe930be7-5e62-47db-91af-98c3a49a38b1']);\r\nlet high = dynamic(['cf1c38e5-3621-4004-a7cb-879624dced7c', '7495fdc4-34c4-4d15-a289-98788ce399fd', 'aaf43236-0c0d-4d5f-883a-6955382ac081', '3edaf663-341e-4475-9f94-5c398ef6c070', '7698a772-787b-4ac8-901f-60d6b08affd2', 'b1be1c3e-b65d-4f19-8427-f6fa0d97feb9', '9f06204d-73c1-4d4c-880a-6edb90606fd8', '29232cdf-9323-42fd-ade2-1d097af3e4de', 'be2f45a1-457d-42af-a067-6ec1fa63bc45', '7be44c8a-adaf-4e2a-84d6-ab2649e08a13', 'e8611ab8-c189-46e8-94e1-60213ab1f814']);//witdstomstl\r\nlet AnomalousRoleAssignment = AuditLogs\r\n    | where TimeGenerated > ago(28d)\r\n    | where OperationName == \"Add member to role\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target = tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner (\r\n        BehaviorAnalytics\r\n        | where ActionType == \"Add member to role\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend AnomalyName = \"Anomalous Role Assignemt\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access.  The query below generates an output of all high Blast Radius users performing Add member to priveleged role, or ones that add users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let LogOns=materialize(\r\n    BehaviorAnalytics\r\n    | where ActivityType == \"LogOn\");\r\nlet AnomalousResourceAccess = LogOns\r\n    | where ActionType == \"ResourceAccess\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous Resource Access\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversary may be trying to move through the environment. APT29 and APT32, for example, has used PtH & PtT techniques to lateral move around the network. The query below generates an output of all users performing an resource access (4624:3) to devices for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousRDPActivity = LogOns\r\n    | where ActionType == \"RemoteInteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous RDP Activity\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. FIN10, for example, has used RDP to move laterally to systems in the victim environment. The query below generates an output of all users performing a remote interactive logon (4624:10) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousLogintoDevices = LogOns\r\n    | where ActionType == \"InteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | where UsersInsights.DormantAccount == true or DevicesInsights.LocalAdmin == true\r\n    | extend AnomalyName = \"Anomalous Login To Devices\",\r\n        Tactic = \"Privilege Escalation\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access and privilege escalation. The query below generates an output of all administator users performing an interactive logon (4624:2) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousPasswordReset = BehaviorAnalytics\r\n    | where ActionType == \"Reset user password\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == \"True\"\r\n    | join (\r\n        AuditLogs\r\n        | where OperationName == \"Reset user password\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Password Reset\",\r\n        Tactic = \"Impact\",\r\n        Technique = \"Account Access Removal\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. LockerGoga, for example, has been observed changing account passwords and logging off current users. The query below generates an output of all users performing Reset user password for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalousGeoLocationLogon = BehaviorAnalytics\r\n    | where ActionType == \"Sign-in\"\r\n    | where ActivityInsights.FirstTimeUserConnectedFromCountry == True and (ActivityInsights.FirstTimeConnectionFromCountryObservedInTenant == True or ActivityInsights.CountryUncommonlyConnectedFromAmongPeers == True)\r\n    | join (\r\n        SigninLogs\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Initial Access\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access. The query below generates an output of successful Sign-in performed by a user from a new geo location he has never connected from before, and none of his peers as well.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousFailedLogon = BehaviorAnalytics\r\n    | where ActivityType == \"LogOn\"\r\n    | where UsersInsights.BlastRadius == \"High\"\r\n    | join (\r\n        SigninLogs  \r\n        | where Status.errorCode == 50126\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Failed Logon\",\r\n        Tactic = \"Credential Access\",\r\n        Technique = \"Brute Force\",\r\n        SubTechnique = \"Password Guessing\",\r\n        Description = \"Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Emotet, for example, has been observed using a hard coded list of passwords to brute force user accounts. The query below generates an output of all users with 'High' BlastRadius that perform failed Sign-in:Invalid username or password.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousAADAccountManipulation = AuditLogs\r\n    | where OperationName == \"Update user\"\r\n    | mv-expand AdditionalDetails\r\n    | where AdditionalDetails.key == \"UserPrincipalName\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner ( \r\n        BehaviorAnalytics\r\n        | where ActionType == \"Update user\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName) \r\n    | extend AnomalyName = \"Anomalous Account Manipulation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access. The query below generates an output of all high Blast Radius users performing 'Update user' (name change) to priveleged role, or ones that changed users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let AnomalousAADAccountCreation = BehaviorAnalytics\r\n    | where ActionType == \"Add user\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == True or ActivityInsights.FirstTimeActionPerformedInTenant == True or ActivityInsights.ActionUncommonlyPerformedAmongPeers == true\r\n    | join(\r\n        AuditLogs\r\n        | where OperationName == \"Add user\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend DisplayName = tostring(UsersInsights.AccountDisplayName),\r\n        UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Account Creation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Create Account\",\r\n        SubTechnique = \"Cloud Account\",\r\n        Description = \"Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system. The query below generates an output of all the users performing user creation for the first time and the target users that were created.\"\t\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalyTable = union kind=outer AnomalousSigninActivity, AnomalousRoleAssignment, AnomalousResourceAccess, AnomalousRDPActivity, AnomalousPasswordReset, AnomalousLogintoDevices, AnomalousGeoLocationLogon, AnomalousAADAccountManipulation, AnomalousAADAccountCreation, AnomalousFailedLogon;\r\nlet TopUsersByAnomalies = AnomalyTable\r\n    | summarize hint.strategy = shuffle AnomalyCount=count() by UserName, UserPrincipalName, tostring(UsersInsights.OnPremSid), tostring(UsersInsights.AccountObjectId)\r\n    | project Name=tolower(UserName), UPN=tolower(UserPrincipalName), AadUserId=UsersInsights_AccountObjectId, Sid=UsersInsights_OnPremSid, AnomalyCount\r\n    | sort by AnomalyCount desc;\r\nlet TopUsersByIncidents = SecurityIncident\r\n    | summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n    | where Status == \"New\" or Status == \"Active\"\r\n    | mv-expand AlertIds\r\n    | extend AlertId = tostring(AlertIds)\r\n    | join kind= innerunique ( \r\n        SecurityAlert \r\n        )\r\n        on $left.AlertId == $right.SystemAlertId\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n    | union TopUsersByAnomalies\r\n    | extend \r\n        AadPivot = iff(isempty(AadUserId), iff(isempty(Sid), Name, Sid), AadUserId),\r\n        SidPivot = iff(isempty(Sid), iff(isempty(AadUserId), Name, AadUserId), Sid),\r\n        UPNExists = iff(isempty(UPN), false, true),\r\n        NameExists = iff(isempty(Name), false, true),\r\n        SidExists = iff(isempty(Sid), false, true),\r\n        AADExists = iff(isempty(AadUserId), false, true)\r\n    | summarize hint.strategy = shuffle IncidentCount=dcount(IncidentNumber, 4), AlertCount=dcountif(AlertId, isnotempty(AlertId), 4), AnomalyCount=sum(AnomalyCount), any(Title, Severity, Status, StartTime, IncidentNumber, IncidentUrl, Owner), UPNAnchor=anyif(UPN, UPNExists == true), NameAnchor=anyif(Name, NameExists == true), AadAnchor=anyif(AadUserId, AADExists == true), SidAnchor=anyif(Sid, SidExists == true), any(SidPivot) by AadPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), NameAnchor=anyif(NameAnchor, isempty(NameAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_Title, any_Severity, any_StartTime, any_IncidentNumber, any_IncidentUrl) by any_SidPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_any_Title, any_any_Severity, any_any_StartTime, any_any_IncidentNumber, any_any_IncidentUrl) by NameAnchor\r\n    | project [\"UserName\"]=NameAnchor, IncidentCount, AlertCount, AnomalyCount, [\"AadUserId\"]=AadAnchor, [\"OnPremSid\"]=SidAnchor, [\"UserPrincipalName\"]=UPNAnchor;\r\nTopUsersByIncidents\r\n| project UserPrincipalName, IncidentCount, AlertCount, AnomalyCount\r\n| where UserPrincipalName !contains \"[\"\r\n| where UserPrincipalName <> \"\"\r\n| sort by IncidentCount desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "User Entity Behavior Analytics Alerts",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "AlertCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "orange"
                                }
                              },
                              {
                                "columnMatch": "AnomalyCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "yellow"
                                }
                              }
                            ],
                            "filter": true,
                            "sortBy": [
                              {
                                "itemKey": "$gen_heatmap_IncidentCount_1",
                                "sortOrder": 2
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_heatmap_IncidentCount_1",
                              "sortOrder": 2
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AU.L2-3.3.5",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AU.L2-3.3.6) Reduction & Reporting\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityIncident](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityincident) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-7](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident\r\n    | summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n    | mv-expand AlertIds\r\n    | extend AlertId = tostring(AlertIds)\r\n    | join kind= innerunique ( \r\n        SecurityAlert \r\n        )\r\n        on $left.AlertId == $right.SystemAlertId\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| extend Href_ = tostring(parse_json(ExtendedLinks)[0].Href)\r\n| where UPN <> \"\"\r\n| extend Workspace = tostring(parse_json(tostring(parse_json(ExtendedProperties).[\"Data Sources\"]))[0])\r\n| extend IncidentURL = strcat(\"https://portal.azure.com/#asset/Microsoft_Azure_Security_Insights/Incident/subscriptions/\",WorkspaceSubscriptionId,\"/resourceGroups/\",WorkspaceResourceGroup,\"/providers/Microsoft.OperationalInsights/workspaces/\",Workspace,\"/providers/Microsoft.SecurityInsights/Incidents/\",IncidentName)\r\n| where IncidentURL !contains \"//resourceGroups\"\r\n| distinct UPN, IncidentNumber, Title, Severity, ProductName, IncidentURL, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "User Security Incidents: Go-To >",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "is Empty",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "PersonWithFriend",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Title",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "error",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentURL",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": ""
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AU.L2-3.3.6",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AU.L2-3.3.7) Authoritative Time Source\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Recommended Configurations\r\nüí° [Time sync for Windows VMs in Azure](https://docs.microsoft.com/azure/virtual-machines/windows/time-sync)\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityBaseline](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securitybaseline) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.7](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-8, AU-8(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityBaseline\r\n| where Description contains \"NTP\" or Description contains \"clock\" or Description contains \"time\" or Description contains \"sync\"\r\n| summarize arg_max(TimeGenerated, *) by Description, _ResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Failed\"),\r\n    Passed‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Passed\"),\r\n    Total‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Failed\" or AnalyzeResult == \"Passed\")\r\n    by Description\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project Description, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Security Baselines for Time Synchronization",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Caller",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "DataType"
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1 - Copy"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AU.L2-3.3.7",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(AU.L2-3.3.8) Audit Protection](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#protect-audit-information-and-audit-logging-tools-from-unauthorized-access-modification-and-deletion)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.8](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-6(7), AU-9](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AzureActivity\r\n| where OperationName contains \"Delete\" or OperationName contains \"Remove\"\r\n| summarize count() by OperationName, Caller\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Monitor Activity (Delete/Remove) Actions",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "OperationName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Caller",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "Last Record Received",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "orangeRed"
                                },
                                "numberFormat": {
                                  "unit": 24,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AU.L2-3.3.8",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (AU.L2-3.3.9) Audit Management\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.9](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-6(7), AU-9](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AzureActivity\r\n| where CategoryValue == \"Administrative\"\r\n| where Resource contains \"security\"\r\n| where OperationName !contains \"license\"\r\n| summarize count() by OperationName, ResourceProvider, Caller\r\n| sort by count_ desc\r\n\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Security Administrative Actions",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Caller",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "AU.L2-3.3.9",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "group - 1"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isAUVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Audit and Accountability Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Configuration Management\r\n---\r\nConfiguration Management establishes security baselines and measuresdeviations provides the basis for tracking the security posture of cloud assets.¬†For more information, see the üí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "CM.L2-3.4.1",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (CM.L2-3.4.1) System Baselining",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "CM.L2-3.4.2",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (CM.L2-3.4.2) Security Configuration Enforcement",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "CM.L2-3.4.3",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (CM.L2-3.4.3) System Change Management",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "CM.L2-3.4.4",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (CM.L2-3.4.4) Security Impact Analysis",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "b8324480-bbbc-43bc-891e-c957307c1d7c",
                        "cellValue": "CM.L2-3.4.5",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (CM.L2-3.4.5) Access Restrictions for Change",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "cf958461-40d8-450c-bc8a-a868de00f93a",
                        "cellValue": "CM.L2-3.4.6",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (CM.L2-3.4.6) Least Functionality",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "a4366ffc-ae2c-4df0-b78f-1bf7bd744095",
                        "cellValue": "CM.L2-3.4.7",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (CM.L2-3.4.7) Nonessential Functionality",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "1648bde4-99eb-41c6-a0d1-fa70da74005c",
                        "cellValue": "CM.L2-3.4.8",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (CM.L2-3.4.8) Application Execution Policy",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "9a09f656-022c-4e0f-8479-7633fd98054a",
                        "cellValue": "CM.L2-3.4.9",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (CM.L2-3.4.9) User-Installed Software",
                        "preText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(CM.L2-3.4.1) System Baselining](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#establish-and-maintain-baseline-configurations-and-inventories-of-organizational-systems-including-hardware-software-firmware-and-documentation-throughout-the-respective-system-development-life-cycles)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\nüî∑ [DeviceEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/deviceevents) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)  <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-2, CM-6, CM-8, CM-8(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| project id,type,location,resourceGroup\r\n| order by location asc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Asset Inventory",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "InitiatingProcessFileName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Diagnostics",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Healthy",
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Unhealthy",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Environment",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Azure",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Direct Agent",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Agent",
                                      "representation": "turquoise",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Management Server",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Heartbeat Trend",
                                "formatter": 10,
                                "formatOptions": {
                                  "palette": "redGreen"
                                }
                              },
                              {
                                "columnMatch": "Details",
                                "formatter": 5
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "DeviceEvents\r\n| where InitiatingProcessFileName <> \"\"\r\n| summarize count() by InitiatingProcessFileName\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Software Baselines",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "InitiatingProcessFileName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Diagnostics",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Healthy",
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Unhealthy",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Environment",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Azure",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Direct Agent",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Agent",
                                      "representation": "turquoise",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Management Server",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Heartbeat Trend",
                                "formatter": 10,
                                "formatOptions": {
                                  "palette": "redGreen"
                                }
                              },
                              {
                                "columnMatch": "Details",
                                "formatter": 5
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 65",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "CM.L2-3.4.1",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(CM.L2-3.4.2) Security Configuration Enforcement](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#establish-and-enforce-security-configuration-settings-for-information-technology-products-employed-in-organizational-systems)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-2, CM-6,CM-8,CM-8(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"config\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "CM.L2-3.4.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(CM.L2-3.4.3) System Change Management](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#track-review-approve-or-disapprove-and-log-changes-to-organizational-systems)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Recommended Configurations\r\nüí° [Enable Change Tracking and Inventory From an Automation Account](https://docs.microsoft.com/azure/automation/change-tracking/enable-from-automation-account)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"log\" or RecommendationDisplayName contains \"audit\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "CM.L2-3.4.3",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (CM.L2-3.4.4) Security Impact Analysis\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [ConfigurationChange](https://docs.microsoft.com/azure/azure-monitor/reference/tables/configurationchange) ‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-4](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationState == \"Unhealthy\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by RecommendationSeverity\r\n| render areachart ",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Secure Score for Assessing/Monitoring Security Impacts",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ConfigChangeType",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Files",
                                      "representation": "File",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Registry",
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "CM.L2-3.4.4",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (CM.L2-3.4.5) Access Restrictions for Change\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [IdentityInfo](https://docs.microsoft.com/azure/azure-monitor/reference/tables/identityinfo) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "IdentityInfo\r\n| extend AssignedRoles = strcat(AssignedRoles)\r\n| distinct AccountUPN, AssignedRoles\r\n| project AccountUPN, AssignedRoles\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "User Assigned Roles",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "PercentageOfPassedRules",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "CriticalFailedRules",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "WarningFailedRules",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Healthy",
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Unhealthy",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Environment",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Azure",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Direct Agent",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Agent",
                                      "representation": "turquoise",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Management Server",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Heartbeat Trend",
                                "formatter": 10,
                                "formatOptions": {
                                  "palette": "redGreen"
                                }
                              },
                              {
                                "columnMatch": "Details",
                                "formatter": 5
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 65",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "CM.L2-3.4.5",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(CM.L2-3.4.5) Least Functionality](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#employ-the-principle-of-least-functionality-by-configuring-organizational-systems-to-provide-only-essential-capabilities)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-7](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"priv\" or RecommendationDisplayName contains \"access\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "CM.L2-3.4.6",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(CM.L2-3.4.6) Nonessential Functionality](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#restrict-disable-or-prevent-the-use-of-nonessential-programs-functions-ports-protocols-and-services)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) <br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.7](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-7(1), CM-7(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"port\" or RecommendationDisplayName contains \"disable\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "CM.L2-3.4.7",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(CM.L2-3.4.8) Application Execution Policy](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#apply-deny-by-exception-blacklisting-policy-to-prevent-the-use-of-unauthorized-software-or-deny-all-permit-by-exception-whitelisting-policy-to-allow-the-execution-of-authorized-software)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityevent) ‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security) ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.8](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-7(4), CM-7(5)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert \r\n| where AlertName contains \"app\" or AlertName contains \"tool\" or AlertName contains \"malware\" or AlertName contains \"hack\" or AlertName contains \"program\"\r\n| summarize count() by ProductName, AlertName\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Security Alerts for Suspicious Software",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "View",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "PercentageOfPassedRules",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "CriticalFailedRules",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "WarningFailedRules",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Healthy",
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Unhealthy",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Environment",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Azure",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Direct Agent",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Agent",
                                      "representation": "turquoise",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Management Server",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Heartbeat Trend",
                                "formatter": 10,
                                "formatOptions": {
                                  "palette": "redGreen"
                                }
                              },
                              {
                                "columnMatch": "Details",
                                "formatter": 5
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "CM.L2-3.4.8",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(CM.L2-3.4.9) User-Installed Software](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#control-and-monitor-user-installed-software)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.9](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-11](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"application\" or RecommendationDisplayName contains \"software\" \r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "CM.L2-3.4.9",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isCMVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Configuration Management",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Identification & Authentication \r\n---\r\nIdentification & Authentication Management is the process of managing user, system, asset identities and controlling access to authorized resources.¬†For more information, see theüí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 1: Foundational",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "The Department views Level 1 (‚ÄúFoundational‚Äù) as an opportunity to engage its contractors in developing and strengthening their approach to cybersecurity. Because Level 1 does not involve sensitive national security information, DoD intends for this Level to allow companies to assess their own cybersecurity and begin adopting practices that will thwart cyber-attacks."
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 2"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "IA.L1-3.5.1",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IA.L1-3.5.1) Identification",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "IA.L1-3.5.2",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IA.L1-3.5.2) Authentication",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML1 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (IA.L1-3.5.1) Identification\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Azure AD Identity Governance](https://docs.microsoft.com/azure/active-directory/governance/identity-governance-overview)   üîÄ[Identity Governance](https://portal.azure.com/#blade/Microsoft_AAD_ERM/DashboardBlade/GettingStarted)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AADManagedIdentitySignInLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/aadmanagedidentitysigninlogs) üî∑ [AADServicePrincipalSignInLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/aadserviceprincipalsigninlogs)  ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-2, IA-3, IA-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AADManagedIdentitySignInLogs\r\n| summarize count() by ServicePrincipalName, ResourceGroup\r\n| sort by count_ desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Managed Identity Actions",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ServicePrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": []
                        },
                        "customWidth": "50",
                        "name": "Managed Identity Actions",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AADServicePrincipalSignInLogs \r\n| summarize count() by ServicePrincipalName, ResourceGroup\r\n| sort by count_ desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Service Principal Actions",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ServicePrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": []
                        },
                        "customWidth": "50",
                        "name": "Service Principal Actions",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "IA.L1-3.5.1",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(IA.L1-3.5.2) Authentication](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#authenticate-or-verify-the-identities-of-those-users-processes-or-devices-as-a-prerequisite-to-allowing-access-to-organizational-information-systems)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Multi-Factor Authentication](https://azure.microsoft.com/services/active-directory/)    üîÄ[Multi-Factor Authentication](https://portal.azure.com/#blade/Microsoft_AAD_IAM/MultifactorAuthenticationMenuBlade/GettingStarted)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Customer Lockbox](https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview)   üîÄ[Customer Lockbox](https://portal.azure.com/#blade/Microsoft_Azure_Lockbox/LockboxMenu/Overview)<br>\r\n\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-2, IA-3, IA-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n|extend errorCode = Status.errorCode\r\n|extend SigninStatus = case(errorCode == 0, \"Success\", errorCode == 50058, \"Pending user action\",errorCode == 50140, \"Pending user action\", errorCode == 51006, \"Pending user action\", errorCode == 50059, \"Pending user action\",errorCode == 65001, \"Pending user action\", errorCode == 52004, \"Pending user action\", errorCode == 50055, \"Pending user action\", errorCode == 50144, \"Pending user action\", errorCode == 50072, \"Pending user action\", errorCode == 50074, \"Pending user action\", errorCode == 16000, \"Pending user action\", errorCode == 16001, \"Pending user action\", errorCode == 16003, \"Pending user action\", errorCode == 50127, \"Pending user action\", errorCode == 50125, \"Pending user action\", errorCode == 50129, \"Pending user action\", errorCode == 50143, \"Pending user action\", errorCode == 81010, \"Pending user action\", errorCode == 81014, \"Pending user action\", errorCode == 81012 ,\"Pending user action\", \"Failure\");\r\ndata\r\n| where IsInteractive == true\r\n| summarize Count = count() by SigninStatus\r\n| join kind = fullouter (datatable(SigninStatus:string)['Success', 'Pending action (Interrupts)', 'Failure']) on SigninStatus\r\n| project SigninStatus = iff(SigninStatus == '', SigninStatus1, SigninStatus), Count = iff(SigninStatus == '', 0, Count)\r\n| join kind = inner (data\r\n    | make-series Trend = count() default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain} by SigninStatus)\r\n    on SigninStatus\r\n| project-away SigninStatus1, TimeGenerated\r\n| extend Status = SigninStatus\r\n| union (\r\n    data \r\n    | summarize Count = count()\r\n    | extend jkey = 1\r\n    | join kind=inner (data\r\n        | make-series Trend = count() default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain}\r\n        | extend jkey = 1) on jkey\r\n    | extend SigninStatus = 'All Sign-ins', Status = '*'    \r\n)\r\n| where SigninStatus <> \"All Sign-ins\"\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "User Authentication Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "User",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "info",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Activities",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n|extend CAStatus = case(ConditionalAccessStatus ==\"success\",\"Successful\",\r\n                    ConditionalAccessStatus == \"failure\", \"Failed\",                                     \r\n                    ConditionalAccessStatus == \"notApplied\", \"Not applied\",                                     \r\n                    isempty(ConditionalAccessStatus), \"Not applied\", \r\n                    \"Disabled\")\r\n|mvexpand ConditionalAccessPolicies\r\n|extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0])\r\n|extend CAGrantControl = case(CAGrantControlName contains \"MFA\", \"Require MFA\", \r\n                            CAGrantControlName contains \"Terms of Use\", \"Require Terms of Use\", \r\n                            CAGrantControlName contains \"Privacy\", \"Require Privacy Statement\", \r\n                            CAGrantControlName contains \"Device\", \"Require Device Compliant\", \r\n                            CAGrantControlName contains \"Azure AD Joined\", \"Require Hybird Azure AD Joined Device\", \r\n                            CAGrantControlName contains \"Apps\", \"Require Approved Apps\",\r\n                            \"Other\");\r\ndata\r\n| summarize Count = dcount(Id) by CAStatus\r\n| join kind = inner (data\r\n                    | make-series Trend = dcount(Id) default = 0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain}) by CAStatus\r\n                    ) on CAStatus\r\n| project-away CAStatus1, TimeGenerated\r\n| order by Count desc",
                          "size": 4,
                          "showAnalytics": true,
                          "title": "Conditional Access Status ",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "CAStatus",
                              "formatter": 1
                            },
                            "subtitleContent": {
                              "columnMatch": "Category"
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "blue"
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "50",
                        "name": "Conditional Access Status "
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where ResultType == 0 and AppDisplayName != \"\"\r\n| summarize count() by AppDisplayName\r\n| join (\r\nSigninLogs\r\n| make-series TrendList = count() on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, 4h) by AppDisplayName \r\n) on AppDisplayName\r\n| top 10 by count_ desc",
                          "size": 4,
                          "showAnalytics": true,
                          "title": "User Sign-Ins By Application",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "User",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "info",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Activities",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "AppDisplayName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "TrendList",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "blue"
                              }
                            },
                            "showBorder": false
                          },
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "AppDisplayName",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "count_",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "IA.L1-3.5.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 1: Foundational"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "IA.L2-3.5.3",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IA.L2-3.5.3) Multifactor Authentication",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "IA.L2-3.5.4",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IA.L2-3.5.4) Replay-Resistant Authentication",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "IA.L2-3.5.5",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IA.L2-3.5.5) Identifier Reuse",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "IA.L2-3.5.6",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IA.L2-3.5.6) Identifier Handling",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "b8324480-bbbc-43bc-891e-c957307c1d7c",
                        "cellValue": "IA.L2-3.5.7",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IA.L2-3.5.7) Password Complexity",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "9521f4a0-f7db-4ea9-aea6-4aed53e33082",
                        "cellValue": "IA.L2-3.5.8",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IA.L2-3.5.8) Pasword Reuse",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "9bf27466-8d4a-45b5-8c02-38a4e7c06948",
                        "cellValue": "IA.L2-3.5.9",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IA.L2-3.5.9) Temporary Passwords",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "df83fe53-c44b-4c47-9d2b-21780d7ee4cf",
                        "cellValue": "IA.L2-3.5.10",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IA.L2-3.5.10) Cryptographically-Protected Passwords",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "c6e6f1f1-17de-46f9-9dd6-75b3c37506c2",
                        "cellValue": "IA.L2-3.5.11",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IA.L2-3.5.11) Obscure Feedback",
                        "preText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(IA.L2-3.5.3) Multifactor Authentication](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#use-multifactor-authentication-for-local-and-network-access-to-privileged-accounts-and-for-network-access-to-non-privileged-accounts)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)   üîÄ[Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Multi-Factor Authentication](https://azure.microsoft.com/services/active-directory/)    üîÄ[Multi-Factor Authentication](https://portal.azure.com/#blade/Microsoft_AAD_IAM/MultifactorAuthenticationMenuBlade/GettingStarted)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations)   ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-2(1), IA-2(2), IA-2(3)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data = \r\nunion SigninLogs,nonInteractive \r\n|extend errorCode = toint(Status.errorCode)\r\n|extend Reason = tostring(Status.failureReason)\r\n|extend CAStatus = case(ConditionalAccessStatus ==0,\"‚úîÔ∏è Success\",                                     \r\n                        ConditionalAccessStatus == 1, \"‚ùå Failure\",                                     \r\n                        ConditionalAccessStatus == 2, \"‚ö†Ô∏è Not Applied\",                                     \r\n                        ConditionalAccessStatus == \"\", \"‚ö†Ô∏è Not Applied\", \r\n                        \"üö´ Disabled\")\r\n|mvexpand ConditionalAccessPolicies\r\n|extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0])\r\n|extend CAGrantControl = case(CAGrantControlName contains \"MFA\", \"Require MFA\", \r\n                            CAGrantControlName contains \"Terms of Use\", \"Require Terms of Use\", \r\n                            CAGrantControlName contains \"Privacy\", \"Require Privacy Statement\", \r\n                            CAGrantControlName contains \"Device\", \"Require Device Compliant\", \r\n                            CAGrantControlName contains \"Azure AD Joined\", \"Require Hybird Azure AD Joined Device\", \r\n                            CAGrantControlName contains \"Apps\", \"Require Approved Apps\",\"Other\");\r\ndata\r\n| summarize Count = dcount(Id) by CAStatus, CAGrantControl\r\n| project Id = strcat(CAStatus, '/', CAGrantControl), Name = CAGrantControl, Parent = CAStatus, Count, Type = 'CAGrantControl'\r\n| join kind = inner (data\r\n                    | make-series Trend = dcount(Id) default = 0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain}) by CAStatus, CAGrantControl\r\n                    | project Id = strcat(CAStatus, '/', CAGrantControl), Trend\r\n                    ) on Id\r\n| project-away Id1\r\n| union (data\r\n    | summarize Count = dcount(Id) by CAStatus\r\n    | project Id = CAStatus, Name = CAStatus, Parent = '', Count, Type = 'CAStatus'\r\n    | join kind = inner (data\r\n                        | make-series Trend = dcount(Id) default = 0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain}) by CAStatus\r\n                        | project Id = CAStatus, Trend\r\n                        ) on Id\r\n    | project-away Id1)\r\n| order by Count desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "MFA: Conditional Access Status",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Id",
                                "formatter": 5,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Parent",
                                "formatter": 5,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Count",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "blue",
                                  "showIcon": true
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Type",
                                "formatter": 5,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Trend",
                                "formatter": 9,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "blue",
                                  "showIcon": true
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "idColumn": "Id",
                              "parentColumn": "Parent",
                              "treeType": 0,
                              "expanderColumn": "Name",
                              "expandTopLevel": true
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 10",
                        "styleSettings": {
                          "margin": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"MFA\" or RecommendationDisplayName contains \"factor\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "IA.L2-3.5.3",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(IA.L2-3.5.4) Replay-Resistant Authentication](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#employ-replay-resistant-authentication-mechanisms-for-network-access-to-privileged-and-nonprivileged-accounts)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Multi-Factor Authentication](https://azure.microsoft.com/services/active-directory/)    üîÄ[Multi-Factor Authentication](https://portal.azure.com/#blade/Microsoft_AAD_IAM/MultifactorAuthenticationMenuBlade/GettingStarted)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs \r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-2(8),IA-2(9)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"accessible\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "IA.L2-3.5.4",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (IA.L2-3.5.5) Identifier Reuse\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Recommended Configurations\r\nüí° [Restore or Remove a Recently Deleted User Using Azure Active Directory](https://docs.microsoft.com/azure/active-directory/fundamentals/active-directory-users-restore)\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityBaseline](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securitybaseline)  ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-4](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityBaseline\r\n| where Description contains \"reuse\" or Description contains \"without password\" or Description contains \"unneccessary account\" or Description contains \"blank password\"\r\n| summarize arg_max(TimeGenerated, *) by Description, _ResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Failed\"),\r\n    Passed‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Passed\"),\r\n    Total‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Failed\" or AnalyzeResult == \"Passed\")\r\n    by Description\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project Description, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Security Baselines for Identifier Reuse",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": []
                        },
                        "customWidth": "50",
                        "name": "query - 1 - Copy"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "IA.L2-3.5.5",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (IA.L2-3.5.6) Identifier Handling\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n\r\n## Recommended Configurations\r\nüí° [Report on Azure AD Stale Users](https://gallery.technet.microsoft.com/scriptcenter/Report-on-Azure-AD-Stale-8e64c1c5)\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-4)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let CurrentUsers = SigninLogs\r\n| where ResultType == \"0\"\r\n| where TimeGenerated > ago(30d)\r\n| summarize HistoricUsers = makeset(UserPrincipalName);\r\nSigninLogs\r\n| where ResultType == \"0\"\r\n| where TimeGenerated between (ago(90d)..ago(30d))\r\n| where UserPrincipalName !in (CurrentUsers)\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| summarize count() by UserPrincipalName, UserProfile\r\n| sort by count_ desc\r\n| extend SignInsBeforeInactive = count_\r\n| project UserPrincipalName, UserProfile, SignInsBeforeInactive\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Inactive AAD Accounts (Last Month)",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "SignInsBeforeInactive",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "IA.L2-3.5.6",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(IA.L2-3.5.7) Password Complexity](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#enforce-a-minimum-password-complexity-and-change-of-characters-when-new-passwords-are-created)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Azure AD Password Protection](https://docs.microsoft.com/azure/active-directory/governance/identity-governance-overview)   üîÄ[Azure AD Password Protection](https://portal.azure.com/#blade/Microsoft_AAD_IAM/PasswordProtectionBlade)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.7](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-5(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"password\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "IA.L2-3.5.7",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(IA.L2-3.5.8) Password Reuse](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#prohibit-password-reuse-for-a-specified-number-of-generations)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Azure AD Password Protection](https://docs.microsoft.com/azure/active-directory/governance/identity-governance-overview)   üîÄ[Azure AD Password Protection](https://portal.azure.com/#blade/Microsoft_AAD_IAM/PasswordProtectionBlade)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.8](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-5(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityBaseline\r\n| where Description contains \"reuse\" or Description contains \"password\" \r\n| summarize arg_max(TimeGenerated, *) by Description, _ResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Failed\"),\r\n    Passed‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Passed\"),\r\n    Total‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Failed\" or AnalyzeResult == \"Passed\")\r\n    by Description\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project Description, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Security Baselines for Password Reuse",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1 - Copy"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "IA.L2-3.5.8",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (IA.L2-3.5.9) Temporary Passwords\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Recommended Configurations\r\nüí° [Reset a User's Password Using Azure Active Directory](https://docs.microsoft.com/azure/active-directory/fundamentals/active-directory-users-reset-password-azure-portal)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.9](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-5(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AuditLogs\r\n| where OperationName contains \"reset\"\r\n| extend InitiatedBy = tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName)\r\n| extend PasswordResetUser = tostring(TargetResources[0].userPrincipalName)\r\n| summarize count() by InitiatedBy, OperationName, PasswordResetUser \r\n| sort by count_ desc\r\n| limit 250 ",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Enforce Temporary Passwords & Monitor Resets",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "InitiatedBy",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "pending",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "OperationName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "PasswordResetUser",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "IA.L2-3.5.9",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(IA.L2-3.5.10) Cryptographically-Protected Passwords](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#store-and-transmit-only-cryptographically-protected-passwords)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityBaseline](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securitybaseline) üî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations)  ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.10](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-5(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityBaseline\r\n| where Description contains \"hash\" or Description contains \"sha\"\r\n| where Description !contains \"network\"\r\n| summarize arg_max(TimeGenerated, *) by Description, _ResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Failed\"),\r\n    Passed‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Passed\"),\r\n    Total‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Failed\" or AnalyzeResult == \"Passed\")\r\n    by Description\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project Description, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Security Baselines for Cryptographically Protected Password Configs",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1 - Copy"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"pass\" or RecommendationDisplayName contains \"hash\" or RecommendationDisplayName contains \"sha\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "IA.L2-3.5.10",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (IA.L2-3.5.11) Obscure Feedback\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityBaseline](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securitybaseline)   ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.11](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-6](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityBaseline\r\n| where Description contains \"reveal\"\r\n| summarize arg_max(TimeGenerated, *) by _ResourceId\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Monitor Password Obfuscation Policies with Security Baselines",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AnalyzeResult",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Passed",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Failed",
                                      "representation": "failed",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "IA.L2-3.5.11",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isIAVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Identification & Authentication Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Incident Response\r\n---\r\nIncident Response¬†is the process of responding to cybersecurity incidents and events. Incident Response includes preparation, identification, containment, eradication, recovery, and lessons learned phases. For more information, see the üí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "IR.L2-3.6.1",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IR.L2-3.6.1) Incident Handling",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "1dd155a5-dfbc-40db-bbd2-b50a8aa54fda",
                        "cellValue": "IR.L2-3.6.2",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IR.L2-3.6.2) Incident Reporting",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "ad7ae5fb-0027-434d-8d04-bee75b0832f4",
                        "cellValue": "IR.L2-3.6.3",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (IR.L2-3.6.3) Incident Response Testing",
                        "preText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(IR.L2-3.6.1) Incident Handling](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#establish-an-operational-incident-handling-capability-for-organizational-systems-that-includes-preparation-detection-analysis-containment-recovery-and-user-response-activities)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityIncident](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityincident) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)  ‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender) \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.6.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": " Incidents Summary",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where Status == \"New\" or Status == \"Active\"\n| where Severity == \"High\"\n| summarize kwSum=count(TenantId)\n\n\n\n",
                                "size": 3,
                                "title": "CRITICAL",
                                "noDataMessage": "No unauthorized devices making config changes",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "kwSum",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "hotCold"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "24",
                              "name": "query - 10"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where Status == \"New\" or Status == \"Active\"\n| summarize kwSum=count(TenantId)\n\n\n\n",
                                "size": 0,
                                "title": "OPEN",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "kwSum",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "hotCold"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 10"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where Status == \"Closed\"\n| summarize kwSum=count(TenantId)\n\n\n\n",
                                "size": 0,
                                "title": "CLOSED",
                                "noDataMessage": "No unauthorized devices making config changes",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "kwSum",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "greenRed"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "24",
                              "name": "query - 10"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where TimeGenerated > ago(1d)\n| where Status == \"New\" or Status == \"Active\"\n| distinct IncidentNumber\n| summarize count()\n\n\n\n\n",
                                "size": 0,
                                "title": "NEW TODAY",
                                "noDataMessage": "No unauthorized devices making config changes",
                                "timeContext": {
                                  "durationMs": 86400000
                                },
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "greenRed"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "24",
                              "name": "query - 10"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 3"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident\r\n    | summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n    | mv-expand AlertIds\r\n    | extend AlertId = tostring(AlertIds)\r\n    | join kind= innerunique ( \r\n        SecurityAlert \r\n        )\r\n        on $left.AlertId == $right.SystemAlertId\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UserPrincipalName = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| extend Href_ = tostring(parse_json(ExtendedLinks)[0].Href)\r\n| extend Workspace = tostring(parse_json(tostring(parse_json(ExtendedProperties).[\"Data Sources\"]))[0])\r\n| extend IncidentURL = strcat(\"https://portal.azure.com/#asset/Microsoft_Azure_Security_Insights/Incident/subscriptions/\",WorkspaceSubscriptionId,\"/resourceGroups/\",WorkspaceResourceGroup,\"/providers/Microsoft.OperationalInsights/workspaces/\",Workspace,\"/providers/Microsoft.SecurityInsights/Incidents/\",IncidentName)\r\n| where IncidentURL !contains \"//resourceGroups\"\r\n| distinct UserPrincipalName, IncidentNumber, Title, Severity, ProductName, IncidentURL, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Security Incidents: Go-To >",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "is Empty",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Title",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "error",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentURL",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "PersonWithFriend",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": ""
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "name": "IR.L2-3.6.1",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (IR.L2-3.6.2) Incident Reporting\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityIncident](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityincident) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.6.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IR-2, IR-4, IR-5, IR-6, IR-7](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident¬†\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by Severity\r\n| render areachart \r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Security Incidents over Time",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ]
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "IR.L2-3.6.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (IR.L2-3.6.3) Incident Response Testing\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Resources\r\nüí° [SimuLand: Understand adversary tradecraft and improve detection strategies](https://www.microsoft.com/security/blog/2021/05/20/simuland-understand-adversary-tradecraft-and-improve-detection-strategies/)<br>\r\nüí° [Microsoft Sentinel - SOC Process Framework Workbook](https://techcommunity.microsoft.com/t5/azure-sentinel/what-s-new-azure-sentinel-soc-process-framework-workbook/ba-p/2339315)<br>\r\nüí° [Sentinel ATT&CK](https://github.com/BlueTeamLabs/sentinel-attack)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.6.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IR-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n| where AlertName contains \"test\"\r\n| distinct AlertName, AlertSeverity, ProductName, Status, Tactics, AlertLink, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review & Test Security Alerts for Incident Response Readiness (Alerts Labeled Test)",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": ""
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "IR.L2-3.6.3",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isIRVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Incident Response Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Maintenance\r\n---\r\nMaintenance includes processes such as system updates, patching, and configuration changes which are required for the overall functionality of the information system. For more information, see the üí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "MA.L2-3.7.1",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MA.L2-3.7.1) Perform Maintenance",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "MA.L2-3.7.2",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MA.L2-3.7.2) System Maintenance Control",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "MA.L2-3.7.3",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MA.L2-3.7.3) Equipment Sanitization",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "MA.L2-3.7.4",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MA.L2-3.7.4) Media Inspection",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "48a6c5e0-cbe1-41c4-be23-d98ae6e95c7e",
                        "cellValue": "MA.L2-3.7.5",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MA.L2-3.7.5) Nonlocal Maintenance",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "5c8ca431-016c-4808-b939-406665e97237",
                        "cellValue": "MA.L2-3.7.6",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MA.L2-3.7.6) Maintenance Personnel",
                        "preText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MA.L2-3.7.1) Perform Maintenance\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Recommended Resources\r\nüí° [Handling Planned Maintenance Notifications Using the Azure Portal](https://docs.microsoft.com/azure/virtual-machines/maintenance-notifications-portal)<br>\r\nüí° [Managing Platform Updates with Maintenance Control](https://docs.microsoft.com/azure/virtual-machines/maintenance-control)<br>\r\nüí° [Scheduling Maintenance Updates with Maintenance Control and Azure Functions](https://github.com/Azure/azure-docs-powershell-samples/tree/master/maintenance-auto-scheduler)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.7.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MA-2, MA-3, MA-3(1), MA-3(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where RecommendationDisplayName contains \"update\" or RecommendationDisplayName contains \"upgrade\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, complianceStandardId, ControlID, Recommendation",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Microsoft Defender for Cloud Assessments: Update Recommendations",
                          "noDataMessage": "No Current  Recommendations in this Area. Confirm Assessments are Enabled in Microsoft Defender for Cloud: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MA.L2-3.7.1",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MA.L2-3.7.2) System Maintenance Control\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Resources\r\nüí° [Privileged Access Workstations](https://docs.microsoft.com/windows-server/identity/securing-privileged-access/privileged-access-workstations)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.7.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MA-2, MA-3, MA-3(1), MA-3(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"identity\" or type contains \"networksecuritygroups\" or type contains \"bastion\" or type contains \"lock\" or type contains \"endpoint\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Recommended Primary & Secondary Service Assets",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MA.L2-3.7.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MA.L2-3.7.3) Equipment Sanitization\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)<br>\r\n\r\n## Recommended Resources\r\nüí° [Data destruction in Microsoft 365](https://docs.microsoft.com/compliance/assurance/assurance-data-destruction)<br>\r\nüí° [Azure customer data protection](https://docs.microsoft.com/azure/security/fundamentals/protection-customer-data)<br>\r\nüí° [Configure encryption with customer-managed keys stored in Azure Key Vault](https://docs.microsoft.com/azure/storage/common/customer-managed-keys-configure-key-vault)<br>\r\nüí° [NIST SP 800-88: Guidelines for Media Sanitization](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-88r1.pdf)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.7.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MA-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"key\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Leverage Key Vaults for Cryptographic Erasure",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MA.L2-3.7.3",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MA.L2-3.7.4) Media Inspection \r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityevent)   ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br> \r\n\r\n## Recommended Resources\r\nüí° [Use Microsoft Endpoint Configuration Manager to Run a Scan](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-antivirus/run-scan-microsoft-defender-antivirus#use-microsoft-endpoint-configuration-manager-to-run-a-scan)<br>\r\nüí° [Custom Scan a USB Drive](https://gallery.technet.microsoft.com/Custom-scan-a-USB-drive-17b9be2a)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.7.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MA-3(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n| where ProviderName == \"MDATP\"\r\n| where AlertName contains \"hack\" or AlertName contains \"mal\" or AlertName contains \"software\" or AlertName contains \"virus\" or AlertName contains \"trojan\" or AlertName contains \"c2\" or AlertName contains \"beacon\"\r\n| distinct AlertName, AlertSeverity, ProductName, AlertLink, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Scan Removeable Media with Microsoft Defender for Endpoint ",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.  ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": ""
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MA.L2-3.7.4",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MA.L2-3.7.5) Nonlocal Maintenance\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Multi-Factor Authentication](https://azure.microsoft.com/services/active-directory/)    üîÄ[Multi-Factor Authentication](https://portal.azure.com/#blade/Microsoft_AAD_IAM/MultifactorAuthenticationMenuBlade/GettingStarted)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.7.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MA-4](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data = \r\nunion SigninLogs,nonInteractive \r\n|extend errorCode = toint(Status.errorCode)\r\n|extend Reason = tostring(Status.failureReason)\r\n|extend CAStatus = case(ConditionalAccessStatus ==0,\"‚úîÔ∏è Success\",                                     \r\n                        ConditionalAccessStatus == 1, \"‚ùå Failure\",                                     \r\n                        ConditionalAccessStatus == 2, \"‚ö†Ô∏è Not Applied\",                                     \r\n                        ConditionalAccessStatus == \"\", \"‚ö†Ô∏è Not Applied\", \r\n                        \"üö´ Disabled\")\r\n|mvexpand ConditionalAccessPolicies\r\n|extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0])\r\n|extend CAGrantControl = case(CAGrantControlName contains \"MFA\", \"Require MFA\", \r\n                            CAGrantControlName contains \"Terms of Use\", \"Require Terms of Use\", \r\n                            CAGrantControlName contains \"Privacy\", \"Require Privacy Statement\", \r\n                            CAGrantControlName contains \"Device\", \"Require Device Compliant\", \r\n                            CAGrantControlName contains \"Azure AD Joined\", \"Require Hybird Azure AD Joined Device\", \r\n                            CAGrantControlName contains \"Apps\", \"Require Approved Apps\",\"Other\");\r\ndata\r\n| where CAGrantControl contains \"MFA\"\r\n| extend Result = tostring(ConditionalAccessPolicies.result)\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| where Result == \"notApplied\"\r\n| summarize count() by UserPrincipalName, UserProfile, CAGrantControl, Result\r\n| sort by count_ desc\r\n| project UserPrincipalName, UserProfile, CAGrantControl, Result, count_\r\n| limit 250\r\n\r\n\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Users Authenticating Without MFA",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "Result",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MA.L2-3.7.5",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MA.L2-3.7.6) Maintenance Personnel\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Customer Lockbox](https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview)   üîÄ[Customer Lockbox](https://portal.azure.com/#blade/Microsoft_Azure_Lockbox/LockboxMenu/Overview)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.7.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MA-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AuditLogs\r\n| where OperationName contains \"PIM\"\r\n| distinct OperationName, Identity, AADOperationType, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| project OperationName, AADOperationType, Identity, TimeGenerated\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Implement/Monitor Privileged Identity Management for Maintenance",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "OperationName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Identity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MA.L2-3.7.6",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isMAVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Maintenance",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Media Protection\r\n---\r\nMedia protection includes physical, logical, and administrative controls over sensitive data. For more information, see the üí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 1: Foundational",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "The Department views Level 1 (‚ÄúFoundational‚Äù) as an opportunity to engage its contractors in developing and strengthening their approach to cybersecurity. Because Level 1 does not involve sensitive national security information, DoD intends for this Level to allow companies to assess their own cybersecurity and begin adopting practices that will thwart cyber-attacks. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 2"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "MP.1.118",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MP.L1-3.8.3) Media Disposal",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML1 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MP.L1-3.8.3) Media Disposal\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ [Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ [Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)<br>\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\n\r\n## Recommended Resources\r\nüí° [Data destruction in Microsoft 365](https://docs.microsoft.com/compliance/assurance/assurance-data-destruction)<br>\r\nüí° [NIST SP 800-88: Guidelines for Media Sanitization](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-88r1.pdf)<br>\r\nüí° [Purge Process](https://docs.microsoft.com/azure/data-explorer/kusto/concepts/data-purge#purge-process)<br>\r\nüí° [Configure encryption with customer-managed keys stored in Azure Key Vault](https://docs.microsoft.com/azure/storage/common/customer-managed-keys-configure-key-vault)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-2, MP-4, MP-6](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| limit 250\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Scan/Monitor for Sensitive Data with Azure Information Protection",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserId_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"key\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Leverage Key Vaults for Cryptographic Erasure",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "MP.L1-3.8.3",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 1: Foundational"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security."
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "MP.L2-3.8.1",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MP.L2-3.8.1) Media Disposal",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "MP.L2-3.8.2",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MP.L2-3.8.2) Media Access",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "MP.L2-3.8.4",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MP.L2-3.8.4) Media Markings",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "047b340d-7610-48fb-bc6d-a545dfa5c509",
                        "cellValue": "MP.L2-3.8.5",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MP.L2-3.8.5) Media Accountability",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "680851a1-60e5-4c20-8559-68e9c6d042c4",
                        "cellValue": "MP.L2-3.8.6",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MP.L2-3.8.6) Portable Storage Encryption",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "fc5ad94b-1331-45ad-bf87-602925d83b8a",
                        "cellValue": "MP.L2-3.8.7",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MP.L2-3.8.7) Removable Storage Encryption",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "f90ba8af-20bb-47be-88ec-ca41e618fc7f",
                        "cellValue": "MP.L2-3.8.8",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MP.L2-3.8.8) Shared Media",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "5ab363c8-664f-4757-8e3d-96f53c62f020",
                        "cellValue": "MP.L2-3.8.9",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (MP.L2-3.8.9) Protect Backups",
                        "preText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MP.L2-3.8.1) Media Protection \r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n\r\n## Recommended Resources\r\nüí° [Physical Security](https://docs.microsoft.com/azure/security/fundamentals/physical-security)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-2, MP-4, MP-6](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Azure Datacenters: Physically Protect CUI Data in a Secure Location\r\n![Image¬†Name](https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE4q5jn?ver=25d1&q=90&m=6&h=431&w=767&b=%23FFFFFFFF&l=f&o=t&aim=true¬†¬†\"Physical Security Controls\")¬†<br>\r\n[Go To: Physical Security Controls >](https://docs.microsoft.com/azure/security/fundamentals/physical-security)<br> "
                        },
                        "customWidth": "50",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MP.L2-3.8.1",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MP.L2-3.8.2) Media Access\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-2, MP-4, MP-6](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| limit 250\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Label/Control Sensitive Data with Azure Information Protection",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserId_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MP.L2-3.8.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MP.L2-3.8.4) Media Markings\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| where LabelName_s <> \"\"\r\n| summarize count() by LabelName_s\r\n| sort by count_ desc\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Label/Control Sensitive Data with Azure Information Protection",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "UserId_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "chartSettings": {
                            "showLegend": true
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MP.L2-3.8.4",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MP.L2-3.8.5) Media Accountability\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Leverage Azure Information Protection to Classify/Protect CUI at Rest and In-Transit\r\n![Image¬†Name](https://docs.microsoft.com/azure/information-protection/media/info-protect-protection-bar-configured.png¬†¬†\"AIP Configuration\")<br>\r\n[Go To: Microsoft Information Protection (Label Policies) >](https://compliance.microsoft.com/informationprotection?viewid=sensitivitylabelpolicies)<br>\r\n[Go To: Azure Information Protection (Label Policies) >](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/scopedpoliciesBlade)<br>"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MP.L2-3.8.5",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MP.L2-3.8.6) Portable Storage Encryption\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-5(4)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"crypt\" or RecommendationDisplayName contains \"transit\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MP.L2-3.8.6",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MP.L2-3.8.7) Removable Media\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [DeviceEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/deviceevents) ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.7](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-7](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "DeviceEvents\r\n| where InitiatingProcessFolderPath <> \"\" \r\n| where InitiatingProcessFolderPath !contains \"c:\" or ActionType contains \"usb\"\r\n| summarize count() by DeviceName, ActionType, AccountName, InitiatingProcessFolderPath\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Monitor/Control Removeable Media Devices",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "DeviceName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ActionType",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AccountName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MP.L2-3.8.7",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MP.L2-3.8.8) Shared Media\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.8](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-7(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Leverage Microsoft Defender for Endpoint & Microsoft Intune to Prohibit Rogue USB Devices\r\n![Image¬†Name](https://docs.microsoft.com/windows/security/threat-protection/device-control/images/baselines.png¬†¬†\"Rogue USB\")¬†<br>\r\n[Go To: Intune/Microsoft Endpoint Manager (Endpoint Security: Attack Surface Reduction) >](https://endpoint.microsoft.com/#blade/Microsoft_Intune_Workflows/SecurityManagementMenu/asr)"
                        },
                        "customWidth": "45",
                        "name": "text - 1",
                        "styleSettings": {
                          "maxWidth": "45"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MP.L2-3.8.8",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (MP.L2-3.8.9) Protect Backups\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CP-9](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"backup\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "MP.L2-3.8.9",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isMPVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Media Protection",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Personnel Security\r\n---\r\nPersonnel Security is focused on controlling human access to systems, networks, and assets. Personnel Security includes considerations for screening individuals with access to Controlled Unclassified Information (CUI) and protection of such data after personnel actions such as terminations or transfers. For more information, see the üí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "PS.L2-3.9.1",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (PS.L2-3.9.1) Screen Individuals",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "a931a632-d4cf-4b7a-8d07-59f5a52ceb24",
                        "cellValue": "PS.L2-3.9.2",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (PS.L2-3.9.2) Personnel Actions",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (PS.L2-3.9.1) Screen Individuals\r\n\r\n## Implementation Statement\r\nPersonnel security screening (vetting) activities involve the evaluation/assessment of individual‚Äôs conduct, integrity, judgment, loyalty, reliability, and stability (i.e., the trustworthiness of the individual) prior to authorizing access to organizational systems containing CUI. The screening activities reflect applicable federal laws, Executive Orders, directives, policies, regulations, and specific criteria established for the level of access required for assigned positions.\r\nYou can ensure all employees who need access to CUI undergo organization-defined screening before being granted access based on the types of screening requirements for a given position and role. Clearly define positions and roles within your organization. Implement roles using üí° [Azure RBAC](https://docs.microsoft.com/azure/role-based-access-control).  For example, administrators with access to CUI and specific roles with permissions to view CUI should follow an organizationally defined screening process. \r\n\r\n## Customer Responsibility\r\n Screening individuals prior to authorizing access to customer-deployed resources.\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.9.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[PS-3, PS-4, PS-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "45",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "45"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "customWidth": "5",
                        "name": "text - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Azure Role Based Access Control\r\n![Image¬†Name](https://azurecomcdn.azureedge.net/cvt-f83fd647d6f366492554e3c84c6972956ea0fa343f1f12abc9590dd97f777e9e/images/page/overview/trusted-cloud/index/ill-1.png)¬†\r\n[Go To: Azure Active Directory (Roles & Administrators) >](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RolesAndAdministrators)\r\n\r\n"
                        },
                        "customWidth": "40",
                        "name": "text - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "PS.L2-3.9.1",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (PS.L2-3.9.2) Personnel Actions\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance: Insider Risk Management](https://www.microsoft.com/microsoft-365/business/compliance-solutions)    üîÄ[Insider Risk Management](https://compliance.microsoft.com/insiderriskmgmt?viewid=overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Microsoft 365 Compliance: Insider Risk Management](https://www.microsoft.com/microsoft-365/business/compliance-solutions) <br> \r\n\r\n## Recommended Configurations\r\nüí° [Insider Risk Management: Setup a Connector to import HR Data & Track Last Working Dates](https://docs.microsoft.com/microsoft-365/compliance/import-hr-data)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.9.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[PS-3, PS-4, PS-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n| where ProductName == \"Microsoft 365 Insider Risk Management\"\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| extend Href_ = tostring(parse_json(ExtendedLinks)[0].Href)\r\n| extend UserPrincipalName = UPN\r\n| distinct AlertName, ProductName, Status, AlertLink, UserPrincipalName, Tactics, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Enable the HR Connector & Monitor Microsoft 365: Insider Risk Management Alert Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "PS.L2-3.9.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isPSVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Personnel Security",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Physical Protection\r\n---\r\nPhysical Protections are focused on protecting direct access to systems, networks, and assets. Physical protection includes considerations for limiting physical access, escorting visitors, maintaining visit audit logs, monitoring infrastructure, and protecting Controlled Unclassified Information (CUI). For more information, see the üí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 1: Foundational",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "The Department views Level 1 (‚ÄúFoundational‚Äù) as an opportunity to engage its contractors in developing and strengthening their approach to cybersecurity. Because Level 1 does not involve sensitive national security information, DoD intends for this Level to allow companies to assess their own cybersecurity and begin adopting practices that will thwart cyber-attacks. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 2"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "PE.L1-3.10.1-PE.L1-3.10.5",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (PE.L1-3.10.1) Limit Physical Access",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "4c0bfeef-f67e-4d83-846e-0b72742c6648",
                        "cellValue": "PE.L1-3.10.1-PE.L1-3.10.5",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (PE.L1-3.10.3) Escort Visitors",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "24dd9388-43f3-4e00-b712-06cb10be7afe",
                        "cellValue": "PE.L1-3.10.1-PE.L1-3.10.5",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (PE.L1-3.10.4) Physical Access Logs",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "dfa2d3dc-b48f-4aee-8368-b6d6388b74c4",
                        "cellValue": "PE.L1-3.10.1-PE.L1-3.10.5",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (PE.L1-3.10.5) Manage Physical Access",
                        "preText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML1 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (PE.L1-3.10.1) Limit Physical Access\r\n# (PE.L1-3.10.3) Escort Visitors\r\n# (PE.L1-3.10.4) Physical Access Logs\r\n# (PE.L1-3.10.5) Manage Physical Access\r\n \r\n## Recommended References\r\nüí° [Datacenter physical access security](https://docs.microsoft.com/compliance/assurance/assurance-datacenter-physical-access-security)<br>\r\nüí° [Azure Facilities, Premises, and Physical Security](https://docs.microsoft.com/azure/security/fundamentals/physical-security)<br>\r\nüí° [Management and Operation of the Azure Production Network](https://docs.microsoft.com/azure/security/fundamentals/infrastructure-operations)<br>\r\nüí° [Azure Infrastructure Availability](https://docs.microsoft.com/azure/security/fundamentals/infrastructure-availability) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.10.1, 3.10.3, 3.10.4, 3.10.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[PE-2, PE-3, PE-6](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "45",
                        "name": "text - 4"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "customWidth": "5",
                        "name": "text - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Azure Datacenters: Physical Security\r\n![Image¬†Name](https://stp-api-cdn-prod.azureedge.net/api/Images/e5724a10-491a-11e8-9fe5-75d16dd56b03?hash=7AC632B242A298BFB2E2CFF3968117CFDA3A33AB0A50B1FCBD565C0F6D1DBCB6¬†¬†\"Physical Security Controls\")[Go To: Azure Physical Security >](https://docs.microsoft.com/azure/security/fundamentals/physical-security)¬†\r\n"
                        },
                        "customWidth": "45",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "45"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "PE.L1-3.10.1-PE.L1-3.10.5",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 1: Foundational"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security.  "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "PE.L2-3.10.2",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (PE.L2-3.10.2) Monitor Facility",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "18c9d473-00f2-47af-bb02-cf0da80e34d1",
                        "cellValue": "PE.L2-3.10.6",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (PE.L2-3.10.6) Alternate Work Sites",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (PE.L2-3.10.2) Monitor Facility\r\n\r\n## Recommended References\r\nüí° [Datacenter physical access security](https://docs.microsoft.com/compliance/assurance/assurance-datacenter-physical-access-security)<br>\r\nüí° [Azure Facilities, Premises, and Physical Security](https://docs.microsoft.com/azure/security/fundamentals/physical-security)<br>\r\nüí° [Management and Operation of the Azure Production Network](https://docs.microsoft.com/azure/security/fundamentals/infrastructure-operations)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.10.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[PE-6](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "45",
                        "name": "text - 0"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "customWidth": "5",
                        "name": "text - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Azure Datacenters: Physical Security\r\n![Image¬†Name](https://www.microsoft.com/security/blog/wp-content/uploads/2019/10/4-principals-for-an-effective-security-operations-center-SOCIAL-1200x600.png¬†¬†\"Physical Security Controls\")[Go To: Azure Physical Security >](https://docs.microsoft.com/azure/security/fundamentals/physical-security)¬†\r\n"
                        },
                        "customWidth": "45",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "45"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "PE.L2-3.10.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (PE.L2-3.10.6) Alternate Work Sites\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Azure Global Infrastructure](https://azure.microsoft.com/global-infrastructure/)   üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Named Locations](https://docs.microsoft.com/azure/active-directory/conditional-access/location-condition)   üîÄ[Azure AD Named Locations](https://portal.azure.com/#blade/Microsoft_AAD_IAM/NamedNetworksWithCountryBlade)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.10.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[PE-17](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| extend UserPrincipalName = UserId_s\r\n| where LabelName_s <> \"\"\r\n| join (SigninLogs) on UserPrincipalName\r\n| extend City = tostring(LocationDetails.city)\r\n| extend State = tostring(LocationDetails.state)\r\n| extend Country_Region = tostring(LocationDetails.countryOrRegion)\r\n| summarize count() by UserPrincipalName, LabelName_s, Activity_s, City, State, Country_Region\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Monitor Geolocation of Sensitive Data Access",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Activity_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "pending",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "City",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Country_Region",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| extend UserPrincipalName = UserId_s\r\n| where LabelName_s <> \"\"\r\n| join (SigninLogs) on UserPrincipalName\r\n\r\n\r\n",
                          "size": 3,
                          "showAnalytics": true,
                          "title": "Monitor Geolocation of Sensitive Data Access",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "map",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Activity_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "pending",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "City",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Country_Region",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ]
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "orange"
                                }
                              ]
                            }
                          }
                        },
                        "name": "query - 1 - Copy"
                      }
                    ]
                  },
                  "name": "PE.L2-3.10.6",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isPEVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Physical Protection",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Risk Assessment\r\n---\r\nRisk Assessment ensures a consistent approach to the identification, mitigation, and response to security risks.¬†For more information, see the üí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "RA.L2-3.11.1",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (RA.L2-3.11.1) Risk Assessments",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "RA.L2-3.11.2",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (RA.L2-3.11.2) Vulnerability Scan",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "RA.L2-3.11.3",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (RA.L2-3.11.3) Vulnerability Remediation",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(RA.L2-3.11.1) Risk Assessments](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#periodically-assess-the-risk-to-organizational-operations-including-mission-functions-image-or-reputation-organizational-assets-and-individuals-resulting-from-the-operation-of-organizational-systems-and-the-associated-processing-storage-or-transmission-of-cui)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityScore](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securescores) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br>  \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.11.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[RA-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| make-series count() default=0 on DiscoveredTimeUTC from {TimeRange:start} to {TimeRange:end} step 1d by RecommendationSeverity",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Microsoft Defender for Cloud: Recommendations over Time by Severity",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "timechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Medium",
                                "color": "yellow"
                              },
                              {
                                "seriesName": "High",
                                "color": "redBright"
                              },
                              {
                                "seriesName": "Low",
                                "color": "blueDark"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "RA.L2-3.11.1",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(RA.L2-3.11.2) Vulnerability Scan](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#scan-for-vulnerabilities-in-organizational-systems-and-applications-periodically-and-when-new-vulnerabilities-affecting-those-systems-and-applications-are-identified)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n‚ú≥Ô∏è [GitHub Advanced Security](https://docs.github.com/en/get-started/learning-about-github/about-github-advanced-security)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure DNS](https://azure.microsoft.com/services/dns/)   üîÄ[DNS Zones](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityBaseline](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securitybaseline) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.11.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[RA-5, RA-5(5)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityBaseline\r\n| summarize arg_max(TimeGenerated, *) by Description, _ResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Failed\"),\r\n    Passed‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Passed\"),\r\n    Total‚ÄØ=‚ÄØcountif(AnalyzeResult == \"Passed\" or AnalyzeResult == \"Failed\")\r\n    by Description, CceId\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project CceId, Description, Total, PassedControls, Passed, Failed\r\n| where CceId <> \"\"\r\n| sort by Total desc\r\n| limit 250\r\n\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Security Baselines",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "CceId",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Description",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "AnalyzeResult",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Passed",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Failed",
                                      "representation": "failed",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Medium",
                                "color": "yellow"
                              },
                              {
                                "seriesName": "High",
                                "color": "redBright"
                              },
                              {
                                "seriesName": "Low",
                                "color": "blueDark"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "RA.L2-3.11.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(RA.L2-3.11.3) Vulnerability Remediation](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#remediate-vulnerabilities-in-accordance-with-risk-assessments)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [GitHub Advanced Security](https://docs.github.com/en/get-started/learning-about-github/about-github-advanced-security)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.11.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[RA-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"vuln\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "RA.L2-3.11.3",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isRMVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Risk Assessment Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Security Assessment\r\n---\r\nSecurity Assessment includes periodic evaluation of security controls for effectiveness. For more information, see the üí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security."
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "099484fd-2dc9-4c76-8ba8-df7726fa117e",
                        "cellValue": "CA.L2-3.12.1",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (CA.L2-3.12.1) Security Control Assessment",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "CA.L2-3.12.2",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (CA.L2-3.12.2) Plan of Action",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "d94ce568-dbf0-46d9-9846-e8012a05682f",
                        "cellValue": "CA.L2-3.12.3",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (CA.L2-3.12.3) Security Control Monitoring",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "b2ee25d7-f4f8-41a2-912a-33da1db24b28",
                        "cellValue": "CA.L2-3.12.4",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (CA.L2-3.12.4) System Security Plan",
                        "preText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(CA.L2-3.12.1) Security Control Assessment](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#periodically-assess-the-security-controls-in-organizational-systems-to-determine-if-the-controls-are-effective-in-their-application)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.12.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CA-2, CA-5, CA-7, PL-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Microsoft Defender for Cloud Recommendations: Controls Assessment",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "CA.L2-3.12.1",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (CA.L2-3.12.2) Plan of Action\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.12.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CA-2, CA-5, CA-7, PL-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by AssessedResourceId\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project AssessedResourceId, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Develop Plan of Action via Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AssessedResourceId",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "CA.L2-3.12.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(CA.L2-3.12.3) Security Control Monitoring](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#monitor-security-controls-on-an-ongoing-basis-to-ensure-the-continued-effectiveness-of-the-controls)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.12.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CA-2, CA-5, CA-7, PL-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by ProductName",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Monitor Security Controls for Efficiency",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "timechart"
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "CA.L2-3.12.3",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (CA.L2-3.12.4) System Security Plan\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Recommended Resources\r\nüí°  [Understanding Network Map](https://docs.microsoft.com/azure/security-center/security-center-network-recommendations#understanding-the-network-map)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.12.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CA-2, CA-5, CA-7, PL-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Network Map\r\n![Image¬†Name](https://docs.microsoft.com/azure/security-center/media/security-center-network-recommendations/network-map-traffic.png)¬†\r\n[Go To: Microsoft Defender for Cloud - Network Map >](https://portal.azure.com/#blade/Microsoft_Azure_Security_R3/NetworkMapBlade)\r\n"
                        },
                        "customWidth": "45",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "45"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "CA.L2-3.12.4",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isCAVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Security Assessment Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# System & Communications Protection\r\n---\r\nSystem & Communications Protection includes network security for administrative and management functions. The System & Communications Protection Control family includes 32 controls which varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibility. ¬†For more information, see the üí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 1: Foundational",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "The Department views Level 1 (‚ÄúFoundational‚Äù) as an opportunity to engage its contractors in developing and strengthening their approach to cybersecurity. Because Level 1 does not involve sensitive national security information, DoD intends for this Level to allow companies to assess their own cybersecurity and begin adopting practices that will thwart cyber-attacks. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 2"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "SC.L1-3.13.1",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L1-3.13.1) Boundary Protection",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "c64247a3-06f1-46af-bdae-bc852cb789ce",
                        "cellValue": "SC.L1-3.13.5",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L1-3.13.5) Public-Access System Separation",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML1 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SC.L1-3.13.1) Boundary Protection](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#monitor-control-and-protect-communications-ie-information-transmitted-or-received-by-organizational-systems-at-the-external-boundaries-and-key-internal-boundaries-of-organizational-systems)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/)   üîÄ[ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)   üîÄ[Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Customer Lockbox](https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview)   üîÄ[Customer Lockbox](https://portal.azure.com/#blade/Microsoft_Azure_Lockbox/LockboxMenu/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-7, SA-8](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"network\" or RecommendationDisplayName contains \"transit\" or RecommendationDisplayName contains \"http\" or RecommendationDisplayName contains \"web\" or RecommendationDisplayName contains \"comm\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "SC.L1-3.13.1",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SC.L1-3.13.5) Public-Access System Separation](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#implement-subnetworks-for-publicly-accessible-system-components-that-are-physically-or-logically-separated-from-internal-networks)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-7](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"microsoft.network/\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Network Asset Listing",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "SC.L1-3.13.5",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 1: Foundational"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "eb462921-f3cf-4d08-ac32-c72bea21e204",
                        "cellValue": "SC.L2-3.13.2",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L2-3.13.2) Security Engineering",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "SC.L2-3.13.3",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L2-3.13.3) Role Separation",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "e391b908-4b08-46ce-b5ba-129d9905dd98",
                        "cellValue": "SC.L2-3.13.6",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L2-3.13.6) Network Communication by Exception",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "2eaf74ad-7c2f-42ae-9ea0-ef223dd2b7e8",
                        "cellValue": "SC.L2-3.13.8",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L2-3.13.8) Data in Transit",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "2885a56b-abb8-4cc5-a945-8cfe0786d160",
                        "cellValue": "SC.L2-3.13.10",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L2-3.13.10) Key Management",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "81a446a5-4409-4152-a958-116936cee2b4",
                        "cellValue": "SC.L2-3.13.11",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L2-3.13.11) CUI Encryption",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "ce448438-09a8-428d-9187-c34880fa323d",
                        "cellValue": "SC.L2-3.13.12",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L2-3.13.12) Collaborative Device Control",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cd62a74b-086f-4e9f-8f89-059b969c692d",
                        "cellValue": "SC.L2-3.13.13",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L2-3.13.13) Mobile Code",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "88caef2e-6d4c-4d8d-b3e4-70c58f384c5d",
                        "cellValue": "SC.L2-3.13.14",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L2-3.13.14) Voice Over Internet Protocol",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "594c1cfd-447f-4616-9351-cb45d5429f11",
                        "cellValue": "SC.L2-3.13.15",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L2-3.13.15) Communications Authenticity",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "47e4f75f-5597-4228-8383-5fc04d1280b5",
                        "cellValue": "SC.L2-3.13.16",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L2-3.13.16) Data at Rest",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SC.L2-3.13.2) Security Engineering](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#employ-architectural-designs-software-development-techniques-and-systems-engineering-principles-that-promote-effective-information-security-within-organizational-systems)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-7, SA-8](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Microsoft Defender for Cloud Recommendations Count Summary",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "SC.L2-3.13.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SC.L2-3.13.3) Role Separation](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#separate-user-functionality-from-system-management-functionality)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AADManagedIdentitySignInLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/aadmanagedidentitysigninlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AADManagedIdentitySignInLogs\r\n| summarize count() by ServicePrincipalName, ResourceDisplayName\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Azure Active Directory: Managed Identities",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ServicePrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "SC.L2-3.13.3",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SC.L2-3.13.6) Network Communication by Exception](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#deny-network-communications-traffic-by-default-and-allow-network-communications-traffic-by-exception-ie-deny-all-permit-by-exception)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AzureDiagnostics]https://docs.microsoft.com/azure/azure-monitor/reference/tables/azurediagnostics) ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-7(5)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AzureDiagnostics\r\n| where Category == \"AzureFirewallApplicationRule\"\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePortInt:int \" \" TempDetails\r\n| parse TempDetails with \"was \" Action1 \". Reason: \" Rule1\r\n| parse TempDetails with \"to \" FQDN \":\" TargetPortInt:int \". Action: \" Action2 \".\" *\r\n| parse TempDetails with * \". Rule Collection: \" RuleCollection2a \". Rule:\" Rule2a\r\n| parse TempDetails with * \"Deny.\" RuleCollection2b \". Proceeding with\" Rule2b\r\n| extend SourcePort = tostring(SourcePortInt)\r\n| extend TargetPort = tostring(TargetPortInt)\r\n| extend Action1 = case(Action1 == \"Deny\",\"Deny\",\"Unknown Action\")\r\n| extend Action = case(Action2 == \"\",Action1,Action2),Rule = case(Rule2a == \"\", case(Rule1 == \"\",case(Rule2b == \"\",\"N/A\", Rule2b),Rule1),Rule2a), \r\nRuleCollection = case(RuleCollection2b == \"\",case(RuleCollection2a == \"\",\"No rule matched\",RuleCollection2a), RuleCollection2b),FQDN = case(FQDN == \"\", \"N/A\", FQDN),TargetPort = case(TargetPort == \"\", \"N/A\", TargetPort)\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by Action\r\n| render timechart ",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Azure Firewall: Action Count by Time",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ]
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "SC.L2-3.13.6",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SC.L2-3.13.8) Data in Transit](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#implement-cryptographic-mechanisms-to-prevent-unauthorized-disclosure-of-cui-during-transmission-unless-otherwise-protected-by-alternative-physical-safeguards)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n\r\n\r\n# Secondary Services\r\n‚ú≥Ô∏è [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/)   üîÄ[ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits)<br>\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)   üîÄ[Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Information Protection](https://www.microsoft.com/security/business/compliance/information-protection)    üîÄ[Microsoft Information Protection](https://compliance.microsoft.com/informationprotection)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.8](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-8, SC-8(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"key\" or RecommendationDisplayName contains \"vault\" or RecommendationDisplayName contains \"crypt\" or RecommendationDisplayName contains \"region\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "SC.L2-3.13.8",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SC.L2-3.13.10) Key Management](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#establish-and-manage-cryptographic-keys-for-cryptography-employed-in-organizational-systems)\r\n\r\n# Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n\r\n# Secondary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.10](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-12](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"key\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "SC.L2-3.13.10",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "#  [(SC.L2-3.13.11) CUI Encryption](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#employ-fips-validated-cryptography-when-used-to-protect-the-confidentiality-of-cui)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.11](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-13](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"key\" or type contains \"crypt\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Key Vault & Crytographic Assets Listing",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "SC.L2-3.13.11",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (SC.L2-3.13.12) Collaborative Device Control <br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Resources\r\nüí° [Group Policy](https://docs.microsoft.com/windows/security/identity-protection/hello-for-business/hello-cert-trust-policy-settings)<br>\r\nüí° [Intune/Microsoft Endpoint Manager policy](https://docs.microsoft.com/mem/intune/protect/windows-hello)<br>\r\nüí° [Windows Hello biometrics in the enterprise](https://docs.microsoft.com/windows/security/identity-protection/hello-for-business/hello-biometrics-in-enterprise)<br>\r\nüí° [View Connected Devices](https://docs.microsoft.com/azure/active-directory/user-help/my-account-portal-devices-page#view-your-connected-devices)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Event](https://docs.microsoft.com/azure/azure-monitor/reference/tables/event) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.12](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-15](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Event\r\n| where TimeGenerated > ago(90d)\r\n| where RenderedDescription contains \"Windows Hello\"\r\n| summarize count() by _ResourceId, EventLevelName, RenderedDescription, EventID\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Configure Windows Hello for Collaborative Computing Devices & Monitor Event Logs",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "SC.L2-3.13.12",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (SC.L2-3.13.13) Mobile Code\r\n\r\n# Primary Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n# Secondary Services\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [DeviceFileEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/devicefileevents) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.13](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-18](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "DeviceFileEvents\r\n| where FileName contains \".pdf\" or FileName contains \".vbx\" or FileName contains \"java\" or FileName contains \".dcr\"\r\n| summarize count() by ActionType, FileName\r\n| sort by count_ desc \r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Control and Monitor the Use of Mobile Code",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ActionType",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "File",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "SC.L2-3.13.13",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (SC.L2-3.13.14) Voice Over Internet Protocol\r\n\r\n# Secondary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [OfficeActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/officeactivity) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.14](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-19](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "OfficeActivity\r\n| where RecordType == \"MicrosoftTeams\"\r\n| summarize count() by RecordType, Operation, UserId\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Control & Monitor Microsoft Teams Activity",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecordType",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Connect",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserId",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "SC.L2-3.13.14",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SC.L2-3.13.15) Communications Authenticity](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#protect-the-authenticity-of-communications-sessions)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n\r\n# Secondary Services\r\n‚ú≥Ô∏è [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/)   üîÄ[ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits)<br>\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)   üîÄ[Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.15](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-23](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"web\" or RecommendationDisplayName contains \"http\" or RecommendationDisplayName contains \"protocol\" or RecommendationDisplayName contains \"session\" or RecommendationDisplayName contains \"comm\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "SC.L2-3.13.15",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SC.L2-3.13.16) Data at Rest](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#protect-the-confidentiality-of-cui-at-rest)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n\r\n# Secondary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.16](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-28](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationDisplayName contains \"stor\" or RecommendationDisplayName contains \"disk\" or RecommendationDisplayName contains \"SQL\" or RecommendationDisplayName contains \"database\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| summarize\r\n    Failed‚ÄØ=‚ÄØcountif(RecommendationState == \"Unhealthy\"),\r\n    Passed‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\"),\r\n    Total‚ÄØ=‚ÄØcountif(RecommendationState == \"Healthy\" or RecommendationState == \"Unhealthy\")\r\n    by RecommendationDisplayName\r\n| extend PassedControls‚ÄØ= (Passed / todouble(Total)) * 100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Notes <br>\r\n{Notes}"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      }
                    ]
                  },
                  "name": "SC.L2-3.13.16",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isSCVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "System & Communications Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# System & Information Integrity\r\n---\r\nSystem & Information Integrity includes controls to identify system flaws, combat malware, and identify anomalies.¬†For more information, see the üí°[CMMC Model](https://www.acq.osd.mil/cmmc/model.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 1: Foundational",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "The Department views Level 1 (‚ÄúFoundational‚Äù) as an opportunity to engage its contractors in developing and strengthening their approach to cybersecurity. Because Level 1 does not involve sensitive national security information, DoD intends for this Level to allow companies to assess their own cybersecurity and begin adopting practices that will thwart cyber-attacks. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 2"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "SC.L1-3.14.1",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L1-3.14.1) Flaw Remediation",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cc953797-1e63-4908-b327-696b9852e011",
                        "cellValue": "SC.L1-3.14.2",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L1-3.14.2) Malicious Code Protection",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "a9af4f42-5e43-480e-b684-94903ea3ab1a",
                        "cellValue": "SC.L1-3.14.4",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L1-3.14.4) Update Malicious Code Protection",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "591eebe3-fee7-4d51-825e-1651c99d5761",
                        "cellValue": "SC.L1-3.14.5",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SC.L1-3.14.5) System & File Scanning",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML1 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SC.L1-3.14.1) Flaw Remediation](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#identify-report-and-correct-information-and-information-system-flaws-in-a-timely-manner)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SI-2, SI-3, SI-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| summarize arg_max(TimeGenerated, *) by RecommendationName, AssessedResourceId, RecommendationSeverity\r\n|‚ÄØsummarize‚ÄØFailed‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Unhealthy\"),‚ÄØPassed‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Healthy\"),‚ÄØTotal‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Healthy\" or RecommendationState == \"Unhealthy\") by RecommendationSeverity\r\n|‚ÄØextend‚ÄØPassedControls‚ÄØ= (Passed/todouble(Total))*100\r\n| where RecommendationSeverity <> \"\"\r\n| project RecommendationSeverity, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Microsoft Defender for Cloud Recommendations by Severity",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "[\"Passed\"]/[\"Total\"]",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true,
                                    "minimumIntegerDigits": 2,
                                    "minimumFractionDigits": 2,
                                    "maximumFractionDigits": 2,
                                    "minimumSignificantDigits": 2,
                                    "maximumSignificantDigits": 4
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "yellowOrangeRed"
                                }
                              },
                              {
                                "columnMatch": "total_controls_curr",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "[\"Passed\"]/[\"Failed\"]",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": []
                        },
                        "customWidth": "50",
                        "name": "query - 6 - Copy"
                      }
                    ]
                  },
                  "name": "SC.L1-3.14.1",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SC.L1-3.14.2) Malicious Code Protection](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#provide-protection-from-malicious-code-at-appropriate-locations-within-organizational-information-systems)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure DNS](https://azure.microsoft.com/services/dns/)   üîÄ[DNS Zones](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SI-2, SI-3, SI-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationName contains \"malware\" or RecommendationName contains \"endpoint protect\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationName, AssessedResourceId\r\n|‚ÄØsummarize‚ÄØFailed‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Unhealthy\"),‚ÄØPassed‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Healthy\"),‚ÄØTotal‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Healthy\" or RecommendationState == \"Unhealthy\") by RecommendationName\r\n|‚ÄØextend‚ÄØPassedControls‚ÄØ= (Passed/todouble(Total))*100\r\n| project RecommendationName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "[\"Passed\"]/[\"Total\"]",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true,
                                    "minimumIntegerDigits": 2,
                                    "minimumFractionDigits": 2,
                                    "maximumFractionDigits": 2,
                                    "minimumSignificantDigits": 2,
                                    "maximumSignificantDigits": 4
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "yellowOrangeRed"
                                }
                              },
                              {
                                "columnMatch": "total_controls_curr",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "[\"Passed\"]/[\"Failed\"]",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": []
                        },
                        "customWidth": "50",
                        "name": "query - 6 - Copy"
                      }
                    ]
                  },
                  "name": "SC.L1-3.14.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SC.L1-3.14.4) Update Malicious Code Protection](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#update-malicious-code-protection-mechanisms-when-new-releases-are-available)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SI-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRegulatoryCompliance\r\n| where RecommendationName contains \"Update\" and RecommendationName contains \"Signature\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationName, AssessedResourceId\r\n|‚ÄØsummarize‚ÄØFailed‚ÄØ=‚ÄØcountif(State‚ÄØ==‚ÄØ\"Failed\"),‚ÄØPassed‚ÄØ=‚ÄØcountif(State‚ÄØ==‚ÄØ\"Passed\"),‚ÄØTotal‚ÄØ=‚ÄØcountif(State‚ÄØ==‚ÄØ\"Passed\" or State == \"Failed\") by RecommendationName\r\n|‚ÄØextend‚ÄØPassedControls‚ÄØ= (Passed/todouble(Total))*100\r\n| project RecommendationName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "[\"Passed\"]/[\"Total\"]",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true,
                                    "minimumIntegerDigits": 2,
                                    "minimumFractionDigits": 2,
                                    "maximumFractionDigits": 2,
                                    "minimumSignificantDigits": 2,
                                    "maximumSignificantDigits": 4
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "yellowOrangeRed"
                                }
                              },
                              {
                                "columnMatch": "total_controls_curr",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "[\"Passed\"]/[\"Failed\"]",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": []
                        },
                        "customWidth": "50",
                        "name": "query - 6 - Copy"
                      }
                    ]
                  },
                  "name": "SC.L1-3.14.4",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SC.L1-3.14.5) System & File Scanning](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#perform-periodic-scans-of-the-information-system-and-real-time-scans-of-files-from-external-sources-as-files-are-downloaded-opened-or-executed)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure DNS](https://azure.microsoft.com/services/dns/)   üîÄ[DNS Zones](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SI-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationName contains \"defender\"\r\n| summarize arg_max(TimeGenerated, *) by RecommendationName, AssessedResourceId\r\n|‚ÄØsummarize‚ÄØFailed‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Unhealthy\"),‚ÄØPassed‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Healthy\"),‚ÄØTotal‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Healthy\" or RecommendationState == \"Unhealthy\") by RecommendationName\r\n|‚ÄØextend‚ÄØPassedControls‚ÄØ= (Passed/todouble(Total))*100\r\n| project RecommendationName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review Microsoft Defender for Cloud Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "[\"Passed\"]/[\"Total\"]",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true,
                                    "minimumIntegerDigits": 2,
                                    "minimumFractionDigits": 2,
                                    "maximumFractionDigits": 2,
                                    "minimumSignificantDigits": 2,
                                    "maximumSignificantDigits": 4
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "yellowOrangeRed"
                                }
                              },
                              {
                                "columnMatch": "total_controls_curr",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "[\"Passed\"]/[\"Failed\"]",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": []
                        },
                        "customWidth": "50",
                        "name": "query - 6 - Copy"
                      }
                    ]
                  },
                  "name": "SC.L1-3.14.5",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 1: Foundational"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Level 2: Advanced",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "A subset of programs with Level 2 (‚ÄúAdvanced‚Äù) requirements do not involve information critical to national security, and associated contractors will only be required to conduct self-assessments. Once CMMC 2.0 is implemented, contractors will be required to obtain a third-party CMMC assessment for a subset of acquisitions requiring Level 2 (‚ÄúAdvanced‚Äù) cybersecurity standards that involve information critical to national security. "
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "SI.L2-3.14.3",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SI.L2-3.14.3) Security Alerts & Advisories",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "aae96c20-ec13-43d0-8602-0c46bdcec567",
                        "cellValue": "SI.L2-3.14.6",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SI.L2-3.14.6) Monitor Communications for Attacks",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "74d74ca8-57df-47d7-8067-0e0044d59579",
                        "cellValue": "SI.L2-3.14.7",
                        "linkTarget": "step",
                        "linkLabel": "‚ú≥Ô∏è (SI.L2-3.14.7) Identify Unauthorized Use",
                        "preText": "",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "40",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# (SI.L2-3.14.3) Security Alerts & Advisories\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter)  ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SI-2, SI-3, SI-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"logic\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Automated Security Response (SOAR) Actions Configured",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "SI.L2-3.14.3",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SI.L2-3.14.6) Monitor Communications for Attacks](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#monitor-organizational-systems-including-inbound-and-outbound-communications-traffic-to-detect-attacks-and-indicators-of-potential-attacks)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure DNS](https://azure.microsoft.com/services/dns/)   üîÄ[DNS Zones](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-2, AU-2(3), AU-6, SI-4, SI-4(4)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n| distinct AlertName, AlertSeverity, ProductName, Status, Tactics, AlertLink, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Monitor Security Alerts",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": ""
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "SI.L2-3.14.6",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [(SI.L2-3.14.7) Identify Unauthorized Use](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#identify-unauthorized-use-of-organizational-systems)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   üîÄ[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)   üîÄ[Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [BehaviorAnalytics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/behavioranalytics) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.7](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SI-4](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Microsoft Defender for Cloud: Regulatory Compliance\r\n[Go To: NIST SP 800-171 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let AnomalousSigninActivity = BehaviorAnalytics\r\n    | where ActionType == \"Sign-in\"\r\n    | where (UsersInsights.NewAccount == True or UsersInsights.DormantAccount == True) and (\r\n        ActivityInsights.FirstTimeUserAccessedResource == True and ActivityInsights.ResourceUncommonlyAccessedAmongPeers == True\r\n        or ActivityInsights.FirstTimeUserUsedApp == True and ActivityInsights.AppUncommonlyUsedAmongPeers == False)\r\n    | join (\r\n        SigninLogs | where Status.errorCode == 0 or Status.errorCode == 0 and RiskDetail != \"none\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Successful Sign-in with one or more of the following indications: sign by new or recently dormant accounts and sign in with resource for the first time (while none of their peers did) or to an app for the first time (while none of their peers did) or performed by a user with Risk indicaiton from AAD\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet critical = dynamic(['9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3', 'c4e39bd9-1100-46d3-8c65-fb160da0071f', '158c047a-c907-4556-b7ef-446551a6b5f7', '62e90394-69f5-4237-9190-012177145e10', 'd29b2b05-8046-44ba-8758-1e26182fcf32', '729827e3-9c14-49f7-bb1b-9608f156bbb8', '966707d0-3269-4727-9be2-8c3a10f19b9d', '194ae4cb-b126-40b2-bd5b-6091b380977d', 'fe930be7-5e62-47db-91af-98c3a49a38b1']);\r\nlet high = dynamic(['cf1c38e5-3621-4004-a7cb-879624dced7c', '7495fdc4-34c4-4d15-a289-98788ce399fd', 'aaf43236-0c0d-4d5f-883a-6955382ac081', '3edaf663-341e-4475-9f94-5c398ef6c070', '7698a772-787b-4ac8-901f-60d6b08affd2', 'b1be1c3e-b65d-4f19-8427-f6fa0d97feb9', '9f06204d-73c1-4d4c-880a-6edb90606fd8', '29232cdf-9323-42fd-ade2-1d097af3e4de', 'be2f45a1-457d-42af-a067-6ec1fa63bc45', '7be44c8a-adaf-4e2a-84d6-ab2649e08a13', 'e8611ab8-c189-46e8-94e1-60213ab1f814']);//witdstomstl\r\nlet AnomalousRoleAssignment = AuditLogs\r\n    | where TimeGenerated > ago(28d)\r\n    | where OperationName == \"Add member to role\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target = tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner (\r\n        BehaviorAnalytics\r\n        | where ActionType == \"Add member to role\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend AnomalyName = \"Anomalous Role Assignemt\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access.  The query below generates an output of all high Blast Radius users performing Add member to priveleged role, or ones that add users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let LogOns=materialize(\r\n    BehaviorAnalytics\r\n    | where ActivityType == \"LogOn\");\r\nlet AnomalousResourceAccess = LogOns\r\n    | where ActionType == \"ResourceAccess\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous Resource Access\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversary may be trying to move through the environment. APT29 and APT32, for example, has used PtH & PtT techniques to lateral move around the network. The query below generates an output of all users performing an resource access (4624:3) to devices for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousRDPActivity = LogOns\r\n    | where ActionType == \"RemoteInteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous RDP Activity\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. FIN10, for example, has used RDP to move laterally to systems in the victim environment. The query below generates an output of all users performing a remote interactive logon (4624:10) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousLogintoDevices = LogOns\r\n    | where ActionType == \"InteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | where UsersInsights.DormantAccount == true or DevicesInsights.LocalAdmin == true\r\n    | extend AnomalyName = \"Anomalous Login To Devices\",\r\n        Tactic = \"Privilege Escalation\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access and privilege escalation. The query below generates an output of all administator users performing an interactive logon (4624:2) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousPasswordReset = BehaviorAnalytics\r\n    | where ActionType == \"Reset user password\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == \"True\"\r\n    | join (\r\n        AuditLogs\r\n        | where OperationName == \"Reset user password\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Password Reset\",\r\n        Tactic = \"Impact\",\r\n        Technique = \"Account Access Removal\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. LockerGoga, for example, has been observed changing account passwords and logging off current users. The query below generates an output of all users performing Reset user password for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalousGeoLocationLogon = BehaviorAnalytics\r\n    | where ActionType == \"Sign-in\"\r\n    | where ActivityInsights.FirstTimeUserConnectedFromCountry == True and (ActivityInsights.FirstTimeConnectionFromCountryObservedInTenant == True or ActivityInsights.CountryUncommonlyConnectedFromAmongPeers == True)\r\n    | join (\r\n        SigninLogs\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Initial Access\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access. The query below generates an output of successful Sign-in performed by a user from a new geo location he has never connected from before, and none of his peers as well.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousFailedLogon = BehaviorAnalytics\r\n    | where ActivityType == \"LogOn\"\r\n    | where UsersInsights.BlastRadius == \"High\"\r\n    | join (\r\n        SigninLogs  \r\n        | where Status.errorCode == 50126\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Failed Logon\",\r\n        Tactic = \"Credential Access\",\r\n        Technique = \"Brute Force\",\r\n        SubTechnique = \"Password Guessing\",\r\n        Description = \"Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Emotet, for example, has been observed using a hard coded list of passwords to brute force user accounts. The query below generates an output of all users with 'High' BlastRadius that perform failed Sign-in:Invalid username or password.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousAADAccountManipulation = AuditLogs\r\n    | where OperationName == \"Update user\"\r\n    | mv-expand AdditionalDetails\r\n    | where AdditionalDetails.key == \"UserPrincipalName\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner ( \r\n        BehaviorAnalytics\r\n        | where ActionType == \"Update user\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName) \r\n    | extend AnomalyName = \"Anomalous Account Manipulation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access. The query below generates an output of all high Blast Radius users performing 'Update user' (name change) to priveleged role, or ones that changed users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let AnomalousAADAccountCreation = BehaviorAnalytics\r\n    | where ActionType == \"Add user\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == True or ActivityInsights.FirstTimeActionPerformedInTenant == True or ActivityInsights.ActionUncommonlyPerformedAmongPeers == true\r\n    | join(\r\n        AuditLogs\r\n        | where OperationName == \"Add user\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend DisplayName = tostring(UsersInsights.AccountDisplayName),\r\n        UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Account Creation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Create Account\",\r\n        SubTechnique = \"Cloud Account\",\r\n        Description = \"Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system. The query below generates an output of all the users performing user creation for the first time and the target users that were created.\"\t\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalyTable = union kind=outer AnomalousSigninActivity, AnomalousRoleAssignment, AnomalousResourceAccess, AnomalousRDPActivity, AnomalousPasswordReset, AnomalousLogintoDevices, AnomalousGeoLocationLogon, AnomalousAADAccountManipulation, AnomalousAADAccountCreation, AnomalousFailedLogon;\r\nlet TopUsersByAnomalies = AnomalyTable\r\n    | summarize hint.strategy = shuffle AnomalyCount=count() by UserName, UserPrincipalName, tostring(UsersInsights.OnPremSid), tostring(UsersInsights.AccountObjectId)\r\n    | project Name=tolower(UserName), UPN=tolower(UserPrincipalName), AadUserId=UsersInsights_AccountObjectId, Sid=UsersInsights_OnPremSid, AnomalyCount\r\n    | sort by AnomalyCount desc;\r\nlet TopUsersByIncidents = SecurityIncident\r\n    | summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n    | where Status == \"New\" or Status == \"Active\"\r\n    | mv-expand AlertIds\r\n    | extend AlertId = tostring(AlertIds)\r\n    | join kind= innerunique ( \r\n        SecurityAlert \r\n        )\r\n        on $left.AlertId == $right.SystemAlertId\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n    | where UPN <> \"\"\r\n    | where UPN <> \" @ \"\r\n    | union TopUsersByAnomalies\r\n    | extend \r\n        AadPivot = iff(isempty(AadUserId), iff(isempty(Sid), Name, Sid), AadUserId),\r\n        SidPivot = iff(isempty(Sid), iff(isempty(AadUserId), Name, AadUserId), Sid),\r\n        UPNExists = iff(isempty(UPN), false, true),\r\n        NameExists = iff(isempty(Name), false, true),\r\n        SidExists = iff(isempty(Sid), false, true),\r\n        AADExists = iff(isempty(AadUserId), false, true)\r\n    | summarize hint.strategy = shuffle IncidentCount=dcount(IncidentNumber, 4), AlertCount=dcountif(AlertId, isnotempty(AlertId), 4), AnomalyCount=sum(AnomalyCount), any(Title, Severity, Status, StartTime, IncidentNumber, IncidentUrl, Owner), UPNAnchor=anyif(UPN, UPNExists == true), NameAnchor=anyif(Name, NameExists == true), AadAnchor=anyif(AadUserId, AADExists == true), SidAnchor=anyif(Sid, SidExists == true), any(SidPivot) by AadPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), NameAnchor=anyif(NameAnchor, isempty(NameAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_Title, any_Severity, any_StartTime, any_IncidentNumber, any_IncidentUrl) by any_SidPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_any_Title, any_any_Severity, any_any_StartTime, any_any_IncidentNumber, any_any_IncidentUrl) by NameAnchor\r\n    | project [\"UserName\"]=NameAnchor, IncidentCount, AlertCount, AnomalyCount, [\"AadUserId\"]=AadAnchor, [\"OnPremSid\"]=SidAnchor, [\"UserPrincipalName\"]=UPNAnchor;\r\nTopUsersByIncidents\r\n| where UserPrincipalName !contains \"[\"\r\n| project UserPrincipalName, IncidentCount, AlertCount, AnomalyCount\r\n| sort by IncidentCount desc\r\n| limit 50\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Review User Entity Behavior Analytics for Unauthorized Activity",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "AlertCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "orange"
                                }
                              },
                              {
                                "columnMatch": "AnomalyCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "yellow"
                                }
                              }
                            ],
                            "rowLimit": 50,
                            "filter": true,
                            "sortBy": [
                              {
                                "itemKey": "$gen_heatmap_IncidentCount_1",
                                "sortOrder": 2
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_heatmap_IncidentCount_1",
                              "sortOrder": 2
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "SI.L2-3.14.7",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isSIVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "System & Information Integrity Group",
      "styleSettings": {
        "showBorder": true
      }
    }
  ],
  "fromTemplateId": "sentinel-CybersecurityMaturityModelCertification(CMMC)2.0",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}