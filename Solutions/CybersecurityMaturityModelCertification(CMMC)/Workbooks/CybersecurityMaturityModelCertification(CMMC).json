{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "version": "KqlParameterItem/1.0",
            "name": "DefaultSubscription_Internal",
            "type": 1,
            "isRequired": true,
            "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| take 1\r\n| project subscriptionId",
            "isHiddenWhenLocked": true,
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "id": "d7afa921-907e-4c42-87ca-e67aecd47310"
          },
          {
            "id": "e6ded9a1-a83c-4762-938d-5bf8ff3d3d38",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 6,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "summarize by subscriptionId\r\n| project value = strcat(\"/subscriptions/\", subscriptionId), label = subscriptionId, selected = iff(subscriptionId =~ '{DefaultSubscription_Internal}', true, false)",
            "crossComponentResources": [
              "value::selected"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "e3225ed0-6210-40a1-b2d0-66e42ffa71d6",
            "version": "KqlParameterItem/1.0",
            "name": "Workspace",
            "type": 5,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "resources\r\n| where type =~ 'microsoft.operationalinsights/workspaces'\r\n| order by name asc\r\n| summarize Selected = makelist(id, 10), All = makelist(id, 1000)\r\n| mvexpand All limit 100\r\n| project value = tostring(All), label = tostring(All), selected = iff(Selected contains All, true, false)",
            "crossComponentResources": [
              "value::all"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "15b2c181-7397-43c1-900a-28e175ae8a6f",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "label": "‚è±Ô∏è Time Range",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 2592000000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "Parameter Selectors"
    },
    {
      "type": 1,
      "content": {
        "json": "<svg viewBox=\"0 0 19 19\" width=\"20\" class=\"fxt-escapeShadow\" role=\"presentation\" focusable=\"false\" xmlns:svg=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" aria-hidden=\"true\"><g><path fill=\"#1b93eb\" d=\"M16.82 8.886c0 4.81-5.752 8.574-7.006 9.411a.477.477 0 01-.523 0C8.036 17.565 2.18 13.7 2.18 8.886V3.135a.451.451 0 01.42-.419C7.2 2.612 6.154.625 9.5.625s2.3 1.987 6.8 2.091a.479.479 0 01.523.419z\"></path><path fill=\"url(#0024423711759027356)\" d=\"M16.192 8.99c0 4.392-5.333 7.947-6.483 8.575a.319.319 0 01-.418 0c-1.15-.732-6.483-4.183-6.483-8.575V3.762a.575.575 0 01.313-.523C7.2 3.135 6.258 1.357 9.4 1.357s2.2 1.882 6.274 1.882a.45.45 0 01.419.418z\"></path><path d=\"M9.219 5.378a.313.313 0 01.562 0l.875 1.772a.314.314 0 00.236.172l1.957.284a.314.314 0 01.174.535l-1.416 1.38a.312.312 0 00-.09.278l.334 1.949a.313.313 0 01-.455.33l-1.75-.92a.314.314 0 00-.292 0l-1.75.92a.313.313 0 01-.455-.33L7.483 9.8a.312.312 0 00-.09-.278L5.977 8.141a.314.314 0 01.174-.535l1.957-.284a.314.314 0 00.236-.172z\" class=\"msportalfx-svg-c01\"></path></g></svg>&nbsp;<span style=\"font-family: Open Sans; font-weight: 620; font-size: 14px;font-style: bold;margin:-10px 0px 0px 0px;position: relative;top:-3px;left:-4px;\"> Please take time to answer a quick survey,\r\n</span>[<span style=\"font-family: Open Sans; font-weight: 620; font-size: 14px;font-style: bold;margin:-10px 0px 0px 0px;position: relative;top:-3px;left:-4px;\"> click here. </span>](https://forms.office.com/r/hK7zcBDNp8)"
      },
      "name": "Survey"
    },
    {
      "type": 1,
      "content": {
        "json": "# Cybersecurity Maturity Model Certification (CMMC) Workbook\n---\n\nWelcome to the CMMC workbook. The Cybersecurity Maturity Model Certification (CMMC) model consists of maturity processes and cybersecurity best practices from multiple cybersecurity standards, frameworks, and other references, as well as inputs from the Defense Industrial Base (DIB) and Department of Defense (DoD stakeholders. The CMMC model specifies 5 levels of maturity measurement from Maturity Level 1 (Basic Cyber Hygiene) to Maturity Level 5 (Proactive & Advanced Cyber Practice). For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html).\n\nThe Azure Sentinel CMMC Workbook demonstrates best practice guidance, but Microsoft does not guarantee nor imply compliance. The workbook outlines controls across Maturity Levels 1-3. All accreditation requirements and decisions are governed by the üí°¬†[CMMC Accreditation Body](https://www.cmmcab.org/c3pao-lp). This workbook provides visibility and situational awareness for control requirements delivered with Microsoft technologies in predominantly cloud-based environments. Customer experience will vary by user and some panels may require additional configurations and query modification for operation. Recommendations should be considered a starting point for planning full or partial coverage of respective control requirements. \n"
      },
      "customWidth": "79",
      "name": "Workbook Overview"
    },
    {
      "type": 1,
      "content": {
        "json": "![Image Name](https://azure.microsoft.com/svghandler/azure-sentinel?width=600&height=315) "
      },
      "customWidth": "20",
      "name": "Azure Sentinel Logo"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Section\\\": \\\"Guide\\\", \\\"tab\\\": \\\"Help\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Access Control\\\", \\\"tab\\\": \\\"AC\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Asset Management\\\", \\\"tab\\\": \\\"AM_\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Audit & Accountability\\\", \\\"tab\\\": \\\"AU\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Awareness & Training\\\", \\\"tab\\\": \\\"AT\\\" },\\r\\n    { \\\"Section\\\": \\\"Configuration Management\\\", \\\"tab\\\": \\\"CM\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Identification & Authentication\\\", \\\"tab\\\": \\\"IA\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Incident Response\\\", \\\"tab\\\": \\\"IR\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Maintenance\\\", \\\"tab\\\": \\\"MA\\\" }\\r\\n]\",\"transformers\":null}",
        "size": 3,
        "title": "Control Family ",
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "tab",
            "parameterName": "Tab",
            "parameterType": 1
          }
        ],
        "queryType": 8,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "tab",
              "formatter": 5
            }
          ]
        }
      },
      "customWidth": "25",
      "name": "Control Family ",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "e8aff99c-1c46-4ece-aaec-76a02641dd5b",
            "version": "KqlParameterItem/1.0",
            "name": "isGuideVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "Help",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "7b682fc9-cb6b-4475-a24c-41dcb43d0cef",
            "version": "KqlParameterItem/1.0",
            "name": "isACVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "AC",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "c01e6494-1f74-4194-88b3-c98bbabdf84f",
            "version": "KqlParameterItem/1.0",
            "name": "isAUVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "AU",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "696bf441-12c0-45db-918c-215a1170f18e",
            "version": "KqlParameterItem/1.0",
            "name": "isATVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "AT",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "e85f9ad6-e6ae-4525-817c-50ddfa04ed68",
            "version": "KqlParameterItem/1.0",
            "name": "isAMVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "AM_",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isCMVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "CM",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "02596750-83d0-48ad-b9e0-2897e262ab29"
          },
          {
            "id": "a932ee8a-1039-4482-9fc8-ed79fe6f2ebb",
            "version": "KqlParameterItem/1.0",
            "name": "isIAVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "IA",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "2822f61e-a9f8-4419-87b6-f7b06a032cc2",
            "version": "KqlParameterItem/1.0",
            "name": "isIRVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "IR",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isMAVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "MA",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "bf0d48ca-a190-4545-a5db-0ba94598632b"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "customWidth": "5",
      "name": "Hidden Parameters Selectors"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Section\\\": \\\"Media Protection\\\", \\\"tab\\\": \\\"MP\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Personnel Security\\\", \\\"tab\\\": \\\"PS\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Physical Protection\\\", \\\"tab\\\": \\\"PE\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Recovery\\\", \\\"tab\\\": \\\"RE\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Risk Management\\\", \\\"tab\\\": \\\"RM\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Security Assessment\\\", \\\"tab\\\": \\\"CA\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Situational Awareness\\\", \\\"tab\\\": \\\"SA\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"System & Communications Protection\\\", \\\"tab\\\": \\\"SC\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"System & Information Integrity\\\", \\\"tab\\\": \\\"SI\\\" }\\r\\n]\",\"transformers\":null}",
        "size": 3,
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "tab",
            "parameterName": "Tab",
            "parameterType": 1
          }
        ],
        "queryType": 8,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "tab",
              "formatter": 5
            }
          ]
        }
      },
      "customWidth": "25",
      "name": "Control Family  - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "version": "KqlParameterItem/1.0",
            "name": "isMPVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "MP",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "d3e704a5-7f2e-44be-b6bd-67242f432376"
          },
          {
            "id": "e18bc9ef-6479-4eda-807a-b47f58f5f2f1",
            "version": "KqlParameterItem/1.0",
            "name": "isPSVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "PS",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "401a85db-1c90-45b4-86d2-3e5439784818",
            "version": "KqlParameterItem/1.0",
            "name": "isPEVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "PE",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "308bde5a-386f-4674-a712-26e31436b12e",
            "version": "KqlParameterItem/1.0",
            "name": "isREVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "RE",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isRMVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "RM",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "0af0cea9-8f28-4850-b48e-93a195efa02b"
          },
          {
            "id": "e9fdb883-980a-4147-b494-43f7137f7131",
            "version": "KqlParameterItem/1.0",
            "name": "isCAVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "CA",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isSAVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SA",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "75018228-addc-419d-a344-ca6c6787c7b0"
          },
          {
            "id": "c16d4f92-ce1a-4ff0-9576-23b39836e95d",
            "version": "KqlParameterItem/1.0",
            "name": "isSCVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SC",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isSIVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SI",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "9637281c-861a-4ba6-90cd-6650f187f00c"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "customWidth": "5",
      "name": "Hidden Parameters Selectors - Copy"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Section\\\": \\\"Assessment\\\", \\\"tab\\\": \\\"Assessment\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Maturity Level 1\\\", \\\"tab\\\": \\\"ML1\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Maturity Level 2\\\", \\\"tab\\\": \\\"ML2\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Maturity Level 3\\\", \\\"tab\\\": \\\"ML3\\\" }\\r\\n]\",\"transformers\":null}",
        "size": 3,
        "title": "Maturity Level",
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "tab",
            "parameterName": "Tab",
            "parameterType": 1
          }
        ],
        "queryType": 8,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "tab",
              "formatter": 5
            }
          ]
        }
      },
      "customWidth": "20",
      "name": "Maturity Level",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "43dec56c-837a-448a-883c-7fb77d265ae0",
            "version": "KqlParameterItem/1.0",
            "name": "isAssessmentVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "Assessment",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "0f8e02ef-c3db-4938-80ac-238929482156",
            "version": "KqlParameterItem/1.0",
            "name": "isML1Visible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "ML1",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isML2Visible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "ML2",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "0b94fcd8-d50f-4d94-a6d0-978630b1a05c"
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isML3Visible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "ML3",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "2be58e88-24c5-400f-bc22-eed894c25a81"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "customWidth": "5",
      "name": "Hidden Parameters Selectors for ML"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Assessment\r\n---\r\nThe Assessment section provides a mechanism to find, fix, and resolve CMMC recommendations. A selector provides capability to filter by all, specific, or groups of CMMC control ids. Upon selection, subordinate panels will summarize CMMC recommendations by control family, status over time, recommendations, and resources identified. These panels are helpful for identifying the CMMC control areas of interest, status over time, and which resources are most impacted by these vulnerabilties. The CMMC Recommendation details provides a mechanism to identify specific recommendation details with deep-links to pivot to Azure Security Center: Regulatory Compliance for remediation. "
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "99a47f97-1aa4-4840-91ee-119aad6d6217",
                        "version": "KqlParameterItem/1.0",
                        "name": "ControlNumber",
                        "label": "Control ID",
                        "type": 2,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "let CMMCPolicyMapping = externaldata(RecommendationDisplayName:string,ControlFamily:string,ControlNumber:string,MaturityLevel:string) [@\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/Feeds/CMMCPolicyMapping.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\r\n  SecurityRecommendation\r\n    | join kind=rightouter CMMCPolicyMapping on RecommendationDisplayName\r\n| summarize count() by ControlNumber\r\n| sort by count_ desc\r\n| project ControlNumber\r\n",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "value": [
                          "CA.3.161",
                          "value::all"
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::all"
                          ],
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "defaultValue": "value::all",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 26"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "  let CMMCPolicyMapping = externaldata(RecommendationDisplayName:string,ControlFamily:string,ControlNumber:string,MaturityLevel:string) [@\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/Feeds/CMMCPolicyMapping.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\r\n  SecurityRecommendation\r\n    | join kind=rightouter CMMCPolicyMapping on RecommendationDisplayName\r\n| where RecommendationName <> \"\"\r\n| where RecommendationState <> \"Healthy\"\r\n| where ControlNumber in ({ControlNumber})\r\n| summarize count() by ControlFamily\r\n| sort by count_ desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Recommendations by Control Family",
                    "noDataMessage": "Confirm CMMC Level 3 SecurityRecommendation Logging is Enabled to this Workspace via ASC Continuous Export and/or Extend Time Thresholds for a Larger Data-Set.  ",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "ControlFamily",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "pending",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "2",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "coldHot"
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 3 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "  let CMMCPolicyMapping = externaldata(RecommendationDisplayName:string,ControlFamily:string,ControlNumber:string,MaturityLevel:string) [@\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/Feeds/CMMCPolicyMapping.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\r\n  SecurityRecommendation\r\n    | join kind=rightouter CMMCPolicyMapping on RecommendationDisplayName\r\n| where RecommendationName <> \"\"\r\n| where RecommendationState <> \"Healthy\"\r\n| where ControlNumber in ({ControlNumber})\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by ControlNumber\r\n| render timechart",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Recommendations over Time",
                    "noDataMessage": "Confirm CMMC Level 3 SecurityRecommendation Logging is Enabled to this Workspace via ASC Continuous Export and/or Extend Time Thresholds for a Larger Data-Set.  ",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "ControlNumber",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Persistence",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "greenRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 3",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId in ({ControlNumber})\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(RecommendationDisplayName)\r\n    | summarize count() by Recommendation\r\n    | sort by count_ desc\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Recommendations",
                    "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Recommendation",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Gear",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "coldHot"
                          }
                        },
                        {
                          "columnMatch": "RecommendationDisplayName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "State",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "ControlID",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "statusChangeDate",
                          "formatter": 6
                        },
                        {
                          "columnMatch": "firstEvaluationDate",
                          "formatter": 6
                        }
                      ],
                      "filter": true
                    },
                    "sortBy": [],
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "RecommendationName",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "count_",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId in ({ControlNumber})\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | summarize count() by ResourceID, ResourceType, ResourceGroup\r\n    | sort by count_ desc\r\n    | limit 250",
                    "size": 0,
                    "title": "Resource Details",
                    "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "ResourceType",
                          "formatter": 16,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "redBright"
                          }
                        },
                        {
                          "columnMatch": "RecommendationDisplayName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "State",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "ControlID",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Recommendation",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Recommendation >"
                          }
                        },
                        {
                          "columnMatch": "statusChangeDate",
                          "formatter": 6
                        },
                        {
                          "columnMatch": "firstEvaluationDate",
                          "formatter": 6
                        }
                      ],
                      "filter": true
                    },
                    "sortBy": [],
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "RecommendationName",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "count_",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 6"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId in ({ControlNumber})\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "CMMC Recommendation Details",
                    "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationDisplayName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "State",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "ControlID",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Recommendation",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Recommendation >"
                          }
                        },
                        {
                          "columnMatch": "statusChangeDate",
                          "formatter": 6
                        },
                        {
                          "columnMatch": "firstEvaluationDate",
                          "formatter": 6
                        }
                      ],
                      "filter": true,
                      "sortBy": [
                        {
                          "itemKey": "$gen_thresholds_Severity_4",
                          "sortOrder": 1
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "$gen_thresholds_Severity_4",
                        "sortOrder": 1
                      }
                    ],
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "RecommendationName",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "count_",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "100",
                  "name": "query - 4"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isAssessmentVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "group - 1"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isAssessmentVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Assessment",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## Getting Started\r\nThis workbook is designed to augment staffing through automation, artificial intelligence, machine learning, query/alerting generation, and visualizations. This workbook leverages Azure Policy, Azure Resource Graph, and Azure Log Analytics to align with Cybersecurity Maturity Model Certification control requirements. A filter set is available for custom reporting by guides, subscriptions, workspaces, time-filtering, control family, and maturity level. This offering telemetry from 50+ Microsoft Security products, while only Azure Sentinel/Azure Security Center are required to get started, each offering provides additional enrichment for aligning with control requirements. Each CMMC control includes a Control Card detailing an overiew of requirements, primary/secondary controls, deep-links to referenced product pages/portals, recommendations, implementation guides, compliance cross-walks and tooling telemetry for building situational awareness of cloud workloads. \r\n\r\nüí° [Deploy Azure CMMC Blueprint](https://docs.microsoft.com/azure/governance/blueprints/samples/cmmc-l3)<br>\r\nüí° [Onboard Azure Sentinel](https://docs.microsoft.com/azure/sentinel/quickstart-onboard)<br>\r\nüí° [Onboard Azure Security Center](https://docs.microsoft.com/azure/security-center/security-center-get-started)<br>\r\nüí° [Add the Azure Security Center: CMMC Assessment to Your Dashboard](https://docs.microsoft.com/azure/security-center/update-regulatory-compliance-packages#add-a-regulatory-standard-to-your-dashboard)<br>\r\nüí° [Continuously Export Security Center Data to Log Analytics Workspace](https://docs.microsoft.com/azure/security-center/continuous-export)<br>\r\nüí° [Extend Azure Sentinel Across Workspaces and Tenants](https://docs.microsoft.com/azure/sentinel/extend-sentinel-across-workspaces-tenants)<br>",
              "style": "info"
            },
            "name": "Help"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isGuideVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "group - 30",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Access Control \r\n---\r\nAccess Control is the process of authorizing users, groups, and computers to access objects on a network, asset, and/or cloud. Key concepts that make up access control are permissions, ownership of objects, inheritance of permissions, user rights, and object auditing. The¬†CMMC Access Control family¬†includes¬†31¬†controls¬†with¬†varying¬†application¬†across¬†the¬†Cloud¬†Service¬†Provider¬†(CSP)¬†model¬†including¬†customer¬†responsibility,¬†service¬†provider¬†responsibility,¬†and¬†shared¬†responsibility.¬†For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 1: Performed / Basic Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 1 requires that an organization performs specified practices. Because the organization may only be able to perform these practices in an ad-hoc manner and may or may not rely on documentation, process maturity is not assessed for Level 1."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 2"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "AC.1.001",
                        "linkTarget": "step",
                        "linkLabel": "AC.1.001   üí° Limit information system access to authorized users, processes acting on behalf of authorized users or devices (including other information systems).",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "AC.1.002",
                        "linkTarget": "step",
                        "linkLabel": "AC.1.002   üí° Limit information system access to the types of transactions and functions that authorized users are permitted to execute.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "AC.1.003",
                        "linkTarget": "step",
                        "linkLabel": "AC.1.003   üí° Verify and control/limit connections to and use of external information systems.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "AC.1.004",
                        "linkTarget": "step",
                        "linkLabel": "AC.1.004   üí° Control information posted or processed on publicly accessibleinformation systems.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML1 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.1.001",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Limit Information System Access to Authorized Users (ML-1)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#limit-information-system-access-to-authorized-users-processes-acting-on-behalf-of-authorized-users-and-devices-including-other-information-systems)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è[Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Customer Lockbox](https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview)   üîÄ[Customer Lockbox](https://portal.azure.com/#blade/Microsoft_Azure_Lockbox/LockboxMenu/Overview)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs \r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-2, AC-3, AC-17](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| summarize count() by UserPrincipalName, UserProfile\r\n| project UserPrincipalName, count_, UserProfile\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ AAD User Profiles",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to User Profile >"
                                }
                              },
                              {
                                "columnMatch": "UserRoles",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Roles >"
                                }
                              },
                              {
                                "columnMatch": "AdminRoles",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to AdminRoles >"
                                }
                              },
                              {
                                "columnMatch": "Groups",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Groups >"
                                }
                              },
                              {
                                "columnMatch": "Applications",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Apps >"
                                }
                              },
                              {
                                "columnMatch": "Licenses",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Licenses >"
                                }
                              },
                              {
                                "columnMatch": "Devices",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Devices >"
                                }
                              },
                              {
                                "columnMatch": "AzureRoles",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to AzureRoles >"
                                }
                              },
                              {
                                "columnMatch": "SignIns",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to SignIns >"
                                }
                              },
                              {
                                "columnMatch": "AuditLogs",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to AuditLogs >"
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "AzureActiveDirectoryProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to AAD Profile >"
                                }
                              },
                              {
                                "columnMatch": "IncidentCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "AlertCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "orange"
                                }
                              },
                              {
                                "columnMatch": "AnomalyCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "yellow"
                                }
                              }
                            ],
                            "rowLimit": 1000,
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 5"
                      }
                    ]
                  },
                  "name": "AC.1.001",
                  "styleSettings": {
                    "margin": "3",
                    "padding": "3",
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.1.002",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Limit Information System Access to the Types of Transactions and Functions that Authorized Users are Permitted to Execute (ML-1)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#limit-information-system-access-to-the-types-of-transactions-and-functions-that-authorized-users-are-permitted-to-execute)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-2, AC-3, AC-17](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AuditLogs\r\n| extend UserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize Runs = count(), Success = countif(Result == 'success'), Fails = countif(Result != 'success') by UserPrincipalName, OperationName, UserProfile // Summarize the total, successful and failed operations by name\r\n| extend SuccessRate = (Success * 100 / Runs) // Calculate the percentage of succesful operations against the total\r\n| summarize count() by UserPrincipalName, UserProfile, OperationName, Runs, SuccessRate, Fails\r\n| where UserPrincipalName <> \"\"\r\n| sort by Runs desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ User Actions",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "OperationName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Runs",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "SuccessRate",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "green"
                                }
                              },
                              {
                                "columnMatch": "Fails",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "red"
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "UserId",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "OfficeWorkload",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": []
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "AC.1.002",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.1.003",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Verify and control/limit connections to and use of external information systems (ML-1)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#verify-and-controllimit-connections-to-and-use-of-external-information-systems)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.20](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-20, AC-20(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where Location <> \"\"\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| extend latitude_ = tostring(parse_json(tostring(LocationDetails.geoCoordinates)).latitude)\r\n| extend longitude_ = tostring(parse_json(tostring(LocationDetails.geoCoordinates)).longitude)\r\n| extend City = tostring(LocationDetails.city)\r\n| summarize count() by UserPrincipalName, City, Location, UserProfile\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "title": "üü¶ User Sign-In Location Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "City",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Location",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where Location <> \"\"\r\n| extend latitude_ = tostring(parse_json(tostring(LocationDetails.geoCoordinates)).latitude)\r\n| extend longitude_ = tostring(parse_json(tostring(LocationDetails.geoCoordinates)).longitude)\r\n| extend city_ = tostring(LocationDetails.city)\r\n",
                          "size": 2,
                          "title": "üü¶ User Sign-Ins by Geolocation",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "map",
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 12,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot",
                              "heatmapMax": 100
                            },
                            "numberFormatSettings": {
                              "unit": 0,
                              "options": {
                                "style": "decimal",
                                "useGrouping": false
                              }
                            }
                          }
                        },
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "AC.1.003",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.1.004",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Control information posted or processed on publicly accessible information systems (ML-1)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.22](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-22](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| distinct UserId_s, LabelName_s, ApplicationName_s_s, Operation_s_s, Protected_b_s, Platform_s_s, Activity_s_s, ProtectionOwner_s, TimeGenerated_s\r\n| sort by TimeGenerated_s desc\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Azure Information Protection Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserId_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| extend Href_ = tostring(parse_json(ExtendedLinks)[0].Href)\r\n| extend UserPrincipalName = UPN\r\n| distinct UserPrincipalName, AlertName, ProductName, Status, AlertLink, Tactics, TimeGenerated\r\n| where AlertName contains \"sensitive\" or AlertName contains \"data\" or AlertName contains \"leak\" or Tactics contains \"exfil\" or AlertName contains \"theft\" or AlertName contains \"steal\" or AlertName contains \"PII\" or AlertName contains \"intellectual\" or AlertName contains \"confidential\" or AlertName contains \"spill\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                          "size": 0,
                          "title": "üü¶ Sensitive Data Leaks Alert Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-S",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "name": "AC.1.004",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 1: Performed / Basic Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "AC.2.005",
                        "linkTarget": "step",
                        "linkLabel": "AC.2.005 üí° Provide privacy and security notices consistent with applicable Controlled Unclassified Information (CUI) rules.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "AC.2.006",
                        "linkTarget": "step",
                        "linkLabel": "AC.2.006 üí° Limit use of portable storage devices on external systems. ",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "AC.2.007",
                        "linkTarget": "step",
                        "linkLabel": " AC.2.007 üí° Employ the principle of least privilege, including for specific security functions and privileged accounts. ",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "AC.2.008",
                        "linkTarget": "step",
                        "linkLabel": "AC.2.008 üí° Use non-privileged accounts or roles when accessing nonsecurity functions.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "4d1f48b7-288c-45e0-a5ae-c97f985f70df",
                        "cellValue": "AC.2.009",
                        "linkTarget": "step",
                        "linkLabel": "AC.2.009 üí° Limit unsuccessful logon attempts.",
                        "preText": "Go to > ",
                        "style": "link"
                      },
                      {
                        "id": "0e930a4d-5f98-482e-8f40-1a6d7fe76624",
                        "cellValue": "AC.2.010",
                        "linkTarget": "step",
                        "linkLabel": "AC.2.010 üí° Use session lock with pattern-hiding displays to prevent access and viewing of data after a period of inactivity.",
                        "preText": "Go to >",
                        "style": "link"
                      },
                      {
                        "id": "6b993013-ec61-4240-9ff3-9b40202600a5",
                        "cellValue": "AC.2.011",
                        "linkTarget": "step",
                        "linkLabel": "AC.2.011 üí° Authorize wireless access prior to allowing such connections.",
                        "preText": "Go to > ",
                        "style": "link"
                      },
                      {
                        "id": "746b1e32-83d7-43f1-a5d0-736dc395da72",
                        "cellValue": "AC.2.013",
                        "linkTarget": "step",
                        "linkLabel": "AC.2.013 üí° Monitor and control remote access sessions. ",
                        "preText": "Go to >",
                        "style": "link"
                      },
                      {
                        "id": "63abaa8d-ff61-466d-a7b2-831c762f815f",
                        "cellValue": "AC.2.015",
                        "linkTarget": "step",
                        "linkLabel": "AC.2.015 üí° Route remote access via managed access control points.",
                        "preText": "Go to >",
                        "style": "link"
                      },
                      {
                        "id": "821f90c8-c8b9-4e44-8c36-6ef941067414",
                        "cellValue": "AC.2.016",
                        "linkTarget": "step",
                        "linkLabel": "AC.2.016 üí° Control the flow of CUI in accordance with approved authorizations.",
                        "preText": "Go to > ",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.2.005",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Provide privacy and security notices consistent with applicable Controlled Unclassified Information (CUI) rules (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Recommended Configuration\r\nüí° [Add Terms of Use](https://docs.microsoft.com/azure/active-directory/conditional-access/terms-of-use#add-terms-of-use)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.9](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-8](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "//Configure Azure Active Direcotry Terms of Use: https://docs.microsoft.com/azure/active-directory/conditional-access/terms-of-use#add-terms-of-use\r\nlet nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n|extend CAStatus = case(ConditionalAccessStatus == \"failure\", \"Failed\",                                     \r\n                    ConditionalAccessStatus == \"notApplied\", \"Not applied\",                                     \r\n                    isempty(ConditionalAccessStatus), \"Not applied\", \r\n                    \"Disabled\")\r\n|mvexpand ConditionalAccessPolicies\r\n|extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0])\r\n|extend CAGrantControl = case(CAGrantControlName contains \"Terms of Use\", \"Require Terms of Use\", \r\n                            CAGrantControlName contains \"Privacy\", \"Require Privacy Statement\",\r\n                            \"Other\");\r\ndata\r\n| where CAGrantControlName <> \"\"\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize count() by UserPrincipalName, UserProfile, AppDisplayName, CAGrantControlName, ConditionalAccessStatus\r\n| where CAGrantControlName contains \"Privacy\" or CAGrantControlName contains \"Term\"\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ User Terms of Use and/or Privacy Statements (Not Applied) to Sign-In",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "ConditionalAccessStatus",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "name": "AC.2.005",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.2.006",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Limit use of portable storage devices on external systems (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Named Locations](https://docs.microsoft.com/azure/active-directory/conditional-access/location-condition)   üîÄ[Azure AD Named Locations](https://portal.azure.com/#blade/Microsoft_AAD_IAM/NamedNetworksWithCountryBlade)<br>\r\n\r\n## Recommended Configuration\r\nüí° [How to Control USB Devices and Other Removable Media Using Microsoft Intune](https://docs.microsoft.com/windows/security/threat-protection/device-control/control-usb-devices-using-intune)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.21](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-20(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "DeviceEvents\r\n| where InitiatingProcessFolderPath <> \"\" \r\n| where InitiatingProcessFolderPath !contains \"c:\" or ActionType contains \"usb\"\r\n| summarize count() by DeviceName, ActionType, AccountName, InitiatingProcessFolderPath\r\n| sort by count_ desc\r\n| limit 250\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Monitor Portable Storage Devices",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "DeviceName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AccountName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "yellow"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "AC.2.006",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.2.007",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Employ the principle of least privilege, including for specific security functions and privileged accounts (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#employ-the-principle-of-least-privilege-including-for-specific-security-functions-and-privileged-accounts)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-6, AC-6(1), AC-6(5)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AuditLogs\r\n| where Identity == \"MS-PIM\"\r\n| extend GrantedTo = tostring(TargetResources[0].userPrincipalName)\r\n| extend GrantedByApp = tostring(parse_json(tostring(InitiatedBy.app)).displayName)\r\n| where GrantedTo <> \"\"\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",GrantedTo)\r\n| summarize count() by GrantedTo, UserProfile, GrantedByApp, SourceSystem, OperationName\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Privileged Identity Management (PIM) Actions",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "GrantedTo",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD Profile >"
                                }
                              },
                              {
                                "columnMatch": "OperationName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "pending",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "AC.2.007",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.2.008",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Use non-privileged accounts or roles when accessing non-security functions (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#use-non-privileged-accounts-or-roles-when-accessing-nonsecurity-functions)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-6(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let Policymap = datatable(RecommendationName:string, ControlFamily:string, ControlNumber: string, MaturityLevel:string, 800171Map:string, 80053Map:string)\r\n[\r\n\"Windows machines should meet requirements for 'Security Options - User Account Control'\",\t\"Access Control\",\t\"AC.2.008\",\t\"ML-2\",\t\"3.1.6\",\t\"AC-6(2)\",\r\n\"Windows machines should meet requirements for 'User Rights Assignment'\",\t\"Access Control\",\t\"AC.2.008\",\t\"ML-2\",\t\"3.1.6\",\t\"AC-6(2)\",\r\n];\r\nSecurityRecommendation\r\n| join kind=rightouter Policymap on RecommendationName\r\n| where RecommendationName <> \"\"\r\n| where ControlNumber == \"AC.2.008\"\r\n| summarize count() by ControlNumber, RecommendationName, RecommendationState\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Azure Security Center Recommendations for AC.2.008",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "AC.2.008",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.2.009",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Limit unsuccessful logon attempts (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Password Protection for Azure AD](https://docs.microsoft.com/azure/active-directory/authentication/howto-password-ban-bad-on-premises-deploy)   üîÄ[Azure AD Password Protection](https://portal.azure.com/#blade/Microsoft_AAD_IAM/PasswordProtectionBlade)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.8](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-7](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let¬†data¬†=¬†SigninLogs\r\n|where¬†AppDisplayName¬†in¬†('*')¬†or¬†'*'¬†in¬†('*')\r\n|where¬†UserDisplayName¬†in¬†('*')¬†or¬†'*'¬†in¬†('*')\r\n|extend¬†errorCode¬†=¬†Status.errorCode\r\n|extend¬†SigninStatus¬†=¬†case(errorCode¬†==¬†0,¬†\"Success\",¬†errorCode¬†==¬†50058,¬†\"Pending¬†user¬†action\",errorCode¬†==¬†50140,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†51006,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50059,¬†\"Pending¬†user¬†action\",errorCode¬†==¬†65001,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†52004,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50055,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50144,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50072,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50074,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†16000,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†16001,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†16003,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50127,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50125,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50129,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†50143,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†81010,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†81014,¬†\"Pending¬†user¬†action\",¬†errorCode¬†==¬†81012¬†,\"Pending¬†user¬†action\",¬†\"Failure\");\r\ndata\r\n|¬†summarize¬†Count¬†=¬†count()¬†by¬†SigninStatus\r\n|¬†join¬†kind¬†=¬†fullouter¬†(datatable(SigninStatus:string)['Success',¬†'Pending¬†action¬†(Interrupts)',¬†'Failure'])¬†on¬†SigninStatus\r\n|¬†project¬†SigninStatus¬†=¬†iff(SigninStatus¬†==¬†'',¬†SigninStatus1,¬†SigninStatus),¬†Count¬†=¬†iff(SigninStatus¬†==¬†'',¬†0,¬†Count)\r\n|¬†join¬†kind¬†=¬†inner¬†(data\r\n|¬†make-series¬†Trend¬†=¬†count()¬†default¬†=¬†0¬†on¬†TimeGenerated¬†from¬†ago(14d)¬†to¬†now()¬†step¬†6h¬†by¬†SigninStatus)\r\n¬†¬†¬†¬†on¬†SigninStatus\r\n|¬†project-away¬†SigninStatus1,¬†TimeGenerated\r\n|¬†extend¬†Status¬†=¬†SigninStatus\r\n|¬†union¬†(\r\n¬†¬†¬†¬†data¬†\r\n|¬†summarize¬†Count¬†=¬†count()¬†\r\n|¬†extend¬†jkey¬†=¬†1\r\n|¬†join¬†kind=inner¬†(data\r\n|¬†make-series¬†Trend¬†=¬†count()¬†default¬†=¬†0¬†on¬†TimeGenerated¬†from¬†ago(14d)¬†to¬†now()¬†step¬†6h\r\n|¬†extend¬†jkey¬†=¬†1)¬†on¬†jkey\r\n|¬†extend¬†SigninStatus¬†=¬†'All¬†Sign-ins',¬†Status¬†=¬†'*'¬†¬†¬†¬†\r\n)\r\n|¬†order¬†by¬†Count¬†desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Login Status Codes by Count",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| extend Alert_Link = tostring(parse_json(ExtendedLinks)[1].Href)\r\n| extend UserPrincipalName = UPN\r\n| distinct Name, AlertName, ProductName, Status, Alert_Link, Tactics, TimeGenerated\r\n| where AlertName contains \"brute\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Sign-In: Brute Force Alerts",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Name",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Alert_Link",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To Alert >"
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "name": "AC.2.009",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.2.010",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Use session lock with pattern-hiding displays to prevent access and viewing of data after a period of inactivity (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Recommended Configuration\r\nüí° [Configure screen lock settings using Intune](https://docs.microsoft.com/mem/intune/configuration/device-restrictions-windows-10#locked-screen-experience)<br>\r\nüí° [Grant access to resources if devices are marked as compliant](https://docs.microsoft.com/azure/active-directory/conditional-access/require-managed-devices#require-device-to-be-marked-as-compliant)<br>\r\nüí° [Conceal Passwords with Password Box](https://docs.microsoft.com/windows/uwp/design/controls-and-patterns/password-box)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.10](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-11, AC-11(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where DeviceDetail.isCompliant <> \"true\"\r\n| where DeviceDetail.isManaged == \"true\"\r\n| extend isCompliant = tostring(DeviceDetail.isCompliant)\r\n| extend isManaged = tostring(DeviceDetail.isManaged)\r\n| extend deviceId = tostring(DeviceDetail.deviceId)\r\n| extend trustType = tostring(DeviceDetail.trustType)\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize count() by UserPrincipalName, UserProfile, isCompliant, isManaged, deviceId, trustType\r\n| sort by count_ desc\r\n\r\n\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Configure Screen Lock and Monitor Managed Device Compliance",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "ConditionalAccessStatus",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "name": "AC.2.010",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.2.011",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Authorize wireless access prior to allowing such connections (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Recommended Configuration\r\nüí° [Network Access Control (NAC)](https://docs.microsoft.com/mem/intune/protect/network-access-control-integrate)<br>\r\nüí° [Grant access to resources if devices are marked as compliant](https://docs.microsoft.com/azure/active-directory/conditional-access/)<br>\r\nüí° [Conditional Access with Intune](https://docs.microsoft.com/mem/intune/protect/conditional-access-intune-common-ways-use)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.16](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-18](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where DeviceDetail.isCompliant <> \"true\"\r\n| where DeviceDetail.isManaged == \"true\"\r\n| extend isCompliant = tostring(DeviceDetail.isCompliant)\r\n| extend isManaged = tostring(DeviceDetail.isManaged)\r\n| extend deviceId = tostring(DeviceDetail.deviceId)\r\n| extend trustType = tostring(DeviceDetail.trustType)\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize count() by UserPrincipalName, UserProfile, isCompliant, isManaged, deviceId, trustType\r\n| sort by count_ desc\r\n\r\n\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Configure Network Access Control and Monitor Managed Device Compliance",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "ConditionalAccessStatus",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "name": "AC.2.011",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.2.013",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Monitor and control remote access sessions (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#monitor-and-control-remote-access-sessions)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   üîÄ[Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)<br>\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/)   üîÄ[ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.12](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-17(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where Location <> \"\"\r\n| extend latitude_ = tostring(parse_json(tostring(LocationDetails.geoCoordinates)).latitude)\r\n| extend longitude_ = tostring(parse_json(tostring(LocationDetails.geoCoordinates)).longitude)\r\n| extend city_ = tostring(LocationDetails.city)\r\n",
                          "size": 3,
                          "showAnalytics": true,
                          "title": "üü¶ User Sign-Ins by Geolocation",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "map",
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 10,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            },
                            "numberFormatSettings": {
                              "unit": 0,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "AC.2.013",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.2.015",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Route remote access via managed access control points (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#route-remote-access-via-managed-access-control-points)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)   üîÄ[Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/)   üîÄ[ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits)<br>\r\n‚ú≥Ô∏è [Named Locations](https://docs.microsoft.com/azure/active-directory/conditional-access/location-condition)   üîÄ[Azure AD Named Locations](https://portal.azure.com/#blade/Microsoft_AAD_IAM/NamedNetworksWithCountryBlade)<br>\r\n‚ú≥Ô∏è [Azure Front Door](https://azure.microsoft.com/services/frontdoor/)   üîÄ[Front Doors](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/frontdoors)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\n\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.14](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-17(3)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "where type contains \"network\" \r\n| project id,type,resourceGroup\r\n| order by type asc\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Network Assets",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Rule",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "yellowOrangeRed"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "AC.2.015",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.2.016",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Control the flow of CUI in accordance with approved authorizations (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#control-the-flow-of-cui-in-accordance-with-approved-authorizations)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Microsoft Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Microsoft 365 Compliance Manager](https://compliance.microsoft.com/informationprotection)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-4](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| distinct UserId_s, LabelName_s, ApplicationName_s_s, Operation_s_s, Protected_b_s, Platform_s_s, Activity_s_s, ProtectionOwner_s, TimeGenerated_s\r\n| sort by TimeGenerated_s desc\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Azure Information Protection Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserId_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "name": "AC.2.016",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "AC.3.012",
                        "linkTarget": "step",
                        "linkLabel": "AC.3.012 üí° Protect wireless access using authentication and encryption.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "29c35aee-4e8d-4777-805c-3a25626dd469",
                        "cellValue": "AC.3.014",
                        "linkTarget": "step",
                        "linkLabel": "AC.3.014 üí° Employ cryptographic mechanisms to protect the confidentiality of remote access sessions.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "AC.3.017",
                        "linkTarget": "step",
                        "linkLabel": "AC.3.017 üí° \tSeparate the duties of individuals to reduce the risk of malevolent activity without collusion.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "AC.3.018",
                        "linkTarget": "step",
                        "linkLabel": "AC.3.018 üí° Prevent non-privileged users from executing privileged functions and capture the execution of such functions in audit logs.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "AC.3.019",
                        "linkTarget": "step",
                        "linkLabel": "AC.3.019 üí° Terminate (automatically) user sessions after a defined condition.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "544f4fb1-a771-43d8-84f0-d94a7c95345a",
                        "cellValue": "AC.3.020",
                        "linkTarget": "step",
                        "linkLabel": "AC.3.020 üí° Control connection of mobile devices.",
                        "preText": "Go to >",
                        "style": "link"
                      },
                      {
                        "id": "d409dea3-f3fa-4d09-98ab-9c9d97af7ff4",
                        "cellValue": "AC.3.021",
                        "linkTarget": "step",
                        "linkLabel": "AC.3.021 üí° Authorize remote execution of privileged commands and remote access to security-relevant information.",
                        "preText": "Go to > ",
                        "style": "link"
                      },
                      {
                        "id": "92cd8b3d-da91-4978-9238-a4f1fea67616",
                        "cellValue": "AC.3.022",
                        "linkTarget": "step",
                        "linkLabel": "AC.3.022 üí° Encrypt CUI on mobile devices and mobile computing platforms.",
                        "preText": "Go to > ",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.3.012",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Protect wireless access using authentication and encryption (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Recommended Configuration\r\nüí° [Use a Custom Device Profile to Create a WiFi Profile with a Pre-Shared Key in Intune](https://docs.microsoft.com/mem/intune/configuration/wi-fi-profile-shared-key)<br>\r\nüí° [Using NAC with Conditional Access & Intune](https://docs.microsoft.com/mem/intune/protect/conditional-access-intune-common-ways-use)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.17](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)    \r\n## NIST SP 800-53 R4 Mapping\r\n[AC-18(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where DeviceDetail.isCompliant <> \"true\"\r\n| where DeviceDetail.isManaged == \"true\"\r\n| extend isCompliant = tostring(DeviceDetail.isCompliant)\r\n| extend isManaged = tostring(DeviceDetail.isManaged)\r\n| extend deviceId = tostring(DeviceDetail.deviceId)\r\n| extend trustType = tostring(DeviceDetail.trustType)\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize count() by UserPrincipalName, UserProfile, isCompliant, isManaged, deviceId, trustType\r\n| sort by count_ desc\r\n\r\n\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Configure Network Access Control and Monitor Managed Device Compliance",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "ConditionalAccessStatus",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "name": "AC.3.012",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.3.014",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Employ cryptographic mechanisms to protect the confidentiality of remote access sessions (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Multi-Factor Authentication](https://azure.microsoft.com/services/active-directory/)    üîÄ[Multi-Factor Authentication](https://portal.azure.com/#blade/Microsoft_AAD_IAM/MultifactorAuthenticationMenuBlade/GettingStarted)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.13](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-17(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"Azure Security Benchmark\"\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId == \"Azure Security Benchmark\"\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"DP.2\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Azure Security Benchmark Recommendations: Data Protection Recommendations",
                          "noDataMessage": "No Current ASB Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": []
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "AC.3.014",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.3.017",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Separate the duties of individuals to reduce the risk of malevolent activity without collusion (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#separate-the-duties-of-individuals-to-reduce-the-risk-of-malevolent-activity-without-collusion)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let Policymap = datatable(RecommendationName:string, ControlFamily:string, ControlNumber: string, MaturityLevel:string, 800171Map:string, 80053Map:string)\r\n[\r\n\"Audit Windows machines missing any of specified members in the Administrators group\",\t\"Access Control\",\t\"AC.3.017\",\t\"ML-3\",\t\"3.1.4\",\t\"AC-5\",\r\n\"Audit Windows machines that have the specified members in the Administrators group\",\t\"Access Control\",\t\"AC.3.017\",\t\"ML-3\",\t\"3.1.4\",\t\"AC-5\",\r\n\"A maximum of 3 owners should be designated for your subscription\",\t\"Access Control\",\t\"AC.3.017\",\t\"ML-3\",\t\"3.1.4\",\t\"AC-5\",\r\n\"There should be more than one owner assigned to your subscription\",\t\"Access Control\",\t\"AC.3.017\",\t\"ML-3\",\t\"3.1.4\",\t\"AC-5\"\r\n];\r\nSecurityRecommendation\r\n| join kind=rightouter Policymap on RecommendationName\r\n| where RecommendationName <> \"\"\r\n| where ControlNumber == \"AC.3.017\"\r\n| summarize count() by ControlNumber, RecommendationName, RecommendationState\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Azure Security Center Recommendations for AC.3.017",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "AC.3.017",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.3.018",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Prevent non-privileged users from executing privileged functions and capture the execution of such functions in audit logs (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#prevent-non-privileged-users-from-executing-privileged-functions-and-capture-the-execution-of-such-functions-in-audit-logs)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.7](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-6(9), AC-6(10)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let Policymap = datatable(RecommendationName:string, ControlFamily:string, ControlNumber: string, MaturityLevel:string, 800171Map:string, 80053Map:string)\r\n[\r\n\"Windows machines should meet requirements for 'System Audit Policies - Privilege Use'\",\t\"Access Control\",\t\"AC.3.018\",\t\"ML-3\",\t\"3.1.7\",\t\"AC-6(9), AC-6(10)\",\r\n\"An activity log alert should exist for Delete SQL Server Firewall Rule\",\t\"Access Control\",\t\"AC.3.018\",\t\"ML-3\",\t\"3.1.7\",\t\"AC-6(9), AC-6(10)\",\r\n\"An activity log alert should exist for the Delete Network Security Group Rule\",\t\"Access Control\",\t\"AC.3.018\",\t\"ML-3\",\t\"3.1.7\",\t\"AC-6(9), AC-6(10)\",\r\n\"An activity log alert should exist for Delete Network Security Solution\",\t\"Access Control\",\t\"AC.3.018\",\t\"ML-3\",\t\"3.1.7\",\t\"AC-6(9), AC-6(10)\",\r\n\"An activity log alert should exist for the Delete Classic Network Security Group Rule\",\t\"Access Control\",\t\"AC.3.018\",\t\"ML-3\",\t\"3.1.7\",\t\"AC-6(9), AC-6(10)\"\r\n];\r\nSecurityRecommendation\r\n| join kind=rightouter Policymap on RecommendationName\r\n| where RecommendationName <> \"\"\r\n| where ControlNumber == \"AC.3.018\"\r\n| summarize count() by ControlNumber, RecommendationName, RecommendationState\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Azure Security Center Recommendations for AC.3.018",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "AC.3.018",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.3.019",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Terminate (automatically) user sessions after a defined condition (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Application Gateway](https://azure.microsoft.com/services/application-gateway/)   üîÄ [Application Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks) <br>\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AADUserRiskEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/aaduserriskevents) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.11](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-12](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AADUserRiskEvents\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| extend countryOrRegion_ = tostring(Location.countryOrRegion)\r\n| extend city_ = tostring(Location.city)\r\n| extend state_ = tostring(Location.state)\r\n| extend latitude_ = tostring(parse_json(tostring(Location.geoCoordinates)).latitude)\r\n| extend longitude_ = tostring(parse_json(tostring(Location.geoCoordinates)).longitude)\r\n| summarize count() by UserPrincipalName, UserProfile, RiskLevel, RiskEventType, city_, countryOrRegion_, state_, latitude_, longitude_, IpAddress\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 3,
                          "showAnalytics": true,
                          "title": "üü¶ AAD Identity Protection: Sign-in Risk by Geolocation",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "map",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UncommonActionVolume",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "UncommonAction",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "green"
                                }
                              },
                              {
                                "columnMatch": "FirstTimeUserAction",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "FirstTimeDeviceLogon",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "yellow"
                                }
                              },
                              {
                                "columnMatch": "IncidentCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "AlertCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "orange"
                                }
                              },
                              {
                                "columnMatch": "AnomalyCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "yellow"
                                }
                              }
                            ]
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "countryOrRegion_",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "countryOrRegion_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "countryOrRegion_",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "countryOrRegion_",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "redBright"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AADUserRiskEvents\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| extend countryOrRegion_ = tostring(Location.countryOrRegion)\r\n| extend city_ = tostring(Location.city)\r\n| extend state_ = tostring(Location.state)\r\n| extend latitude_ = tostring(parse_json(tostring(Location.geoCoordinates)).latitude)\r\n| extend longitude_ = tostring(parse_json(tostring(Location.geoCoordinates)).longitude)\r\n| summarize count() by UserPrincipalName, UserProfile, RiskLevel, RiskEventType, city_, countryOrRegion_, state_, latitude_, longitude_, IpAddress\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ AAD Identity Protection: User Sign-in Risk Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "RiskLevel",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "high",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "countryOrRegion_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "purpleDark"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "name": "query - 14"
                      }
                    ]
                  },
                  "name": "AC.3.019",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.3.020",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Control connection of mobile devices (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.18](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-19](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| extend OperatingSystem = tostring(DeviceDetail.operatingSystem)\r\n| extend Browser = tostring(DeviceDetail.browser)\r\n| where OperatingSystem contains \"Android\" or OperatingSystem contains \"iOS\"\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize count() by UserPrincipalName, UserProfile, OperatingSystem, Browser, AppDisplayName, IPAddress, Location\r\n| sort by count_ desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Mobile Device Access",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile > "
                                }
                              },
                              {
                                "columnMatch": "Location",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "AC.3.020",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.3.021",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Authorize remote execution of privileged commands and remote access to security-relevant information (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#authorize-remote-execution-of-privileged-commands-and-remote-access-to-security-relevant-information)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Named Locations](https://docs.microsoft.com/azure/active-directory/conditional-access/location-condition)   üîÄ[Azure AD Named Locations](https://portal.azure.com/#blade/Microsoft_AAD_IAM/NamedNetworksWithCountryBlade)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [IdentityInfo](https://docs.microsoft.com/azure/azure-monitor/reference/tables/identityinfo)üî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.15](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-17(4)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "IdentityInfo\r\n| extend Roles = strcat(AssignedRoles)\r\n| extend Groups = strcat(GroupMembership)\r\n| where Roles contains \"security\" or Groups contains \"security\" or Roles contains \"admin\" or Groups contains \"admin\"\r\n| extend UserPrincipalName = MailAddress\r\n| join (SigninLogs) on UserPrincipalName\r\n// where Location <> \"US\" // Exempt Non Remote Locations\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| distinct UserPrincipalName, UserProfile, Roles, Groups, UserType, Location, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Security/Admin Users by Location",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile > "
                                }
                              },
                              {
                                "columnMatch": "Location",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "AC.3.021",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AC.3.022",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Encrypt CUI on mobile devices and mobile computing platforms (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Recommended Configurations\r\nüí° [How to Create and Assign App Protection Policies](https://docs.microsoft.com/mem/intune/apps/app-protection-policies)<br>\r\nüí° [App Protection Policies Overview](https://docs.microsoft.com/mem/intune/apps/app-protection-policy)<br> \r\nüí° [Microsoft Intune Protected Apps](https://docs.microsoft.com/mem/intune/apps/apps-supported-intune-apps)<br> \r\nüí° [Data Protection Framework Using App Protection Policies](https://docs.microsoft.com/mem/intune/apps/app-protection-framework)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.1.19](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-19(5)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "//Configure Azure Active Direcotry Terms of Use: https://docs.microsoft.com/azure/active-directory/conditional-access/terms-of-use#add-terms-of-use\r\nlet nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n|extend CAStatus = case(ConditionalAccessStatus == \"failure\", \"Failed\",                                     \r\n                    ConditionalAccessStatus == \"notApplied\", \"Not applied\",                                     \r\n                    isempty(ConditionalAccessStatus), \"Not applied\", \r\n                    \"Disabled\")\r\n|mvexpand ConditionalAccessPolicies\r\n| extend Conditional_AccessPolicies = strcat(ConditionalAccessPolicies.displayName)\r\n|extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0]);\r\ndata\r\n| where CAGrantControlName <> \"\"\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserPrincipalName)\r\n| summarize count() by UserPrincipalName, UserProfile, AppDisplayName, Conditional_AccessPolicies, ConditionalAccessStatus\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Configure App Protection Policy and Monitor Conditional Access Policies",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "ConditionalAccessStatus",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "name": "AC.3.022",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isACVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Access Control Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Asset Management\r\n---\r\nAsset Management is an engineering process to establish and maintain consisentency in information technology resources. The Asset Management Control family inlcudes include 7 controls with varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibility.¬†For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "AM.3.036",
                        "linkTarget": "step",
                        "linkLabel": "AM.3.036 üí° Define procedures for the handling of CUI data.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AM.3.036",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Define procedures for the handling of CUI data (ML-3)\r\n\r\n ## Secondary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)<br>\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\n## Recommended Resources\r\n üí° [How to configure the policy settings for Azure Information Protection](https://docs.microsoft.com/azure/information-protection/configure-policy-settings)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-2, MP-4, MP-5, MP-6, MP-7, PE-16, PE-18, PE- 20, SC-8, SC-28 ](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| where LabelName_s <> \"\"\r\n| summarize count() by LabelName_s\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Label/Control Sensitive Data with Azure Information Protection",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "UserId_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "name": "AM.3.036",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isAMVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Asset Management",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Audit & Accountability\r\n---\r\nAudit & Accountability involves the evaluation of configurable security and logging options to help identify gaps in security policies and mechanisms. \r\nThe¬†Audit Accountability¬†Control¬†family¬†includes¬†19¬†controls¬†with¬†varying¬†application¬†across¬†the¬†Cloud¬†Service¬†Provider¬†(CSP)¬†model¬†including¬†customer¬†responsibility,¬†service¬†provider¬†responsibility,¬†and¬†shared¬†responsibility.¬†For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "AU.2.041",
                        "linkTarget": "step",
                        "linkLabel": "AU.2.041 üí° Ensure that the actions of individual system users can be uniquely traced to those users so they can be held accountable for their actions.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "AU.2.042",
                        "linkTarget": "step",
                        "linkLabel": "AU.2.042 üí° Create and retain system audit logs and records to the extent needed to enable the monitoring, analysis, investigation and reporting of unlawful or unauthorized system activity.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "AU.2.043",
                        "linkTarget": "step",
                        "linkLabel": " AU.2.043 üí° Provide a system capability that compares and synchronizes internal system clocks with an authoritative source to generate time stamps for audit records.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "AU.2.044",
                        "linkTarget": "step",
                        "linkLabel": "AU.2.044 üí° Review audit logs.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AU.2.041",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Ensure that the actions of individual system users can be uniquely traced to those users so they can be held accountable for their actions (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#ensure-that-the-actions-of-individual-system-users-can-be-uniquely-traced-to-those-users-so-they-can-be-held-accountable-for-their-actions)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-2, AU-3, AU-3(1), AU-6, AU-11, AU-12](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AzureActivity\r\n| where Caller <> \"\"\r\n| extend UserPrincipalName = Caller\r\n| join (SigninLogs) on UserPrincipalName\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| summarize count() by UserPrincipalName, UserProfile\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Azure User Activity by Action Count",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "AU.2.041",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AU.2.042",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Create and retain system audit logs and records to the extent needed to enable the monitoring, analysis, investigation, and reporting of unlawful or unauthorized system activity (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#create-and-retain-system-audit-logs-and-records-to-the-extent-needed-to-enable-the-monitoring-analysis-investigation-and-reporting-of-unlawful-or-unauthorized-system-activity)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   üîÄ[Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)<br>\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Datatable](https://docs.microsoft.com/azure/data-explorer/kusto/query/datatableoperator?pivots=azuremonitor) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-2, AU-3, AU-3(1), AU-6, AU-11, AU-12](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "union withsource=_TableName *\r\n| summarize Entries = count(), Size = sum(_BilledSize), last_log = datetime_diff(\"second\",now(), max(TimeGenerated)), estimate  = sumif(_BilledSize, _IsBillable==true)  by _TableName, _IsBillable\r\n| project ['Table Name'] = _TableName, ['Table Size'] = Size, ['Table Entries'] = Entries,\r\n          ['Size per Entry'] = 1.0 * Size / Entries, ['IsBillable'] = _IsBillable\r\n| order by ['Table Size']  desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Log Table Management",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Table Name",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Table Size",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "purple"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false
                                  }
                                }
                              },
                              {
                                "columnMatch": "Table Entries",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "turquoise"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false
                                  }
                                }
                              },
                              {
                                "columnMatch": "Size per Entry",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                },
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false
                                  }
                                }
                              },
                              {
                                "columnMatch": "IsBillable",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "True",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "False",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Important",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true,
                            "sortBy": [
                              {
                                "itemKey": "$gen_thresholds_IsBillable_4",
                                "sortOrder": 2
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_thresholds_IsBillable_4",
                              "sortOrder": 2
                            }
                          ],
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "DataType",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3 - Copy - Copy",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "AU.2.042",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AU.2.043",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Provide a system capability that compares and synchronizes internal system clocks with an authoritative source to generate time stamps for audit records (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Recommended Configurations\r\nüí° [Time sync for Windows VMs in Azure](https://docs.microsoft.com/azure/virtual-machines/windows/time-sync)\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityBaseline](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securitybaseline) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.7](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-8, AU-8(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityBaseline\r\n| where Description == \"Ensure \\'Enable Windows NTP Client\\' is set to \\'Enabled\\'\" or Description == \"Ensure \\'Enable Windows NTP Client\\' is set to \\'Disabled\\'\"\r\n| summarize count() by ResourceId, Description, AnalyzeResult\r\n| sort by count_ desc\r\n| limit 250\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Security Baseline for NTP Client Failures",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AnalyzeResult",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Passed",
                                      "representation": "error",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Caller",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "DataType"
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "AU.2.043",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AU.2.044",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Review audit logs (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[N/A](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-6](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let data = AuditLogs\r\n| extend UserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)\r\n    | where \"All\" == \"All\" or Result in ('All')\r\n    | extend initiator = iif (tostring(InitiatedBy.user.userPrincipalName) != \"\", tostring(InitiatedBy.user.userPrincipalName), \"unknown\")\r\n    | where \"All\" == \"All\" or initiator in ('All')\r\n    | where \"All\" == \"All\" or Category in ('All')\r\n    | where Category == 'All' or 'All' == \"All\";\r\nlet appData = data\r\n    | summarize TotalCount = count() by OperationName, Category\r\n    | join kind=inner (data\r\n        | make-series Trend = count() default = 0 on TimeGenerated in range(ago(7d), now(), 3h) by OperationName\r\n        | project-away TimeGenerated)\r\n        on OperationName\r\n    | order by TotalCount desc, OperationName asc\r\n    | project OperationName, TotalCount, Trend, Category\r\n    | serialize Id = row_number();\r\ndata\r\n| summarize TotalCount = count() by initiator = iif (tostring(InitiatedBy.user.userPrincipalName) != \"\", tostring(InitiatedBy.user.userPrincipalName), \"unknown\"), Category, OperationName\r\n| join kind=inner (data\r\n    | make-series Trend = count() default = 0 on TimeGenerated in range(ago(7d), now(), 3h) by OperationName, initiator = iif (tostring(InitiatedBy.user.userPrincipalName) != \"\", tostring(InitiatedBy.user.userPrincipalName), \"unknown\")\r\n    | project-away TimeGenerated)\r\n    on OperationName, initiator\r\n| order by TotalCount desc, OperationName asc\r\n| project OperationName, initiator, TotalCount, Category, Trend\r\n| serialize Id = row_number(1000000)\r\n| join kind=inner (appData) on OperationName\r\n| project Id, Name = initiator, Type = 'initiator', ['Operations Count'] = TotalCount, Trend, Category, ParentId = Id1\r\n| union (appData \r\n    | project Id, Name = OperationName, Type = 'Operation', ['Operations Count'] = TotalCount, Category, Trend)\r\n| order by ['Operations Count'] desc, Name asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ User Activities",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Id",
                                "formatter": 5,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Type",
                                "formatter": 5,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Operations Count",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "blue",
                                  "showIcon": true
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Trend",
                                "formatter": 9,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "turquoise",
                                  "showIcon": true
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "ParentId",
                                "formatter": 5,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              }
                            ],
                            "rowLimit": 1000,
                            "filter": true,
                            "hierarchySettings": {
                              "idColumn": "Id",
                              "parentColumn": "ParentId",
                              "treeType": 0,
                              "expanderColumn": "Name"
                            }
                          },
                          "sortBy": [],
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "Results65"
                      }
                    ]
                  },
                  "name": "AU.2.044",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "AU.3.045",
                        "linkTarget": "step",
                        "linkLabel": "AU.3.045 üí° Review and update logged events.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "29c35aee-4e8d-4777-805c-3a25626dd469",
                        "cellValue": "AU.3.046",
                        "linkTarget": "step",
                        "linkLabel": "AU.3.046 üí° Alert in the event of an audit logging process failure.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "AU.3.048",
                        "linkTarget": "step",
                        "linkLabel": "AU.3.048 üí° Collect audit information (e.g., logs) into one or more central repositories.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "AU.3.049",
                        "linkTarget": "step",
                        "linkLabel": "AU.3.049 üí° Protect audit information and audit logging tools from unauthorized access, modification and deletion.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "AU.3.050",
                        "linkTarget": "step",
                        "linkLabel": "AU.3.050 üí° Limit management of audit logging functionality to a subset of privileged users.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "544f4fb1-a771-43d8-84f0-d94a7c95345a",
                        "cellValue": "AU.3.051",
                        "linkTarget": "step",
                        "linkLabel": "AU.3.051 üí° Correlate audit record review, analysis and reporting processes for investigation and response to indications of unlawful, unauthorized, suspicious or unusual activity.",
                        "preText": "Go to >",
                        "style": "link"
                      },
                      {
                        "id": "d409dea3-f3fa-4d09-98ab-9c9d97af7ff4",
                        "cellValue": "AU.3.052",
                        "linkTarget": "step",
                        "linkLabel": "AU.3.052 üí° \tProvide audit record reduction and report generation to support on-demand analysis and reporting.",
                        "preText": "Go to > ",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AU.3.045",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Review and update logged events (ML-3)\r\n\r\n## Primary Services\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Recommended Configurations\r\nüí° [Connect Data Sources](https://docs.microsoft.com/azure/sentinel/connect-data-sources)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-2(3)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Usage\r\n| summarize¬†count()¬†by¬†DataType\r\n| sort¬†by¬†count_¬†desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Log Events Count by Log Type",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "gridSettings": {
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "DataType",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "AU.3.045",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AU.3.046",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Alert in the event of an audit logging process failure (ML-3]](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#alert-in-the-event-of-an-audit-logging-process-failure)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Datatable](https://docs.microsoft.com/azure/data-explorer/kusto/query/datatableoperator?pivots=azuremonitor) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "union withsource = _TableName *\r\n| summarize last_log = datetime_diff(\"second\",now(), max(TimeGenerated)) by _TableName\r\n| where last_log > 0\r\n| project ['Table Name'] = _TableName, ['Last Record Received'] = last_log\r\n| order by ['Last Record Received'] desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Monitor Log Source Health ",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.                   ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust Query Time Thresholds for a Larger Data-Set",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Last Record Received",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "orangeRed"
                                },
                                "numberFormat": {
                                  "unit": 24,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "Table Name",
                                "label": "Table name"
                              },
                              {
                                "columnId": "Last Record Received",
                                "label": "Last record recieved",
                                "comment": "When did the last record arrive?"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "AU.3.046",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AU.3.048",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Collect audit information (e.g., logs) into one or more central repositories (ML-3]](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#collect-audit-information-eg-logs-into-one-or-more-central-repositories)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Datatable](https://docs.microsoft.com/azure/data-explorer/kusto/query/datatableoperator?pivots=azuremonitor) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[N/A](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-6(4)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Usage\r\n|¬†summarize¬†count()¬†by¬†DataType\r\n|¬†sort¬†by¬†count_¬†desc\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Log Events Count by Type",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Caller",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "DataType"
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "AU.3.048",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AU.3.049",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Protect audit information and audit logging tools from unauthorized access, modification, and deletion (ML-3]](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#protect-audit-information-and-audit-logging-tools-from-unauthorized-access-modification-and-deletion)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.8](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-6(7), AU-9](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AzureActivity\r\n| where OperationName contains \"Delete\" or OperationName contains \"Remove\"\r\n| summarize count() by OperationName, Caller\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Monitor Activity (Delete/Remove) Actions",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "OperationName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Caller",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "Last Record Received",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "orangeRed"
                                },
                                "numberFormat": {
                                  "unit": 24,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "AU.3.049",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AU.3.050",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Limit management of audit logging functionality to a subset of privileged users (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.9](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-6(7), AU-9](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AzureActivity\r\n| where CategoryValue == \"Administrative\"\r\n| where Resource contains \"security\"\r\n| where OperationName !contains \"license\"\r\n| summarize count() by OperationName, ResourceProvider, Caller\r\n| sort by count_ desc\r\n\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Security Administrative Actions",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Caller",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "AU.3.050",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AU.3.051",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Correlate audit record review, analysis and reporting processes for investigation and response to indications of unlawful, unauthorized, suspicious, or unusual activity (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   üîÄ[Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [BehaviorAnalytics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/behavioranalytics) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-6(3)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let AnomalousSigninActivity = BehaviorAnalytics\r\n    | where ActionType == \"Sign-in\"\r\n    | where (UsersInsights.NewAccount == True or UsersInsights.DormantAccount == True) and (\r\n        ActivityInsights.FirstTimeUserAccessedResource == True and ActivityInsights.ResourceUncommonlyAccessedAmongPeers == True\r\n        or ActivityInsights.FirstTimeUserUsedApp == True and ActivityInsights.AppUncommonlyUsedAmongPeers == False)\r\n    | join (\r\n        SigninLogs | where Status.errorCode == 0 or Status.errorCode == 0 and RiskDetail != \"none\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Successful Sign-in with one or more of the following indications: sign by new or recently dormant accounts and sign in with resource for the first time (while none of their peers did) or to an app for the first time (while none of their peers did) or performed by a user with Risk indicaiton from AAD\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet critical = dynamic(['9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3', 'c4e39bd9-1100-46d3-8c65-fb160da0071f', '158c047a-c907-4556-b7ef-446551a6b5f7', '62e90394-69f5-4237-9190-012177145e10', 'd29b2b05-8046-44ba-8758-1e26182fcf32', '729827e3-9c14-49f7-bb1b-9608f156bbb8', '966707d0-3269-4727-9be2-8c3a10f19b9d', '194ae4cb-b126-40b2-bd5b-6091b380977d', 'fe930be7-5e62-47db-91af-98c3a49a38b1']);\r\nlet high = dynamic(['cf1c38e5-3621-4004-a7cb-879624dced7c', '7495fdc4-34c4-4d15-a289-98788ce399fd', 'aaf43236-0c0d-4d5f-883a-6955382ac081', '3edaf663-341e-4475-9f94-5c398ef6c070', '7698a772-787b-4ac8-901f-60d6b08affd2', 'b1be1c3e-b65d-4f19-8427-f6fa0d97feb9', '9f06204d-73c1-4d4c-880a-6edb90606fd8', '29232cdf-9323-42fd-ade2-1d097af3e4de', 'be2f45a1-457d-42af-a067-6ec1fa63bc45', '7be44c8a-adaf-4e2a-84d6-ab2649e08a13', 'e8611ab8-c189-46e8-94e1-60213ab1f814']);//witdstomstl\r\nlet AnomalousRoleAssignment = AuditLogs\r\n    | where TimeGenerated > ago(28d)\r\n    | where OperationName == \"Add member to role\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target = tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner (\r\n        BehaviorAnalytics\r\n        | where ActionType == \"Add member to role\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend AnomalyName = \"Anomalous Role Assignemt\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access.  The query below generates an output of all high Blast Radius users performing Add member to priveleged role, or ones that add users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let LogOns=materialize(\r\n    BehaviorAnalytics\r\n    | where ActivityType == \"LogOn\");\r\nlet AnomalousResourceAccess = LogOns\r\n    | where ActionType == \"ResourceAccess\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous Resource Access\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversary may be trying to move through the environment. APT29 and APT32, for example, has used PtH & PtT techniques to lateral move around the network. The query below generates an output of all users performing an resource access (4624:3) to devices for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousRDPActivity = LogOns\r\n    | where ActionType == \"RemoteInteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous RDP Activity\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. FIN10, for example, has used RDP to move laterally to systems in the victim environment. The query below generates an output of all users performing a remote interactive logon (4624:10) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousLogintoDevices = LogOns\r\n    | where ActionType == \"InteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | where UsersInsights.DormantAccount == true or DevicesInsights.LocalAdmin == true\r\n    | extend AnomalyName = \"Anomalous Login To Devices\",\r\n        Tactic = \"Privilege Escalation\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access and privilege escalation. The query below generates an output of all administator users performing an interactive logon (4624:2) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousPasswordReset = BehaviorAnalytics\r\n    | where ActionType == \"Reset user password\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == \"True\"\r\n    | join (\r\n        AuditLogs\r\n        | where OperationName == \"Reset user password\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Password Reset\",\r\n        Tactic = \"Impact\",\r\n        Technique = \"Account Access Removal\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. LockerGoga, for example, has been observed changing account passwords and logging off current users. The query below generates an output of all users performing Reset user password for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalousGeoLocationLogon = BehaviorAnalytics\r\n    | where ActionType == \"Sign-in\"\r\n    | where ActivityInsights.FirstTimeUserConnectedFromCountry == True and (ActivityInsights.FirstTimeConnectionFromCountryObservedInTenant == True or ActivityInsights.CountryUncommonlyConnectedFromAmongPeers == True)\r\n    | join (\r\n        SigninLogs\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Initial Access\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access. The query below generates an output of successful Sign-in performed by a user from a new geo location he has never connected from before, and none of his peers as well.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousFailedLogon = BehaviorAnalytics\r\n    | where ActivityType == \"LogOn\"\r\n    | where UsersInsights.BlastRadius == \"High\"\r\n    | join (\r\n        SigninLogs  \r\n        | where Status.errorCode == 50126\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Failed Logon\",\r\n        Tactic = \"Credential Access\",\r\n        Technique = \"Brute Force\",\r\n        SubTechnique = \"Password Guessing\",\r\n        Description = \"Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Emotet, for example, has been observed using a hard coded list of passwords to brute force user accounts. The query below generates an output of all users with 'High' BlastRadius that perform failed Sign-in:Invalid username or password.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousAADAccountManipulation = AuditLogs\r\n    | where OperationName == \"Update user\"\r\n    | mv-expand AdditionalDetails\r\n    | where AdditionalDetails.key == \"UserPrincipalName\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner ( \r\n        BehaviorAnalytics\r\n        | where ActionType == \"Update user\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName) \r\n    | extend AnomalyName = \"Anomalous Account Manipulation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access. The query below generates an output of all high Blast Radius users performing 'Update user' (name change) to priveleged role, or ones that changed users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let AnomalousAADAccountCreation = BehaviorAnalytics\r\n    | where ActionType == \"Add user\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == True or ActivityInsights.FirstTimeActionPerformedInTenant == True or ActivityInsights.ActionUncommonlyPerformedAmongPeers == true\r\n    | join(\r\n        AuditLogs\r\n        | where OperationName == \"Add user\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend DisplayName = tostring(UsersInsights.AccountDisplayName),\r\n        UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Account Creation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Create Account\",\r\n        SubTechnique = \"Cloud Account\",\r\n        Description = \"Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system. The query below generates an output of all the users performing user creation for the first time and the target users that were created.\"\t\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalyTable = union kind=outer AnomalousSigninActivity, AnomalousRoleAssignment, AnomalousResourceAccess, AnomalousRDPActivity, AnomalousPasswordReset, AnomalousLogintoDevices, AnomalousGeoLocationLogon, AnomalousAADAccountManipulation, AnomalousAADAccountCreation, AnomalousFailedLogon;\r\nlet TopUsersByAnomalies = AnomalyTable\r\n    | summarize hint.strategy = shuffle AnomalyCount=count() by UserName, UserPrincipalName, tostring(UsersInsights.OnPremSid), tostring(UsersInsights.AccountObjectId)\r\n    | project Name=tolower(UserName), UPN=tolower(UserPrincipalName), AadUserId=UsersInsights_AccountObjectId, Sid=UsersInsights_OnPremSid, AnomalyCount\r\n    | sort by AnomalyCount desc;\r\nlet TopUsersByIncidents = SecurityIncident\r\n    | summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n    | where Status == \"New\" or Status == \"Active\"\r\n    | mv-expand AlertIds\r\n    | extend AlertId = tostring(AlertIds)\r\n    | join kind= innerunique ( \r\n        SecurityAlert \r\n        )\r\n        on $left.AlertId == $right.SystemAlertId\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n    | union TopUsersByAnomalies\r\n    | extend \r\n        AadPivot = iff(isempty(AadUserId), iff(isempty(Sid), Name, Sid), AadUserId),\r\n        SidPivot = iff(isempty(Sid), iff(isempty(AadUserId), Name, AadUserId), Sid),\r\n        UPNExists = iff(isempty(UPN), false, true),\r\n        NameExists = iff(isempty(Name), false, true),\r\n        SidExists = iff(isempty(Sid), false, true),\r\n        AADExists = iff(isempty(AadUserId), false, true)\r\n    | summarize hint.strategy = shuffle IncidentCount=dcount(IncidentNumber, 4), AlertCount=dcountif(AlertId, isnotempty(AlertId), 4), AnomalyCount=sum(AnomalyCount), any(Title, Severity, Status, StartTime, IncidentNumber, IncidentUrl, Owner), UPNAnchor=anyif(UPN, UPNExists == true), NameAnchor=anyif(Name, NameExists == true), AadAnchor=anyif(AadUserId, AADExists == true), SidAnchor=anyif(Sid, SidExists == true), any(SidPivot) by AadPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), NameAnchor=anyif(NameAnchor, isempty(NameAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_Title, any_Severity, any_StartTime, any_IncidentNumber, any_IncidentUrl) by any_SidPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_any_Title, any_any_Severity, any_any_StartTime, any_any_IncidentNumber, any_any_IncidentUrl) by NameAnchor\r\n    | project [\"UserName\"]=NameAnchor, IncidentCount, AlertCount, AnomalyCount, [\"AadUserId\"]=AadAnchor, [\"OnPremSid\"]=SidAnchor, [\"UserPrincipalName\"]=UPNAnchor;\r\nTopUsersByIncidents\r\n| project UserPrincipalName, IncidentCount, AlertCount, AnomalyCount\r\n| where UserPrincipalName !contains \"[\"\r\n| where UserPrincipalName <> \"\"\r\n| sort by IncidentCount desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ User Entity Behavior Analytics Alerts",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "AlertCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "orange"
                                }
                              },
                              {
                                "columnMatch": "AnomalyCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "yellow"
                                }
                              }
                            ],
                            "filter": true,
                            "sortBy": [
                              {
                                "itemKey": "$gen_heatmap_IncidentCount_1",
                                "sortOrder": 2
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_heatmap_IncidentCount_1",
                              "sortOrder": 2
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "AU.3.051",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AU.3.052",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Provide audit record reduction and report generation to support on-demand analysis and reporting (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   üîÄ[Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityIncident](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityincident) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.3.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-7](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident\r\n    | summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n    | mv-expand AlertIds\r\n    | extend AlertId = tostring(AlertIds)\r\n    | join kind= innerunique ( \r\n        SecurityAlert \r\n        )\r\n        on $left.AlertId == $right.SystemAlertId\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| extend Href_ = tostring(parse_json(ExtendedLinks)[0].Href)\r\n| where UPN <> \"\"\r\n| extend Workspace = tostring(parse_json(tostring(parse_json(ExtendedProperties).[\"Data Sources\"]))[0])\r\n| extend IncidentURL = strcat(\"https://portal.azure.com/#asset/Microsoft_Azure_Security_Insights/Incident/subscriptions/\",WorkspaceSubscriptionId,\"/resourceGroups/\",WorkspaceResourceGroup,\"/providers/Microsoft.OperationalInsights/workspaces/\",Workspace,\"/providers/Microsoft.SecurityInsights/Incidents/\",IncidentName)\r\n| where IncidentURL !contains \"//resourceGroups\"\r\n| distinct UPN, IncidentNumber, Title, Severity, ProductName, IncidentURL, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ User Security Incidents: Go-To >",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "PersonWithFriend",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Title",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "error",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentURL",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": ""
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "name": "AU.3.052",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isAUVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Audit and Accountability Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Awareness & Training\r\n---\r\nAwareness & Training is focused on controlling human access to systems, networks, and assets. Personnel Security includes considerations for screening individuals with access to Controlled Unclassified Information (CUI) and protection of such data after personnel actions such as terminations or transfers. The Personnel Security Control family includes 10 controls which varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibility.¬†For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "AT.2.057",
                        "linkTarget": "step",
                        "linkLabel": "AT.2.057 üí° Ensure that personnel are trained to carry out their assigned information security- related duties and responsibilities.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "3e97829b-9622-49ce-8991-efc8e4d0ce47",
                        "cellValue": "AT.2.057",
                        "linkTarget": "step",
                        "linkLabel": "AT.2.056 üí° Ensure that managers, system administrators and users of organizational systems are made aware of the security risks associated with their activities.",
                        "preText": "Go to >",
                        "style": "link"
                      },
                      {
                        "id": "68d97a98-0320-42d5-93c0-2746fd2848c4",
                        "cellValue": "AT.2.057",
                        "linkTarget": "step",
                        "linkLabel": "AT.3.058 üí° Provide security awareness training on recognizing and reporting potential indicators of insider threat.",
                        "preText": "Go to >",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AT.2.057",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## AT.2.056 üí° Ensure that managers, system administrators and users of organizational systems are made aware of the security risks associated with their activities and of the applicable policies, standards and procedures related to the security of those systems (ML-2)<br>\r\n## AT.2.057 üí° Ensure that personnel are trained to carry out their assigned information security- related duties and responsibilities (ML-2)<br>\r\n## AT.3.058 üí° Provide security awareness training on recognizing and reporting potential indicators of insider threat (ML-3)<br>\r\n\r\n## Recommended Resources\r\nüí° [Microsoft Certified: Security Operations Analyst Associate](https://docs.microsoft.com/learn/certifications/security-operations-analyst)<br>\r\nüí° [Learn Azure Sentinel on Microsoft Learn](https://techcommunity.microsoft.com/t5/itops-talk-blog/learn-azure-sentinel-on-microsoft-learn/ba-p/2006346)<br>\r\nüí° [Azure Sentinel Ninja Training Knowledge Check](https://techcommunity.microsoft.com/t5/azure-sentinel/what-s-new-azure-sentinel-ninja-training-knowledge-check/ba-p/2677696)<br>\r\nüí° [Manage Insider Risk](https://docs.microsoft.com/learn/modules/m365-compliance-insider-manage-insider-risk/)<br>\r\nüí° [Get Started Using Attack Simulation Training](https://docs.microsoft.com/microsoft-365/security/office-365-security/attack-simulation-training-get-started)<br>\r\nüí° [SimuLand: Understand adversary tradecraft and improve detection strategies](https://www.microsoft.com/security/blog/2021/05/20/simuland-understand-adversary-tradecraft-and-improve-detection-strategies/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)<br>\r\n## NIST SP 800-171 Mapping\r\n[3.2.1, 3.2.2, 3.2.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AT-2, AT-2(2), AT-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### üü¶ Leverage Microsoft Learn for Role-Based Training for Security Professionals \r\n![Image¬†Name](https://docs.microsoft.com/media/learn/home/hero_background_light.svg?branch=main)¬†\r\n[Go To: Microsoft Learn >](https://docs.microsoft.com/learn/)"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "AT.2.056 > AT.3.058",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isATVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Awareness & Training Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Configuration Management\r\n---\r\nConfiguration Management establishes security baselines and measuresdeviations provides the basis for tracking the security posture of cloud assets. The Configuration Management Control family includes 16 controls (Configuration Management with varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibility.¬†For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "CM.2.061",
                        "linkTarget": "step",
                        "linkLabel": "CM.2.061 üí° Establish and maintain baseline configurations and inventories of organizational systems throughout the respective system development life cycles.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "CM.2.062",
                        "linkTarget": "step",
                        "linkLabel": "CM.2.062 üí° Employ the principle of least functionality by configuring organizational systems to provide only essential capabilities.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "CM.2.063",
                        "linkTarget": "step",
                        "linkLabel": " CM.2.063 üí° Control and monitor user-installed software.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "CM.2.064",
                        "linkTarget": "step",
                        "linkLabel": "CM.2.064 üí° Establish and enforce security configuration settings for information technology products employed in organizational systems.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "b8324480-bbbc-43bc-891e-c957307c1d7c",
                        "cellValue": "CM.2.065",
                        "linkTarget": "step",
                        "linkLabel": "CM.2.065 üí° Track, review, approve or disapprove and log changes to organizational systems.",
                        "preText": "Go to >",
                        "style": "link"
                      },
                      {
                        "id": "cf958461-40d8-450c-bc8a-a868de00f93a",
                        "cellValue": "CM.2.066",
                        "linkTarget": "step",
                        "linkLabel": "CM.2.066 üí° Analyze the security impact of changes prior to implementation.",
                        "preText": "Go to >",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CM.2.061",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Establish and maintain baseline configurations and inventories of organizational systems (including hardware, software, firmware and documentation) throughout the respective system development life cycles (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#establish-and-maintain-baseline-configurations-and-inventories-of-organizational-systems-including-hardware-software-firmware-and-documentation-throughout-the-respective-system-development-life-cycles)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   üîÄ[Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\nüî∑ [DeviceEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/deviceevents) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)  <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-2, CM-6, CM-8, CM-8(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| project id,type,location,resourceGroup\r\n| order by location asc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Asset Inventory",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "InitiatingProcessFileName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Diagnostics",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Healthy",
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Unhealthy",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Environment",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Azure",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Direct Agent",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Agent",
                                      "representation": "turquoise",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Management Server",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Heartbeat Trend",
                                "formatter": 10,
                                "formatOptions": {
                                  "palette": "redGreen"
                                }
                              },
                              {
                                "columnMatch": "Details",
                                "formatter": 5
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "DeviceEvents\r\n| where InitiatingProcessFileName <> \"\"\r\n| summarize count() by InitiatingProcessFileName\r\n| sort by count_ desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Software Baselines",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "InitiatingProcessFileName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Diagnostics",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Healthy",
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Unhealthy",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Environment",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Azure",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Direct Agent",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Agent",
                                      "representation": "turquoise",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Management Server",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Heartbeat Trend",
                                "formatter": 10,
                                "formatOptions": {
                                  "palette": "redGreen"
                                }
                              },
                              {
                                "columnMatch": "Details",
                                "formatter": 5
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 65",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "CM.2.061",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CM.2.062",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Employ the principle of least functionality by configuring organizational systems to provide only essential capabilities (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#employ-the-principle-of-least-functionality-by-configuring-organizational-systems-to-provide-only-essential-capabilities)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-7](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let Policymap = datatable(RecommendationName:string, ControlFamily:string, ControlNumber: string, MaturityLevel:string, 800171Map:string, 80053Map:string)\r\n[\r\n\"Windows machines should meet requirements for 'System Audit Policies - Privilege Use'\",\t\"Configuration Management\",\t\"CM.2.062\",\t\"ML-2\",\t\"3.4.6\",\t\"CM-7\",\r\n\"Role-Based Access Control should be used on Kubernetes Services\",\t\"Configuration Management\",\t\"CM.2.062\",\t\"ML-2\",\t\"3.4.6\",\t\"CM-7\"\r\n];\r\nSecurityRecommendation\r\n| join kind=rightouter Policymap on RecommendationName\r\n| where RecommendationName <> \"\"\r\n| where ControlNumber == \"CM.2.062\"\r\n| summarize count() by ControlNumber, RecommendationName, RecommendationState\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Azure Security Center Recommendations for CM.2.062",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "CM.2.062",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CM.2.063",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Control and monitor user-installed software (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#control-and-monitor-user-installed-software)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.9](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-11](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let Policymap = datatable(RecommendationName:string, ControlFamily:string, ControlNumber: string, MaturityLevel:string, 800171Map:string, 80053Map:string)\r\n[\r\n\"Adaptive application controls for defining safe applications should be enabled on your machines\",\t\"Configuration Management\",\t\"CM.2.063\",\t\"ML-2\",\t\"3.4.6\",\t\"CM-7\",\r\n\"Role-Based Access Control should be used on Kubernetes Services\",\t\"Configuration Management\",\t\"CM.2.063\",\t\"ML-2\",\t\"3.4.6\",\t\"CM-7\",\r\n\"Allowlist rules in your adaptive application control policy should be updated\",\t\"Configuration Management\",\t\"CM.2.063\",\t\"ML-2\",\t\"3.4.6\",\t\"CM-7\",\r\n\"Role-Based Access Control should be used on Kubernetes Services\",\t\"Configuration Management\",\t\"CM.2.063\",\t\"ML-2\",\t\"3.4.6\",\t\"CM-7\",\r\n\"Security Center standard pricing tier should be selected\",\t\"Configuration Management\",\t\"CM.2.063\",\t\"ML-2\",\t\"3.4.6\",\t\"CM-7\",\r\n\"Role-Based Access Control should be used on Kubernetes Services\",\t\"Configuration Management\",\t\"CM.2.063\",\t\"ML-2\",\t\"3.4.6\",\t\"CM-7\",\r\n\"Windows machines should meet requirements for 'Security Options - User Account Control'\",\t\"Configuration Management\",\t\"CM.2.063\",\t\"ML-2\",\t\"3.4.6\",\t\"CM-7\",\r\n\"Role-Based Access Control should be used on Kubernetes Services\",\t\"Configuration Management\",\t\"CM.2.063\",\t\"ML-2\",\t\"3.4.6\",\t\"CM-7\"\r\n];\r\nSecurityRecommendation\r\n| join kind=rightouter Policymap on RecommendationName\r\n| where RecommendationName <> \"\"\r\n| where ControlNumber == \"CM.2.063\"\r\n| summarize count() by ControlNumber, RecommendationName, RecommendationState\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Azure Security Center Recommendations for CM.2.063",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "CM.2.063",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CM.2.064",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Establish and enforce security configuration settings for information technology products employed in organizational systems (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#establish-and-enforce-security-configuration-settings-for-information-technology-products-employed-in-organizational-systems)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-2, CM-6,CM-8,CM-8(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let Policymap = datatable(RecommendationName:string, ControlFamily:string, ControlNumber: string)\r\n[\r\n\"All Internet traffic should be routed via your deployed Azure Firewall\",\t\"Configuration Management\",\t\"CM.2.064\",\r\n\"All network ports should be restricted on network security groups associated to your virtual machine\",\t\"Configuration Management\",\t\"CM.2.064\",\r\n\"Azure Defender for SQL should be enabled for unprotected Azure SQL servers\",\t\"Configuration Management\",\t\"CM.2.064\",\r\n\"Azure Defender for SQL should be enabled for unprotected SQL Managed Instances\",\t\"Configuration Management\",\t\"CM.2.064\",\r\n\"Azure Key Vault should disable public network access\",\t\"Configuration Management\",\t\"CM.2.064\",\r\n\"Web Application Firewall (WAF) should be enabled for Azure Front Door Service service\",\t\"Configuration Management\",\t\"CM.2.064\",\r\n\"Web Application Firewall (WAF) should use the specified mode for Application Gateway\",\t\"Configuration Management\",\t\"CM.2.064\",\r\n\"Web Application Firewall (WAF) should use the specified mode for Azure Front Door Service\",\t\"Configuration Management\",\t\"CM.2.064\",\r\n\"Windows machines should meet requirements for 'Security Options - Network Security'\",\t\"Configuration Management\",\t\"CM.2.064\",\r\n];\r\nSecurityRecommendation\r\n| join kind=rightouter Policymap on RecommendationName\r\n| where RecommendationName <> \"\"\r\n| where ControlNumber == \"CM.2.064\"\r\n| summarize count() by ControlNumber, RecommendationName, RecommendationState\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Azure Security Center Recommendations for CM.2.064",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "CM.2.064",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CM.2.065",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Track, review, approve or disapprove, and log changes to organizational systems (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#track-review-approve-or-disapprove-and-log-changes-to-organizational-systems)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Recommended Configurations\r\nüí° [Enable Change Tracking and Inventory From an Automation Account](https://docs.microsoft.com/azure/automation/change-tracking/enable-from-automation-account)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let Policymap = datatable(RecommendationName:string, ControlFamily:string, ControlNumber: string)\r\n[\r\n\"An activity log alert should exist for specific Administrative operations\",\t\"Configuration Management\",\t\"CM.2.065\",\r\n\"An activity log alert should exist for specific Policy operations\",\t\"Configuration Management\",\t\"CM.2.065\",\r\n\"An activity log alert should exist for specific Security operations\",\t\"Configuration Management\",\t\"CM.2.065\",\r\n\"Azure Monitor should collect activity logs from all regions\",\t\"Configuration Management\",\t\"CM.2.065\",\r\n\"Azure subscriptions should have a log profile for Activity Log\",\t\"Configuration Management\",\t\"CM.2.065\",\r\n\"Windows machines should meet requirements for 'System Audit Policies - Policy Change'\",\t\"Configuration Management\",\t\"CM.2.065\"\r\n];\r\nSecurityRecommendation\r\n| join kind=rightouter Policymap on RecommendationName\r\n| where RecommendationName <> \"\"\r\n| where ControlNumber == \"CM.2.065\"\r\n| summarize count() by ControlNumber, RecommendationName, RecommendationState\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Azure Security Center Recommendations for CM.2.065",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "CM.2.065",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CM.2.066",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Track, review, approve or disapprove, and log changes to organizational systems (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [ConfigurationChange](https://docs.microsoft.com/azure/azure-monitor/reference/tables/configurationchange) ‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ConfigurationChange\r\n| summarize count() by ConfigChangeType, Type, _ResourceId\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Log & Monitor Asset Configuration Changes",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ConfigChangeType",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Files",
                                      "representation": "File",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Registry",
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "CM.2.066",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "29c35aee-4e8d-4777-805c-3a25626dd469",
                        "cellValue": "CM.3.067",
                        "linkTarget": "step",
                        "linkLabel": "CM.3.067 üí° Define, document, approve and enforce physical and logical access restrictions associated with changes to organizational systems.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "CM.3.068",
                        "linkTarget": "step",
                        "linkLabel": "CM.3.068 üí° Restrict, disable or prevent the use of nonessential programs, functions, ports, protocols and services.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "CM.3.069",
                        "linkTarget": "step",
                        "linkLabel": "CM.3.069 üí° Apply deny-by-exception (blacklisting) policy to prevent the use of unauthorized software or deny-all, permit-by-exception (whitelisting) policy to allow the execution of authorized software.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CM.3.067",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Define, document, approve and enforce physical and logical access restrictions associated with changes to organizational systems (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [IdentityInfo](https://docs.microsoft.com/azure/azure-monitor/reference/tables/identityinfo) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "IdentityInfo\r\n| extend AssignedRoles = strcat(AssignedRoles)\r\n| distinct AccountUPN, AssignedRoles\r\n| project AccountUPN, AssignedRoles\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ User Assigned Roles",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "PercentageOfPassedRules",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "CriticalFailedRules",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "WarningFailedRules",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Healthy",
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Unhealthy",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Environment",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Azure",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Direct Agent",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Agent",
                                      "representation": "turquoise",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Management Server",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Heartbeat Trend",
                                "formatter": 10,
                                "formatOptions": {
                                  "palette": "redGreen"
                                }
                              },
                              {
                                "columnMatch": "Details",
                                "formatter": 5
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 65",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "CM.3.067",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CM.3.068",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Restrict, disable, or prevent the use of nonessential programs, functions, ports, protocols, and services (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#restrict-disable-or-prevent-the-use-of-nonessential-programs-functions-ports-protocols-and-services)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   üîÄ[Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.7](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-7(1), CM-7(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let Policymap = datatable(RecommendationName:string, ControlFamily:string, ControlNumber: string)\r\n[\r\n\"An activity log alert should exist for specific Administrative operations\",\t\"Configuration Management\",\t\"CM.2.065\",\r\n\"An activity log alert should exist for specific Policy operations\",\t\"Configuration Management\",\t\"CM.2.065\",\r\n\"An activity log alert should exist for specific Security operations\",\t\"Configuration Management\",\t\"CM.2.065\",\r\n\"Azure Monitor should collect activity logs from all regions\",\t\"Configuration Management\",\t\"CM.2.065\",\r\n\"Azure subscriptions should have a log profile for Activity Log\",\t\"Configuration Management\",\t\"CM.2.065\",\r\n\"Windows machines should meet requirements for 'System Audit Policies - Policy Change'\",\t\"Configuration Management\",\t\"CM.2.065\"\r\n];\r\nSecurityRecommendation\r\n| where RecommendationName contains \"program\" or RecommendationName contains \"function\" or RecommendationName contains \"port\" or RecommendationName contains \"protocol\" or RecommendationName contains \"service\"\r\n| where RecommendationName <> \"\"\r\n| summarize count() by RecommendationName, RecommendationState\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Azure Security Center Recommendations for Programs, Functions, Ports, Protocols, and Services",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "CM.3.068",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CM.3.069",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Apply deny-by-exception (blacklisting) policy to prevent the use of unauthorized software or deny-all, permit-by-exception (whitelisting) policy to allow the execution of authorized software (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#apply-deny-by-exception-blacklisting-policy-to-prevent-the-use-of-unauthorized-software-or-deny-all-permit-by-exception-whitelisting-policy-to-allow-the-execution-of-authorized-software)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityevent) ‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security) ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.8](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CM-7(4), CM-7(5)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert \r\n| where AlertName contains \"app\" or AlertName contains \"tool\" or AlertName contains \"malware\" or AlertName contains \"hack\" or AlertName contains \"program\"\r\n| summarize count() by ProductName, AlertName\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Security Alerts for Suspicious Software",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "View",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "PercentageOfPassedRules",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "CriticalFailedRules",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "WarningFailedRules",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Healthy",
                                      "representation": "green",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Unhealthy",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Environment",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Azure",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Direct Agent",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Agent",
                                      "representation": "turquoise",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "SCOM Management Server",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Heartbeat Trend",
                                "formatter": 10,
                                "formatOptions": {
                                  "palette": "redGreen"
                                }
                              },
                              {
                                "columnMatch": "Details",
                                "formatter": 5
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "CM.3.069",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isCMVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Configuration Management",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Identification & Authentication \r\n---\r\nIdentification & Authentication Management is the process of managing user, system, asset identities and controlling access to authorized resources. The Identification & Authentication Management Control family includes 16 controls with varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibility.¬†For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 1: Performed / Basic Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 1 requires that an organization performs specified practices. Because the organization may only be able to perform these practices in an ad-hoc manner and may or may not rely on documentation, process maturity is not assessed for Level 1."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 2"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "IA.1.076",
                        "linkTarget": "step",
                        "linkLabel": "IA.1.076   üí° Identify information system users, processes acting on behalf of users or devices.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "IA.1.077",
                        "linkTarget": "step",
                        "linkLabel": "IA.1.077  üí° Authenticate (or verify) the identities of those users, processes or devices, as a prerequisite to allowing access to organizational information systems.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML1 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IA.1.076",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Identify information system users, processes acting on behalf of users or devices (ML-1)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Azure AD Identity Governance](https://docs.microsoft.com/azure/active-directory/governance/identity-governance-overview)   üîÄ[Identity Governance](https://portal.azure.com/#blade/Microsoft_AAD_ERM/DashboardBlade/GettingStarted)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AADManagedIdentitySignInLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/aadmanagedidentitysigninlogs) üî∑ [AADServicePrincipalSignInLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/aadserviceprincipalsigninlogs)  ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.4.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-2, IA-3, IA-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AADManagedIdentitySignInLogs\r\n| summarize count() by ServicePrincipalName, ResourceGroup\r\n| sort by count_ desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Managed Identity Actions",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ServicePrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": []
                        },
                        "customWidth": "50",
                        "name": "üü¶ Managed Identity Actions",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AADServicePrincipalSignInLogs \r\n| summarize count() by ServicePrincipalName, ResourceGroup\r\n| sort by count_ desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Service Principal Actions",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ServicePrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": []
                        },
                        "customWidth": "50",
                        "name": "üü¶ Service Principal Actions",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "IA.1.076",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IA.1.077",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Authenticate (or verify) the identities of those users, processes, or devices, as a prerequisite to allowing access to organizational information systems (ML-1)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#authenticate-or-verify-the-identities-of-those-users-processes-or-devices-as-a-prerequisite-to-allowing-access-to-organizational-information-systems)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Multi-Factor Authentication](https://azure.microsoft.com/services/active-directory/)    üîÄ[Multi-Factor Authentication](https://portal.azure.com/#blade/Microsoft_AAD_IAM/MultifactorAuthenticationMenuBlade/GettingStarted)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Customer Lockbox](https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview)   üîÄ[Customer Lockbox](https://portal.azure.com/#blade/Microsoft_Azure_Lockbox/LockboxMenu/Overview)<br>\r\n\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-2, IA-3, IA-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n|extend errorCode = Status.errorCode\r\n|extend SigninStatus = case(errorCode == 0, \"Success\", errorCode == 50058, \"Pending user action\",errorCode == 50140, \"Pending user action\", errorCode == 51006, \"Pending user action\", errorCode == 50059, \"Pending user action\",errorCode == 65001, \"Pending user action\", errorCode == 52004, \"Pending user action\", errorCode == 50055, \"Pending user action\", errorCode == 50144, \"Pending user action\", errorCode == 50072, \"Pending user action\", errorCode == 50074, \"Pending user action\", errorCode == 16000, \"Pending user action\", errorCode == 16001, \"Pending user action\", errorCode == 16003, \"Pending user action\", errorCode == 50127, \"Pending user action\", errorCode == 50125, \"Pending user action\", errorCode == 50129, \"Pending user action\", errorCode == 50143, \"Pending user action\", errorCode == 81010, \"Pending user action\", errorCode == 81014, \"Pending user action\", errorCode == 81012 ,\"Pending user action\", \"Failure\");\r\ndata\r\n| where IsInteractive == true\r\n| summarize Count = count() by SigninStatus\r\n| join kind = fullouter (datatable(SigninStatus:string)['Success', 'Pending action (Interrupts)', 'Failure']) on SigninStatus\r\n| project SigninStatus = iff(SigninStatus == '', SigninStatus1, SigninStatus), Count = iff(SigninStatus == '', 0, Count)\r\n| join kind = inner (data\r\n    | make-series Trend = count() default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain} by SigninStatus)\r\n    on SigninStatus\r\n| project-away SigninStatus1, TimeGenerated\r\n| extend Status = SigninStatus\r\n| union (\r\n    data \r\n    | summarize Count = count()\r\n    | extend jkey = 1\r\n    | join kind=inner (data\r\n        | make-series Trend = count() default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain}\r\n        | extend jkey = 1) on jkey\r\n    | extend SigninStatus = 'All Sign-ins', Status = '*'    \r\n)\r\n| where SigninStatus <> \"All Sign-ins\"\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ User Authentication Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "User",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "info",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Activities",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data = \r\nunion SigninLogs,nonInteractive\r\n|extend CAStatus = case(ConditionalAccessStatus ==\"success\",\"Successful\",\r\n                    ConditionalAccessStatus == \"failure\", \"Failed\",                                     \r\n                    ConditionalAccessStatus == \"notApplied\", \"Not applied\",                                     \r\n                    isempty(ConditionalAccessStatus), \"Not applied\", \r\n                    \"Disabled\")\r\n|mvexpand ConditionalAccessPolicies\r\n|extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0])\r\n|extend CAGrantControl = case(CAGrantControlName contains \"MFA\", \"Require MFA\", \r\n                            CAGrantControlName contains \"Terms of Use\", \"Require Terms of Use\", \r\n                            CAGrantControlName contains \"Privacy\", \"Require Privacy Statement\", \r\n                            CAGrantControlName contains \"Device\", \"Require Device Compliant\", \r\n                            CAGrantControlName contains \"Azure AD Joined\", \"Require Hybird Azure AD Joined Device\", \r\n                            CAGrantControlName contains \"Apps\", \"Require Approved Apps\",\r\n                            \"Other\");\r\ndata\r\n| summarize Count = dcount(Id) by CAStatus\r\n| join kind = inner (data\r\n                    | make-series Trend = dcount(Id) default = 0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain}) by CAStatus\r\n                    ) on CAStatus\r\n| project-away CAStatus1, TimeGenerated\r\n| order by Count desc",
                          "size": 4,
                          "showAnalytics": true,
                          "title": "üü¶ Conditional Access Status ",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "CAStatus",
                              "formatter": 1
                            },
                            "subtitleContent": {
                              "columnMatch": "Category"
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "blue"
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "50",
                        "name": "üü¶ Conditional Access Status "
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SigninLogs\r\n| where ResultType == 0 and AppDisplayName != \"\"\r\n| summarize count() by AppDisplayName\r\n| join (\r\nSigninLogs\r\n| make-series TrendList = count() on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, 4h) by AppDisplayName \r\n) on AppDisplayName\r\n| top 10 by count_ desc",
                          "size": 4,
                          "showAnalytics": true,
                          "title": "üü¶ User Sign-Ins By Application",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "tiles",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "User",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "info",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Activities",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "AppDisplayName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "TrendList",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "blue"
                              }
                            },
                            "showBorder": false
                          },
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "AppDisplayName",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "count_",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "IA.1.077",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 1: Performed / Basic Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "IA.2.078",
                        "linkTarget": "step",
                        "linkLabel": "IA.2.078 üí° Enforce a minimum password complexity and change of characters when new passwords are created.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "IA.2.079",
                        "linkTarget": "step",
                        "linkLabel": "IA.2.079 üí° Prohibit password reuse for a specified number of generations.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "IA.2.080",
                        "linkTarget": "step",
                        "linkLabel": "IA.2.080 üí° Allow temporary password use for system logons with an immediate change to a permanent password.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "IA.2.081",
                        "linkTarget": "step",
                        "linkLabel": "IA.2.081 üí° Store and transmit only cryptographically- protected passwords.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "b8324480-bbbc-43bc-891e-c957307c1d7c",
                        "cellValue": "IA.2.082",
                        "linkTarget": "step",
                        "linkLabel": "IA.2.082 üí° Obscure feedback of authentication information.",
                        "preText": "Go to >",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IA.2.078",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Enforce a minimum password complexity and change of characters when new passwords are created (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#enforce-a-minimum-password-complexity-and-change-of-characters-when-new-passwords-are-created)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Azure AD Password Protection](https://docs.microsoft.com/azure/active-directory/governance/identity-governance-overview)   üîÄ[Azure AD Password Protection](https://portal.azure.com/#blade/Microsoft_AAD_IAM/PasswordProtectionBlade)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.7](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-5(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let Policymap = datatable(RecommendationName:string, ControlFamily:string, ControlNumber: string, MaturityLevel:string, 800171Map:string, 80053Map:string)\r\n[\r\n\"Audit Windows machines that do not restrict the minimum password length to 14 characters\",\t\"Identification & Authentication\",\t\"IA.2.078\",\t\"ML-2\",\t\"3.5.7\",\t\"IA-5(1)\",\r\n\"Deploy the Windows Guest Configuration extension to enable Guest Configuration assignments on Windows VMs\",\t\"Identification & Authentication\",\t\"IA.2.078\",\t\"ML-2\",\t\"3.5.7\",\t\"IA-5(1)\",\r\n\"Audit Windows machines that do not have the password complexity setting enabled\",\t\"Identification & Authentication\",\t\"IA.2.078\",\t\"ML-2\",\t\"3.5.7\",\t\"IA-5(1)\",\r\n\"Windows machines should meet requirements for 'Security Options - Network Security'\",\t\"Identification & Authentication\",\t\"IA.2.078\",\t\"ML-2\",\t\"3.5.7\",\t\"IA-5(1)\"\r\n];\r\nSecurityRecommendation\r\n| join kind=rightouter Policymap on RecommendationName\r\n| where RecommendationName <> \"\"\r\n| where ControlNumber == \"IA.2.078\"\r\n| summarize count() by ControlNumber, RecommendationName, RecommendationState\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Azure Security Center Recommendations for IA.2.078",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "IA.2.078",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IA.2.079",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Prohibit password reuse for a specified number of generations (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#prohibit-password-reuse-for-a-specified-number-of-generations)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Azure AD Password Protection](https://docs.microsoft.com/azure/active-directory/governance/identity-governance-overview)   üîÄ[Azure AD Password Protection](https://portal.azure.com/#blade/Microsoft_AAD_IAM/PasswordProtectionBlade)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.8](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-5(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let Policymap = datatable(RecommendationName:string, ControlFamily:string, ControlNumber: string, MaturityLevel:string, 800171Map:string, 80053Map:string)\r\n[\r\n\"Add system-assigned managed identity to enable Guest Configuration assignments on virtual machines with no identities\",\t\"Identification & Authentication\",\t\"IA.2.079\",\t\"ML-2\",\t\"3.5.8\",\t\"IA-5(1)\",\r\n\"Audit Windows machines that allow re-use of the previous 24 passwords\",\t\"Identification & Authentication\",\t\"IA.2.079\",\t\"ML-2\",\t\"3.5.8\",\t\"IA-5(1)\",\r\n\"Deploy the Windows Guest Configuration extension to enable Guest Configuration assignments on Windows VMs\",\t\"Identification & Authentication\",\t\"IA.2.079\",\t\"ML-2\",\t\"3.5.8\",\t\"IA-5(1)\",\r\n\"Windows machines should meet requirements for 'Security Options - Network Security'\",\t\"Identification & Authentication\",\t\"IA.2.079\",\t\"ML-2\",\t\"3.5.8\",\t\"IA-5(1)\",\r\n\"Add system-assigned managed identity to enable Guest Configuration assignments on VMs with a user-assigned identity\",\t\"Identification & Authentication\",\t\"IA.2.079\",\t\"ML-2\",\t\"3.5.8\",\t\"IA-5(1)\",\r\n\"Add system-assigned managed identity to enable Guest Configuration assignments on virtual machines with no identities\",\t\"Identification & Authentication\",\t\"IA.2.079\",\t\"ML-2\",\t\"3.5.10\",\t\"IA-5(1)\",\r\n\"Audit Windows machines that do not store passwords using reversible encryption\",\t\"Identification & Authentication\",\t\"IA.2.079\",\t\"ML-2\",\t\"3.5.10\",\t\"IA-5(1)\",\r\n\"Deploy the Windows Guest Configuration extension to enable Guest Configuration assignments on Windows VMs\",\t\"Identification & Authentication\",\t\"IA.2.079\",\t\"ML-2\",\t\"3.5.10\",\t\"IA-5(1)\",\r\n\"Windows machines should meet requirements for 'Security Options - Network Security'\",\t\"Identification & Authentication\",\t\"IA.2.079\",\t\"ML-2\",\t\"3.5.10\",\t\"IA-5(1)\",\r\n\"Add system-assigned managed identity to enable Guest Configuration assignments on VMs with a user-assigned identity\",\t\"Identification & Authentication\",\t\"IA.2.079\",\t\"ML-2\",\t\"3.5.10\",\t\"IA-5(1)\",\r\n];\r\nSecurityRecommendation\r\n| join kind=rightouter Policymap on RecommendationName\r\n| where RecommendationName <> \"\"\r\n| where ControlNumber == \"IA.2.079\"\r\n| summarize count() by ControlNumber, RecommendationName, RecommendationState\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Azure Security Center Recommendations for IA.2.079",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "IA.2.079",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IA.2.080",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Allow temporary password use for system logons with an immediate change to a permanent password (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Recommended Configurations\r\nüí° [Reset a User's Password Using Azure Active Directory](https://docs.microsoft.com/azure/active-directory/fundamentals/active-directory-users-reset-password-azure-portal)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.9](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-5(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AuditLogs\r\n| where OperationName contains \"reset\"\r\n| extend InitiatedBy = tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName)\r\n| extend PasswordResetUser = tostring(TargetResources[0].userPrincipalName)\r\n| summarize count() by InitiatedBy, OperationName, PasswordResetUser \r\n| sort by count_ desc\r\n| limit 250 ",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Enforce Temporary Passwords & Monitor Resets",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "InitiatedBy",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "pending",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "OperationName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "PasswordResetUser",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "IA.2.080",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IA.2.081",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Store and transmit only cryptographically-protected passwords (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#store-and-transmit-only-cryptographically-protected-passwords)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityBaseline](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securitybaseline) üî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations)  ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.10](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-5(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityBaseline\r\n| where Description contains \"hash\" or Description contains \"sha\" or Description contains \"encrypt\"\r\n| summarize count() by Description, AnalyzeResult, _ResourceId\r\n| sort by count_ desc\r\n| limit 250\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Security Baselines for Password Cryptographic Protections",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Description",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AnalyzeResult",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Passed",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Failed",
                                      "representation": "failed",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let Policymap = datatable(RecommendationName:string, ControlFamily:string, ControlNumber: string)\r\n[\r\n\"Add system-assigned managed identity to enable Guest Configuration assignments on virtual machines with no identities\",\t\"Identification & Authentication\",\t\"IA.2.081\",\r\n\"Add system-assigned managed identity to enable Guest Configuration assignments on VMs with a user-assigned identity\",\t\"Identification & Authentication\",\t\"IA.2.081\",\r\n\"Audit Windows machines that do not store passwords using reversible encryption\",\t\"Identification & Authentication\",\t\"IA.2.081\",\r\n\"Deploy the Windows Guest Configuration extension to enable Guest Configuration assignments on Windows VMs\",\t\"Identification & Authentication\",\t\"IA.2.081\",\r\n\"Windows machines should meet requirements for 'Security Options - Network Security'\",\t\"Identification & Authentication\",\t\"IA.2.081\"\r\n];\r\nSecurityRecommendation\r\n| join kind=rightouter Policymap on RecommendationName\r\n| where RecommendationName <> \"\"\r\n| where ControlNumber == \"IA.2.081\"\r\n| summarize count() by ControlNumber, RecommendationName, RecommendationState\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Azure Security Center Recommendations for IA.2.081",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "IA.2.081",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IA.2.082",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Obscure feedback of authentication information (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityBaseline](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securitybaseline)   ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.11](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-6](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityBaseline\r\n| where Description contains \"reveal\"\r\n| summarize count() by Description, AnalyzeResult, _ResourceId\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Monitor Password Obfuscation Policies with Security Baselines",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AnalyzeResult",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Passed",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Failed",
                                      "representation": "failed",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "IA.2.082",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "IA.3.083",
                        "linkTarget": "step",
                        "linkLabel": "IA.3.083 üí° Use multi-factor authentication for local and network access to privileged accounts and for network access to non-privileged accounts.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "29c35aee-4e8d-4777-805c-3a25626dd469",
                        "cellValue": "IA.3.084",
                        "linkTarget": "step",
                        "linkLabel": "IA.3.084 üí° Employ replay-resistant authentication mechanisms for network access to privileged and non-privileged accounts.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "IA.3.085",
                        "linkTarget": "step",
                        "linkLabel": "IA.3.085 üí° Prevent the reuse of identifiers for a defined period.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "IA.3.086",
                        "linkTarget": "step",
                        "linkLabel": "IA.3.086 üí° Disable identifiers after a defined period of inactivity.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IA.3.083",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Use multifactor authentication for local and network access to privileged accounts and for network access to non-privileged accounts (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#use-multifactor-authentication-for-local-and-network-access-to-privileged-accounts-and-for-network-access-to-non-privileged-accounts)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)   üîÄ[Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Multi-Factor Authentication](https://azure.microsoft.com/services/active-directory/)    üîÄ[Multi-Factor Authentication](https://portal.azure.com/#blade/Microsoft_AAD_IAM/MultifactorAuthenticationMenuBlade/GettingStarted)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations)   ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-2(1), IA-2(2), IA-2(3)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data = \r\nunion SigninLogs,nonInteractive \r\n|extend errorCode = toint(Status.errorCode)\r\n|extend Reason = tostring(Status.failureReason)\r\n|extend CAStatus = case(ConditionalAccessStatus ==0,\"‚úîÔ∏è Success\",                                     \r\n                        ConditionalAccessStatus == 1, \"‚ùå Failure\",                                     \r\n                        ConditionalAccessStatus == 2, \"‚ö†Ô∏è Not Applied\",                                     \r\n                        ConditionalAccessStatus == \"\", \"‚ö†Ô∏è Not Applied\", \r\n                        \"üö´ Disabled\")\r\n|mvexpand ConditionalAccessPolicies\r\n|extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0])\r\n|extend CAGrantControl = case(CAGrantControlName contains \"MFA\", \"Require MFA\", \r\n                            CAGrantControlName contains \"Terms of Use\", \"Require Terms of Use\", \r\n                            CAGrantControlName contains \"Privacy\", \"Require Privacy Statement\", \r\n                            CAGrantControlName contains \"Device\", \"Require Device Compliant\", \r\n                            CAGrantControlName contains \"Azure AD Joined\", \"Require Hybird Azure AD Joined Device\", \r\n                            CAGrantControlName contains \"Apps\", \"Require Approved Apps\",\"Other\");\r\ndata\r\n| summarize Count = dcount(Id) by CAStatus, CAGrantControl\r\n| project Id = strcat(CAStatus, '/', CAGrantControl), Name = CAGrantControl, Parent = CAStatus, Count, Type = 'CAGrantControl'\r\n| join kind = inner (data\r\n                    | make-series Trend = dcount(Id) default = 0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain}) by CAStatus, CAGrantControl\r\n                    | project Id = strcat(CAStatus, '/', CAGrantControl), Trend\r\n                    ) on Id\r\n| project-away Id1\r\n| union (data\r\n    | summarize Count = dcount(Id) by CAStatus\r\n    | project Id = CAStatus, Name = CAStatus, Parent = '', Count, Type = 'CAStatus'\r\n    | join kind = inner (data\r\n                        | make-series Trend = dcount(Id) default = 0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain}) by CAStatus\r\n                        | project Id = CAStatus, Trend\r\n                        ) on Id\r\n    | project-away Id1)\r\n| order by Count desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ MFA: Conditional Access Status",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Id",
                                "formatter": 5,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Parent",
                                "formatter": 5,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Count",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "blue",
                                  "showIcon": true
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Type",
                                "formatter": 5,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Trend",
                                "formatter": 9,
                                "formatOptions": {
                                  "min": 0,
                                  "palette": "blue",
                                  "showIcon": true
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "idColumn": "Id",
                              "parentColumn": "Parent",
                              "treeType": 0,
                              "expanderColumn": "Name",
                              "expandTopLevel": true
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 10",
                        "styleSettings": {
                          "margin": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"IA.3.083\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for IA.3.083",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "IA.3.083",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IA.3.084",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Employ replay-resistant authentication mechanisms for network access to privileged and nonprivileged accounts (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#employ-replay-resistant-authentication-mechanisms-for-network-access-to-privileged-and-nonprivileged-accounts)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Multi-Factor Authentication](https://azure.microsoft.com/services/active-directory/)    üîÄ[Multi-Factor Authentication](https://portal.azure.com/#blade/Microsoft_AAD_IAM/MultifactorAuthenticationMenuBlade/GettingStarted)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs \r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-2(8),IA-2(9)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"IA.3.084\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for IA.3.084",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "IA.3.084",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IA.3.085",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Prevent the reuse of identifiers for a defined period (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Recommended Configurations\r\nüí° [Restore or Remove a Recently Deleted User Using Azure Active Directory](https://docs.microsoft.com/azure/active-directory/fundamentals/active-directory-users-restore)\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityBaseline](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securitybaseline)  ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-4)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityBaseline\r\n| where Description contains \"reuse\" or Description contains \"without password\" or Description contains \"unneccessary account\" or Description contains \"blank password\"\r\n| summarize count() by Description, AnalyzeResult, _ResourceId\r\n| sort by count_ desc\r\n| limit 250\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review Security Baselines for Identifier Reuse",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Description",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AnalyzeResult",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Passed",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "contains",
                                      "thresholdValue": "Failed",
                                      "representation": "failed",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "IA.3.085",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IA.3.086",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Disable identifiers after a defined period of inactivity (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n\r\n## Recommended Configurations\r\nüí° [Report on Azure AD Stale Users](https://gallery.technet.microsoft.com/scriptcenter/Report-on-Azure-AD-Stale-8e64c1c5)\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.5.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-4)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let CurrentUsers = SigninLogs\r\n| where ResultType == \"0\"\r\n| where TimeGenerated > ago(30d)\r\n| summarize HistoricUsers = makeset(UserPrincipalName);\r\nSigninLogs\r\n| where ResultType == \"0\"\r\n| where TimeGenerated between (ago(90d)..ago(30d))\r\n| where UserPrincipalName !in (CurrentUsers)\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| summarize count() by UserPrincipalName, UserProfile\r\n| sort by count_ desc\r\n| extend SignInsBeforeInactive = count_\r\n| project UserPrincipalName, UserProfile, SignInsBeforeInactive\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Inactive AAD Accounts (Last Month)",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "SignInsBeforeInactive",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "IA.3.086",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isIAVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Identification & Authentication Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Incident Response\r\n---\r\nIncident Response¬†is the process of responding to cybersecurity incidents and events. Incident Response includes preparation, identification, containment, eradication, recovery, and lessons learned phases. The¬†Incident Response¬†Control¬†family¬†includes¬†18¬†controls¬†with¬†varying¬†application¬†across¬†the¬†Cloud¬†Service¬†Provider¬†(CSP)¬†model¬†including¬†customer¬†responsibility,¬†service¬†provider¬†responsibility,¬†and¬†shared¬†responsibility. For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "IR.2.092",
                        "linkTarget": "step",
                        "linkLabel": "IR.2.092 üí° Establish an operational incident-handling capability for organizational systems that includes preparation, detection, analysis, containment, recovery and user response activities.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "IR.2.093",
                        "linkTarget": "step",
                        "linkLabel": "IR.2.093 üí° Detect and report events.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "IR.2.094",
                        "linkTarget": "step",
                        "linkLabel": "IR.2.094 üí° Analyze and triage events to support event resolution and incident declaration.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "IR.2.096",
                        "linkTarget": "step",
                        "linkLabel": "IR.2.096 üí° Develop and implement responses to declared incidents according to pre- defined procedures.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "b70234e6-408e-4d0b-abea-5eb00cff3762",
                        "cellValue": "IR.2.097",
                        "linkTarget": "step",
                        "linkLabel": "IR.2.097 üí° Perform root cause analysis on incidents to determine underlying causes.",
                        "preText": "Go to >",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IR.2.092",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Establish an operational incident-handling capability for organizational systems that includes preparation, detection, analysis, containment, recovery, and user response activities (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#establish-an-operational-incident-handling-capability-for-organizational-systems-that-includes-preparation-detection-analysis-containment-recovery-and-user-response-activities)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityIncident](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityincident) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)  ‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender) \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.6.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IA-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "üü¶  Incidents Summary",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where Status == \"New\" or Status == \"Active\"\n| where Severity == \"High\"\n| summarize kwSum=count(TenantId)\n\n\n\n",
                                "size": 3,
                                "title": "CRITICAL",
                                "noDataMessage": "No unauthorized devices making config changes",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "kwSum",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "hotCold"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "24",
                              "name": "query - 10"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where Status == \"New\" or Status == \"Active\"\n| summarize kwSum=count(TenantId)\n\n\n\n",
                                "size": 0,
                                "title": "OPEN",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "kwSum",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "hotCold"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "25",
                              "name": "query - 10"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where Status == \"Closed\"\n| summarize kwSum=count(TenantId)\n\n\n\n",
                                "size": 0,
                                "title": "CLOSED",
                                "noDataMessage": "No unauthorized devices making config changes",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "kwSum",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "greenRed"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "24",
                              "name": "query - 10"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where TimeGenerated > ago(1d)\n| where Status == \"New\" or Status == \"Active\"\n| distinct IncidentNumber\n| summarize count()\n\n\n\n\n",
                                "size": 0,
                                "title": "NEW TODAY",
                                "noDataMessage": "No unauthorized devices making config changes",
                                "timeContext": {
                                  "durationMs": 86400000
                                },
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "greenRed"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "24",
                              "name": "query - 10"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 3"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident\r\n    | summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n    | mv-expand AlertIds\r\n    | extend AlertId = tostring(AlertIds)\r\n    | join kind= innerunique ( \r\n        SecurityAlert \r\n        )\r\n        on $left.AlertId == $right.SystemAlertId\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UserPrincipalName = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| extend Href_ = tostring(parse_json(ExtendedLinks)[0].Href)\r\n| extend Workspace = tostring(parse_json(tostring(parse_json(ExtendedProperties).[\"Data Sources\"]))[0])\r\n| extend IncidentURL = strcat(\"https://portal.azure.com/#asset/Microsoft_Azure_Security_Insights/Incident/subscriptions/\",WorkspaceSubscriptionId,\"/resourceGroups/\",WorkspaceResourceGroup,\"/providers/Microsoft.OperationalInsights/workspaces/\",Workspace,\"/providers/Microsoft.SecurityInsights/Incidents/\",IncidentName)\r\n| where IncidentURL !contains \"//resourceGroups\"\r\n| distinct UserPrincipalName, IncidentNumber, Title, Severity, ProductName, IncidentURL, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Security Incidents: Go-To >",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Title",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "error",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentURL",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "PersonWithFriend",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": ""
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "name": "IR.2.092",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IR.2.093",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Detect and report events (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#detect-and-report-events)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   üîÄ[Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AR-4, AU-13, IA-10, IR-4, IR-5, IR-6, PE-6, RA-6](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "üü¶ Alerts Summary",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityAlert\n| where Status == \"New\" or Status == \"Active\"\n| where AlertSeverity == \"High\"\n| summarize kwSum=count(TenantId)\n\n\n\n",
                                "size": 2,
                                "title": "CRITICAL",
                                "noDataMessage": "No unauthorized devices making config changes",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "kwSum",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "hotCold"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "24",
                              "name": "query - 10"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityAlert\n| where Status == \"New\" or Status == \"Active\"\n| summarize kwSum=count(TenantId)\n\n\n\n",
                                "size": 2,
                                "title": "OPEN",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "kwSum",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "hotCold"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "24",
                              "name": "query - 10"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityAlert\n| where ProductName !contains \"iot\"\n| where Status == \"Closed\"\n| summarize kwSum=count(TenantId)\n\n\n\n",
                                "size": 2,
                                "title": "CLOSED",
                                "noDataMessage": "No unauthorized devices making config changes",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "kwSum",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "greenRed"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "24",
                              "name": "query - 10"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityAlert\n| where ProductName !contains \"iot\"\n| where Status == \"New\" or Status == \"Active\"\n| where dayofyear(TimeGenerated) == dayofyear(now())\n| summarize kwSum=count(TenantId)\n\n\n\n",
                                "size": 2,
                                "title": "NEW TODAY",
                                "noDataMessage": "No unauthorized devices making config changes",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "tiles",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "kwSum",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "greenRed"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                }
                              },
                              "customWidth": "24",
                              "name": "query - 10"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 5"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n| distinct AlertName, AlertSeverity, ProductName, Status, Tactics, AlertLink, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Security Alerts: Go To >",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "name": "query - 4",
                        "styleSettings": {
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "name": "IR.2.093",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IR.2.094",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Analyze and triage events to support event resolution and incident declaration (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   üîÄ[Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityIncident](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityincident) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)<br>  \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IR-4(3)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "üü¶ Efficiency",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| summarize count() by Severity\n| render piechart\n\n\n",
                                "size": 0,
                                "showAnalytics": true,
                                "title": "SEVERITY",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "timeContextFromParameter": "TimeRange",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "kwSum",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "greenRed"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                },
                                "chartSettings": {
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Low",
                                      "color": "yellow"
                                    },
                                    {
                                      "seriesName": "Medium",
                                      "color": "orange"
                                    },
                                    {
                                      "seriesName": "High",
                                      "color": "redBright"
                                    },
                                    {
                                      "seriesName": "Informational",
                                      "color": "blue"
                                    }
                                  ]
                                }
                              },
                              "customWidth": "35",
                              "name": "query - 7"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\r\n| where Status == 'Closed'\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| extend Owner = todynamic(Owner.assignedTo) \r\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \r\n| extend feedback =strcat(Classification,\" \",ClassificationReason)\r\n| summarize dcount(IncidentNumber) by feedback\r\n",
                                "size": 0,
                                "showAnalytics": true,
                                "title": "CLOSE CODES",
                                "timeContext": {
                                  "durationMs": 2592000000
                                },
                                "timeContextFromParameter": "TimeRange",
                                "showExportToExcel": true,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "visualization": "piechart",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Description",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "60%"
                                      }
                                    },
                                    {
                                      "columnMatch": "name",
                                      "formatter": 0,
                                      "formatOptions": {
                                        "customColumnWidthSetting": "5%"
                                      }
                                    },
                                    {
                                      "columnMatch": "severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Critical",
                                            "representation": "critical",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Major",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": null,
                                            "text": "{0}{1}"
                                          }
                                        ],
                                        "customColumnWidthSetting": "5"
                                      }
                                    },
                                    {
                                      "columnMatch": "message",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "CellDetails",
                                        "linkIsContextBlade": true,
                                        "customColumnWidthSetting": "70%"
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "titleContent": {
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "kwSum",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "greenRed"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal",
                                        "maximumFractionDigits": 2,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                },
                                "chartSettings": {
                                  "seriesLabelSettings": [
                                    {
                                      "seriesName": "Low",
                                      "color": "yellow"
                                    },
                                    {
                                      "seriesName": "Medium",
                                      "color": "orange"
                                    },
                                    {
                                      "seriesName": "High",
                                      "color": "redBright"
                                    },
                                    {
                                      "seriesName": "Informational",
                                      "color": "blue"
                                    }
                                  ]
                                }
                              },
                              "customWidth": "35",
                              "name": "query - 6"
                            },
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "SecurityIncident\n| extend Tactics = todynamic(AdditionalData.tactics)\n| extend Owner = todynamic(Owner.assignedTo) \n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| summarize arg_max(LastModifiedTime,*) by IncidentNumber \n| extend TimeToTriage =  (FirstModifiedTime - CreatedTime)/1h\n| summarize 50th_Percentile=percentile(TimeToTriage, 50) \n",
                                      "size": 1,
                                      "title": "MEAN TIME TO RESPOND",
                                      "timeContext": {
                                        "durationMs": 2592000000
                                      },
                                      "timeContextFromParameter": "TimeRange",
                                      "queryType": 0,
                                      "resourceType": "microsoft.operationalinsights/workspaces",
                                      "crossComponentResources": [
                                        "{Workspace}"
                                      ],
                                      "visualization": "tiles",
                                      "tileSettings": {
                                        "titleContent": {
                                          "formatter": 1
                                        },
                                        "leftContent": {
                                          "columnMatch": "50th_Percentile",
                                          "formatter": 12,
                                          "formatOptions": {
                                            "palette": "auto"
                                          },
                                          "numberFormat": {
                                            "unit": 26,
                                            "options": {
                                              "style": "decimal",
                                              "useGrouping": false,
                                              "maximumFractionDigits": 3
                                            }
                                          }
                                        },
                                        "showBorder": false,
                                        "size": "auto"
                                      }
                                    },
                                    "customWidth": "50",
                                    "name": "query - 2"
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "SecurityIncident\n| extend Tactics = todynamic(AdditionalData.tactics)\n| extend Owner = todynamic(Owner.assignedTo) \n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| summarize arg_max(TimeGenerated,*) by IncidentNumber \n| extend TimeToClosure =  (ClosedTime - CreatedTime)/1h\n| summarize 50th_Percentile=percentile(TimeToClosure, 50)",
                                      "size": 1,
                                      "title": "MEAN TIME TO RESOLVE",
                                      "timeContext": {
                                        "durationMs": 2592000000
                                      },
                                      "timeContextFromParameter": "TimeRange",
                                      "queryType": 0,
                                      "resourceType": "microsoft.operationalinsights/workspaces",
                                      "crossComponentResources": [
                                        "{Workspace}"
                                      ],
                                      "visualization": "tiles",
                                      "sortBy": [],
                                      "tileSettings": {
                                        "titleContent": {
                                          "columnMatch": "Classification",
                                          "formatter": 1,
                                          "formatOptions": {}
                                        },
                                        "leftContent": {
                                          "columnMatch": "50th_Percentile",
                                          "formatter": 12,
                                          "formatOptions": {
                                            "palette": "auto"
                                          },
                                          "numberFormat": {
                                            "unit": 26,
                                            "options": {
                                              "style": "decimal",
                                              "useGrouping": false,
                                              "maximumFractionDigits": 3
                                            }
                                          }
                                        },
                                        "showBorder": false,
                                        "size": "auto"
                                      }
                                    },
                                    "customWidth": "50",
                                    "name": "query - 2"
                                  }
                                ]
                              },
                              "customWidth": "70",
                              "name": "Mean times "
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 3"
                      }
                    ]
                  },
                  "name": "IR.2.094",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IR.2.096",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Develop and implement responses to declared incidents according to pre-defined procedures (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IR-4, IR-9, SE-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == \"microsoft.logic/workflows\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Azure Sentinel: Playbooks (SOAR)",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "IR.2.096",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IR.2.097",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Perform root cause analysis on incidents to determine underlying causes (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityIncident](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityincident) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-2, IR-4](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident\r\n| where Status == \"Closed\"\r\n| summarize count() by Classification\r\n| render piechart\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Security Incident Closure Classifications",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ]
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "IR.2.097",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "IR.3.098",
                        "linkTarget": "step",
                        "linkLabel": "IR.3.098 üí° Track, document and report incidents to designated officials and/or authorities both internal and external to the organization.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f4e0cc9a-45d2-4845-8279-a0872e5e8044",
                        "cellValue": "IR.3.099",
                        "linkTarget": "step",
                        "linkLabel": "IR.3.099 üí° Test the organizational incident response capability.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IR.3.098",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Track, document and report incidents to designated officials and/or authorities both internal and external to the organization (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityIncident](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityincident) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.6.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IR-2, IR-4, IR-5, IR-6, IR-7](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident¬†\r\n|¬†extend¬†Tactics¬†=¬†todynamic(AdditionalData.tactics)\r\n|¬†extend¬†Owner¬†=¬†todynamic(Owner.assignedTo)¬†\r\n|¬†extend¬†Product¬†=¬†todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0]))¬†\r\n|¬†summarize¬†Incidents=dcount(IncidentNumber)¬†by¬†Severity,¬†bin(CreatedTime,¬†1d)\r\n|¬†render¬†areachart¬†\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Security Incidents over Time",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ]
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "IR.3.098",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "IR.3.099",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Test the organizational incident response capability (ML-3)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Resources\r\nüí° [SimuLand: Understand adversary tradecraft and improve detection strategies](https://www.microsoft.com/security/blog/2021/05/20/simuland-understand-adversary-tradecraft-and-improve-detection-strategies/)<br>\r\nüí° [Azure Sentinel - SOC Process Framework Workbook](https://techcommunity.microsoft.com/t5/azure-sentinel/what-s-new-azure-sentinel-soc-process-framework-workbook/ba-p/2339315)<br>\r\nüí° [Sentinel ATT&CK](https://github.com/BlueTeamLabs/sentinel-attack)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.6.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[IR-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n| where AlertName contains \"test\"\r\n| distinct AlertName, AlertSeverity, ProductName, Status, Tactics, AlertLink, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review & Test Security Alerts for Incident Response Readiness",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "IR.3.099",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isIRVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Incident Response Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Maintenance\r\n---\r\nMaintenance includes processes such as system updates, patching, and configuration changes which are required for the overall functionality of the information system. The Maintenance Protection Control family includes 10 controls. These controls have varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibility. For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "MA.2.111",
                        "linkTarget": "step",
                        "linkLabel": "MA.2.111 üí° Perform maintenance on organizational systems.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "MA.2.112",
                        "linkTarget": "step",
                        "linkLabel": "MA.2.112 üí° Provide controls on the tools, techniques, mechanisms, and personnel used to conduct system maintenance.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "MA.2.113",
                        "linkTarget": "step",
                        "linkLabel": "MA.2.113 üí° Require multifactor authentication to establish nonlocal maintenance sessions via external network connections and terminate such connections when nonlocal maintenance is complete.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "35bfb771-67e1-480a-ac96-0a59f2c8dbc2",
                        "cellValue": "MA.2.114",
                        "linkTarget": "step",
                        "linkLabel": "MA.2.114 üí° Supervise the maintenance activities of personnel without required access authorization.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MA.2.111",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Perform maintenance on organizational systems (ML-2)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Recommended Resources\r\nüí° [Handling Planned Maintenance Notifications Using the Azure Portal](https://docs.microsoft.com/azure/virtual-machines/maintenance-notifications-portal)<br>\r\nüí° [Managing Platform Updates with Maintenance Control](https://docs.microsoft.com/azure/virtual-machines/maintenance-control)<br>\r\nüí° [Scheduling Maintenance Updates with Maintenance Control and Azure Functions](https://github.com/Azure/azure-docs-powershell-samples/tree/master/maintenance-auto-scheduler)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.7.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MA-2, MA-3, MA-3(1), MA-3(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where RecommendationDisplayName contains \"update\" or RecommendationDisplayName contains \"upgrade\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, complianceStandardId, ControlID, Recommendation",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Azure Security Center Assessments: Update Recommendations",
                          "noDataMessage": "No Current  Recommendations in this Area. Confirm Assessments are Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "name": "MA.2.111",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MA.2.112",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Provide controls on the tools, techniques, mechanisms, and personnel used to conduct system maintenance (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Resources\r\nüí° [Privileged Access Workstations](https://docs.microsoft.com/windows-server/identity/securing-privileged-access/privileged-access-workstations)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.7.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MA-2, MA-3, MA-3(1), MA-3(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"identity\" or type contains \"networksecuritygroups\" or type contains \"bastion\" or type contains \"lock\" or type contains \"endpoint\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Recommended Primary & Secondary Service Assets",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 3"
                      }
                    ]
                  },
                  "name": "MA.2.112",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MA.2.113",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Require multifactor authentication to establish nonlocal maintenance sessions via external network connections and terminate such connections when nonlocal maintenance is complete (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Multi-Factor Authentication](https://azure.microsoft.com/services/active-directory/)    üîÄ[Multi-Factor Authentication](https://portal.azure.com/#blade/Microsoft_AAD_IAM/MultifactorAuthenticationMenuBlade/GettingStarted)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.7.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MA-4](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let nonInteractive = AADNonInteractiveUserSignInLogs\r\n| extend LocationDetails = parse_json(LocationDetails)\r\n| extend Status = parse_json(Status)\r\n| extend ConditionalAccessPolicies = parse_json(ConditionalAccessPolicies);\r\nlet data = \r\nunion SigninLogs,nonInteractive \r\n|extend errorCode = toint(Status.errorCode)\r\n|extend Reason = tostring(Status.failureReason)\r\n|extend CAStatus = case(ConditionalAccessStatus ==0,\"‚úîÔ∏è Success\",                                     \r\n                        ConditionalAccessStatus == 1, \"‚ùå Failure\",                                     \r\n                        ConditionalAccessStatus == 2, \"‚ö†Ô∏è Not Applied\",                                     \r\n                        ConditionalAccessStatus == \"\", \"‚ö†Ô∏è Not Applied\", \r\n                        \"üö´ Disabled\")\r\n|mvexpand ConditionalAccessPolicies\r\n|extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0])\r\n|extend CAGrantControl = case(CAGrantControlName contains \"MFA\", \"Require MFA\", \r\n                            CAGrantControlName contains \"Terms of Use\", \"Require Terms of Use\", \r\n                            CAGrantControlName contains \"Privacy\", \"Require Privacy Statement\", \r\n                            CAGrantControlName contains \"Device\", \"Require Device Compliant\", \r\n                            CAGrantControlName contains \"Azure AD Joined\", \"Require Hybird Azure AD Joined Device\", \r\n                            CAGrantControlName contains \"Apps\", \"Require Approved Apps\",\"Other\");\r\ndata\r\n| where CAGrantControl contains \"MFA\"\r\n| extend Result = tostring(ConditionalAccessPolicies.result)\r\n| extend UserProfile = strcat(\"https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/\",UserId)\r\n| where Result == \"notApplied\"\r\n| summarize count() by UserPrincipalName, UserProfile, CAGrantControl, Result\r\n| sort by count_ desc\r\n| project UserPrincipalName, UserProfile, CAGrantControl, Result, count_\r\n| limit 250\r\n\r\n\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Users Authenticating Without MFA",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserProfile",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go To: AAD User Profile >"
                                }
                              },
                              {
                                "columnMatch": "Result",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      }
                    ]
                  },
                  "name": "MA.2.113",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MA.2.114",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Supervise the maintenance activities of personnel without required access authorization (ML-2)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Customer Lockbox](https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview)   üîÄ[Customer Lockbox](https://portal.azure.com/#blade/Microsoft_Azure_Lockbox/LockboxMenu/Overview)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.7.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MA-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AuditLogs\r\n| where OperationName contains \"PIM\"\r\n| distinct OperationName, Identity, AADOperationType, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| project OperationName, AADOperationType, Identity, TimeGenerated\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Implement/Monitor Privileged Identity Management for Maintenance",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "OperationName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Identity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "MA.2.114",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "MA.3.115",
                        "linkTarget": "step",
                        "linkLabel": "MA.3.115 üí° Ensure equipment removed for off-site maintenance is sanitized of any CUI. ",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "MA.3.116",
                        "linkTarget": "step",
                        "linkLabel": "MA.3.116 üí° Check media containing diagnostic and test programs for malicious code before the media are used in organizational systems.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MA.3.115",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Ensure equipment removed for off-site maintenance is sanitized of any CUI (ML-3)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)<br>\r\n\r\n## Recommended Resources\r\nüí° [Data destruction in Microsoft 365](https://docs.microsoft.com/compliance/assurance/assurance-data-destruction)<br>\r\nüí° [Azure customer data protection](https://docs.microsoft.com/azure/security/fundamentals/protection-customer-data)<br>\r\nüí° [Configure encryption with customer-managed keys stored in Azure Key Vault](https://docs.microsoft.com/azure/storage/common/customer-managed-keys-configure-key-vault)<br>\r\nüí° [NIST SP 800-88: Guidelines for Media Sanitization](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-88r1.pdf)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.7.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MA-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"key\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Leverage Key Vaults for Cryptographic Erasure",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "MA.3.115",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MA.3.116",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Check media containing diagnostic and test programs for malicious code before the media are used in organizational systems (ML-3)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityevent)   ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br> \r\n\r\n## Recommended Resources\r\nüí° [Use Microsoft Endpoint Configuration Manager to Run a Scan](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-antivirus/run-scan-microsoft-defender-antivirus#use-microsoft-endpoint-configuration-manager-to-run-a-scan)<br>\r\nüí° [Custom Scan a USB Drive](https://gallery.technet.microsoft.com/Custom-scan-a-USB-drive-17b9be2a)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.7.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MA-3(2)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n| where ProviderName == \"MDATP\"\r\n| where AlertName contains \"hack\" or AlertName contains \"mal\" or AlertName contains \"software\" or AlertName contains \"virus\" or AlertName contains \"trojan\" or AlertName contains \"c2\" or AlertName contains \"beacon\"\r\n| distinct AlertName, AlertSeverity, ProductName, AlertLink, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Scan Removeable Media with Microsoft Defender for Endpoint ",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.  ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "name": "MA.3.116",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isMAVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Maintenance",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Media Protection\r\n---\r\nMedia protection includes physical, logical, and administrative controls over sensitive data. The Maintenance Protection Control family includes 13 controls. These controls have varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibility. For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 1: Performed / Basic Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 1 requires that an organization performs specified practices. Because the organization may only be able to perform these practices in an ad-hoc manner and may or may not rely on documentation, process maturity is not assessed for Level 1."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 2"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "MP.1.118",
                        "linkTarget": "step",
                        "linkLabel": "MP.1.118  üí° Sanitize or destroy information system media containing Federal Contract Information (FCI) before disposal or release for reuse.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML1 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MP.1.118",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Sanitize or destroy information system media containing Federal Contract Information (FCI) before disposal or release for reuse (ML-1)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)<br>\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\n\r\n## Recommended Resources\r\nüí° [Data destruction in Microsoft 365](https://docs.microsoft.com/compliance/assurance/assurance-data-destruction)<br>\r\nüí° [NIST SP 800-88: Guidelines for Media Sanitization](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-88r1.pdf)<br>\r\nüí° [Purge Process](https://docs.microsoft.com/azure/data-explorer/kusto/concepts/data-purge#purge-process)<br>\r\nüí° [Configure encryption with customer-managed keys stored in Azure Key Vault](https://docs.microsoft.com/azure/storage/common/customer-managed-keys-configure-key-vault)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-2, MP-4, MP-6](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| distinct UserId_s, LabelName_s, ApplicationName_s_s, Operation_s_s, Protected_b_s, Platform_s_s, Activity_s_s, ProtectionOwner_s, TimeGenerated_s\r\n| sort by TimeGenerated_s desc\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Scan/Monitor for Sensitive Data with Azure Information Protection",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserId_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"key\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Leverage Key Vaults for Cryptographic Erasure",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "MP.1.118",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 1: Performed / Basic Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "MP.2.119",
                        "linkTarget": "step",
                        "linkLabel": "MP.2.119 üí° Protect (e.g., physically control and securely store) system media containing Federal Contract Information, both paper and digital.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "MP.2.120",
                        "linkTarget": "step",
                        "linkLabel": "MP.2.120 üí° Limit access to CUI on system media to authorized users.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "MP.2.121",
                        "linkTarget": "step",
                        "linkLabel": "MP.2.121 üí° Control the use of removable media on system components.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MP.2.119",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Protect (i.e., physically control and securely store) system media containing CUI, both paper and digital (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n\r\n## Recommended Resources\r\nüí° [Physical Security](https://docs.microsoft.com/azure/security/fundamentals/physical-security)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-2, MP-4, MP-6](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### üü¶ Azure Datacenters: Physically Protect CUI Data in a Secure Location\r\n![Image¬†Name](https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE4q5jn?ver=25d1&q=90&m=6&h=431&w=767&b=%23FFFFFFFF&l=f&o=t&aim=true¬†¬†\"Physical Security Controls\")¬†<br>\r\n[Go To: Physical Security Controls >](https://docs.microsoft.com/azure/security/fundamentals/physical-security)<br> "
                        },
                        "customWidth": "50",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      }
                    ]
                  },
                  "name": "MP.2.119",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MP.2.120",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Limit access to CUI on system media to authorized users (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-2, MP-4, MP-6](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| distinct UserId_s, LabelName_s, ApplicationName_s_s, Operation_s_s, Protected_b_s, Platform_s_s, Activity_s_s, ProtectionOwner_s, TimeGenerated_s\r\n| sort by TimeGenerated_s desc\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Label/Control Sensitive Data with Azure Information Protection",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserId_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "name": "MP.2.120",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MP.2.121",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Control the use of removable media on system components (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [DeviceEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/deviceevents) ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.7](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-7](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "DeviceEvents\r\n| where InitiatingProcessFolderPath <> \"\" \r\n| where InitiatingProcessFolderPath !contains \"c:\" or ActionType contains \"usb\"\r\n| summarize count() by DeviceName, ActionType, AccountName, InitiatingProcessFolderPath\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Monitor/Control Removeable Media Devices",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "DeviceName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "resource",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ActionType",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AccountName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "MP.2.121",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "MP.3.122",
                        "linkTarget": "step",
                        "linkLabel": "MP.3.122 üí° Mark media with necessary CUI markings and distribution limitations.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "MP.3.123",
                        "linkTarget": "step",
                        "linkLabel": "MP.3.123 üí° Prohibit the use of portable storage devices when such devices have no identifiable owner.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "dd0eaac4-75b0-4c8c-ba66-c4fbf9adfab4",
                        "cellValue": "MP.3.124",
                        "linkTarget": "step",
                        "linkLabel": "MP.3.124 üí° \tControl access to media containing CUI and maintain accountability for media during transport outside of controlled areas.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "328e615d-4a3a-48a9-8085-1a7b187334f8",
                        "cellValue": "MP.3.125",
                        "linkTarget": "step",
                        "linkLabel": "MP.3.125 üí° Implement cryptographic mechanisms to protect the confidentiality of CUI stored on digital media during transport unless otherwise protected by alternative physical safeguards.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MP.3.122",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Mark media with necessary CUI markings and distribution limitations (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| where LabelName_s <> \"\"\r\n| summarize count() by LabelName_s\r\n| sort by count_ desc\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Label/Control Sensitive Data with Azure Information Protection",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "UserId_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "chartSettings": {
                            "showLegend": true
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "name": "MP.3.122",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MP.3.123",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Prohibit the use of portable storage devices when such devices have no identifiable owner (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.8](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-7(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### üü¶ Leverage Microsoft Defender for Endpoint & Microsoft Intune to Prohibit Rogue USB Devices\r\n![Image¬†Name](https://docs.microsoft.com/windows/security/threat-protection/device-control/images/baselines.png¬†¬†\"Rogue USB\")¬†<br>\r\n[Go To: Intune/Microsoft Endpoint Manager (Endpoint Security: Attack Surface Reduction) >](https://endpoint.microsoft.com/#blade/Microsoft_Intune_Workflows/SecurityManagementMenu/asr)"
                        },
                        "customWidth": "45",
                        "name": "text - 1",
                        "styleSettings": {
                          "maxWidth": "45"
                        }
                      }
                    ]
                  },
                  "name": "MP.3.123",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MP.3.124",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Control access to media containing CUI and maintain accountability for media during transport outside of controlled areas (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### üü¶ Leverage Azure Information Protection to Classify/Protect CUI at Rest and In-Transit\r\n![Image¬†Name](https://docs.microsoft.com/azure/information-protection/media/info-protect-protection-bar-configured.png¬†¬†\"AIP Configuration\")<br>\r\n[Go To: Microsoft Information Protection (Label Policies) >](https://compliance.microsoft.com/informationprotection?viewid=sensitivitylabelpolicies)<br>\r\n[Go To: Azure Information Protection (Label Policies) >](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/scopedpoliciesBlade)<br>"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "MP.3.124",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "MP.3.125",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Implement cryptographic mechanisms to protect the confidentiality of CUI stored on digital media during transport unless otherwise protected by alternative physical safeguards (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[MP-5(4)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| where RecommendationName contains \"crypt\" or RecommendationName contains \"transit\"\r\n| summarize count() by RecommendationName\r\n| sort by count_ desc\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Azure Security Center: Encryption/Transit Recommendations",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 151",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      }
                    ]
                  },
                  "name": "MP.3.125",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isMPVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Media Protection",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Personnel Security\r\n---\r\nPersonnel Security is focused on controlling human access to systems, networks, and assets. Personnel Security includes considerations for screening individuals with access to Controlled Unclassified Information (CUI) and protection of such data after personnel actions such as terminations or transfers. The Personnel Security Control family includes 7 controls which varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibility. For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "PS.2.127",
                        "linkTarget": "step",
                        "linkLabel": "PS.2.127 üí° Protect and monitor the physical facility and support infrastructure for organizational systems.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "a931a632-d4cf-4b7a-8d07-59f5a52ceb24",
                        "cellValue": "PS.2.128",
                        "linkTarget": "step",
                        "linkLabel": "PS.2.128 üí° Practice: Ensure that organizational systems containing CUI are protected during and after personnel actions such as terminations and transfers. Primary Services\tSecondary Services",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "PS.2.127",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Screen individuals prior to authorizing access to organizational systems containing CUI (ML-2)\r\n\r\n## Implementation Statement\r\nPersonnel security screening (vetting) activities involve the evaluation/assessment of individual‚Äôs conduct, integrity, judgment, loyalty, reliability, and stability (i.e., the trustworthiness of the individual) prior to authorizing access to organizational systems containing CUI. The screening activities reflect applicable federal laws, Executive Orders, directives, policies, regulations, and specific criteria established for the level of access required for assigned positions.\r\nYou can ensure all employees who need access to CUI undergo organization-defined screening before being granted access based on the types of screening requirements for a given position and role. Clearly define positions and roles within your organization. Implement roles using üí° [Azure RBAC](https://docs.microsoft.com/azure/role-based-access-control).  For example, administrators with access to CUI and specific roles with permissions to view CUI should follow an organizationally defined screening process. \r\n\r\n## Customer Responsibility\r\n Screening individuals prior to authorizing access to customer-deployed resources.\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.9.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[PS-3, PS-4, PS-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "45",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "45"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "customWidth": "5",
                        "name": "text - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### üü¶ Azure Role Based Access Control\r\n![Image¬†Name](https://azurecomcdn.azureedge.net/cvt-f83fd647d6f366492554e3c84c6972956ea0fa343f1f12abc9590dd97f777e9e/images/page/overview/trusted-cloud/index/ill-1.png)¬†\r\n[Go To: Azure Active Directory(Roles & Administrators) >](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RolesAndAdministrators)\r\n\r\n"
                        },
                        "customWidth": "40",
                        "name": "text - 2"
                      }
                    ]
                  },
                  "name": "PS.2.127",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "PS.2.128",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Ensure that organizational systems containing CUI are protected during and after personnel actions such as terminations and transfers (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance: Insider Risk Management](https://www.microsoft.com/microsoft-365/business/compliance-solutions)    üîÄ[Insider Risk Management](https://compliance.microsoft.com/insiderriskmgmt?viewid=overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Microsoft 365 Compliance: Insider Risk Management](https://www.microsoft.com/microsoft-365/business/compliance-solutions) <br> \r\n\r\n## Recommended Configurations\r\nüí° [Insider Risk Management: Setup a Connector to import HR Data & Track Last Working Dates](https://docs.microsoft.com/microsoft-365/compliance/import-hr-data)\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.9.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[PS-3, PS-4, PS-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n| where ProductName == \"Microsoft 365 Insider Risk Management\"\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| extend Href_ = tostring(parse_json(ExtendedLinks)[0].Href)\r\n| extend UserPrincipalName = UPN\r\n| distinct AlertName, ProductName, Status, AlertLink, UserPrincipalName, Tactics, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Enable the HR Connector & Monitor Microsoft 365: Insider Risk Management Alert Details",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2"
                      }
                    ]
                  },
                  "name": "PS.2.128",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isPSVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Personnel Security",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Physical Protection\r\n---\r\nPhysical Protections are focused on protecting direct access to systems, networks, and assets. Physical protection includes considerations for limiting physical access, escorting visitors, maintaining visit audit logs, monitoring infrastructure, and protecting Controlled Unclassified Information (CUI). The Physical Protection Control family includes 11 controls which varying application across the Cloud Service Provider (CSP) model including customer responsibility,service provider responsibility, and shared responsibility. For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 1: Performed / Basic Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 1 requires that an organization performs specified practices. Because the organization may only be able to perform these practices in an ad-hoc manner and may or may not rely on documentation, process maturity is not assessed for Level 1."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 2"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "PE.1.131 - PE.1.134",
                        "linkTarget": "step",
                        "linkLabel": "PE.1.131  üí° Limit physical access to organizational information systems, equipment and the respective operating environments to authorized individuals.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "4c0bfeef-f67e-4d83-846e-0b72742c6648",
                        "cellValue": "PE.1.131 - PE.1.134",
                        "linkTarget": "step",
                        "linkLabel": "PE.1.132  üí° Escort visitors and monitor visitor activity.",
                        "preText": "Go to >",
                        "style": "link"
                      },
                      {
                        "id": "24dd9388-43f3-4e00-b712-06cb10be7afe",
                        "cellValue": "PE.1.131 - PE.1.134",
                        "linkTarget": "step",
                        "linkLabel": "PE.1.133  üí° Maintain audit logs of physical access.",
                        "preText": "Go to >",
                        "style": "link"
                      },
                      {
                        "id": "dfa2d3dc-b48f-4aee-8368-b6d6388b74c4",
                        "cellValue": "PE.1.131 - PE.1.134",
                        "linkTarget": "step",
                        "linkLabel": "PE.1.134  üí° Control and manage physical access devices.",
                        "preText": "Go to >",
                        "style": "link"
                      },
                      {
                        "id": "bf9741ed-a8d5-441d-a0b2-013e64634cb9",
                        "cellValue": "PE.1.131 - PE.1.134",
                        "linkTarget": "step",
                        "linkLabel": "PE.2.135 üí° Protect and monitor the physical facility and support infrastructure for organizational systems.",
                        "preText": "Go to >",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML1 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "PE.1.131 > PE.2.135",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## PE.1.131 üí° Limit physical access to organizational information systems, <br>equipment and the respective operating environments to authorized individuals (ML-1)\r\n## PE.1.132 üí° Escort visitors and monitor visitor activity (ML-1)\r\n## PE.1.133 üí° Maintain audit logs of physical access (ML-1)\r\n## PE.1.134 üí° Control and manage physical access devices (ML-1)\r\n## PE.2.135 üí° Protect and monitor the physical facility and support infrastructure for organizational systems (ML-2)\r\n\r\n## Recommended References\r\nüí° [Azure Facilities, Premises, and Physical Security](https://docs.microsoft.com/azure/security/fundamentals/physical-security)<br>\r\nüí° [Management and Operation of the Azure Production Network](https://docs.microsoft.com/azure/security/fundamentals/infrastructure-operations)<br>\r\nüí° [Azure Infrastructure Availability](https://docs.microsoft.com/azure/security/fundamentals/infrastructure-availability) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.10.1, 3.10.2, 3.10.3, 3.10.4, 3.10.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[PE-2, PE-3, PE-6](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "45",
                        "name": "text - 0"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "customWidth": "5",
                        "name": "text - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### üü¶ Azure Datacenters: Physical Security\r\n![Image¬†Name](https://stp-api-cdn-prod.azureedge.net/api/Images/e5724a10-491a-11e8-9fe5-75d16dd56b03?hash=7AC632B242A298BFB2E2CFF3968117CFDA3A33AB0A50B1FCBD565C0F6D1DBCB6¬†¬†\"Physical Security Controls\")[Go To: Azure Physical Security >](https://docs.microsoft.com/azure/security/fundamentals/physical-security)¬†\r\n"
                        },
                        "customWidth": "45",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "45"
                        }
                      }
                    ]
                  },
                  "name": "PE.1.131 > PE.2.135",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 1: Performed / Basic Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "PE.3.136",
                        "linkTarget": "step",
                        "linkLabel": "PE.3.136 üí° Enforce safeguarding measures for CUI at alternate work sites.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "PE.3.136",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Enforce safeguarding measures for CUI <br>at alternate work sites (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Azure Global Infrastructure](https://azure.microsoft.com/global-infrastructure/)   üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Named Locations](https://docs.microsoft.com/azure/active-directory/conditional-access/location-condition)   üîÄ[Azure AD Named Locations](https://portal.azure.com/#blade/Microsoft_AAD_IAM/NamedNetworksWithCountryBlade)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.10.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[PE-17](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| extend UserPrincipalName = UserId_s_s\r\n| where LabelName_s <> \"\"\r\n| join (SigninLogs) on UserPrincipalName\r\n| extend City = tostring(LocationDetails.city)\r\n| extend State = tostring(LocationDetails.state)\r\n| extend Country_Region = tostring(LocationDetails.countryOrRegion)\r\n| summarize count() by UserPrincipalName, LabelName_s, Activity_s, City, State, Country_Region\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Monitor Geolocation of Sensitive Data Access",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Activity_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "pending",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "City",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Country_Region",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "InformationProtectionLogs_CL\r\n| extend UserPrincipalName = UserId_s_s\r\n| where LabelName_s <> \"\"\r\n| join (SigninLogs) on UserPrincipalName\r\n\r\n\r\n",
                          "size": 3,
                          "showAnalytics": true,
                          "title": "üü¶ Monitor Geolocation of Sensitive Data Access",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "map",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Activity_s",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "pending",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "City",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Country_Region",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Globe",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ]
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "orange"
                                }
                              ]
                            }
                          }
                        },
                        "name": "query - 1 - Copy"
                      }
                    ]
                  },
                  "name": "PE.3.136",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isPEVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Physical Protection",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Recovery\r\n---\r\nRecovery Management includes processes and procedures aligned to recovering from a disaster and ensuring business continuity.¬†The Recovery Control family includes 10 controls. These controls have varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibility. For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "RE.2.137",
                        "linkTarget": "step",
                        "linkLabel": "RE.2.137 üí° Regularly perform and test data back-ups.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "RE.2.138",
                        "linkTarget": "step",
                        "linkLabel": "RE.2.138 üí° Protect the confidentiality of backup CUI at storage locations.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "RE.2.137",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Regularly perform and test data back-ups (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#regularly-perform-and-test-data-back-ups)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Backup](https://azure.microsoft.com/services/backup/)  üîÄ[Backup Center](https://portal.azure.com/#blade/Microsoft_Azure_DataProtection/BackupCenterMenuBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Site Recovery](https://azure.microsoft.com/services/site-recovery/)  üîÄ [Recovery Services Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.RecoveryServices%2Fvaults)<br>\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Microsoft Information Protection](https://www.microsoft.com/security/business/compliance/information-protection)    üîÄ[Microsoft Information Protection](https://compliance.microsoft.com/informationprotection)<br\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Backup](https://azure.microsoft.com/services/backup/) <br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CP-9, CP-9(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"recover\" or type contains \"restore\" or id contains \"recover\" or id contains \"back\" \r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Backup/Restore Assets",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "RE.2.137",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "RE.2.138",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Protect the confidentiality of backup CUI at <br>storage locations (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/) \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.8.9](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CP-9](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"key\" or type contains \"crypt\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Key Vault Assets",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "RE.2.138",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                        },
                        "customWidth": "25",
                        "name": "text - 1"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "customWidth": "5",
                        "name": "text - 1"
                      },
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "list",
                          "links": [
                            {
                              "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                              "cellValue": "RE.3.139",
                              "linkTarget": "step",
                              "linkLabel": "RE.3.139 üí° Regularly perform complete, comprehensive and resilient data backups as organizationally-defined.",
                              "preText": "Go to >",
                              "postText": "",
                              "style": "link"
                            }
                          ]
                        },
                        "customWidth": "70",
                        "name": "ML3 Steps"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "RE.3.139",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# [Regularly perform complete, comprehensive and resilient data backups as organizationally-defined (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#regularly-perform-complete-comprehensive-and-resilient-data-backups-as-organizationally-defined)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Backup](https://azure.microsoft.com/services/backup/)  üîÄ[Backup Center](https://portal.azure.com/#blade/Microsoft_Azure_DataProtection/BackupCenterMenuBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Site Recovery](https://azure.microsoft.com/services/site-recovery/)  üîÄ [Recovery Services Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.RecoveryServices%2Fvaults)<br>\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Microsoft Information Protection](https://www.microsoft.com/security/business/compliance/information-protection)    üîÄ[Microsoft Information Protection](https://compliance.microsoft.com/informationprotection)<br\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br>  \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CP-9, CP-9(3), CP-9(5)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 0",
                              "styleSettings": {
                                "maxWidth": "50"
                              }
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"RE.3.139\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                                "size": 0,
                                "showAnalytics": true,
                                "title": "üü¶ CMMC Assessment Details for RE.3.139",
                                "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Workspace}"
                                ],
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "RecommendationDisplayName",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "warning",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "Severity",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "colors",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High",
                                            "representation": "redBright",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Medium",
                                            "representation": "orange",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low",
                                            "representation": "yellow",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "blue",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "State",
                                      "formatter": 1
                                    },
                                    {
                                      "columnMatch": "ControlID",
                                      "formatter": 1
                                    },
                                    {
                                      "columnMatch": "Recommendation",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "Url",
                                        "linkLabel": "Go to Recommendation >"
                                      }
                                    },
                                    {
                                      "columnMatch": "statusChangeDate",
                                      "formatter": 6
                                    },
                                    {
                                      "columnMatch": "firstEvaluationDate",
                                      "formatter": 6
                                    }
                                  ],
                                  "filter": true
                                },
                                "sortBy": [],
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "RecommendationName",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "query - 4"
                            }
                          ]
                        },
                        "name": "RE.3.139",
                        "styleSettings": {
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isML3Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isREVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Recovery Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Risk Management\r\n---\r\nRisk Management ensures a consistent approach to the identification, mitigation, and response to security risks. The Risk Management Control family includes 17 controls. These controls have varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibility.¬†For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "RM.2.141",
                        "linkTarget": "step",
                        "linkLabel": "RM.2.141 üí° Periodically assess the risk to organizational operations, assets and individuals, operation of organizational systems and the associated processing, storage or transmission of CUI.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "RM.2.142",
                        "linkTarget": "step",
                        "linkLabel": "RM.2.142 üí° Scan for vulnerabilities in organizational systems and applications periodically and when new vulnerabilities affecting those systems and applications are identified.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "f7074cad-e2ec-4a2c-84d1-7b33b14d4c04",
                        "cellValue": "RM.2.143",
                        "linkTarget": "step",
                        "linkLabel": "RM.2.143 üí° Remediate vulnerabilities in accordance with risk assessments.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "RM.2.141",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Periodically assess the risk to organizational operations (including mission, functions, image or reputation), organizational assets and individuals, resulting from the operation of organizational systems and the associated processing, storage or transmission of CUI (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#periodically-assess-the-risk-to-organizational-operations-including-mission-functions-image-or-reputation-organizational-assets-and-individuals-resulting-from-the-operation-of-organizational-systems-and-the-associated-processing-storage-or-transmission-of-cui)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   üîÄ[Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityScore](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securescores) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br>  \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.11.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[RA-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityRecommendation\r\n| make-series count() default=0 on DiscoveredTimeUTC from {TimeRange:start} to {TimeRange:end} step 1d by RecommendationSeverity",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Azure Security Center: Recommendations over Time by Severity",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "timechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Medium",
                                "color": "yellow"
                              },
                              {
                                "seriesName": "High",
                                "color": "redBright"
                              },
                              {
                                "seriesName": "Low",
                                "color": "blueDark"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "RM.2.141",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "RM.2.142",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Scan for vulnerabilities in organizational systems and applications periodically and when new vulnerabilities affecting those systems and applications are identified (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#scan-for-vulnerabilities-in-organizational-systems-and-applications-periodically-and-when-new-vulnerabilities-affecting-those-systems-and-applications-are-identified)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   üîÄ[Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n‚ú≥Ô∏è [GitHub Advanced Security](https://docs.github.com/en/get-started/learning-about-github/about-github-advanced-security)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure DNS](https://azure.microsoft.com/services/dns/)   üîÄ[DNS Zones](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityBaseline](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securitybaseline) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.11.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[RA-5, RA-5(5)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityBaseline\r\n| where CceId <> \"\"\r\n| summarize count() by CceId, Description\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Securty Baseline Vulnerabilities",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "CceId",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Description",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "RuleSeverity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Critical",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Warning",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "‚ÄãInformational",
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Resource",
                                "formatter": 0,
                                "formatOptions": {
                                  "aggregation": "Count"
                                }
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "CceId"
                              },
                              {
                                "columnId": "Description"
                              }
                            ]
                          },
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Medium",
                                "color": "yellow"
                              },
                              {
                                "seriesName": "High",
                                "color": "redBright"
                              },
                              {
                                "seriesName": "Low",
                                "color": "blueDark"
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "RM.2.142",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "RM.2.143",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Remediate vulnerabilities in accordance with risk assessments (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#remediate-vulnerabilities-in-accordance-with-risk-assessments)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [GitHub Advanced Security](https://docs.github.com/en/get-started/learning-about-github/about-github-advanced-security)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   üîÄ[Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.11.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[RA-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"RM.2.143\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for RM.2.143",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "RM.2.143",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                              },
                              "customWidth": "25",
                              "name": "text - 1"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": ""
                              },
                              "customWidth": "5",
                              "name": "text - 1"
                            },
                            {
                              "type": 11,
                              "content": {
                                "version": "LinkItem/1.0",
                                "style": "list",
                                "links": [
                                  {
                                    "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                                    "cellValue": "RM.3.144",
                                    "linkTarget": "step",
                                    "linkLabel": "RM.3.144 üí° Periodically perform risk assessments to identify and prioritize risks according to the defined risk categories, risk sources and risk measurement criteria.",
                                    "preText": "Go to >",
                                    "postText": "",
                                    "style": "link"
                                  }
                                ]
                              },
                              "customWidth": "70",
                              "name": "ML3 Steps"
                            },
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "title": "RM.3.144",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "# [Periodically perform risk assessments to identify and prioritize risks according to the defined risk categories, risk sources and risk measurement criteria (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#periodically-perform-risk-assessments-to-identify-and-prioritize-risks-according-to-the-defined-risk-categories-risk-sources-and-risk-measurement-criteria)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CA-2, PM-9, RA-3, SA-20](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 0",
                                    "styleSettings": {
                                      "maxWidth": "50"
                                    }
                                  },
                                  {
                                    "type": 3,
                                    "content": {
                                      "version": "KqlItem/1.0",
                                      "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"RM.3.144\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                                      "size": 0,
                                      "showAnalytics": true,
                                      "title": "üü¶ CMMC Assessment Details for RM.3.144",
                                      "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                                      "showExportToExcel": true,
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "crossComponentResources": [
                                        "{Workspace}"
                                      ],
                                      "gridSettings": {
                                        "formatters": [
                                          {
                                            "columnMatch": "RecommendationDisplayName",
                                            "formatter": 18,
                                            "formatOptions": {
                                              "thresholdsOptions": "icons",
                                              "thresholdsGrid": [
                                                {
                                                  "operator": "Default",
                                                  "thresholdValue": null,
                                                  "representation": "warning",
                                                  "text": "{0}{1}"
                                                }
                                              ]
                                            }
                                          },
                                          {
                                            "columnMatch": "Severity",
                                            "formatter": 18,
                                            "formatOptions": {
                                              "thresholdsOptions": "colors",
                                              "thresholdsGrid": [
                                                {
                                                  "operator": "==",
                                                  "thresholdValue": "High",
                                                  "representation": "redBright",
                                                  "text": "{0}{1}"
                                                },
                                                {
                                                  "operator": "==",
                                                  "thresholdValue": "Medium",
                                                  "representation": "orange",
                                                  "text": "{0}{1}"
                                                },
                                                {
                                                  "operator": "==",
                                                  "thresholdValue": "Low",
                                                  "representation": "yellow",
                                                  "text": "{0}{1}"
                                                },
                                                {
                                                  "operator": "Default",
                                                  "thresholdValue": null,
                                                  "representation": "blue",
                                                  "text": "{0}{1}"
                                                }
                                              ]
                                            }
                                          },
                                          {
                                            "columnMatch": "State",
                                            "formatter": 1
                                          },
                                          {
                                            "columnMatch": "ControlID",
                                            "formatter": 1
                                          },
                                          {
                                            "columnMatch": "Recommendation",
                                            "formatter": 7,
                                            "formatOptions": {
                                              "linkTarget": "Url",
                                              "linkLabel": "Go to Recommendation >"
                                            }
                                          },
                                          {
                                            "columnMatch": "statusChangeDate",
                                            "formatter": 6
                                          },
                                          {
                                            "columnMatch": "firstEvaluationDate",
                                            "formatter": 6
                                          }
                                        ],
                                        "filter": true
                                      },
                                      "sortBy": [],
                                      "tileSettings": {
                                        "showBorder": false,
                                        "titleContent": {
                                          "columnMatch": "RecommendationName",
                                          "formatter": 1
                                        },
                                        "leftContent": {
                                          "columnMatch": "count_",
                                          "formatter": 12,
                                          "formatOptions": {
                                            "palette": "auto"
                                          },
                                          "numberFormat": {
                                            "unit": 17,
                                            "options": {
                                              "maximumSignificantDigits": 3,
                                              "maximumFractionDigits": 2
                                            }
                                          }
                                        }
                                      }
                                    },
                                    "customWidth": "50",
                                    "name": "query - 4"
                                  }
                                ]
                              },
                              "name": "RM.3.144",
                              "styleSettings": {
                                "showBorder": true
                              }
                            },
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "###¬†Risk Management¬†(Not¬†Included¬†in¬†Workbook)\r\n|¬†Risk Management¬†|\r\n|¬†:¬†|¬†:¬†| :¬†|\r\n|¬†Maturity Level¬†| Control #¬†|¬†Requirement¬†|¬†\r\n|¬†ML-3¬†|¬†RM.3.146 | Develop and implement risk mitigation plans. | \r\n|¬†ML-3¬†|¬†RM.3.147 | Manage non-vendor-supported products (e.g., end of life) separately and restrict as necessary to reduce risk. |\r\nFor more information, see üí°¬†[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 1"
                                  }
                                ]
                              },
                              "name": "ML3 Not Covered"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "isML3Visible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isML2Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isRMVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Risk Management Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Security Assessment\r\n---\r\nSecurity Assessment includes periodic evaluation of security controls for effectiveness. The Security Assessment Control family includes 13 controls. These controls have varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibilityFor more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "099484fd-2dc9-4c76-8ba8-df7726fa117e",
                        "cellValue": "CA.2.157",
                        "linkTarget": "step",
                        "linkLabel": "CA.2.157 üí° Develop, document and periodically update System Security Plans (SSPs) ",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "CA.2.158",
                        "linkTarget": "step",
                        "linkLabel": "CA.2.158 üí° Periodically assess the security controls in organizational systems to determine if the controls are effective in their application.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "d94ce568-dbf0-46d9-9846-e8012a05682f",
                        "cellValue": "CA.2.159",
                        "linkTarget": "step",
                        "linkLabel": "CA.2.159 üí° Develop and implement plans of action (e.g., POA&M) designed to correct deficiencies.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CA.2.157",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Develop, document and periodically update System Security Plans (SSPs) that describe system boundaries, system environments of operation, how security requirements are implemented and the relationships with or connections to other systems (ML-2)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Defender](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Defender](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Recommended Resources\r\nüí°  [Understanding Network Map](https://docs.microsoft.com/azure/security-center/security-center-network-recommendations#understanding-the-network-map)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.12.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CA-2, CA-5, CA-7, PL-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### üü¶ Network Map\r\n![Image¬†Name](https://docs.microsoft.com/azure/security-center/media/security-center-network-recommendations/network-map-traffic.png)¬†\r\n[Go To: Azure Defender Network Map >](https://portal.azure.com/#blade/Microsoft_Azure_Security_R3/NetworkMapBlade)\r\n"
                        },
                        "customWidth": "45",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "45"
                        }
                      }
                    ]
                  },
                  "name": "CA.2.157",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CA.2.158",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Periodically assess the security controls in organizational systems to determine if the controls are effective in their application (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#periodically-assess-the-security-controls-in-organizational-systems-to-determine-if-the-controls-are-effective-in-their-application)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.12.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CA-2, CA-5, CA-7, PL-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"CA.2.158\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for CA.2.158",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "CA.2.158 ",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CA.2.159",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Develop and implement plans of action (e.g., POA&M) designed to correct deficiencies and reduce or eliminate vulnerabilities in organizational systems (ML-2)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.12.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CA-2, CA-5, CA-7, PL-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | summarize count() by ResourceID, ResourceType\r\n    | sort by count_ desc\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Security Recommendations by Asset (Roadmap Priorities)",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ResourceID",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "ResourceType",
                                "formatter": 16,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "CA.2.159",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "CA.3.161",
                        "linkTarget": "step",
                        "linkLabel": "CA.3.161 üí° Monitor security controls on an ongoing basis to ensure the continued effectiveness of the controls.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "76cbfe79-43ca-45f1-894b-559a2d87b8d5",
                        "cellValue": "CA.3.162",
                        "linkTarget": "step",
                        "linkLabel": "CA.3.162 üí° Employ a security assessment of enterprise software that has been developed internally, for internal use, and that has been organizationally-defined as an area of risk.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CA.3.161",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Monitor security controls on an ongoing basis to ensure the continued effectiveness of the controls (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#monitor-security-controls-on-an-ongoing-basis-to-ensure-the-continued-effectiveness-of-the-controls)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   üîÄ[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.12.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[CA-2, CA-5, CA-7, PL-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by ProductName",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Monitor Security Controls for Efficiency",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "visualization": "areachart"
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      }
                    ]
                  },
                  "name": "CA.3.161",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CA.3.162",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Employ a security assessment of enterprise software that has been developed internally, for internal use, and that has been organizationally-defined as an area of risk (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [GitHub Advanced Security](https://docs.github.com/en/get-started/learning-about-github/about-github-advanced-security)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n\r\n## Recommended Resources\r\nüí° [GitHub: Code Scanning](https://docs.github.com/en/github-ae@latest/github/finding-security-vulnerabilities-and-errors-in-your-code/about-code-scanning)<br>\r\nüí° [GitHub: Secret Scanning](https://docs.github.com/en/github-ae@latest/github/administering-a-repository/about-secret-scanning)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SA-11, SA-11(8)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### üü¶ GitHub: Code Scanning & Secret Scanning\r\n![Image¬†Name](https://docs.github.com/assets/images/enterprise/github-ae/repository/enable-ghas-ghae.png)¬†<br>\r\n[Go To: GitHub (Code Security) >](https://docs.github.com/en/github-ae@latest/code-security)\r\n"
                        },
                        "customWidth": "45",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "45"
                        }
                      }
                    ]
                  },
                  "name": "CA.3.162",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isCAVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Security Assessment Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Situational Awareness\r\n---\r\nSituational Awareness is grounded in cyber threat intelligence programs including ingestion, reporting, and sharing. The Situational Awareness Control family includes 8 controls. These controls have varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibilityFor more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "SA.3.169",
                        "linkTarget": "step",
                        "linkLabel": "SA.3.169 üí° Receive and respond to cyber threat intelligence from information sharing forums and sources and communicate to stakeholders.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SA.3.169",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Receive and respond to cyber threat intelligence from information sharing forums and sources and communicate to stakeholders (ML-3)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n\r\n## Recommended Logs\r\nüî∑ [ThreatIntelligenceIndicator](https://docs.microsoft.com/azure/azure-monitor/reference/tables/threatintelligenceindicator) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n## Recommended Resources\r\nüí° [Azure Sentinel lets you import the threat indicators](https://docs.microsoft.com/azure/architecture/example-scenario/data/sentinel-threat-intelligence)<br>\r\nüí° [Connect data from threat intelligence providers](https://docs.microsoft.com/azure/sentinel/connect-threat-intelligence)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[PM-16](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ThreatIntelligenceIndicator\r\n| where TimeGenerated < now()\r\nand ExpirationDateTime > now()\r\nand Active == true\r\n| summarize count() by SourceSystem, ThreatType\r\n| sort by count_ desc\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Cyber Threat Intelligence: Active Indicator Counts",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "SourceSystem",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "PowerUp",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ThreatType",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "AzureQuickstart",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      }
                    ]
                  },
                  "name": "SA.3.169",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isSAVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Situational Awareness Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# System & Communications Protection\r\n---\r\nSystem & Communications Protection includes network security for administrative and management functions. The System & Communications Protection Control family includes 32 controls which varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibility. ¬†For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 1: Performed / Basic Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 1 requires that an organization performs specified practices. Because the organization may only be able to perform these practices in an ad-hoc manner and may or may not rely on documentation, process maturity is not assessed for Level 1."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 2"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "SC.1.175",
                        "linkTarget": "step",
                        "linkLabel": "SC.1.175   üí° Monitor, control and protect organizational communications at the external boundaries and key internal boundaries of the information systems.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "c64247a3-06f1-46af-bdae-bc852cb789ce",
                        "cellValue": "SC.1.176",
                        "linkTarget": "step",
                        "linkLabel": "SC.1.176   üí° Implement subnetworks for publicly accessible system components that are physically or logically separated from internal networks.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML1 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.1.175",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Monitor, control and protect organizational communications (e.g., information transmitted or received by organizational information systems) at the external boundaries and key internal boundaries of the information systems (ML-1)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#monitor-control-and-protect-communications-ie-information-transmitted-or-received-by-organizational-systems-at-the-external-boundaries-and-key-internal-boundaries-of-organizational-systems)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/)   üîÄ[ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)   üîÄ[Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Customer Lockbox](https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview)   üîÄ[Customer Lockbox](https://portal.azure.com/#blade/Microsoft_Azure_Lockbox/LockboxMenu/Overview)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-7, SA-8](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"SC.1.175\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for SC.1.175",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "SC.1.175",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.1.176",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Implement subnetworks for publicly accessible system components that are physically or logically separated from internal networks (ML-1)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#implement-subnetworks-for-publicly-accessible-system-components-that-are-physically-or-logically-separated-from-internal-networks)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-7](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"microsoft.network/\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Network Asset Listing",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "SC.1.176",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 1: Performed / Basic Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "SC.2.178",
                        "linkTarget": "step",
                        "linkLabel": "SC.2.178 üí° Prohibit remote activation of collaborative computing devices and provide indication of devices in use to users present at the device.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cca4d1e8-e1e2-4b1d-9b8a-698e6496924c",
                        "cellValue": "SC.2.179",
                        "linkTarget": "step",
                        "linkLabel": "SC.2.179 üí° Use encrypted sessions for the management of network devices.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.2.178",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Prohibit remote activation of collaborative computing devices and provide indication of devices in use to users present at the device <br>(ML-2)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Resources\r\nüí° [Group Policy](https://docs.microsoft.com/windows/security/identity-protection/hello-for-business/hello-cert-trust-policy-settings)<br>\r\nüí° [Intune/Microsoft Endpoint Manager policy](https://docs.microsoft.com/mem/intune/protect/windows-hello)<br>\r\nüí° [Windows Hello biometrics in the enterprise](https://docs.microsoft.com/windows/security/identity-protection/hello-for-business/hello-biometrics-in-enterprise)<br>\r\nüí° [View Connected Devices](https://docs.microsoft.com/azure/active-directory/user-help/my-account-portal-devices-page#view-your-connected-devices)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Event](https://docs.microsoft.com/azure/azure-monitor/reference/tables/event) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.12](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-15](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Event\r\n| where TimeGenerated > ago(90d)\r\n| where RenderedDescription contains \"Windows Hello\"\r\n| summarize count() by _ResourceId, EventLevelName, RenderedDescription, EventID\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Configure Windows Hello for Collaborative Computing Devices& Monitor Event Logs",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "SC.2.178",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.2.179",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "#  [Use encrypted sessions for the management of network devices (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#use-encrypted-sessions-for-the-management-of-network-devices)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"SC.2.179\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for SC.2.179",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "SC.2.179",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "SC.3.177",
                        "linkTarget": "step",
                        "linkLabel": "SC.3.177 üí° Employ FIPS-validated cryptography when used to protect the confidentiality of CUI.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "e391b908-4b08-46ce-b5ba-129d9905dd98",
                        "cellValue": "SC.3.180",
                        "linkTarget": "step",
                        "linkLabel": "SC.3.180 üí° Employ architectural designs, software development techniques and systems engineering principles that promote effective information security within organizational systems.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "2eaf74ad-7c2f-42ae-9ea0-ef223dd2b7e8",
                        "cellValue": "SC.3.181",
                        "linkTarget": "step",
                        "linkLabel": "SC.3.181 üí° Separate user functionality from system management functionality.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "2885a56b-abb8-4cc5-a945-8cfe0786d160",
                        "cellValue": "SC.3.183 ",
                        "linkTarget": "step",
                        "linkLabel": "SC.3.183 üí° Deny network communications traffic by default and allow network communications traffic by exception (e.g., deny all, permit by exception).",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "81a446a5-4409-4152-a958-116936cee2b4",
                        "cellValue": "SC.3.185",
                        "linkTarget": "step",
                        "linkLabel": "SC.3.185 üí° Implement cryptographic mechanisms to prevent unauthorized disclosure of CUI during transmission unless otherwise protected by alternative physical safeguards.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "ce448438-09a8-428d-9187-c34880fa323d",
                        "cellValue": "SC.3.187",
                        "linkTarget": "step",
                        "linkLabel": "SC.3.187 üí° Establish and manage cryptographic keys for cryptography employed in organizational systems.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cd62a74b-086f-4e9f-8f89-059b969c692d",
                        "cellValue": "SC.3.188",
                        "linkTarget": "step",
                        "linkLabel": "SC.3.188 üí° Control and monitor the use of mobile code.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "88caef2e-6d4c-4d8d-b3e4-70c58f384c5d",
                        "cellValue": "SC.3.189",
                        "linkTarget": "step",
                        "linkLabel": "SC.3.189 üí° Control and monitor the use of Voice over Internet Protocol (VoIP) technologies.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "594c1cfd-447f-4616-9351-cb45d5429f11",
                        "cellValue": "SC.3.190",
                        "linkTarget": "step",
                        "linkLabel": "SC.3.190 üí° Protect the authenticity of communications sessions.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "47e4f75f-5597-4228-8383-5fc04d1280b5",
                        "cellValue": "SC.3.191 ",
                        "linkTarget": "step",
                        "linkLabel": "SC.3.191 üí° Protect the confidentiality of CUI at rest.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "1b136378-f814-40be-bfd2-bad330023058",
                        "cellValue": "SC.3.192",
                        "linkTarget": "step",
                        "linkLabel": "SC.3.192 üí° Implement Domain Name System (DNS) filtering services.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.3.177",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "#  [Employ FIPS-validated cryptography when used to protect the confidentiality of CUI (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#employ-fips-validated-cryptography-when-used-to-protect-the-confidentiality-of-cui)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   üîÄ[GitHub](https://github.com/)<br>\r\n\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.11](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-13](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"key\" or type contains \"crypt\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Key Vault & Crytographic Assets Listing",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "SC.3.177",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.3.180",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Employ architectural designs, software development techniques, and systems engineering principles that promote effective information security within organizational systems (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#employ-architectural-designs-software-development-techniques-and-systems-engineering-principles-that-promote-effective-information-security-within-organizational-systems)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-7, SA-8](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"SC.3.180\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for SC.3.180",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "SC.3.180",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.3.181",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Separate user functionality from system management functionality (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#separate-user-functionality-from-system-management-functionality)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AADManagedIdentitySignInLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/aadmanagedidentitysigninlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-2](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AADManagedIdentitySignInLogs\r\n| summarize count() by ServicePrincipalName, ResourceDisplayName\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Azure Active Directory: Managed Identities",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ServicePrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "SC.3.181",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.3.183 ",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Deny network communications traffic by default and allow network communications traffic by exception (i.e., deny all, permit by exception)(ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#deny-network-communications-traffic-by-default-and-allow-network-communications-traffic-by-exception-ie-deny-all-permit-by-exception)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [AzureDiagnostics]https://docs.microsoft.com/azure/azure-monitor/reference/tables/azurediagnostics) ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-7(5)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AzureDiagnostics\r\n| where Category == \"AzureFirewallApplicationRule\"\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePortInt:int \" \" TempDetails\r\n| parse TempDetails with \"was \" Action1 \". Reason: \" Rule1\r\n| parse TempDetails with \"to \" FQDN \":\" TargetPortInt:int \". Action: \" Action2 \".\" *\r\n| parse TempDetails with * \". Rule Collection: \" RuleCollection2a \". Rule:\" Rule2a\r\n| parse TempDetails with * \"Deny.\" RuleCollection2b \". Proceeding with\" Rule2b\r\n| extend SourcePort = tostring(SourcePortInt)\r\n| extend TargetPort = tostring(TargetPortInt)\r\n| extend Action1 = case(Action1 == \"Deny\",\"Deny\",\"Unknown Action\")\r\n| extend Action = case(Action2 == \"\",Action1,Action2),Rule = case(Rule2a == \"\", case(Rule1 == \"\",case(Rule2b == \"\",\"N/A\", Rule2b),Rule1),Rule2a), \r\nRuleCollection = case(RuleCollection2b == \"\",case(RuleCollection2a == \"\",\"No rule matched\",RuleCollection2a), RuleCollection2b),FQDN = case(FQDN == \"\", \"N/A\", FQDN),TargetPort = case(TargetPort == \"\", \"N/A\", TargetPort)\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by Action\r\n| render timechart ",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Azure Firewall: Action Count by Time",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ]
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "SC.3.183 ",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.3.185",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Implement cryptographic mechanisms to prevent unauthorized disclosure of CUI during transmission unless otherwise protected by alternative physical safeguards (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#implement-cryptographic-mechanisms-to-prevent-unauthorized-disclosure-of-cui-during-transmission-unless-otherwise-protected-by-alternative-physical-safeguards)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n\r\n\r\n# Secondary Services\r\n‚ú≥Ô∏è [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/)   üîÄ[ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits)<br>\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)   üîÄ[Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Information Protection](https://www.microsoft.com/security/business/compliance/information-protection)    üîÄ[Microsoft Information Protection](https://compliance.microsoft.com/informationprotection)<br\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.8](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-8, SC-8(1)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"SC.3.185\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for SC.3.185",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "SC.3.185",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.3.187",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Establish and manage cryptographic keys for cryptography employed in organizational systems (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#establish-and-manage-cryptographic-keys-for-cryptography-employed-in-organizational-systems)\r\n\r\n# Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [GitHub Enterprise Cloud](https://github.com/enterprise)   üîÄ[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n\r\n# Secondary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.10](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-12](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"SC.3.187\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for SC.3.187",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "SC.3.187",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.3.188",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Control and monitor the use of mobile code (ML-3)\r\n\r\n# Primary Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n# Secondary Services\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [DeviceFileEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/devicefileevents) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.13](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-18](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "DeviceFileEvents\r\n| where FileName contains \".pdf\" or FileName contains \".vbx\" or FileName contains \"java\" or FileName contains \".dcr\"\r\n| summarize count() by ActionType, FileName\r\n| sort by count_ desc \r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Control and Monitor the Use of Mobile Code",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ActionType",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "File",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "SC.3.188",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.3.189",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Control and monitor the use of Voice over Internet Protocol (VoIP) technologies (ML-3)\r\n\r\n# Secondary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [OfficeActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/officeactivity) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.14](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-19](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "OfficeActivity\r\n| where RecordType == \"MicrosoftTeams\"\r\n| summarize count() by RecordType, Operation, UserId\r\n| sort by count_ desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Control & Monitor Microsoft Teams Activity",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecordType",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Connect",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "UserId",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "SC.3.189",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.3.190",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Protect the authenticity of communications sessions (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#protect-the-authenticity-of-communications-sessions)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    üîÄ[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n\r\n# Secondary Services\r\n‚ú≥Ô∏è [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/)   üîÄ[ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits)<br>\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)   üîÄ[Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.15](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-23](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"SC.3.190\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for SC.3.190",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "SC.3.190",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.3.191",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Protect the confidentiality of CUI at rest (ML-3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#protect-the-confidentiality-of-cui-at-rest)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n\r\n# Secondary Services\r\n‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)   üîÄ[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    üîÄ[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.13.16](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-28](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"SC.3.191\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for SC.3.191",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "SC.3.191 ",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SC.3.192",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Implement Domain Name System (DNS) filtering services (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Azure DNS](https://azure.microsoft.com/services/dns/)   üîÄ[DNS Zones](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure DNS](https://azure.microsoft.com/services/dns/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AC-4(8), SC-20](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "AzureDiagnostics \r\n| where Category == \"AzureFirewallApplicationRule\"\r\n| where Resource in (split(\"SOC-NS-FW\", \", \"))\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePortInt: int \" \" TempDetails \r\n| parse TempDetails with \"was \" Action1 \". Reason: \" Rule1 \r\n| parse TempDetails with \"to \" FQDN \":\" TargetPortInt: int \". Action: \" Action2 \".\" * \r\n| parse TempDetails with * \". Rule Collection: \" RuleCollection2a \". Rule:\" Rule2a \r\n| parse TempDetails with * \"Deny.\" RuleCollection2b \". Proceeding with\" Rule2b \r\n| extend SourcePort = tostring(SourcePortInt) \r\n| extend TargetPort = tostring(TargetPortInt) \r\n| extend Action1 = case(Action1 == \"denied\", \"Deny\", \"Unknown Action\") \r\n| extend Action = case(Action2 == \"\", Action1, Action2), Rule = case(Rule2a == \"\", case(Rule1 == \"\", case(Rule2b == \"\", \"N/A\", Rule2b), Rule1), Rule2a), RuleCollection = case(RuleCollection2b == \"\", case(RuleCollection2a == \"\", \"No rule matched\", RuleCollection2a), RuleCollection2b), FQDN = case(FQDN == \"\", \"N/A\", FQDN), TargetPort = case(TargetPort == \"\", \"N/A\", TargetPort)\r\n| where Action == \"Deny\"\r\n| where '*' == SourceIP or '*' == \"*\"  \r\n| summarize count() by FQDN\r\n| sort by count_ desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Azure Firewall: Blocked FQDNs",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "FQDN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "failed",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "SC.3.192",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 1,
                  "content": {
                    "json": "###¬†System & Communications Protection¬†(Not¬†Included¬†in¬†Workbook)\r\n|¬†System & Communications Protection¬†|\r\n|¬†:¬†|¬†:¬†| :¬†|\r\n|¬†Maturity Level¬†| Control #¬†|¬†Requirement¬†|¬†\r\n|¬†ML-3¬†|¬†SC.3.182 | Prevent unauthorized and unintended information transfer via shared system resources. | \r\n|¬†ML-3¬†|¬†SC.3.184 | Prevent remote devices from simultaneously establishing non-remote connections with organizational systems and communicating via some other connection to resources in external networks (i.e., split tunneling). |\r\n|¬†ML-3¬†|¬†SC.3.186 | Terminate network connections associated with communications sessions at the end of the sessions or after a defined period of inactivity. |\r\n|¬†ML-3¬†|¬†SC.3.193 | Implement a policy restricting the publication of CUI on externally-owned, publicly-accessible websites (e.g., forums, LinkedIn, Facebook, Twitter, etc.). |\r\nFor more information, see üí°¬†[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
                  },
                  "customWidth": "50",
                  "name": "text - 1"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isSCVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "System & Communications Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# System & Information Integrity\r\n---\r\nSystem & Information Integrity includes controls to identify system flaws, combat malware, and identify anomalies. The System & Information Integrity Control family includes 18 controls which varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibility.¬†For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment üí°[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)"
            },
            "customWidth": "50",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 1: Performed / Basic Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 1 requires that an organization performs specified practices. Because the organization may only be able to perform these practices in an ad-hoc manner and may or may not rely on documentation, process maturity is not assessed for Level 1."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 2"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "SI.1.210",
                        "linkTarget": "step",
                        "linkLabel": "SI.1.210  üí° Identify, report and correct information and information system flaws in a timely manner.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "cc953797-1e63-4908-b327-696b9852e011",
                        "cellValue": "SI.1.211",
                        "linkTarget": "step",
                        "linkLabel": "SI.1.211  üí° Provide protection from malicious code at appropriate locations within organizational information systems.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "a9af4f42-5e43-480e-b684-94903ea3ab1a",
                        "cellValue": "SI.1.212",
                        "linkTarget": "step",
                        "linkLabel": "SI.1.212  üí° Update malicious code protection mechanisms when new releases are available.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "591eebe3-fee7-4d51-825e-1651c99d5761",
                        "cellValue": "SI.1.213",
                        "linkTarget": "step",
                        "linkLabel": "SI.1.213  üí° Perform periodic scans of the information system and real-time scans of files from external sources as files are downloaded, opened or executed.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML1 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SI.1.210",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Identify, report and correct information and information system flaws in a timely manner (ML-1)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#identify-report-and-correct-information-and-information-system-flaws-in-a-timely-manner)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.1](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SI-2, SI-3, SI-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"SI.1.210\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for SI.1.210",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "SI.1.210",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SI.1.211",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Provide protection from malicious code at appropriate locations within organizational information systems (ML-1)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#provide-protection-from-malicious-code-at-appropriate-locations-within-organizational-information-systems)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   üîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure DNS](https://azure.microsoft.com/services/dns/)   üîÄ[DNS Zones](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.2](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SI-2, SI-3, SI-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"SI.1.211\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for SI.1.211",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "rowLimit": 50,
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "SI.1.211",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SI.1.212",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Update malicious code protection mechanisms when new releases are available (ML-1)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#update-malicious-code-protection-mechanisms-when-new-releases-are-available)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.4](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SI-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"SI.1.212\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for SI.1.212",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "SI.1.212",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SI.1.213",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Perform periodic scans of the information system and real-time scans of files from external sources as files are downloaded, opened, or executed (ML-1)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#perform-periodic-scans-of-the-information-system-and-real-time-scans-of-files-from-external-sources-as-files-are-downloaded-opened-or-executed)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   üîÄ[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure DNS](https://azure.microsoft.com/services/dns/)   üîÄ[DNS Zones](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.5](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SI-3](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"CMMC Level 3\"\r\n    | extend firstEvaluationDate = todatetime(properties.status.firstEvaluationDate)\r\n    | extend statusChangeDate = todatetime(properties.status.statusChangeDate)\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId == \"SI.1.213\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ CMMC Assessment Details for SI.1.213",
                          "noDataMessage": "No Current CMMC Level 3 Recommendations in this Area. Confirm the CMMC Level 3 Assessment is Enabled in Azure Security Center: Regulatory Compliance Blade.",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "State",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "ControlID",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Recommendation",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Recommendation >"
                                }
                              },
                              {
                                "columnMatch": "statusChangeDate",
                                "formatter": 6
                              },
                              {
                                "columnMatch": "firstEvaluationDate",
                                "formatter": 6
                              }
                            ],
                            "rowLimit": 50,
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "RecommendationName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "SI.1.213",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 1: Performed / Basic Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 2: Documented / Intermediate Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 2 requires that an organization establish and document practices and policies to guide the implementation of their CMMC efforts. The documentation of practices enables individuals to perform them in a repeatable manner. Organizations develop mature capabilities by documenting their processes and then practicing them as documented. "
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "SI.2.214",
                        "linkTarget": "step",
                        "linkLabel": "SI.2.214 üí° Monitor system security alerts and advisories and take action in response.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "aae96c20-ec13-43d0-8602-0c46bdcec567",
                        "cellValue": "SI.2.216",
                        "linkTarget": "step",
                        "linkLabel": "SI.2.216 üí° Monitor organizational systems, including inbound and outbound communications traffic, to detect attacks and indicators of potential attacks.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "74d74ca8-57df-47d7-8067-0e0044d59579",
                        "cellValue": "SI.2.217 ",
                        "linkTarget": "step",
                        "linkLabel": "SI.2.217 üí° Identify unauthorized use of organizational systems.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML2 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SI.2.214",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Monitor system security alerts and advisories and take action in response (ML-2)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   üîÄ[Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter)  ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.3](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SI-2, SI-3, SI-5](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type contains \"logic\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Automated Security Response (SOAR) Actions Configured",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "SI.2.214",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SI.2.216",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Monitor organizational systems, including inbound and outbound communications traffic, to detect attacks and indicators of potential attacks (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#monitor-organizational-systems-including-inbound-and-outbound-communications-traffic-to-detect-attacks-and-indicators-of-potential-attacks)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   üîÄ[Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure DNS](https://azure.microsoft.com/services/dns/)   üîÄ[DNS Zones](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones)<br>\r\n‚ú≥Ô∏è [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   üîÄ[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/)   üîÄ[Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)   üîÄ[Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks)<br>\r\n‚ú≥Ô∏è [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   üîÄ[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   üîÄ[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.6](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[AU-2, AU-2(3), AU-6, SI-4, SI-4(4)](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityAlert\r\n| distinct AlertName, AlertSeverity, ProductName, Status, Tactics, AlertLink, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Monitor Security Alerts",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "AlertName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "red",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "orange",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ProductName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "uninitialized",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "AlertLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Alert >"
                                }
                              },
                              {
                                "columnMatch": "UPN",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentUrl",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkLabel": "Go to Incident >"
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              },
                              {
                                "columnMatch": "city_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "state_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "name": "SI.2.216",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SI.2.217 ",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# [Identify unauthorized use of organizational systems (ML-2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3?WT.mc_id=Portal-fx#identify-unauthorized-use-of-organizational-systems)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   üîÄ[Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center)   üîÄ[Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   üîÄ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   üîÄ[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   üîÄ[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n‚ú≥Ô∏è [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   üîÄ[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n‚ú≥Ô∏è [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   üîÄ[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)   üîÄ[Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)<br>\r\n‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   üîÄ[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)   üîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n‚ú≥Ô∏è [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   üîÄ[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [BehaviorAnalytics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/behavioranalytics) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[3.14.7](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SI-4](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let AnomalousSigninActivity = BehaviorAnalytics\r\n    | where ActionType == \"Sign-in\"\r\n    | where (UsersInsights.NewAccount == True or UsersInsights.DormantAccount == True) and (\r\n        ActivityInsights.FirstTimeUserAccessedResource == True and ActivityInsights.ResourceUncommonlyAccessedAmongPeers == True\r\n        or ActivityInsights.FirstTimeUserUsedApp == True and ActivityInsights.AppUncommonlyUsedAmongPeers == False)\r\n    | join (\r\n        SigninLogs | where Status.errorCode == 0 or Status.errorCode == 0 and RiskDetail != \"none\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Successful Sign-in with one or more of the following indications: sign by new or recently dormant accounts and sign in with resource for the first time (while none of their peers did) or to an app for the first time (while none of their peers did) or performed by a user with Risk indicaiton from AAD\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet critical = dynamic(['9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3', 'c4e39bd9-1100-46d3-8c65-fb160da0071f', '158c047a-c907-4556-b7ef-446551a6b5f7', '62e90394-69f5-4237-9190-012177145e10', 'd29b2b05-8046-44ba-8758-1e26182fcf32', '729827e3-9c14-49f7-bb1b-9608f156bbb8', '966707d0-3269-4727-9be2-8c3a10f19b9d', '194ae4cb-b126-40b2-bd5b-6091b380977d', 'fe930be7-5e62-47db-91af-98c3a49a38b1']);\r\nlet high = dynamic(['cf1c38e5-3621-4004-a7cb-879624dced7c', '7495fdc4-34c4-4d15-a289-98788ce399fd', 'aaf43236-0c0d-4d5f-883a-6955382ac081', '3edaf663-341e-4475-9f94-5c398ef6c070', '7698a772-787b-4ac8-901f-60d6b08affd2', 'b1be1c3e-b65d-4f19-8427-f6fa0d97feb9', '9f06204d-73c1-4d4c-880a-6edb90606fd8', '29232cdf-9323-42fd-ade2-1d097af3e4de', 'be2f45a1-457d-42af-a067-6ec1fa63bc45', '7be44c8a-adaf-4e2a-84d6-ab2649e08a13', 'e8611ab8-c189-46e8-94e1-60213ab1f814']);//witdstomstl\r\nlet AnomalousRoleAssignment = AuditLogs\r\n    | where TimeGenerated > ago(28d)\r\n    | where OperationName == \"Add member to role\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target = tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner (\r\n        BehaviorAnalytics\r\n        | where ActionType == \"Add member to role\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend AnomalyName = \"Anomalous Role Assignemt\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access.  The query below generates an output of all high Blast Radius users performing Add member to priveleged role, or ones that add users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let LogOns=materialize(\r\n    BehaviorAnalytics\r\n    | where ActivityType == \"LogOn\");\r\nlet AnomalousResourceAccess = LogOns\r\n    | where ActionType == \"ResourceAccess\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous Resource Access\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversary may be trying to move through the environment. APT29 and APT32, for example, has used PtH & PtT techniques to lateral move around the network. The query below generates an output of all users performing an resource access (4624:3) to devices for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousRDPActivity = LogOns\r\n    | where ActionType == \"RemoteInteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous RDP Activity\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. FIN10, for example, has used RDP to move laterally to systems in the victim environment. The query below generates an output of all users performing a remote interactive logon (4624:10) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousLogintoDevices = LogOns\r\n    | where ActionType == \"InteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | where UsersInsights.DormantAccount == true or DevicesInsights.LocalAdmin == true\r\n    | extend AnomalyName = \"Anomalous Login To Devices\",\r\n        Tactic = \"Privilege Escalation\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access and privilege escalation. The query below generates an output of all administator users performing an interactive logon (4624:2) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousPasswordReset = BehaviorAnalytics\r\n    | where ActionType == \"Reset user password\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == \"True\"\r\n    | join (\r\n        AuditLogs\r\n        | where OperationName == \"Reset user password\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Password Reset\",\r\n        Tactic = \"Impact\",\r\n        Technique = \"Account Access Removal\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. LockerGoga, for example, has been observed changing account passwords and logging off current users. The query below generates an output of all users performing Reset user password for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalousGeoLocationLogon = BehaviorAnalytics\r\n    | where ActionType == \"Sign-in\"\r\n    | where ActivityInsights.FirstTimeUserConnectedFromCountry == True and (ActivityInsights.FirstTimeConnectionFromCountryObservedInTenant == True or ActivityInsights.CountryUncommonlyConnectedFromAmongPeers == True)\r\n    | join (\r\n        SigninLogs\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Initial Access\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access. The query below generates an output of successful Sign-in performed by a user from a new geo location he has never connected from before, and none of his peers as well.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousFailedLogon = BehaviorAnalytics\r\n    | where ActivityType == \"LogOn\"\r\n    | where UsersInsights.BlastRadius == \"High\"\r\n    | join (\r\n        SigninLogs  \r\n        | where Status.errorCode == 50126\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Failed Logon\",\r\n        Tactic = \"Credential Access\",\r\n        Technique = \"Brute Force\",\r\n        SubTechnique = \"Password Guessing\",\r\n        Description = \"Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Emotet, for example, has been observed using a hard coded list of passwords to brute force user accounts. The query below generates an output of all users with 'High' BlastRadius that perform failed Sign-in:Invalid username or password.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousAADAccountManipulation = AuditLogs\r\n    | where OperationName == \"Update user\"\r\n    | mv-expand AdditionalDetails\r\n    | where AdditionalDetails.key == \"UserPrincipalName\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner ( \r\n        BehaviorAnalytics\r\n        | where ActionType == \"Update user\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName) \r\n    | extend AnomalyName = \"Anomalous Account Manipulation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access. The query below generates an output of all high Blast Radius users performing 'Update user' (name change) to priveleged role, or ones that changed users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let AnomalousAADAccountCreation = BehaviorAnalytics\r\n    | where ActionType == \"Add user\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == True or ActivityInsights.FirstTimeActionPerformedInTenant == True or ActivityInsights.ActionUncommonlyPerformedAmongPeers == true\r\n    | join(\r\n        AuditLogs\r\n        | where OperationName == \"Add user\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend DisplayName = tostring(UsersInsights.AccountDisplayName),\r\n        UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Account Creation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Create Account\",\r\n        SubTechnique = \"Cloud Account\",\r\n        Description = \"Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system. The query below generates an output of all the users performing user creation for the first time and the target users that were created.\"\t\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalyTable = union kind=outer AnomalousSigninActivity, AnomalousRoleAssignment, AnomalousResourceAccess, AnomalousRDPActivity, AnomalousPasswordReset, AnomalousLogintoDevices, AnomalousGeoLocationLogon, AnomalousAADAccountManipulation, AnomalousAADAccountCreation, AnomalousFailedLogon;\r\nlet TopUsersByAnomalies = AnomalyTable\r\n    | summarize hint.strategy = shuffle AnomalyCount=count() by UserName, UserPrincipalName, tostring(UsersInsights.OnPremSid), tostring(UsersInsights.AccountObjectId)\r\n    | project Name=tolower(UserName), UPN=tolower(UserPrincipalName), AadUserId=UsersInsights_AccountObjectId, Sid=UsersInsights_OnPremSid, AnomalyCount\r\n    | sort by AnomalyCount desc;\r\nlet TopUsersByIncidents = SecurityIncident\r\n    | summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n    | where Status == \"New\" or Status == \"Active\"\r\n    | mv-expand AlertIds\r\n    | extend AlertId = tostring(AlertIds)\r\n    | join kind= innerunique ( \r\n        SecurityAlert \r\n        )\r\n        on $left.AlertId == $right.SystemAlertId\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n    | where UPN <> \"\"\r\n    | where UPN <> \" @ \"\r\n    | union TopUsersByAnomalies\r\n    | extend \r\n        AadPivot = iff(isempty(AadUserId), iff(isempty(Sid), Name, Sid), AadUserId),\r\n        SidPivot = iff(isempty(Sid), iff(isempty(AadUserId), Name, AadUserId), Sid),\r\n        UPNExists = iff(isempty(UPN), false, true),\r\n        NameExists = iff(isempty(Name), false, true),\r\n        SidExists = iff(isempty(Sid), false, true),\r\n        AADExists = iff(isempty(AadUserId), false, true)\r\n    | summarize hint.strategy = shuffle IncidentCount=dcount(IncidentNumber, 4), AlertCount=dcountif(AlertId, isnotempty(AlertId), 4), AnomalyCount=sum(AnomalyCount), any(Title, Severity, Status, StartTime, IncidentNumber, IncidentUrl, Owner), UPNAnchor=anyif(UPN, UPNExists == true), NameAnchor=anyif(Name, NameExists == true), AadAnchor=anyif(AadUserId, AADExists == true), SidAnchor=anyif(Sid, SidExists == true), any(SidPivot) by AadPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), NameAnchor=anyif(NameAnchor, isempty(NameAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_Title, any_Severity, any_StartTime, any_IncidentNumber, any_IncidentUrl) by any_SidPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_any_Title, any_any_Severity, any_any_StartTime, any_any_IncidentNumber, any_any_IncidentUrl) by NameAnchor\r\n    | project [\"UserName\"]=NameAnchor, IncidentCount, AlertCount, AnomalyCount, [\"AadUserId\"]=AadAnchor, [\"OnPremSid\"]=SidAnchor, [\"UserPrincipalName\"]=UPNAnchor;\r\nTopUsersByIncidents\r\n| where UserPrincipalName !contains \"[\"\r\n| project UserPrincipalName, IncidentCount, AlertCount, AnomalyCount\r\n| sort by IncidentCount desc\r\n| limit 50\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Review User Entity Behavior Analytics for Unauthorized Activity",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "UserPrincipalName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "IncidentCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "AlertCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "orange"
                                }
                              },
                              {
                                "columnMatch": "AnomalyCount",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "yellow"
                                }
                              }
                            ],
                            "rowLimit": 50,
                            "filter": true,
                            "sortBy": [
                              {
                                "itemKey": "$gen_heatmap_IncidentCount_1",
                                "sortOrder": 2
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_heatmap_IncidentCount_1",
                              "sortOrder": 2
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "SI.2.217 ",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 2: Documented / Intermediate Cyber Hygiene"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Maturity Level 3: Managed / Good Cyber Hygiene",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Level 3 requires that an organization establish, maintain, and resource a plan demonstrating the management of activities for practice implementation. The plan may include information on missions, goals, project plans, resourcing, required training, and involvement of relevant stakeholders."
                  },
                  "customWidth": "25",
                  "name": "text - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 1"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "af33f331-b64b-4fbd-a0b4-3e411ff705a8",
                        "cellValue": "SI.3.218",
                        "linkTarget": "step",
                        "linkLabel": "SI.3.218 üí° Employ spam protection mechanisms at information system access entry and exit points.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "a8a8b802-adff-442d-a987-a27bf11315b1",
                        "cellValue": "SI.3.219 ",
                        "linkTarget": "step",
                        "linkLabel": "SI.3.219 üí° Implement email forgery protections.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      },
                      {
                        "id": "4abf409f-0e19-4715-bc2e-665f59138ee9",
                        "cellValue": "SI.3.220",
                        "linkTarget": "step",
                        "linkLabel": "SI.3.220 üí° \tUtilize email sandboxing to detect or block potentially malicious email.",
                        "preText": "Go to >",
                        "postText": "",
                        "style": "link"
                      }
                    ]
                  },
                  "customWidth": "70",
                  "name": "ML3 Steps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SI.3.218",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Employ spam protection mechanisms at information system access entry and exit points (ML-3)\r\n\r\n## Primary  Services\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure DNS](https://azure.microsoft.com/services/dns/)   üîÄ[DNS Zones](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [EmailEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/emailevents) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)  <br>\r\n\r\n## Recommended Configurations\r\nüí° [Anti-Spam Protection in Exchange Online Protection](https://docs.microsoft.com/microsoft-365/security/office-365-security/anti-spam-and-anti-malware-protection#anti-spam-protection-in-eop)<br>\r\nüí° [Use DMARC to Validate Email](https://docs.microsoft.com/microsoft-365/security/office-365-security/use-dmarc-to-validate-email)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SI-8](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "EmailEvents\r\n| where TimeGenerated > ago(90d)\r\n| extend Spam_ = tostring(parse_json(ConfidenceLevel).Spam)\r\n| where Spam_ <> \"Not spam\" and Spam_ <> \"Skipped\"\r\n| extend DetectionMethods = tostring(parse_json(tostring(parse_json(DetectionMethods).Spam))[0])\r\n| summarize count() by Spam_, SenderMailFromAddress, DetectionMethods, EmailActionPolicy\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Configure Filters & Monitor Spam Email Trends",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Spam_",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "SenderMailFromAddress",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Person",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "SI.3.218",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SI.3.219",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Implement email forgery protections (ML-3)\r\n\r\n## Secondary Services\r\n‚ú≥Ô∏è [Azure DNS](https://azure.microsoft.com/services/dns/)   üîÄ[DNS Zones](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones)<br>\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [EmailEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/emailevents) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)  <br> \r\n\r\n## Recommended Configurations\r\nüí° [Exchange Online Protection](https://docs.microsoft.com/microsoft-365/security/office-365-security/exchange-online-protection-overview)<br>\r\nüí° [Use DMARC to Validate Email](https://docs.microsoft.com/microsoft-365/security/office-365-security/use-dmarc-to-validate-email)<br>\r\nüí° [Configure Spoof intelligence in Exchange Online Protection](https://docs.microsoft.com/microsoft-365/security/office-365-security/learn-about-spoof-intelligence)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-8, SC-20, SC-21](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "EmailEvents\r\n| where TimeGenerated > ago(30d)\r\n| where DetectionMethods contains \"spoof\"\r\n| summarize count() by DetectionMethods, EmailAction, EmailActionPolicy\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Configure Email DMARC and Monitor for Spoofing Threats via Exchange Online Protection",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "DetectionMethods",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              },
                              {
                                "columnMatch": "AlertSeverity",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "colors",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High",
                                      "representation": "redBright",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Medium",
                                      "representation": "yellow",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low",
                                      "representation": "blueDark",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Informational",
                                      "representation": "lightBlue",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "blue",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "rowLimit": 50,
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 2",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      }
                    ]
                  },
                  "name": "SI.3.219 ",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SI.3.220",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Utilize email sandboxing to detect or block potentially malicious email (ML-3)\r\n\r\n## Primary Services\r\n‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   üîÄ[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n## Recommended Logs\r\nüî∑ [EmailEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/emailevents) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)  <br> \r\n\r\n## Recommended Configurations\r\nüí° [Safe Links in Microsoft Defender for Office 365](https://docs.microsoft.com/microsoft-365/security/office-365-security/safe-links)<br>\r\nüí° [Safe Documents in Microsoft 365 E5](https://docs.microsoft.com/microsoft-365/security/office-365-security/safe-docs)<br>\r\nüí° [Set up Safe Attachments policies in Microsoft Defender for Office 365](https://docs.microsoft.com/microsoft-365/security/office-365-security/set-up-safe-attachments-policies)<br>\r\n\r\n## Implementation Guidance\r\n[Microsoft Technical Reference Guide for CMMC](https://aka.ms/cmmc/techrefguide)\r\n## NIST SP 800-171 Mapping\r\n[NA](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)<br>\r\n## NIST SP 800-53 R4 Mapping\r\n[SC-44](https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final)\r\n## Azure Security Center: Regulatory Compliance\r\n[Go To: CMMC Level 3 Assessment >](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/22)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 0",
                        "styleSettings": {
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "EmailEvents\r\n| where EmailAction <> \"\"\r\n| summarize count() by EmailAction, DetectionMethods, EmailActionPolicy\r\n| sort by count_ desc\r\n| limit 250",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "üü¶ Leverage Microsoft Defender for Office 365 for Sandbox Detonationss via Safe Attachments, Safe Documents, and Safe Links",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "EmailAction",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Defense Evasion",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "DetectionMethods",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "redBright"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 1"
                      }
                    ]
                  },
                  "name": "SI.3.220",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isML3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Maturity Level 3: Managed / Good Cyber Hygiene"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isSIVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "System & Information Integrity Group",
      "styleSettings": {
        "showBorder": true
      }
    }
  ],
  "fromTemplateId": "sentinel-CybersecurityMaturityModelCertification(CMMC)",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}