{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "3218e2b0-1bcc-46d4-affa-d298e0cf90f6",
            "version": "KqlParameterItem/1.0",
            "name": "Help",
            "label": "üîé Guide",
            "type": 10,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "jsonData": "[\r\n    {\"value\": \"Yes\", \"label\": \"Yes\", \"selected\":true},\r\n    {\"value\": \"No\", \"label\": \"No\"}\r\n]"
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "DefaultSubscription_Internal",
            "type": 1,
            "isRequired": true,
            "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| take 1\r\n| project subscriptionId",
            "isHiddenWhenLocked": true,
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "id": "d7afa921-907e-4c42-87ca-e67aecd47310"
          },
          {
            "id": "e6ded9a1-a83c-4762-938d-5bf8ff3d3d38",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 6,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "summarize by subscriptionId\r\n| project value = strcat(\"/subscriptions/\", subscriptionId), label = subscriptionId, selected = iff(subscriptionId =~ '{DefaultSubscription_Internal}', true, false)",
            "crossComponentResources": [
              "value::selected"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "e3225ed0-6210-40a1-b2d0-66e42ffa71d6",
            "version": "KqlParameterItem/1.0",
            "name": "Workspace",
            "type": 5,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "resources\r\n| where type =~ 'microsoft.operationalinsights/workspaces'\r\n| order by name asc\r\n| summarize Selected = makelist(id, 10), All = makelist(id, 1000)\r\n| mvexpand All limit 100\r\n| project value = tostring(All), label = tostring(All), selected = iff(Selected contains All, true, false)",
            "crossComponentResources": [
              "value::all"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "15b2c181-7397-43c1-900a-28e175ae8a6f",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "label": "‚è±Ô∏è Time Range",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 2592000000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2592000000
                }
              ],
              "allowCustom": true
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "Parameter Selectors"
    },
    {
      "type": 1,
      "content": {
        "json": "<svg viewBox=\"0 0 19 19\" width=\"20\" class=\"fxt-escapeShadow\" role=\"presentation\" focusable=\"false\" xmlns:svg=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" aria-hidden=\"true\"><g><path fill=\"#1b93eb\" d=\"M16.82 8.886c0 4.81-5.752 8.574-7.006 9.411a.477.477 0 01-.523 0C8.036 17.565 2.18 13.7 2.18 8.886V3.135a.451.451 0 01.42-.419C7.2 2.612 6.154.625 9.5.625s2.3 1.987 6.8 2.091a.479.479 0 01.523.419z\"></path><path fill=\"url(#0024423711759027356)\" d=\"M16.192 8.99c0 4.392-5.333 7.947-6.483 8.575a.319.319 0 01-.418 0c-1.15-.732-6.483-4.183-6.483-8.575V3.762a.575.575 0 01.313-.523C7.2 3.135 6.258 1.357 9.4 1.357s2.2 1.882 6.274 1.882a.45.45 0 01.419.418z\"></path><path d=\"M9.219 5.378a.313.313 0 01.562 0l.875 1.772a.314.314 0 00.236.172l1.957.284a.314.314 0 01.174.535l-1.416 1.38a.312.312 0 00-.09.278l.334 1.949a.313.313 0 01-.455.33l-1.75-.92a.314.314 0 00-.292 0l-1.75.92a.313.313 0 01-.455-.33L7.483 9.8a.312.312 0 00-.09-.278L5.977 8.141a.314.314 0 01.174-.535l1.957-.284a.314.314 0 00.236-.172z\" class=\"msportalfx-svg-c01\"></path></g></svg>&nbsp;<span style=\"font-family: Open Sans; font-weight: 620; font-size: 14px;font-style: bold;margin:-10px 0px 0px 0px;position: relative;top:-3px;left:-4px;\"> Please take time to answer a quick survey,\r\n</span>[<span style=\"font-family: Open Sans; font-weight: 620; font-size: 14px;font-style: bold;margin:-10px 0px 0px 0px;position: relative;top:-3px;left:-4px;\"> click here. </span>](https://forms.office.com/r/n9beey85aP)"
      },
      "name": "Survey"
    },
    {
      "type": 1,
      "content": {
        "json": "# Threat Intelligence Workbook\n---\n\nWelcome to the Threat Intelligence Workbook. The workbook provides a guided threat intelligence experiene for researching threats, aligning Microsoft telemetry with indicators of compromise, and developing threat intelligence programs. Within a Security Information and Event Management (SIEM) solution like Microsoft Sentinel, the most commonly used form of CTI is threat indicators, also known as Indicators of Compromise or IoCs. Threat indicators are data that associate observed artifacts such as URLs, file hashes, or IP addresses with known threat activity such as phishing, botnets, or malware. This form of threat intelligence is often called tactical threat intelligence because it can be applied to security products and automation in large scale to detect potential threats to an organization and protect against them. In Microsoft Sentinel, you can use threat indicators to help detect malicious activity observed in your environment and provide context to security investigators to help inform response decisions. For more information, see ‚ú≥Ô∏è [Understand Threat Intelligence in Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/understand-threat-intelligence).\n"
      },
      "conditionalVisibility": {
        "parameterName": "Help",
        "comparison": "isEqualTo",
        "value": "Yes"
      },
      "customWidth": "79",
      "name": "Workbook Overview"
    },
    {
      "type": 1,
      "content": {
        "json": "![Image Name](https://azure.microsoft.com/svghandler/azure-sentinel?width=600&height=315) "
      },
      "conditionalVisibility": {
        "parameterName": "Help",
        "comparison": "isEqualTo",
        "value": "Yes"
      },
      "customWidth": "20",
      "name": "Microsoft Sentinel Logo"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "18c690d7-7cbd-46c1-b677-1f72692d40cd",
            "cellValue": "TAB",
            "linkTarget": "parameter",
            "linkLabel": "Indicators Ingestion",
            "subTarget": "Indicators",
            "preText": "Alert rules",
            "style": "link"
          },
          {
            "id": "f88dcf47-af98-4684-9de3-1ee5f48f68fc",
            "cellValue": "TAB",
            "linkTarget": "parameter",
            "linkLabel": "Threat Detection & Hunting",
            "subTarget": "ThreatHunting",
            "style": "link"
          },
          {
            "id": "67e3c0a1-0069-41cf-ae86-04ff6a1566ca",
            "cellValue": "TAB",
            "linkTarget": "parameter",
            "linkLabel": "Observed Threats",
            "subTarget": "ThreatIntelligence",
            "style": "link"
          }
        ]
      },
      "name": "Tabs link"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ThreatIntelligenceIndicator\r\n// Select all indicators from the table\r\n// Create a new column to identify the type of indicator, IP, Domain, URL, File, or Other\r\n| extend IndicatorType = iif(isnotempty(EmailSourceIpAddress) or isnotempty(NetworkDestinationIP) or isnotempty(NetworkIP) or isnotempty(NetworkSourceIP) or isnotempty(NetworkCidrBlock), \"IP\",\r\n                        iff(isnotempty(Url), \"URL\",\r\n                        iff(isnotempty(EmailRecipient) or isnotempty(EmailSenderAddress), \"Email\",\r\n                        iff(isnotempty(FileHashValue), \"File\",\r\n                         iff(isnotempty(DomainName) or isnotempty(EmailSourceDomain), \"Domain\",\r\n                        \"Other\")))))\r\n// Summarize and order the data, then render the chart\r\n| summarize CountOfIndicators = count() by IndicatorType, bin(TimeGenerated, 1h)\r\n| order by CountOfIndicators desc \r\n| render barchart kind=stacked ",
              "size": 0,
              "showAnalytics": true,
              "title": "‚ú≥Ô∏è Indicators Imported into Sentinel by Indicator Type and Date",
              "timeContext": {
                "durationMs": 2592000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "query - 1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ThreatIntelligenceIndicator\r\n// Select all indicators from the table\r\n// Summarize and order the data, then render the chart\r\n| summarize CountOfIndicators = count() by SourceSystem, bin(TimeGenerated, 1h)\r\n| render barchart kind=stacked",
              "size": 0,
              "showAnalytics": true,
              "title": "‚ú≥Ô∏è Indicators Imported into Sentinel by Indicator Provider and Date",
              "timeContext": {
                "durationMs": 2592000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "query - 3"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ThreatIntelligenceIndicator\r\n// Select all indicators from the table\r\n| where TimeGenerated < now()\r\n// Select only indicators that have not expired\r\n    and ExpirationDateTime > now()\r\n// Select only indicators that are marked active\r\n    and Active == true\r\n// Select only the most recently ingested copy of an indicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n// Create a new column to identify the type of indicator, IP, Domain, URL, File, or Other\r\n| extend IndicatorType = iif(isnotempty(EmailSourceIpAddress) or isnotempty(NetworkDestinationIP) or isnotempty(NetworkIP) or isnotempty(NetworkSourceIP) or isnotempty(NetworkCidrBlock), \"IP\",\r\n                        iff(isnotempty(Url), \"URL\",\r\n                        iff(isnotempty(EmailRecipient) or isnotempty(EmailSenderAddress), \"Email\",\r\n                        iff(isnotempty(FileHashValue), \"File\",\r\n                         iff(isnotempty(DomainName) or isnotempty(EmailSourceDomain), \"Domain\",\r\n                        \"Other\")))))\r\n// Summarize and order the data, then render the chart\r\n| summarize CountOfIndicators = count() by IndicatorType\r\n| order by CountOfIndicators desc \r\n| render barchart kind=unstacked",
              "size": 0,
              "showAnalytics": true,
              "title": "‚ú≥Ô∏è Active Indicators by Indicator Type",
              "timeContext": {
                "durationMs": 2592000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "query - 5"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ThreatIntelligenceIndicator\r\n// Select all indicators from the table\r\n| where TimeGenerated < now()\r\n// Select only indicators that have not expired\r\n    and ExpirationDateTime > now()\r\n// Select only indicators that are marked active\r\n    and Active == true\r\n// Select only the most recently ingested copy of an indicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n// Summarize and order the data, then render the chart\r\n| summarize CountOfIndicators = count() by SourceSystem\r\n| order by CountOfIndicators desc \r\n| render barchart kind=unstacked",
              "size": 0,
              "showAnalytics": true,
              "title": "‚ú≥Ô∏è Active Indicators by Indicator Source",
              "timeContext": {
                "durationMs": 2592000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "query - 7"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ThreatIntelligenceIndicator\r\n// Select all indicators from the table\r\n| where TimeGenerated < now()\r\n// Select only indicators that have not expired\r\n    and ExpirationDateTime > now()\r\n// Select only indicators that are marked active\r\n    and Active == true\r\n// Select only the most recently ingested copy of an indicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n// Summarize and order the data, then render the chart\r\n| summarize CountOfIndicators = count() by tostring(ConfidenceScore)\r\n| order by CountOfIndicators desc \r\n| render piechart",
              "size": 0,
              "showAnalytics": true,
              "title": "‚ú≥Ô∏è Active Indicators by Confidence Score",
              "timeContext": {
                "durationMs": 2592000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "query - 10"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let DomainQuery=view() { \r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(DomainName)\r\n| summarize SourceSystemArray=make_set(SourceSystem) by DomainName\r\n| summarize count() by tostring(SourceSystemArray)\r\n| project SourceSystemArray, count_, EntryType=\"DomainEntry\"\r\n};\r\nlet UrlQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(Url)\r\n| summarize SourceSystemArray=make_set(SourceSystem) by Url\r\n| summarize count() by tostring(SourceSystemArray)\r\n| project SourceSystemArray, count_, EntryType=\"UrlEntry\"\r\n};\r\nlet FileHashQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(FileHashValue)\r\n| summarize SourceSystemArray=make_set(SourceSystem) by FileHashValue\r\n| summarize count() by tostring(SourceSystemArray)\r\n| project SourceSystemArray, count_, EntryType=\"FileHashEntry\"\r\n};\r\nlet IPQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(NetworkIP) or isnotempty(NetworkSourceIP)\r\n| summarize SourceSystemArray=make_set(SourceSystem) by NetworkIP, NetworkSourceIP\r\n| summarize count() by tostring(SourceSystemArray)\r\n| project SourceSystemArray, count_, EntryType=\"IPEntry\"\r\n};\r\nlet EmailAddressQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(EmailSenderAddress)\r\n| summarize SourceSystemArray=make_set(SourceSystem) by EmailSenderAddress\r\n| summarize count() by tostring(SourceSystemArray)\r\n| project SourceSystemArray, count_, EntryType=\"EmailAddressEntry\"\r\n};\r\nlet EmailMessageQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(EmailSubject)\r\n| summarize SourceSystemArray=make_set(SourceSystem) by EmailSubject\r\n| summarize count() by tostring(SourceSystemArray)\r\n| project SourceSystemArray, count_, EntryType=\"EmailMessageEntry\"\r\n};\r\nlet SingleSourceIndicators=view(){\r\n    DomainQuery\r\n    | union UrlQuery\r\n    | union FileHashQuery\r\n    | union IPQuery\r\n    | union EmailAddressQuery\r\n    | union EmailMessageQuery\r\n    | where array_length(todynamic(SourceSystemArray))==1\r\n    | summarize sum(count_) by SourceSystemArray\r\n    | extend counter=1 \r\n};\r\nlet MultipleSourceIndicators=view(){\r\n    DomainQuery\r\n    | union UrlQuery\r\n    | union FileHashQuery\r\n    | union IPQuery\r\n    | union EmailAddressQuery\r\n    | union EmailMessageQuery\r\n    | where array_length(todynamic(SourceSystemArray))!=1\r\n    | summarize sum(count_) by SourceSystemArray\r\n    | extend counter=1\r\n};\r\nlet CountOfActiveIndicatorsBySource=view(){\r\n    ThreatIntelligenceIndicator\r\n\t| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n    | where ExpirationDateTime > now() and Active == true\r\n    | summarize count() by SourceSystem\r\n    | project SourceSystem, count_\r\n};\r\nSingleSourceIndicators\r\n| join kind=fullouter MultipleSourceIndicators on counter \r\n| where SourceSystemArray contains todynamic(SourceSystemArray)[0] \r\n| order by SourceSystemArray\r\n| extend solitary_count=sum_count_\r\n| summarize shared_count = sum(sum_count_1) by SourceSystemArray, solitary_count\r\n| extend total_count = shared_count + solitary_count\r\n| extend unique_percentage = round(toreal(solitary_count)/toreal(total_count)*100, 1)\r\n| extend IndicatorSource = tostring(todynamic(SourceSystemArray)[0])\r\n| join kind=inner CountOfActiveIndicatorsBySource on $left.IndicatorSource == $right.SourceSystem\r\n| order by unique_percentage desc\r\n| project Source=IndicatorSource, UniquenessPercentage=unique_percentage, ActiveIndicators = count_\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "‚ú≥Ô∏è Uniqueness of Threat Intelligence Sources",
              "timeContext": {
                "durationMs": 2592000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Source",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "View",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "ActiveIndicators",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  }
                ],
                "filter": true
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 12"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "TAB",
        "comparison": "isEqualTo",
        "value": "Indicators"
      },
      "name": "Indicators Ingestion"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "9aec751b-07bd-43ba-80b9-f711887dce45",
                  "version": "KqlParameterItem/1.0",
                  "name": "Indicator",
                  "label": "Indicator Search",
                  "type": 1,
                  "value": "",
                  "timeContext": {
                    "durationMs": 7776000000
                  },
                  "timeContextFromParameter": "TimeRange"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "Threat Research Parameters"
          },
          {
            "type": 1,
            "content": {
              "json": ""
            },
            "customWidth": "50",
            "name": "text - 9"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let tiObservables = ThreatIntelligenceIndicator\r\n    | where TimeGenerated < now()\r\n    | project IndicatorId, ThreatType, Description, Active, IndicatorTime = TimeGenerated, Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP, Url, FileHashValue, EmailSourceIpAddress, EmailSenderAddress, DomainName), SourceSystem;\r\nlet alertEntity = SecurityAlert \r\n    | project parse_json(Entities), SystemAlertId , AlertTime = TimeGenerated\r\n    | mvexpand(Entities)\r\n    | extend entity = iif(isnotempty(Entities.Address), Entities.Address,\r\n                      iif(isnotempty(Entities.HostName),strcat(Entities.HostName, \".\", Entities.DnsDomain),\r\n                      iif(isnotempty(Entities.Url), Entities.Url,\r\n                      iif(isnotempty(Entities.Value), Entities.Value,\r\n                      iif(Entities.Type == \"account\", strcat(Entities.Name,\"@\",Entities.UPNSuffix),\"\")))))\r\n    | where isnotempty(entity) \r\n    | project entity, SystemAlertId, AlertTime;\r\nlet IncidentAlerts = SecurityIncident\r\n    | project IncidentTime = TimeGenerated, IncidentNumber, Title, parse_json(AlertIds)\r\n    | mv-expand AlertIds\r\n    | project IncidentTime, IncidentNumber, Title, tostring(AlertIds);\r\nlet AlertsWithTiObservables = alertEntity\r\n    | join kind=inner tiObservables on $left.entity == $right.Indicator;\r\nlet IncidentsWithAlertsWithTiObservables = AlertsWithTiObservables\r\n    | join kind=inner IncidentAlerts on $left.SystemAlertId == $right.AlertIds;\r\nIncidentsWithAlertsWithTiObservables\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| summarize Incidents=dcount(IncidentNumber), Alerts=dcount(SystemAlertId) by Indicator, ThreatType, Description, Source = SourceSystem\r\n| sort by Incidents desc",
              "size": 0,
              "title": "‚ú≥Ô∏è Incident and Alert Counts by Indicator",
              "timeContext": {
                "durationMs": 2592000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "ThreatType",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Botnet",
                          "representation": "Command and Control",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "MaliciousUrl",
                          "representation": "Initial_Access",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Malware",
                          "representation": "Execution",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Phishing",
                          "representation": "Exfiltration",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Pre attack",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Incidents",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  },
                  {
                    "columnMatch": "Alerts",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "orange"
                    }
                  }
                ],
                "filter": true
              }
            },
            "customWidth": "50",
            "name": "query - 13 - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let tiObservables = ThreatIntelligenceIndicator \r\n    | where TimeGenerated < now() \r\n    | project IndicatorId, Active, SourceSystem, IndicatorTime = TimeGenerated , Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP, Url, FileHashValue, EmailSourceIpAddress, EmailSenderAddress, DomainName)\r\n    | summarize arg_min(IndicatorTime, *) by IndicatorId;\r\n// Create a temp table containing all alerts generated from threat intelligence.\r\nlet alertEntity = SecurityAlert \r\n    | where TimeGenerated < now()\r\n    | project parse_json(Entities), SystemAlertId , AlertTime = TimeGenerated\r\n    | mv-expand Entities\r\n    | extend Indicator = iif((isnotempty(Entities.Address)), Entities.Address,\r\n                      iif(isnotempty(Entities.HostName),strcat(Entities.HostName, '.', Entities.DnsDomain),\r\n                      iif(isnotempty(Entities.Url), Entities.Url,\r\n                      iif(isnotempty(Entities.Value), Entities.Value,\r\n                      iif(Entities.Type == 'account', strcat(Entities.Name,'@',Entities.UPNSuffix),'')))))\r\n    | where isnotempty(Indicator)\r\n    | project Indicator, SystemAlertId, AlertTime;\r\n// Join the two temp tables and summarize the data in a table showing indicator sources by detection time and count of alerts.\r\nalertEntity \r\n| join kind = inner tiObservables on $left.Indicator == $right.Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project SystemAlertId, IndicatorId, timedelta = AlertTime - IndicatorTime, SourceSystem\r\n| summarize DetectionTime=case(toint(avg(timedelta))>0,strcat(replace(@'\\-',@'',replace(@'(\\:\\d+\\:\\d+\\.\\d+)',@'',tostring(avg(timedelta)))),' hrs',' DELAYED'),toint(avg(timedelta))<0,strcat(replace(@'\\-',@'',replace(@'(\\:\\d+\\:\\d+\\.\\d+)',@'',tostring(avg(timedelta)))),' hrs',' AHEAD'), 'None'), Alerts = dcount(SystemAlertId) by Source = SourceSystem\r\n| order by Source asc\r\n| render table",
              "size": 0,
              "showAnalytics": true,
              "title": "‚ú≥Ô∏è Average Detection Time by Source",
              "timeContext": {
                "durationMs": 2592000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Source",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "View",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "DetectionTime",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "contains",
                          "thresholdValue": "AHEAD",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "DELAYED",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Alerts",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "orange"
                    }
                  }
                ],
                "filter": true
              },
              "sortBy": [],
              "graphSettings": {
                "type": 0,
                "topContent": {
                  "columnMatch": "Source",
                  "formatter": 1
                },
                "centerContent": {
                  "columnMatch": "Alerts",
                  "formatter": 1,
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "query - 15"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "d8e8ac75-e764-4ff8-941b-bc8ad77df072",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results1",
                        "type": 1,
                        "query": "VMConnection \r\n| extend Indicator = strcat(SourceIp)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results1",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "7e2c1d11-c9bf-415a-ad8e-914dc54a6de2",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results2",
                        "type": 1,
                        "query": "VMConnection \r\n| extend Indicator = strcat(DestinationIp)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 7776000000
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results2",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "7aff2d64-59f9-4a50-a9b8-048472ca9ab1",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results3",
                        "type": 1,
                        "query": "SecurityEvent \r\n| extend Indicator = strcat(IpAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results3",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "d5403b32-796b-4027-b03b-31db0611fc1e",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results4",
                        "type": 1,
                        "query": "DnsEvents \r\n| extend Indicator = strcat(IPAddresses)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 7776000000
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results4",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "a3517bad-a459-4424-b14b-37cfc246bcdf",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results5",
                        "type": 1,
                        "query": "//reference list posted here : https://docs.microsoft.com/azure/data-explorer/kusto/query/ipv4-lookup-plugin\r\nlet geoData = externaldata\r\n    (network: string, geoname_id: string, continent_code: string, continent_name: string,\r\n    country_iso_code: string, country_name: string, is_anonymous_proxy: string, is_satellite_provider: string)\r\n    [@\"https://raw.githubusercontent.com/datasets/geoip2-ipv4/master/data/geoip2-ipv4.csv\"] with (ignoreFirstRecord=true, format=\"csv\");\r\nlet materializedData =\r\n    materialize(\r\n    AzureDiagnostics\r\n    | where Category == \"AzureFirewallNetworkRule\"\r\n    | where OperationName <> \"AzureFirewallThreatIntelLog\"\r\n    | where OperationName <> \"AzureFirewallIDSLog\"\r\n    | project msg_s, Resource, TimeGenerated, ResourceId, ResourceGroup, SubscriptionId);\r\nunion\r\n    (\r\n    // Azure Firewall Networking - Standard Log\r\n    materializedData\r\n    | where msg_s !has \"Type=\"\r\n        and msg_s !has \"DNAT'ed\"\r\n        and msg_s !has \"Rule Collection:\"\r\n        and msg_s !has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \". Action: \" Action\r\n    ),\r\n    (\r\n    // Azure Firewall Networking with ICMP\r\n    materializedData\r\n    | where msg_s has \"Type=\"\r\n    | parse msg_s with Protocol \" Type=\" ICMPType \" request from \" SourceIP \" to \" DestinationIP \". Action: \" Action\r\n    ),\r\n    (\r\n    // Azure Firewall Networking DNAT rule - Standard\r\n    materializedData\r\n    | where msg_s has \"DNAT'ed\" and msg_s !has \". Rule Collection:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \" was \" Action \" to \" NatDestination\r\n    ),\r\n    (\r\n    // Azure Firewall Networking DNAT rule (firewall not using policy)\r\n    materializedData\r\n    | where msg_s has \"DNAT'ed\" and msg_s has \". Rule Collection:\" and msg_s !has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \" was \" Action \" to \" NatDestination \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    // Azure Firewall Networking DNAT rule (firewall using policy)\r\n    materializedData\r\n    | where msg_s has \"DNAT'ed\" and msg_s has \". Rule Collection:\" and msg_s has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \" was \" Action \" to \" NatDestination \". Policy: \" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    // Azure Firewall Network rule (firewall not using policy)\r\n    materializedData\r\n    | where msg_s has \"Rule Collection:\" and msg_s !has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \". Action: \" Action \". Rule Collection: \" RuleCollection \". Rule Name: \" Rule\r\n    ),\r\n    (\r\n    // Azure Firewall Network rule (firewall using policy)\r\n    materializedData\r\n    | where msg_s has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \". Action: \" Action \". Policy:\" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule Name: \" Rule\r\n    )\r\n| summarize\r\n    by\r\n    TimeGenerated,\r\n    Protocol,\r\n    ICMPType,\r\n    Action,\r\n    SourceIP,\r\n    SourcePort,\r\n    DestinationIP,\r\n    DestinationPort,\r\n    NatDestination,\r\n    ResourceId,\r\n    ResourceGroup,\r\n    SubscriptionId\r\n| evaluate ipv4_lookup (geoData, DestinationIP, network, false)\r\n| extend Indicator = strcat(SourceIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 7776000000
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results5",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "4813bde0-7ede-4514-9d62-9b0eea7f3b21",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results6",
                        "type": 1,
                        "query": "///reference list posted here : https://docs.microsoft.com/azure/data-explorer/kusto/query/ipv4-lookup-plugin\r\nlet geoData = externaldata\r\n    (network: string, geoname_id: string, continent_code: string, continent_name: string,\r\n    country_iso_code: string, country_name: string, is_anonymous_proxy: string, is_satellite_provider: string)\r\n    [@\"https://raw.githubusercontent.com/datasets/geoip2-ipv4/master/data/geoip2-ipv4.csv\"] with (ignoreFirstRecord=true, format=\"csv\");\r\nlet materializedData =\r\n    materialize(\r\n    AzureDiagnostics\r\n    | where Category == \"AzureFirewallNetworkRule\"\r\n    | where OperationName <> \"AzureFirewallThreatIntelLog\"\r\n    | where OperationName <> \"AzureFirewallIDSLog\"\r\n    | project msg_s, Resource, TimeGenerated, ResourceId, ResourceGroup, SubscriptionId);\r\nunion\r\n    (\r\n    // Azure Firewall Networking - Standard Log\r\n    materializedData\r\n    | where msg_s !has \"Type=\"\r\n        and msg_s !has \"DNAT'ed\"\r\n        and msg_s !has \"Rule Collection:\"\r\n        and msg_s !has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \". Action: \" Action\r\n    ),\r\n    (\r\n    // Azure Firewall Networking with ICMP\r\n    materializedData\r\n    | where msg_s has \"Type=\"\r\n    | parse msg_s with Protocol \" Type=\" ICMPType \" request from \" SourceIP \" to \" DestinationIP \". Action: \" Action\r\n    ),\r\n    (\r\n    // Azure Firewall Networking DNAT rule - Standard\r\n    materializedData\r\n    | where msg_s has \"DNAT'ed\" and msg_s !has \". Rule Collection:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \" was \" Action \" to \" NatDestination\r\n    ),\r\n    (\r\n    // Azure Firewall Networking DNAT rule (firewall not using policy)\r\n    materializedData\r\n    | where msg_s has \"DNAT'ed\" and msg_s has \". Rule Collection:\" and msg_s !has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \" was \" Action \" to \" NatDestination \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    // Azure Firewall Networking DNAT rule (firewall using policy)\r\n    materializedData\r\n    | where msg_s has \"DNAT'ed\" and msg_s has \". Rule Collection:\" and msg_s has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \" was \" Action \" to \" NatDestination \". Policy: \" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    // Azure Firewall Network rule (firewall not using policy)\r\n    materializedData\r\n    | where msg_s has \"Rule Collection:\" and msg_s !has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \". Action: \" Action \". Rule Collection: \" RuleCollection \". Rule Name: \" Rule\r\n    ),\r\n    (\r\n    // Azure Firewall Network rule (firewall using policy)\r\n    materializedData\r\n    | where msg_s has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \". Action: \" Action \". Policy:\" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule Name: \" Rule\r\n    )\r\n| summarize\r\n    by\r\n    TimeGenerated,\r\n    Protocol,\r\n    ICMPType,\r\n    Action,\r\n    SourceIP,\r\n    SourcePort,\r\n    DestinationIP,\r\n    DestinationPort,\r\n    NatDestination,\r\n    ResourceId,\r\n    ResourceGroup,\r\n    SubscriptionId\r\n| evaluate ipv4_lookup (geoData, DestinationIP, network, false)\r\n| extend Indicator = strcat(DestinationIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results6",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "5f373071-efaf-4338-9b1b-12a5d49790d1",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results7",
                        "type": 1,
                        "query": "BehaviorAnalytics \r\n| extend Indicator = strcat(SourceIPAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results7",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "06c5ffbf-c50b-49e6-846e-3fa16d58283d",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results8",
                        "type": 1,
                        "query": "AzureActivity \r\n| extend Indicator = strcat(CallerIpAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results8",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "2d652993-5cbd-4ade-96c3-5f82602e7f5d",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results9",
                        "type": 1,
                        "query": "DeviceLogonEvents \r\n| extend Indicator = strcat(RemoteIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results9",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "43248b6f-9140-4422-843f-97cc08e4b454",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results10",
                        "type": 1,
                        "query": "DeviceNetworkEvents \r\n| extend Indicator = strcat(RemoteIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results10",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "21662808-9de9-4e19-8087-354263c6d20e",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results11",
                        "type": 1,
                        "query": "DeviceEvents \r\n| extend Indicator = strcat(RemoteIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results11",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "5378d561-b156-4d41-94de-1810a27a8088",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results12",
                        "type": 1,
                        "query": "CommonSecurityLog \r\n| extend Indicator = strcat(SourceIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 7776000000
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results12",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "220542eb-4eaf-4c0b-b8e6-e1b53c10c0ab",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results13",
                        "type": 1,
                        "query": "CommonSecurityLog \r\n| extend Indicator = strcat(DestinationIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results13",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "9d858b45-7f94-443d-9ebb-25b9d9884c19",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results14",
                        "type": 1,
                        "query": "SigninLogs\r\n| extend Indicator = strcat(IPAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results14",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "7fbbbc5b-b0cc-4ba8-bce0-b3f248cd6544",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results15",
                        "type": 1,
                        "query": "AADNonInteractiveUserSignInLogs\r\n| extend Indicator = strcat(IPAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 7776000000
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results15",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "90044a2c-4268-4c22-a90e-f16a0d8d0a8a",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results16",
                        "type": 1,
                        "query": "AADServicePrincipalSignInLogs\r\n| extend Indicator = strcat(IPAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results16",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "f44c7b90-fac7-4ae3-8189-0d43a069bb48",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results17",
                        "type": 1,
                        "query": "StorageBlobLogs\r\n| extend Indicator = strcat(CallerIpAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 7776000000
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results17",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "19d0086f-88ff-439e-8ee1-6fbd1bcd0cc9",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results18",
                        "type": 1,
                        "query": "SecurityAlert\r\n| extend Indicator = tostring(parse_json(Entities)[1].Address)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results18",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "187c8c20-0890-4dd4-a0b8-0f37f79b70bc",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results19",
                        "type": 1,
                        "query": "InformationProtectionLogs_CL\r\n| extend Indicator = strcat(IPv4_s_s)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "60",
                  "name": "Results19"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "92369bba-f4e2-4796-85a7-45ca15633b1b",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results20",
                        "type": 1,
                        "query": "imNetworkSession\r\n| extend Indicator = strcat(SrcIpAddr)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith \"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP)| where Indicator <> \"\") on Indicator\r\n| project Indicator, ThreatType, SrcIpAddr, DstIpAddr, Type, Activity, EventVendor, EventResult, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results20"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "75e83733-d80e-4017-a03c-1ad75eb46ca0",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results21",
                        "type": 1,
                        "query": "imAuthentication\r\n| extend Indicator = strcat(SrcDvcIpAddr)\r\n| where RemoteIPType <> \"Private\"\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith \"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP)| where Indicator <> \"\") on Indicator\r\n| project Indicator, ThreatType, SrcDvcIpAddr, EventVendor, EventProduct, SrcDvcHostname, TargetDvcHostname, TargetUsername, ActionType, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results21"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "3f107c77-8c5c-4043-8018-b91e38d63805",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results22",
                        "type": 1,
                        "query": "imDns\r\n| extend Indicator = strcat(DnsResponseName)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith \"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP)| where Indicator <> \"\") on Indicator\r\n| project Indicator, ThreatType, Dvc, SrcIpAddr, DnsResponseName, EventVendor, EventProduct, EventType, DnsQuery, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results22"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# IP Address Indicators Observed\r\n\r\n| <strong> IP Indicator Queries </strong> | -|\r\n|:--| :--|\r\n| ‚ú≥Ô∏è imNetworkSession Match | ‚ú≥Ô∏è imAuthentication Match |\r\n| ‚ú≥Ô∏è imDns Match |‚ú≥Ô∏è VMConnection (SourceIP) Match |\r\n| ‚ú≥Ô∏è VMConnection (DestinationIP) Match |‚ú≥Ô∏è SecurityEvent Match |\r\n| ‚ú≥Ô∏è DnsEvents Match |‚ú≥Ô∏è AzureFirewall (SourceIP) Match |\r\n| ‚ú≥Ô∏è AzureFirewall (DestinationIP) Match |‚ú≥Ô∏è BehaviorAnalytics Match |\r\n| ‚ú≥Ô∏è AzureActivity Match |‚ú≥Ô∏è DeviceLogonEvents Match |\r\n| ‚ú≥Ô∏è DeviceNetworkEvents Match |‚ú≥Ô∏è DeviceEvents Match |\r\n| ‚ú≥Ô∏è CommonSecurityLog (SourceIP) Match |‚ú≥Ô∏è CommonSecurityLog (DestinationIP) Match |\r\n| ‚ú≥Ô∏è SigninLogs Match |‚ú≥Ô∏è AADNonInteractiveUserSignInLogs Match |\r\n| ‚ú≥Ô∏è AADServicePrincipalSignInLogs Match |‚ú≥Ô∏è StorageBlobLogs Match |\r\n| ‚ú≥Ô∏è SecurityAlerts Match |‚ú≥Ô∏è AzureInformationProtectionLogs Match |\r\n"
                  },
                  "customWidth": "50",
                  "name": "text - 19"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imNetworkSession\r\n| extend Indicator = strcat(SrcIpAddr)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith \"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP)| where Indicator <> \"\") on Indicator\r\n| project Indicator, ThreatType, SrcIpAddr, DstIpAddr, Type, Activity, EventVendor, EventResult, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è imNetworkSession Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results20",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 41"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imAuthentication\r\n| extend Indicator = strcat(SrcDvcIpAddr)\r\n| where RemoteIPType <> \"Private\"\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith \"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP)| where Indicator <> \"\") on Indicator\r\n| project Indicator, ThreatType, SrcDvcIpAddr, EventVendor, EventProduct, SrcDvcHostname, TargetDvcHostname, TargetUsername, ActionType, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è imAuthentication Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results21",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 42"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imDns\r\n| extend Indicator = strcat(DnsResponseName)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith \"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP)| where Indicator <> \"\") on Indicator\r\n| project Indicator, ThreatType, Dvc, SrcIpAddr, DnsResponseName, EventVendor, EventProduct, EventType, DnsQuery, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è imDns Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results22",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 44"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "VMConnection \r\n| extend Indicator = strcat(SourceIp)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, Computer, SourceIp, DestinationIp, Direction, RemoteCountry, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è VMConnection (SourceIP) Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results1",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 10"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "VMConnection \r\n| extend Indicator = strcat(DestinationIp)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, Computer, SourceIp, DestinationIp, Direction, RemoteCountry, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è VMConnection (DestinationIP) Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results2",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 11"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityEvent \r\n| extend Indicator = strcat(IpAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, NetworkSourceIP, Computer, Account, Activity, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è SecurityEvent Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results3",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DnsEvents \r\n| extend Indicator = strcat(IPAddresses)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, ClientIP, SubType, Name, QueryType, ResultCode, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DnsEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results4",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//reference list posted here : https://docs.microsoft.com/azure/data-explorer/kusto/query/ipv4-lookup-plugin\r\nlet geoData = externaldata\r\n    (network: string, geoname_id: string, continent_code: string, continent_name: string,\r\n    country_iso_code: string, country_name: string, is_anonymous_proxy: string, is_satellite_provider: string)\r\n    [@\"https://raw.githubusercontent.com/datasets/geoip2-ipv4/master/data/geoip2-ipv4.csv\"] with (ignoreFirstRecord=true, format=\"csv\");\r\nlet materializedData =\r\n    materialize(\r\n    AzureDiagnostics\r\n    | where Category == \"AzureFirewallNetworkRule\"\r\n    | where OperationName <> \"AzureFirewallThreatIntelLog\"\r\n    | where OperationName <> \"AzureFirewallIDSLog\"\r\n    | project msg_s, Resource, TimeGenerated, ResourceId, ResourceGroup, SubscriptionId);\r\nunion\r\n    (\r\n    // Azure Firewall Networking - Standard Log\r\n    materializedData\r\n    | where msg_s !has \"Type=\"\r\n        and msg_s !has \"DNAT'ed\"\r\n        and msg_s !has \"Rule Collection:\"\r\n        and msg_s !has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \". Action: \" Action\r\n    ),\r\n    (\r\n    // Azure Firewall Networking with ICMP\r\n    materializedData\r\n    | where msg_s has \"Type=\"\r\n    | parse msg_s with Protocol \" Type=\" ICMPType \" request from \" SourceIP \" to \" DestinationIP \". Action: \" Action\r\n    ),\r\n    (\r\n    // Azure Firewall Networking DNAT rule - Standard\r\n    materializedData\r\n    | where msg_s has \"DNAT'ed\" and msg_s !has \". Rule Collection:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \" was \" Action \" to \" NatDestination\r\n    ),\r\n    (\r\n    // Azure Firewall Networking DNAT rule (firewall not using policy)\r\n    materializedData\r\n    | where msg_s has \"DNAT'ed\" and msg_s has \". Rule Collection:\" and msg_s !has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \" was \" Action \" to \" NatDestination \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    // Azure Firewall Networking DNAT rule (firewall using policy)\r\n    materializedData\r\n    | where msg_s has \"DNAT'ed\" and msg_s has \". Rule Collection:\" and msg_s has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \" was \" Action \" to \" NatDestination \". Policy: \" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    // Azure Firewall Network rule (firewall not using policy)\r\n    materializedData\r\n    | where msg_s has \"Rule Collection:\" and msg_s !has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \". Action: \" Action \". Rule Collection: \" RuleCollection \". Rule Name: \" Rule\r\n    ),\r\n    (\r\n    // Azure Firewall Network rule (firewall using policy)\r\n    materializedData\r\n    | where msg_s has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \". Action: \" Action \". Policy:\" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule Name: \" Rule\r\n    )\r\n| summarize\r\n    by\r\n    TimeGenerated,\r\n    Protocol,\r\n    ICMPType,\r\n    Action,\r\n    SourceIP,\r\n    SourcePort,\r\n    DestinationIP,\r\n    DestinationPort,\r\n    NatDestination,\r\n    ResourceId,\r\n    ResourceGroup,\r\n    SubscriptionId\r\n| evaluate ipv4_lookup (geoData, DestinationIP, network, false)\r\n| extend Indicator = strcat(SourceIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, ResourceId, SourceIP, SourcePort, DestinationIP, DestinationPort, Protocol, Action, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è AzureFirewall (SourceIP) Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results5",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//reference list posted here : https://docs.microsoft.com/azure/data-explorer/kusto/query/ipv4-lookup-plugin\r\nlet geoData = externaldata\r\n    (network: string, geoname_id: string, continent_code: string, continent_name: string,\r\n    country_iso_code: string, country_name: string, is_anonymous_proxy: string, is_satellite_provider: string)\r\n    [@\"https://raw.githubusercontent.com/datasets/geoip2-ipv4/master/data/geoip2-ipv4.csv\"] with (ignoreFirstRecord=true, format=\"csv\");\r\nlet materializedData =\r\n    materialize(\r\n    AzureDiagnostics\r\n    | where Category == \"AzureFirewallNetworkRule\"\r\n    | where OperationName <> \"AzureFirewallThreatIntelLog\"\r\n    | where OperationName <> \"AzureFirewallIDSLog\"\r\n    | project msg_s, Resource, TimeGenerated, ResourceId, ResourceGroup, SubscriptionId);\r\nunion\r\n    (\r\n    // Azure Firewall Networking - Standard Log\r\n    materializedData\r\n    | where msg_s !has \"Type=\"\r\n        and msg_s !has \"DNAT'ed\"\r\n        and msg_s !has \"Rule Collection:\"\r\n        and msg_s !has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \". Action: \" Action\r\n    ),\r\n    (\r\n    // Azure Firewall Networking with ICMP\r\n    materializedData\r\n    | where msg_s has \"Type=\"\r\n    | parse msg_s with Protocol \" Type=\" ICMPType \" request from \" SourceIP \" to \" DestinationIP \". Action: \" Action\r\n    ),\r\n    (\r\n    // Azure Firewall Networking DNAT rule - Standard\r\n    materializedData\r\n    | where msg_s has \"DNAT'ed\" and msg_s !has \". Rule Collection:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \" was \" Action \" to \" NatDestination\r\n    ),\r\n    (\r\n    // Azure Firewall Networking DNAT rule (firewall not using policy)\r\n    materializedData\r\n    | where msg_s has \"DNAT'ed\" and msg_s has \". Rule Collection:\" and msg_s !has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \" was \" Action \" to \" NatDestination \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    // Azure Firewall Networking DNAT rule (firewall using policy)\r\n    materializedData\r\n    | where msg_s has \"DNAT'ed\" and msg_s has \". Rule Collection:\" and msg_s has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \" was \" Action \" to \" NatDestination \". Policy: \" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    // Azure Firewall Network rule (firewall not using policy)\r\n    materializedData\r\n    | where msg_s has \"Rule Collection:\" and msg_s !has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \". Action: \" Action \". Rule Collection: \" RuleCollection \". Rule Name: \" Rule\r\n    ),\r\n    (\r\n    // Azure Firewall Network rule (firewall using policy)\r\n    materializedData\r\n    | where msg_s has \"Policy:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestinationIP \":\" DestinationPort \". Action: \" Action \". Policy:\" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule Name: \" Rule\r\n    )\r\n| summarize\r\n    by\r\n    TimeGenerated,\r\n    Protocol,\r\n    ICMPType,\r\n    Action,\r\n    SourceIP,\r\n    SourcePort,\r\n    DestinationIP,\r\n    DestinationPort,\r\n    NatDestination,\r\n    ResourceId,\r\n    ResourceGroup,\r\n    SubscriptionId\r\n| evaluate ipv4_lookup (geoData, DestinationIP, network, false)\r\n| extend Indicator = strcat(DestinationIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, ResourceId, SourceIP, SourcePort, DestinationIP, DestinationPort, Protocol, Action, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è AzureFirewall (DestinationIP) Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results6",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 5"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "BehaviorAnalytics \r\n| extend Indicator = strcat(SourceIPAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, ActivityType, ActionType, SourceIPLocation, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è BehaviorAnalytics Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results7",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 7"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureActivity \r\n| extend Indicator = strcat(CallerIpAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, Caller, ResourceId, OperationName, ActivityStatus, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è AzureActivity Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Caller",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results8",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 7"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceLogonEvents \r\n| extend Indicator = strcat(RemoteIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, AccountName, DeviceName, ActionType, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DeviceLogonEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "DeviceId",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Caller",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results9",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 8"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceNetworkEvents \r\n| extend Indicator = strcat(RemoteIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, DeviceName, InitiatingProcessFolderPath, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DeviceNetworkEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "DeviceId",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Caller",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results10",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 9"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceEvents \r\n| extend Indicator = strcat(RemoteIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, DeviceName, ActionType, InitiatingProcessFolderPath, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DeviceEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "DeviceId",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Caller",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results11",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 16"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "CommonSecurityLog \r\n| extend Indicator = strcat(SourceIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, DeviceProduct, SourceIP, DestinationIP, Activity, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è CommonSecurityLog (SourceIP) Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "DeviceId",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Caller",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results12",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": true,
                  "name": "query - 13"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "CommonSecurityLog \r\n| extend Indicator = strcat(DestinationIP)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, DeviceProduct, SourceIP, DestinationIP, Activity, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è CommonSecurityLog (DestinationIP) Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "DeviceId",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Caller",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results13",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 13"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SigninLogs\r\n| extend Indicator = strcat(IPAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, UserPrincipalName, AppDisplayName, ResultType, Location, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è SigninLogs Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "UserPrincipalName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Location",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "DeviceId",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Caller",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results14",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 13"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AADNonInteractiveUserSignInLogs\r\n| extend Indicator = strcat(IPAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, UserPrincipalName, AppDisplayName, ResultType, Location, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è AADNonInteractiveUserSignInLogs Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "UserPrincipalName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Location",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "DeviceId",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Caller",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results15",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 14"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AADServicePrincipalSignInLogs\r\n| extend Indicator = strcat(IPAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, Category, ResourceDisplayName, Location, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è AADServicePrincipalSignInLogs Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "UserPrincipalName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Location",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "DeviceId",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Caller",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results16",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 15"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "StorageBlobLogs\r\n| extend Indicator = strcat(CallerIpAddress)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, AccountName, OperationName, Location, StatusText, Uri, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è StorageBlobLogs Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Location",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Uri",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go To: Storage Blob >"
                          }
                        },
                        {
                          "columnMatch": "UserPrincipalName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "DeviceId",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Caller",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results17",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 17"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityAlert\r\n| extend Indicator = tostring(parse_json(Entities)[1].Address)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, ProductName, AlertName, AlertSeverity, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è SecurityAlerts Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "AlertSeverity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "AlertLink",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": ""
                          }
                        },
                        {
                          "columnMatch": "Location",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Uri",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go To: Storage Blob >"
                          }
                        },
                        {
                          "columnMatch": "UserPrincipalName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "DeviceId",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Caller",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results18",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 17"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "InformationProtectionLogs_CL\r\n| extend Indicator = strcat(IPv4_s_s)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith\"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, UserId_s_s, IPv4_s_s, LabelName_s, Operation_s_s, Activity_s_s, ApplicationName_s_s, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è AzureInformationProtectionLogs Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "AlertLink",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go To: Alert >"
                          }
                        },
                        {
                          "columnMatch": "Location",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Uri",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go To: Storage Blob >"
                          }
                        },
                        {
                          "columnMatch": "UserPrincipalName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "DeviceId",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Caller",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results19",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 19"
                }
              ]
            },
            "name": "IP Address"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "d8e8ac75-e764-4ff8-941b-bc8ad77df072",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results01",
                        "type": 1,
                        "query": "DeviceEvents\r\n| extend Indicator = strcat(InitiatingProcessSHA256)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results01",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "0170dd32-b8c9-420c-9713-fa4b4e31e439",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results02",
                        "type": 1,
                        "query": "DeviceProcessEvents\r\n| extend Indicator = strcat(InitiatingProcessSHA256)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results02",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "df16df02-0697-4169-bd6b-1a8f41075d30",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results03",
                        "type": 1,
                        "query": "DeviceFileEvents\r\n| extend Indicator = strcat(InitiatingProcessSHA256)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results03",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "7b07c228-c62a-45cc-86ba-8b0758227e50",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results04",
                        "type": 1,
                        "query": "DeviceImageLoadEvents\r\n| extend Indicator = strcat(InitiatingProcessSHA256)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results04",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "c5a037bf-2be0-464e-abeb-e3aa99d098c5",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results05",
                        "type": 1,
                        "query": "DeviceNetworkEvents\r\n| extend Indicator = strcat(InitiatingProcessSHA256)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results05",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "00807003-daed-47ca-8372-3ee8742f1826",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results06",
                        "type": 1,
                        "query": "imProcess\r\n| extend Indicator = TargetProcessSHA256\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(FileHashValue) | where Indicator <> \"\") on Indicator\r\n| project Indicator, Type, EventType, EventProduct, EventVendor, DvcHostname, TargetUsername, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results06",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "6fa82d56-f6f5-457e-920e-720042ef67cb",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results07",
                        "type": 1,
                        "query": "imProcessCreate\r\n| extend Indicator = TargetProcessSHA256\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(FileHashValue) | where Indicator <> \"\") on Indicator\r\n| project Indicator, Type, EventType, EventProduct, EventVendor, DvcHostname, TargetUsername, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "25",
                  "name": "Results07",
                  "styleSettings": {
                    "maxWidth": "25"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "68b1e45b-a9d5-4383-a88a-28f4eb9788d4",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results08",
                        "type": 1,
                        "query": "imProcessTerminate\r\n| extend Indicator = TargetProcessSHA256\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(FileHashValue) | where Indicator <> \"\") on Indicator\r\n| project Indicator, Type, EventType, EventProduct, EventVendor, DvcHostname, TargetUsername, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results08",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "60536e3c-7248-49dc-a591-5a459de84ef3",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results09",
                        "type": 1,
                        "query": "imRegistry\r\n| extend Indicator = strcat(ActingProcessSHA256)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(FileHashValue) | where Indicator <> \"\") on Indicator\r\n| project Indicator, Type, RegistryKey, EventType, EventProduct, EventVendor, DvcHostname, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results09",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# File Hash Indicators Observed\r\n\r\n| <strong> File Hash Indicator Queries </strong> | \r\n|:--|\r\n| ‚ú≥Ô∏è imProcess Match |\r\n| ‚ú≥Ô∏è imProcessCreate Match |\r\n| ‚ú≥Ô∏è imProcessTerminate Match |\r\n| ‚ú≥Ô∏è imRegistry Match |\r\n| ‚ú≥Ô∏è DeviceEvents Match |\r\n| ‚ú≥Ô∏è DeviceProcessEvents Match |\r\n| ‚ú≥Ô∏è DeviceFileEvents Match |\r\n| ‚ú≥Ô∏è DeviceImageLoadEvents Match |\r\n| ‚ú≥Ô∏è DeviceNetworkEvents Match |\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "text - 19"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imProcess\r\n| extend Indicator = TargetProcessSHA256\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(FileHashValue) | where Indicator <> \"\") on Indicator\r\n| project Indicator, Type, EventType, EventProduct, EventVendor, DvcHostname, TargetUsername, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è imProcess Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results06",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 12"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imProcessCreate\r\n| extend Indicator = TargetProcessSHA256\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(FileHashValue) | where Indicator <> \"\") on Indicator\r\n| project Indicator, Type, EventType, EventProduct, EventVendor, DvcHostname, TargetUsername, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è imProcessCreate Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results07",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 14"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imProcessTerminate\r\n| extend Indicator = TargetProcessSHA256\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(FileHashValue) | where Indicator <> \"\") on Indicator\r\n| project Indicator, Type, EventType, EventProduct, EventVendor, DvcHostname, TargetUsername, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è imProcessTerminate Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results08",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 16"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imRegistry\r\n| extend Indicator = strcat(ActingProcessSHA256)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(FileHashValue) | where Indicator <> \"\") on Indicator\r\n| project Indicator, Type, RegistryKey, EventType, EventProduct, EventVendor, DvcHostname, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è imRegistry Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results09",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 18"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceEvents\r\n| extend Indicator = strcat(InitiatingProcessSHA256)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, DeviceName, FileName, FolderPath, InitiatingProcessParentFileName, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DeviceEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results01",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 10"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceProcessEvents\r\n| extend Indicator = strcat(InitiatingProcessSHA256)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, DeviceName, FileName, FolderPath, InitiatingProcessParentFileName, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DeviceProcessEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results02",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceFileEvents\r\n| extend Indicator = strcat(InitiatingProcessSHA256)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, DeviceName, FileName, FolderPath, InitiatingProcessParentFileName, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DeviceFileEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results03",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 7"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceImageLoadEvents\r\n| extend Indicator = strcat(InitiatingProcessSHA256)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, DeviceName, FileName, FolderPath, InitiatingProcessParentFileName, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DeviceImageLoadEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results04",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 8"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceNetworkEvents\r\n| extend Indicator = strcat(InitiatingProcessSHA256)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project DeviceName, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessFolderPath, RemoteIP, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DeviceNetworkEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results05",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 9"
                }
              ]
            },
            "name": "FIle Hash"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "d8e8ac75-e764-4ff8-941b-bc8ad77df072",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results001",
                        "type": 1,
                        "query": "DnsEvents\r\n| extend Indicator = strcat(Name)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results001",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "17a9430a-f040-4724-b623-a52c637192bb",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results002",
                        "type": 1,
                        "query": "let materializedData =\r\n    materialize(\r\n    AzureDiagnostics\r\n    | where Category == \"AzureFirewallApplicationRule\"\r\n    | project msg_s, Resource, TimeGenerated);\r\nunion\r\n    (\r\n    materializedData\r\n    | where msg_s has \"Web Category:\" and msg_s has \". Url\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Url:\" Url \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s has \". Url\"\r\n        and msg_s has \". No rule matched\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Url:\" Url \". Action: \" Action \". No rule matched\" *\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s has \". No rule matched\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". No rule matched\" *\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \"Web Category:\" and msg_s !has \". Url\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Rule Collection\"\r\n        and msg_s !has \" Reason: \"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". \" RuleCollection \". \" Rule\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Rule Collection\"\r\n        and msg_s !has \"TLS extension was missing\"\r\n    | where msg_s has \" Reason:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \". Action: \" Action \". Reason: \" Rule \".\"\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"TLS extension was missing\"\r\n        and msg_s !has \"No rule matched\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Rule Collection\"\r\n        and msg_s !has \" Reason: \"\r\n    | where msg_s has \"Rule Collection Group\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Policy:\" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    )\r\n| extend Indicator = FQDN\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results002",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "4423d393-062f-4165-8f56-0325beacfdb7",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results003",
                        "type": 1,
                        "query": "DeviceEvents\r\n| extend Indicator = RemoteUrl\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results003",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "c6fae073-a5f3-4913-a3ff-a0ddb286f96f",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results004",
                        "type": 1,
                        "query": "DeviceFileCertificateInfo \r\n| extend Indicator = tostring(parse_json(CrlDistributionPointUrls)[0])\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results004",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "40830046-0eac-4712-899f-8bd61f63f859",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results005",
                        "type": 1,
                        "query": "DeviceFileEvents\r\n| where FileOriginUrl <> \"\"\r\n| extend Indicator = FileOriginUrl\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results005",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "b8bf1128-3622-4de1-85cc-1d940508ee07",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results006",
                        "type": 1,
                        "query": "DeviceNetworkEvents\r\n| where RemoteUrl <> \"\"\r\n| extend Indicator = strcat(\"https://\",RemoteUrl)\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results006",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "651f9a95-4de7-44cc-9411-da7f6d409eb7",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results007",
                        "type": 1,
                        "query": "EmailUrlInfo\r\n| extend Indicator = Url\r\n| where Url <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "30",
                  "name": "Results007",
                  "styleSettings": {
                    "maxWidth": "30"
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "1beb6967-f7b0-4491-83bc-4a9d0233588c",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results008",
                        "type": 1,
                        "query": "imDns\r\n| extend Indicator = DnsQuery\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(Url, DomainName) | where Indicator <> \"\" ) on Indicator\r\n| project Indicator, ThreatType, DnsQuery, Dvc, SrcIpAddr, DnsResponseName, EventVendor, EventProduct, EventType, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "5",
                  "name": "Results008",
                  "styleSettings": {
                    "maxWidth": "5"
                  }
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# URL & Domain Indicators Observed\r\n\r\n| <strong> URL & Domain Indicator Queries </strong> | \r\n|:--|\r\n| ‚ú≥Ô∏è imDns Match |\r\n| ‚ú≥Ô∏è DnsEvents Match |\r\n| ‚ú≥Ô∏è Azure Firewall FQDN Match |\r\n| ‚ú≥Ô∏è DeviceEvents Match |\r\n| ‚ú≥Ô∏è DeviceFileCertificateInfo Match |\r\n| ‚ú≥Ô∏è DeviceFileEvents Match |\r\n| ‚ú≥Ô∏è DeviceNetworkEvents Match |\r\n| ‚ú≥Ô∏è EmailUrlInfo Match |\r\n\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "text - 19"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imDns\r\n| extend Indicator = DnsQuery\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(Url, DomainName) | where Indicator <> \"\" ) on Indicator\r\n| project Indicator, ThreatType, DnsQuery, Dvc, SrcIpAddr, DnsResponseName, EventVendor, EventProduct, EventType, TimeGenerated\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è imDns Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results008",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 16"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DnsEvents\r\n| extend Indicator = strcat(Name)\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, ClientIP, SubType, QueryType, ResultCode, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DnsEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results001",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 10"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let materializedData =\r\n    materialize(\r\n    AzureDiagnostics\r\n    | where Category == \"AzureFirewallApplicationRule\"\r\n    | project msg_s, Resource, TimeGenerated);\r\nunion\r\n    (\r\n    materializedData\r\n    | where msg_s has \"Web Category:\" and msg_s has \". Url\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Url:\" Url \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s has \". Url\"\r\n        and msg_s has \". No rule matched\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Url:\" Url \". Action: \" Action \". No rule matched\" *\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s has \". No rule matched\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". No rule matched\" *\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \"Web Category:\" and msg_s !has \". Url\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Rule Collection\"\r\n        and msg_s !has \" Reason: \"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". \" RuleCollection \". \" Rule\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Rule Collection\"\r\n        and msg_s !has \"TLS extension was missing\"\r\n    | where msg_s has \" Reason:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \". Action: \" Action \". Reason: \" Rule \".\"\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"TLS extension was missing\"\r\n        and msg_s !has \"No rule matched\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Rule Collection\"\r\n        and msg_s !has \" Reason: \"\r\n    | where msg_s has \"Rule Collection Group\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Policy:\" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    )\r\n| extend Indicator = FQDN\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, Resource, SourceIP, Action, msg_s, TimeGenerated\r\n| sort by TimeGenerated desc \r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è AzureFirewall FQDN Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results002",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceEvents\r\n| extend Indicator = RemoteUrl\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, InitiatingProcessAccountUpn, DeviceName, InitiatingProcessFolderPath, TimeGenerated\r\n| sort by TimeGenerated desc \r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DeviceEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results003",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 6"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceFileCertificateInfo \r\n| extend Indicator = tostring(parse_json(CrlDistributionPointUrls)[0])\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, DeviceName, Issuer, Type, TimeGenerated\r\n| sort by TimeGenerated desc \r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DeviceFileCertificateInfo  Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results004",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 8"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceFileEvents\r\n| where FileOriginUrl <> \"\"\r\n| extend Indicator = FileOriginUrl\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, DeviceName, FileName, FolderPath, FileOriginUrl, TimeGenerated \r\n| sort by TimeGenerated desc \r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DeviceFileEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results005",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 10"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceNetworkEvents\r\n| where RemoteUrl <> \"\"\r\n| extend Indicator = strcat(\"https://\",RemoteUrl)\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, DeviceName, InitiatingProcessAccountName, InitiatingProcessFolderPath, \r\nInitiatingProcessParentFileName, LocalIP, RemoteIP, TimeGenerated\r\n| sort by TimeGenerated desc \r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è DeviceNetworkEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results006",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 12"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "EmailUrlInfo\r\n| extend Indicator = Url\r\n| where Url <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project Indicator, Type, UrlDomain, TenantId, NetworkMessageId, TimeGenerated\r\n| sort by TimeGenerated desc \r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è EmailUrlInfo Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results007",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 14"
                }
              ]
            },
            "name": "URL & Domain"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "d8e8ac75-e764-4ff8-941b-bc8ad77df072",
                        "version": "KqlParameterItem/1.0",
                        "name": "Results0001",
                        "type": 1,
                        "query": "EmailEvents\r\n| extend Indicator = SenderMailFromAddress\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "doNotRunWhenHidden": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "60",
                  "name": "Results0001",
                  "styleSettings": {
                    "maxWidth": "60"
                  }
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Email Sender Indicators Observed\r\n\r\n| <strong> URL & Domain Indicator Queries </strong> | \r\n|:--|\r\n| ‚ú≥Ô∏è EmailEvents Match |\r\n\r\n\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "text - 19"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "EmailEvents\r\n| extend Indicator = SenderMailFromAddress\r\n| where Indicator <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)) on Indicator\r\n| where Indicator contains '{Indicator}' or Indicator == \"*\"\r\n| project SenderMailFromAddress, EmailDirection, DeliveryAction, ConfidenceLevel, RecipientEmailAddress, Subject, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "‚ú≥Ô∏è EmailEvents Match",
                    "noDataMessage": "There are currently no matching threat indicators within these parameters.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Results0001",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "showPin": false,
                  "name": "query - 10"
                }
              ]
            },
            "name": "Email Sender"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "TAB",
        "comparison": "isEqualTo",
        "value": "ThreatHunting"
      },
      "name": "Threat Hunting"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "parameters": [
                {
                  "id": "187c8c20-0890-4dd4-a0b8-0f37f79b70bc",
                  "version": "KqlParameterItem/1.0",
                  "name": "Results200",
                  "type": 1,
                  "query": "VMConnection\r\n| extend Indicator = strcat(RemoteIp)\r\n| where Indicator <> \"\"\r\n| where RemoteCountry <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP)) on Indicator\r\n| limit 1\r\n| summarize count()\r\n| extend Results = iff(count_ ==0, \"No\", \"Yes\")\r\n| project Results",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "isHiddenWhenLocked": true,
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "pills",
              "doNotRunWhenHidden": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "Results200"
          },
          {
            "type": 1,
            "content": {
              "json": "## [‚ú≥Ô∏èEnable ServiceMap for VMConnection Logging by Geolocation](https://docs.microsoft.com/azure/azure-monitor/vm/service-map)\r\n\r\n| <strong> Threat Intelligence Queries </strong> | -|\r\n|:--| :--|\r\n| ‚ú≥Ô∏è Indicators Observed by Geolocation | ‚ú≥Ô∏è Indicators Observed by Geolocation Details |\r\n| ‚ú≥Ô∏è Network Assets Targeted over Time |‚ú≥Ô∏è Threat Intelligence: Indicator Details |\r\n"
            },
            "name": "text - 19"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "VMConnection\r\n| extend Indicator = strcat(RemoteIp)\r\n| where Indicator <> \"\"\r\n| where RemoteCountry <> \"\"\r\n| join (ThreatIntelligenceIndicator | extend Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP)) on Indicator",
              "size": 3,
              "showAnalytics": true,
              "title": "üü¶ Indicators Observed by Geolocation",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "map",
              "mapSettings": {
                "locInfo": "CountryRegion",
                "locInfoColumn": "RemoteCountry",
                "latitude": "RemoteLatitude",
                "longitude": "RemoteLongitude",
                "sizeSettings": "RemoteCountry",
                "sizeAggregation": "Count",
                "labelSettings": "RemoteCountry",
                "legendMetric": "RemoteCountry",
                "legendAggregation": "Count",
                "itemColorSettings": {
                  "nodeColorField": "RemoteIp",
                  "colorAggregation": "Count",
                  "type": "thresholds",
                  "thresholdsGrid": [
                    {
                      "operator": "Default",
                      "thresholdValue": null,
                      "representation": "redBright"
                    }
                  ]
                }
              }
            },
            "customWidth": "60",
            "conditionalVisibility": {
              "parameterName": "Results200",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "query - 0"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "VMConnection\r\n| extend Indicator = strcat(RemoteIp)\r\n| where Indicator <> \"\"\r\n| where RemoteCountry <> \"\"\r\n| join (ThreatIntelligenceIndicator\r\n    | extend Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP))\r\n    on Indicator\r\n    | summarize count() by RemoteCountry, Indicator\r\n    | sort by count_ desc\r\n    | limit 250",
              "size": 0,
              "showAnalytics": true,
              "title": "üü¶ Indicators Observed by Geolocation Details",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "RemoteCountry",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Globe",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Indicator",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev0",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "RiskIQ_Lookup",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "RiskIQ Lookup >"
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  }
                ],
                "filter": true
              }
            },
            "customWidth": "40",
            "conditionalVisibility": {
              "parameterName": "Results200",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "query - 6"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "VMConnection\r\n| extend NetworkSourceIP=RemoteIp\r\n| where NetworkSourceIP <> \"\"\r\n| join (ThreatIntelligenceIndicator) on NetworkSourceIP\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by Computer\r\n| render timechart",
              "size": 2,
              "showAnalytics": true,
              "title": "üü¶ Network Assets Targeted over Time",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "ThreatType",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "2",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "RemoteCountry",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Globe",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Source",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "View",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  }
                ],
                "filter": true
              },
              "mapSettings": {
                "locInfo": "CountryRegion",
                "locInfoColumn": "RemoteCountry",
                "latitude": "RemoteLatitude",
                "longitude": "RemoteLongitude",
                "sizeSettings": "RemoteCountry",
                "sizeAggregation": "Count",
                "labelSettings": "RemoteCountry",
                "legendMetric": "RemoteCountry",
                "legendAggregation": "Count",
                "itemColorSettings": {
                  "nodeColorField": "RemoteIp",
                  "colorAggregation": "Count",
                  "type": "thresholds",
                  "thresholdsGrid": [
                    {
                      "operator": "Default",
                      "thresholdValue": null,
                      "representation": "redBright"
                    }
                  ]
                }
              }
            },
            "conditionalVisibility": {
              "parameterName": "Results200",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "query - 3"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "VMConnection\r\n| extend NetworkSourceIP=RemoteIp\r\n| where NetworkSourceIP <> \"\"\r\n| join (ThreatIntelligenceIndicator) on NetworkSourceIP\r\n| extend Indicator = strcat(NetworkSourceIP, FileHashValue, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)\r\n| extend Source=SourceSystem1\r\n| summarize count () by ThreatType, Indicator, Direction, _ResourceId, RemoteCountry, RemoteIp, Source\r\n| sort by count_ desc\r\n| limit 250",
              "size": 0,
              "showAnalytics": true,
              "title": "üü¶ Threat Intelligence: Indicator Details",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "ThreatType",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "2",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "RiskIQ_Lookup",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "RiskIQ Lookup >"
                    }
                  },
                  {
                    "columnMatch": "RemoteCountry",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Globe",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Source",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "View",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  },
                  {
                    "columnMatch": "VirusTotalURL",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "VirusTotal Lookup >"
                    }
                  }
                ],
                "filter": true
              },
              "mapSettings": {
                "locInfo": "CountryRegion",
                "locInfoColumn": "RemoteCountry",
                "latitude": "RemoteLatitude",
                "longitude": "RemoteLongitude",
                "sizeSettings": "RemoteCountry",
                "sizeAggregation": "Count",
                "labelSettings": "RemoteCountry",
                "legendMetric": "RemoteCountry",
                "legendAggregation": "Count",
                "itemColorSettings": {
                  "nodeColorField": "RemoteIp",
                  "colorAggregation": "Count",
                  "type": "thresholds",
                  "thresholdsGrid": [
                    {
                      "operator": "Default",
                      "thresholdValue": null,
                      "representation": "redBright"
                    }
                  ]
                }
              }
            },
            "conditionalVisibility": {
              "parameterName": "Results200",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "Threat Intelligence: Indicator Details"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "TAB",
        "comparison": "isEqualTo",
        "value": "ThreatIntelligence"
      },
      "name": "Threat Intelligence"
    }
  ],
  "fromTemplateId": "sentinel-ThreatIntelligence",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}