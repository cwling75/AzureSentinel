{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "3218e2b0-1bcc-46d4-affa-d298e0cf90f6",
            "version": "KqlParameterItem/1.0",
            "name": "Help",
            "label": "üîé Guide",
            "type": 10,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "jsonData": "[\r\n    {\"value\": \"Yes\", \"label\": \"Yes\", \"selected\":true},\r\n    {\"value\": \"No\", \"label\": \"No\"}\r\n]",
            "value": "No"
          },
          {
            "id": "e6ded9a1-a83c-4762-938d-5bf8ff3d3d38",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 6,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "value": [
              "value::all"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "includeAll": true,
              "showDefault": false
            }
          },
          {
            "id": "e3225ed0-6210-40a1-b2d0-66e42ffa71d6",
            "version": "KqlParameterItem/1.0",
            "name": "Workspace",
            "type": 5,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "resources\r\n| where type =~ 'microsoft.operationalinsights/workspaces'\r\n| order by name asc\r\n| summarize Selected = makelist(id, 10), All = makelist(id, 1000)\r\n| mvexpand All limit 100\r\n| project value = tostring(All), label = tostring(All), selected = iff(Selected contains All, true, false)",
            "crossComponentResources": [
              "value::all"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "15b2c181-7397-43c1-900a-28e175ae8a6f",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "label": "‚è±Ô∏è Time Range",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 2592000000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            }
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "Parameter Selectors"
    },
    {
      "type": 1,
      "content": {
        "json": "<svg viewBox=\"0 0 19 19\" width=\"20\" class=\"fxt-escapeShadow\" role=\"presentation\" focusable=\"false\" xmlns:svg=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" aria-hidden=\"true\"><g><path fill=\"#1b93eb\" d=\"M16.82 8.886c0 4.81-5.752 8.574-7.006 9.411a.477.477 0 01-.523 0C8.036 17.565 2.18 13.7 2.18 8.886V3.135a.451.451 0 01.42-.419C7.2 2.612 6.154.625 9.5.625s2.3 1.987 6.8 2.091a.479.479 0 01.523.419z\"></path><path fill=\"url(#0024423711759027356)\" d=\"M16.192 8.99c0 4.392-5.333 7.947-6.483 8.575a.319.319 0 01-.418 0c-1.15-.732-6.483-4.183-6.483-8.575V3.762a.575.575 0 01.313-.523C7.2 3.135 6.258 1.357 9.4 1.357s2.2 1.882 6.274 1.882a.45.45 0 01.419.418z\"></path><path d=\"M9.219 5.378a.313.313 0 01.562 0l.875 1.772a.314.314 0 00.236.172l1.957.284a.314.314 0 01.174.535l-1.416 1.38a.312.312 0 00-.09.278l.334 1.949a.313.313 0 01-.455.33l-1.75-.92a.314.314 0 00-.292 0l-1.75.92a.313.313 0 01-.455-.33L7.483 9.8a.312.312 0 00-.09-.278L5.977 8.141a.314.314 0 01.174-.535l1.957-.284a.314.314 0 00.236-.172z\" class=\"msportalfx-svg-c01\"></path></g></svg>&nbsp;<span style=\"font-family: Open Sans; font-weight: 620; font-size: 14px;font-style: bold;margin:-10px 0px 0px 0px;position: relative;top:-3px;left:-4px;\"> Please take time to answer a quick survey,\r\n</span>[<span style=\"font-family: Open Sans; font-weight: 620; font-size: 14px;font-style: bold;margin:-10px 0px 0px 0px;position: relative;top:-3px;left:-4px;\"> click here. </span>](https://forms.office.com/r/0diZsXih6e)"
      },
      "name": "Survey"
    },
    {
      "type": 1,
      "content": {
        "json": "## Getting Started\r\nThe Microsoft Sentinel: Maturity Model for Event Log Management (M-21-31) Solution leverages Azure Policy, Azure Resource Graph, and Azure Log Analytics to align directly with the requirements outlined in the Executive Office of the President: Office of Management & Budget Memorandum (M-21-31): Improving the Federal Government's Investigative and Remediation Capabilities Related to Cybersecurity Incidents. This solution provides the capability to design, build, monitor, and remediate event log management. The Solution includes (1) Workbook for reporting, (5) Analytics Rules for monitoring, and (1) Playbook for response/remediation. The documentation below provides getting started recommendations for centralizing log analytics data and enabling Microsoft Defender for Cloud Continuous Export. This offering includes telemetry from 25+ Microsoft and Third Party products. Common use cases include conducting M-21-31 assessments via custom reporting, time filtering, subscription filtering, workspace filtering, and guides. The report is exportable for print or PDF with the Print Workbook feature. The workbook is organized by Event Logging Tiers (1-3) which highlight maturity from basic to advanced levels. There are multiple requirements within each Event Logging Tier, each covered by a Control Card. Control Cards include requirements summary, reference documentation links, recommendations for build/design, technology mapping, telemetry over time, and product/portal pages.<br> For more information, see üí°[Improving the Federal Government‚Äôs Investigative and Remediation Capabilities Related to Cybersecurity Incidents (M-21-31)](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)<br>\r\n\r\n1Ô∏è‚É£ [Design Log Management Architecture](https://docs.microsoft.com/azure/azure-monitor/logs/design-logs-deployment)<br>\r\n2Ô∏è‚É£ [Onboard Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/quickstart-onboard)<br>\r\n3Ô∏è‚É£ [Connect & Ingest Data Sources](https://docs.microsoft.com/azure/sentinel/connect-data-sources)<br>\r\n4Ô∏è‚É£ [Extend Microsoft Sentinel Across Workspaces and Tenants](https://docs.microsoft.com/azure/sentinel/extend-sentinel-across-workspaces-tenants)<br>\r\n5Ô∏è‚É£ [Configure 12 Months Active Storage with Data Retention](https://docs.microsoft.com/azure/azure-monitor/logs/manage-cost-storage#change-the-data-retention-period)<br>\r\n6Ô∏è‚É£ [Configure 18 Months Cold Data Storage with Azure Data Explorer](https://docs.microsoft.com/azure/sentinel/store-logs-in-azure-data-explorer?tabs=adx-event-hub)<br>\r\n7Ô∏è‚É£ [Onboard Microsoft Defender for Cloud](https://docs.microsoft.com/azure/security-center/security-center-get-started)<br>\r\n8Ô∏è‚É£ [Add the Azure Security Benchmark Assessment to Your Dashboard](https://docs.microsoft.com/azure/security-center/update-regulatory-compliance-packages#add-a-regulatory-standard-to-your-dashboard)<br>\r\n9Ô∏è‚É£ [Continuously Export Security Center Data](https://docs.microsoft.com/azure/security-center/continuous-export)<br>\r\n\r\nThis Solution demonstrates best practice guidance, but Microsoft does not guarantee nor imply compliance. All requirements, validations, and controls are governed by respective organizations. This solution provides visibility and situational awareness for security capabilities delivered with Microsoft technologies in predominantly cloud-based environments. Customer experience will vary by user and some panels may require additional configurations for operation. Recommendations do not imply coverage of respective controls as they are often one of several courses of action for approaching requirements which is unique to each customer. Recommendations should be considered a starting point for planning full or partial coverage of respective requirements. ",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Help",
        "comparison": "isEqualTo",
        "value": "Yes"
      },
      "name": "Help"
    },
    {
      "type": 1,
      "content": {
        "json": "# Maturity Model for Event Log Management (M-21-31)\n---\n\nWelcome to the Maturity Model for Event Log Management (M-21-31) Solution. This solution is designed to enable Cloud Architects, Security Engineers, and Governance Risk Compliance Professionals to increase visibility before, during, and after a cybersecurity incident. Information from logs on information systems (for both on-premises systems and connections \nhosted by third parties, such as cloud services providers (CSPs) is invaluable in the detection, \ninvestigation, and remediation of cyber threats. \"Executive Order 14028, Improving the Nation's Cybersecurity, directs decisive action to improve the Federal Government‚Äôs investigative and remediation capabilities. This memorandum was developed in accordance with and addresses the requirements in section 8 of the Executive Order for logging, log retention, and log management, with a focus on ensuring centralized access and visibility for the highest-level enterprise security operations center (SOC) of each agency. In addition, this memorandum establishes requirements for agencies to increase the sharing of such information, as needed and appropriate, to accelerate incident response efforts and to enable more effective defense of Federal information and executive branch departments and agencies.\" For more information, see üí°[Improving the Federal Government‚Äôs Investigative and Remediation Capabilities Related to Cybersecurity Incidents (M-21-31)](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\n"
      },
      "customWidth": "79",
      "name": "Workbook Overview"
    },
    {
      "type": 1,
      "content": {
        "json": "![Image Name](https://azure.microsoft.com/svghandler/azure-sentinel?width=600&height=315) "
      },
      "customWidth": "21",
      "name": "Microsoft Sentinel Logo"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Section\\\": \\\"Assessment\\\", \\\"tab\\\": \\\"AT\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Log Management\\\", \\\"tab\\\": \\\"LM\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Event Logging (EL0)\\\", \\\"tab\\\": \\\"EL0\\\" },\\t\\r\\n\\t{ \\\"Section\\\": \\\"Basic Event Logging (EL1)\\\", \\\"tab\\\": \\\"EL1\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Intermediate Event Logging (EL2)\\\", \\\"tab\\\": \\\"EL2\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Advanced Event Logging (EL3)\\\", \\\"tab\\\": \\\"EL3\\\" }\\r\\n]\",\"transformers\":null}",
        "size": 3,
        "title": "Event Logging Tiers",
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "tab",
            "parameterName": "Tab",
            "parameterType": 1
          }
        ],
        "queryType": 8,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "Section",
              "formatter": 8,
              "formatOptions": {
                "palette": "blue"
              }
            },
            {
              "columnMatch": "tab",
              "formatter": 5
            }
          ]
        }
      },
      "customWidth": "50",
      "name": "Event Logging Tiers"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "a30d01d0-38f1-4a91-9cf6-cdb181d676b5",
            "version": "KqlParameterItem/1.0",
            "name": "isATVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "AT",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isLMVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "LM",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "b9206eb3-218c-4745-9cfe-9a9e49e46314"
          },
          {
            "id": "d41cb044-86ef-4603-ae24-c61e864c067d",
            "version": "KqlParameterItem/1.0",
            "name": "isEL0Visible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "EL0",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isEL1Visible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "EL1",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "89e12ca8-369c-4aca-802b-e014a0d54c46"
          },
          {
            "id": "7b682fc9-cb6b-4475-a24c-41dcb43d0cef",
            "version": "KqlParameterItem/1.0",
            "name": "isEL2Visible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "EL2",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "15158143-a4f8-417b-90b0-123dd13f1ff5",
            "version": "KqlParameterItem/1.0",
            "name": "isEL3Visible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "EL3",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "customWidth": "1",
      "name": "Hidden Parameters"
    },
    {
      "type": 1,
      "content": {
        "json": ""
      },
      "customWidth": "30",
      "name": "text - 13"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Assessment\r\n---\r\n\r\nThe Assessment section provides a mechanism to find, fix, and resolve M-21-31 recommendations. A selector provides capability to filter by all, specific, or groups of event logging levels. Upon selection, subordinate panels will summarize recommendations by event logging level, status over time, recommendations, and resources identified. These panels are helpful for identifying the event logging areas of interest, status over time, and which resources are most impacted by these vulnerabilities. The Recommendation details provides a mechanism to identify specific recommendation details with deep-links to pivot to Microsoft Defender for Cloud: Regulatory Compliance for remediation. "
            },
            "customWidth": "49",
            "name": "NS Guide"
          },
          {
            "type": 1,
            "content": {
              "json": ""
            },
            "customWidth": "5",
            "name": "text - 11"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "parameters": [
                {
                  "id": "99a47f97-1aa4-4840-91ee-119aad6d6217",
                  "version": "KqlParameterItem/1.0",
                  "name": "MaturityLevel",
                  "label": "Maturity Level",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "value": [
                    "Advanced Event Logging (EL3)",
                    "Event Logging (EL0)",
                    "Basic Event Logging (EL1)",
                    "Intermediate Event Logging (EL2)"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    {\"value\": \"Event Logging (EL0)\", \"label\": \"Event Logging (EL0)\"},\r\n    {\"value\": \"Basic Event Logging (EL1)\", \"label\": \"Basic Event Logging (EL1)\"},\r\n    {\"value\": \"Intermediate Event Logging (EL2)\", \"label\": \"Intermediate Event Logging (EL2)\"},\r\n    {\"value\": \"Advanced Event Logging (EL3)\", \"label\": \"Advanced Event Logging (EL3)\"}\r\n]",
                  "timeContext": {
                    "durationMs": 2592000000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "40",
            "name": "parameters - 26"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let EventLogManagement = externaldata(RecommendationDisplayName:string,LoggingCategory:string,MaturityLevel:string) [@\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/Feeds/EventLogManagement.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\r\nSecurityRecommendation\r\n| join kind=leftouter (EventLogManagement) on RecommendationDisplayName\r\n| where MaturityLevel in ({MaturityLevel})\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n|‚ÄØsummarize‚ÄØFailed‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Unhealthy\"),‚ÄØPassed‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Healthy\"),‚ÄØTotal‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Healthy\" or RecommendationState == \"Unhealthy\") by MaturityLevel\r\n|‚ÄØextend‚ÄØPassedControls‚ÄØ= (Passed/todouble(Total))*100\r\n| project MaturityLevel, Total, PassedControls, Passed, Failed\r\n| sort by Total desc\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "üîÄ Log Management Recommendations by Maturity Level",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Total",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "[\"Passed\"]/[\"Total\"]",
                        "columnSettings": [
                          {
                            "columnName": "Passed",
                            "color": "green"
                          },
                          {
                            "columnName": "Failed",
                            "color": "redBright"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "PassedControls",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 1,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true,
                        "minimumIntegerDigits": 2,
                        "minimumFractionDigits": 2,
                        "maximumFractionDigits": 2,
                        "minimumSignificantDigits": 2,
                        "maximumSignificantDigits": 4
                      }
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "yellowOrangeRed"
                    }
                  },
                  {
                    "columnMatch": "total_controls_curr",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "[\"Passed\"]/[\"Failed\"]",
                        "columnSettings": [
                          {
                            "columnName": "Passed",
                            "color": "green"
                          },
                          {
                            "columnName": "Failed",
                            "color": "redBright"
                          }
                        ]
                      }
                    }
                  }
                ],
                "filter": true
              }
            },
            "customWidth": "50",
            "name": "query - 6"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let EventLogManagement = externaldata(RecommendationDisplayName:string,LoggingCategory:string,MaturityLevel:string) [@\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/Feeds/EventLogManagement.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\r\nSecurityRecommendation\r\n| join kind=leftouter (EventLogManagement) on RecommendationDisplayName\r\n| where MaturityLevel in ({MaturityLevel})\r\n| summarize arg_max(TimeGenerated, *) by AssessedResourceId\r\n|‚ÄØsummarize‚ÄØFailed‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Unhealthy\"),‚ÄØPassed‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Healthy\"),‚ÄØTotal‚ÄØ=‚ÄØcountif(RecommendationState‚ÄØ==‚ÄØ\"Healthy\" or RecommendationState == \"Unhealthy\") by RecommendationDisplayName, MaturityLevel\r\n|‚ÄØextend‚ÄØPassedControls‚ÄØ= (Passed/todouble(Total))*100\r\n| project RecommendationDisplayName, Total, PassedControls, Passed, Failed\r\n| sort by Total desc",
              "size": 0,
              "showAnalytics": true,
              "title": "üîÄ Log Management Recommendations by Count",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Total",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "[\"Passed\"]/[\"Total\"]",
                        "columnSettings": [
                          {
                            "columnName": "Passed",
                            "color": "green"
                          },
                          {
                            "columnName": "Failed",
                            "color": "redBright"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "PassedControls",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 1,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true,
                        "minimumIntegerDigits": 2,
                        "minimumFractionDigits": 2,
                        "maximumFractionDigits": 2,
                        "minimumSignificantDigits": 2,
                        "maximumSignificantDigits": 4
                      }
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "yellowOrangeRed"
                    }
                  },
                  {
                    "columnMatch": "total_controls_curr",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "[\"Passed\"]/[\"Failed\"]",
                        "columnSettings": [
                          {
                            "columnName": "Passed",
                            "color": "green"
                          },
                          {
                            "columnName": "Failed",
                            "color": "redBright"
                          }
                        ]
                      }
                    }
                  }
                ],
                "filter": true
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 6 - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let EventLogManagement = externaldata(RecommendationDisplayName:string,LoggingCategory:string,MaturityLevel:string) [@\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/Feeds/EventLogManagement.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\r\nSecurityRecommendation\r\n| join kind=leftouter (EventLogManagement) on RecommendationDisplayName\r\n| where MaturityLevel in ({MaturityLevel})\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| where RecommendationState == \"Unhealthy\"\r\n| summarize count() by AssessedResourceId\r\n| sort by count_ desc\r\n| limit 250",
              "size": 0,
              "showAnalytics": true,
              "title": " üîÄ Event Logging Recommendations by Asset",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "count_",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "yellowOrangeRed"
                    }
                  },
                  {
                    "columnMatch": "RecommendationDisplayName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "warning",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "State",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "ControlID",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Recommendation",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to Recommendation >"
                    }
                  }
                ],
                "filter": true
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isATVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 8"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let EventLogManagement = externaldata(RecommendationDisplayName:string,LoggingCategory:string,MaturityLevel:string) [@\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/Feeds/EventLogManagement.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\r\nSecurityRecommendation\r\n| join kind=leftouter (EventLogManagement) on RecommendationDisplayName\r\n| where MaturityLevel in ({MaturityLevel})\r\n| make-series count() default=0 on TimeGenerated from startofday({TimeRange:start}) to startofday({TimeRange:end}) step 1d by MaturityLevel\r\n| render timechart",
              "size": 0,
              "showAnalytics": true,
              "title": "üîÄ Event Logging Posture by Maturity Level over Time",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "RecommendationDisplayName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "warning",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "State",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "ControlID",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Recommendation",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to Recommendation >"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isATVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 7"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let EventLogManagement = externaldata(RecommendationDisplayName:string,LoggingCategory:string,MaturityLevel:string) [@\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/Feeds/EventLogManagement.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\r\nSecurityRecommendation\r\n| join kind=leftouter (EventLogManagement) on RecommendationDisplayName\r\n| where MaturityLevel in ({MaturityLevel})\r\n| extend RemediationLink = strcat(\"https://\",RecommendationLink)\r\n| summarize arg_max(TimeGenerated, *) by RecommendationDisplayName, AssessedResourceId\r\n| where RecommendationState == \"Unhealthy\"\r\n| project RecommendationDisplayName, AssessedResourceId, MaturityLevel,LoggingCategory, RecommendationState, RecommendationSeverity, RemediationLink, FirstEvaluationDate, TimeGenerated\r\n| limit 250",
              "size": 0,
              "showAnalytics": true,
              "title": " üîÄ  Event Logging Recommendation Details",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "RecommendationDisplayName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "warning",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "State",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "RemediationLink",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Quick Fix >>"
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "yellowOrangeRed"
                    }
                  },
                  {
                    "columnMatch": "ControlID",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Recommendation",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to Recommendation >"
                    }
                  }
                ],
                "filter": true
              }
            },
            "conditionalVisibility": {
              "parameterName": "isATVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 9"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isATVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Assessment"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Log Management\r\n---\r\n\r\nThis section focuses on collecting, storing, and analyzing telemetry, where the collection and storage are designed to facilitate data fusion and the security analysis aids in discovery and response to malicious activity. The Microsoft Sentinel Maturity Model for Event Log Management (M-21-31) Solution includes (4) hunting queries and (8) analytics rules for monitoring these components including: \r\n\r\n    ‚Ä¢ Recommended Datatable is not logged: Event Logging (EL0)\r\n    ‚Ä¢ Recommended Datatable is not logged: Basic Event Logging (EL1)\r\n    ‚Ä¢ Recommended Datatable is not logged: Intermediate Event Logging (EL2)\r\n    ‚Ä¢ Recommended Datatable is not logged: Advanced Event Logging (EL3)\r\n    ‚Ä¢ Recommended Datatable is unhealthy (last logged received drop)\r\n    ‚Ä¢ Log Analytics Workspace: Active Storage is less than 12 Months\r\n    ‚Ä¢ Event Log Management Posture Changed (EL0)\r\n\t‚Ä¢ Event Log Management Posture Changed (EL1)\r\n\t‚Ä¢ Event Log Management Posture Changed (EL2)\r\n\t‚Ä¢ Event Log Management Posture Changed (EL3)\r\n    ‚Ä¢ Data Connector added changed removed\r\n    ‚Ä¢ Asset stopped logging (heartbeat)"
            },
            "customWidth": "30",
            "name": "NS Guide"
          },
          {
            "type": 1,
            "content": {
              "json": ""
            },
            "customWidth": "5",
            "name": "text - 1"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "9375c625-e916-4f48-b072-352d6aeefddb",
                  "version": "KqlParameterItem/1.0",
                  "name": "Price",
                  "label": "Ingestion Cost by GB",
                  "type": 1,
                  "description": "Enter Microsoft Sentinel Cost by GB (https://azure.microsoft.com/pricing/details/azure-sentinel/)",
                  "isRequired": true,
                  "value": "0.7"
                },
                {
                  "id": "fa35987d-0bb4-4612-9870-ea2c1da9dcbe",
                  "version": "KqlParameterItem/1.0",
                  "name": "RetentionPrice",
                  "label": "Retention Cost by GB",
                  "type": 1,
                  "description": "Enter Log Analytics Cost by GB (https://azure.microsoft.com/pricing/details/monitor/). Note, every GB of data ingested into the workspace can be retained at no charge for the first 90 days",
                  "isRequired": true,
                  "value": "1.6"
                },
                {
                  "id": "fa35987d-0bb4-4612-9870-ea2c1da9dcbe",
                  "version": "KqlParameterItem/1.0",
                  "name": "MaturityLevel",
                  "label": "Maturity Level",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "value": [
                    "Event Logging (EL0)",
                    "Basic Event Logging (EL1)",
                    "Intermediate Event Logging (EL2)",
                    "Advanced Event Logging (EL3)",
                    ""
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    {\"value\": \"Event Logging (EL0)\", \"label\": \"Event Logging (EL0)\"},\r\n    {\"value\": \"Basic Event Logging (EL1)\", \"label\": \"Basic Event Logging (EL1)\"},\r\n    {\"value\": \"Intermediate Event Logging (EL2)\", \"label\": \"Intermediate Event Logging (EL2)\"},\r\n    {\"value\": \"Advanced Event Logging (EL3)\", \"label\": \"Advanced Event Logging (EL3)\"},\r\n    {\"value\": \"\", \"label\": \"AdditionalLogs\"}\r\n]"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "15",
            "name": "parameters - 5"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "union withsource=TableName1 * \r\n| where TimeGenerated > startofday({TimeRange:start}) and TimeGenerated < startofday({TimeRange:end})\r\n| where _IsBillable == True\r\n| summarize TotalGB=round(sum(_BilledSize/(1024*1024*1024)),2)\r\n| extend IngestionCost=TotalGB*{Price}\r\n| project TotalGB, IngestionCost\r\n\r\n",
              "size": 4,
              "title": "Data Ingestion Cost (Microsoft Sentinel)",
              "noDataMessageStyle": 3,
              "timeContext": {
                "durationMs": 2592000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "tiles",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Data over 90 days",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 36,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Retention Cost",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  }
                ]
              },
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "TotalGB",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "greenRed"
                  },
                  "numberFormat": {
                    "unit": 39,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 1
                    }
                  }
                },
                "rightContent": {
                  "columnMatch": "IngestionCost",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "greenRed"
                  },
                  "numberFormat": {
                    "unit": 0,
                    "options": {
                      "currency": "USD",
                      "style": "currency",
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false,
                "size": "auto"
              }
            },
            "customWidth": "17",
            "name": "query - 7 - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "union withsource=TableName1 * | where TimeGenerated < ago(90d) | extend key = 'Key' | summarize size = sum(_BilledSize)/1024/1024/1024 by key\r\n| project ['Data over 90 days'] = size, ['Retention Cost'] = size*{RetentionPrice}\r\n\r\n\r\n\r\n",
              "size": 4,
              "title": "Data Retention Cost (Log Analytics)",
              "noDataMessage": "You have no data older than 90 days",
              "noDataMessageStyle": 3,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "tiles",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Data over 90 days",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 36,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Retention Cost",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  }
                ]
              },
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Data over 90 days",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "greenRed"
                  },
                  "numberFormat": {
                    "unit": 39,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 1
                    }
                  }
                },
                "rightContent": {
                  "columnMatch": "Retention Cost",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "greenRed"
                  },
                  "numberFormat": {
                    "unit": 0,
                    "options": {
                      "currency": "USD",
                      "style": "currency",
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false,
                "size": "auto"
              }
            },
            "customWidth": "17",
            "name": "query - 7"
          },
          {
            "type": 1,
            "content": {
              "json": "### Pricing\r\n‚ú≥Ô∏è[Microsoft Sentinel: Ingestion](https://azure.microsoft.com/pricing/details/azure-sentinel/#pricing)<br>\r\n‚ú≥Ô∏è[Log Analytics: Log Retention](https://azure.microsoft.com/pricing/details/monitor/#pricing)"
            },
            "customWidth": "15",
            "name": "text - 10"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let M2131Mapping = externaldata(DataTable:string, MaturityLevel:string) [@\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/Feeds/M2131RecommendedDataTables.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\r\nlet Retention = Usage\r\n| where TimeGenerated > ago(730d)\r\n| summarize arg_min(TimeGenerated, TenantId) by DataType\r\n| summarize count() by DataType, TimeGenerated\r\n| join kind=fullouter (M2131Mapping) on $left.DataType == $right.DataTable\r\n| project DataTable, MaturityLevel, TimeGenerated\r\n| summarize LogRetention_Days = datetime_diff('day',now(),min(TimeGenerated)) by DataTable, MaturityLevel;\r\nUsage\r\n| summarize Entries = count(), Size = sum(Quantity), last_log = datetime_diff(\"second\",now(), max(TimeGenerated)), estimate  = sumif(_BilledSize, IsBillable==true)  by DataType, IsBillable\r\n| join kind=fullouter(M2131Mapping) on $left.DataType == $right.DataTable\r\n| join kind=fullouter(Retention) on DataTable\r\n| project RecommendedDataTable=DataTable, ExistingDataTable=DataType, MaturityLevel, ['Table Size'] = Size*1000000, ['Table Entries'] = Entries,\r\n          ['Size per Entry'] = 1.0 * Size / Entries, IsBillable, ['Estimated Cost'] = Size*{Price}/1000, LogRetention_Days\r\n| order by ['Table Size']  desc \r\n| where RecommendedDataTable <> \"Usage\"\r\n| where MaturityLevel in ({MaturityLevel})",
              "size": 0,
              "showAnalytics": true,
              "title": "Log Table Management",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "DataTable",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "is Empty",
                          "representation": "Ellipsis",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Log",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "MaturityLevel",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Event Logging (EL0)",
                          "representation": "Sev0",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Basic Event Logging (EL1)",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Intermediate Event Logging (EL2)",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Advanced Event Logging (EL3)",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Ellipsis",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Table Size",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "purple"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Entries",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "turquoise"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Size per Entry",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "blue"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Estimated Cost",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "currency": "USD",
                        "style": "currency"
                      }
                    }
                  },
                  {
                    "columnMatch": "LogRetention_Days",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "is Empty",
                          "representation": "critical",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "<=",
                          "thresholdValue": "363",
                          "representation": "2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": ">=",
                          "thresholdValue": "364",
                          "representation": "success",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "1",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Estimated Ingestion Cost",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "currency": "USD",
                        "style": "currency"
                      }
                    }
                  },
                  {
                    "columnMatch": "Estimated Ingestion Cost (Billable Only)",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "currency": "USD",
                        "style": "currency"
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Name",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "uninitialized",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ],
                "filter": true,
                "sortBy": [
                  {
                    "itemKey": "$gen_bar_Table Size_3",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "$gen_bar_Table Size_3",
                  "sortOrder": 2
                }
              ],
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "DataType",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "name": "query - 5"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "resources\r\n| where type =~ 'microsoft.operationalinsights/workspaces' \r\n| extend state = trim(' ', tostring(properties.provisioningState))\r\n\t\t,sku   = trim(' ', tostring(properties.sku.name))\r\n        ,skuUpdate = trim(' ', tostring(properties.sku.lastSkuUpdate))\r\n\t\t,retentionDays = trim(' ', tostring(properties.retentionInDays))\r\n\t\t,dailyquotaGB  = trim(' ', tostring(properties.workspaceCapping.dailyQuotaGb))\r\n| extend dailyquotaGB = iif(dailyquotaGB !=-1.0, dailyquotaGB,\"Not set\")\r\n| extend skuUpdate    = iif(strlen(skuUpdate) > 0, skuUpdate,\"Unknown\")\r\n| extend sentinel     = iif(toint(retentionDays) < 90,\"If you have Sentinel, you can change your retention to 90days (free)?\",\"\")\r\n| project LogAnalyticsWorkspace=id, ['Resource Group']=resourceGroup, \t\r\nLogRetention_Days=retentionDays\r\n",
              "size": 2,
              "showAnalytics": true,
              "title": "Log Retention & Storage",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "LogRetention_Days",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "is Empty",
                          "representation": "4",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "<=",
                          "thresholdValue": "363",
                          "representation": "2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": ">=",
                          "thresholdValue": "364",
                          "representation": "success",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "2",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Data Retention(days)",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "orangeBlue"
                    }
                  },
                  {
                    "columnMatch": "Computer",
                    "formatter": 16,
                    "formatOptions": {
                      "showIcon": true
                    }
                  }
                ],
                "filter": true
              },
              "sortBy": [],
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "type",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "name": "query - 9",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let M2131Mapping = externaldata(DataTable:string, MaturityLevel:string) [@\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/Feeds/M2131RecommendedDataTables.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\r\nunion withsource=_TableName *\r\n| summarize count() , Size = sum(_BilledSize) by bin(_TimeReceived, 1m), Type, _IsBillable\r\n| extend counttemp =count_ / 60\r\n| summarize \r\n           ['Current EPS Average']=avg(counttemp), ['Minimum EPS']=min(counttemp),\r\n           ['Maximum EPS']=max(counttemp)\r\n  by DataTable=Type\r\n| join kind=fullouter(M2131Mapping) on DataTable\r\n| project-away DataTable1\r\n| where MaturityLevel in ({MaturityLevel})\r\n| order  by ['Current EPS Average'] desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Events Per Second (EPS) Management",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "DataTable",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Log",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Current EPS Average",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "blueDark"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  },
                  {
                    "columnMatch": "Minimum EPS",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "red"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  },
                  {
                    "columnMatch": "Maximum EPS",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "green"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "MaturityLevel",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Event Logging (EL0)",
                          "representation": "Sev0",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Basic Event Logging (EL1)",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Intermediate Event Logging (EL2)",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Advanced Event Logging (EL3)",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Ellipsis",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Table Name",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "uninitialized",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Table Size",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "purple"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Entries",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "turquoise"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Size per Entry",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "IsBillable",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "True",
                          "representation": "2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "False",
                          "representation": "success",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Important",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ],
                "filter": true,
                "sortBy": [
                  {
                    "itemKey": "$gen_bar_Current EPS Average_1",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "$gen_bar_Current EPS Average_1",
                  "sortOrder": 2
                }
              ],
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "DataType",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "name": "query - 5"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let M2131Mapping = externaldata(DataTable:string, MaturityLevel:string) [@\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/Feeds/M2131RecommendedDataTables.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\r\nlet LastLogTime = union withsource = _TableName *\r\n| summarize LastLog_Time = arg_max(TimeGenerated, *) by _TableName;\r\nunion withsource = _TableName *\r\n| summarize last_log = datetime_diff(\"second\",now(), max(TimeGenerated)) by _TableName\r\n| where last_log > 0\r\n| join kind=inner (LastLogTime) on _TableName\r\n| project DataTable = _TableName, ['Last Log Received'] = last_log, LastLog_Time\r\n| join kind=fullouter(M2131Mapping) on DataTable\r\n| project-away DataTable1\r\n| where MaturityLevel in ({MaturityLevel})\r\n| order by ['Last Log Received'] desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Last Datatable Log Received",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "DataTable",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Log",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Last Log Received",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "yellowOrangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "MaturityLevel",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Event Logging (EL0)",
                          "representation": "Sev0",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Basic Event Logging (EL1)",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Intermediate Event Logging (EL2)",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Advanced Event Logging",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Ellipsis",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "yellowOrangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  }
                ],
                "filter": true
              }
            },
            "customWidth": "50",
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let LastHeartbeatTime = Heartbeat\r\n| summarize LastHeartbeat_Time = arg_max(TimeGenerated, *) by ResourceId;\r\nHeartbeat\r\n| summarize LastHeartbeat = datetime_diff(\"second\",now(), max(TimeGenerated)) by ResourceId\r\n| where ResourceId <> \"\"\r\n| where ResourceId <> \"None\"\r\n| join kind=inner (LastHeartbeatTime) on ResourceId\r\n| project ResourceId, LastHeartbeat, LastHeartbeat_Time\r\n| sort by LastHeartbeat desc\r\n| limit 250\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Last Asset Heartbeat",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
              "timeContext": {
                "durationMs": 2592000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "LastHeartbeat",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "yellowOrangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Computer",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Gear",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "OSType",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Windows",
                          "representation": "blue",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Linux",
                          "representation": "red",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "mac",
                          "representation": "magenta",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Category",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "trenddown",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ],
                "filter": true
              }
            },
            "customWidth": "50",
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isLMVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Log Management"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Log Event Management (EL0)\r\n---\r\nLogging requirements of highest criticality are either not met or are only partially met. The agency or one or more of its components have not implemented the following \r\nrequirement. For more information, see üí°[Improving the Federal Government‚Äôs Investigative and Remediation Capabilities Related to Cybersecurity Incidents (M-21-31)](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf).\r\n\r\n    ‚Ä¢ Ensuring that the Required Logs categorized as Criticality Level 0 are retained in acceptable formats for specified timeframes\r\n\t‚Ä¢ Aligned to technical details described in Appendix C (Logging Requirements ‚Äì Technical Details) "
            },
            "customWidth": "45",
            "name": "EL0 Guide",
            "styleSettings": {
              "maxWidth": "45"
            }
          },
          {
            "type": 1,
            "content": {
              "json": ""
            },
            "customWidth": "5",
            "name": "text - 10"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "{\"version\":\"1.0.0\",\"content\":\"\\t[\\r\\n\\t\\t{ \\\"Section\\\": \\\"Identity & Credential Management\\\", \\\"tab\\\": \\\"EL0_1_\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Privileged Identity & Credential Management\\\", \\\"tab\\\": \\\"EL0_2\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"IP & Domain Reputation\\\", \\\"tab\\\": \\\"EL0_3\\\" },\\t\\r\\n\\t\\t{ \\\"Section\\\": \\\"DHCP Lease Information\\\", \\\"tab\\\": \\\"EL0_4\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"DNS\\\", \\\"tab\\\": \\\"EL0_5\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Passive DNS Log\\\", \\\"tab\\\": \\\"EL0_6\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"DNS, DHCP, & Wi-Fi\\\", \\\"tab\\\": \\\"EL0_7\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"IDS / IPS / NTA / NDR / SIEM\\\", \\\"tab\\\": \\\"EL0_8\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Router & Switches\\\", \\\"tab\\\": \\\"EL0_9\\\" },\\t\\r\\n\\t\\t{ \\\"Section\\\": \\\"Load Balancer / Reverse Proxy\\\", \\\"tab\\\": \\\"EL0_10\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Proxies & Web Content Filters\\\", \\\"tab\\\": \\\"EL0_11\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Access, Authorization, & Accounting\\\", \\\"tab\\\": \\\"EL0_12\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Operating System Logging (Windows)\\\", \\\"tab\\\": \\\"EL0_13\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Operating System Logging (Mac OS)\\\", \\\"tab\\\": \\\"EL0_14\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Operating System Logging (Linux)\\\", \\\"tab\\\": \\\"EL0_15\\\" },\\t\\r\\n\\t\\t{ \\\"Section\\\": \\\"Cloud Environments (General Logging)\\\", \\\"tab\\\": \\\"EL0_16\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Cloud AWS\\\", \\\"tab\\\": \\\"EL0_17\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Cloud Azure\\\", \\\"tab\\\": \\\"EL0_18\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Cloud GCP\\\", \\\"tab\\\": \\\"EL0_19\\\" }\\r\\n\\t]\",\"transformers\":null}",
              "size": 3,
              "title": "EL0 Requirements",
              "exportMultipleValues": true,
              "exportedParameters": [
                {
                  "fieldName": "tab",
                  "parameterName": "Tab",
                  "parameterType": 1
                }
              ],
              "queryType": 8,
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Section",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  },
                  {
                    "columnMatch": "tab",
                    "formatter": 5
                  }
                ],
                "filter": true
              }
            },
            "customWidth": "35",
            "name": "Event Logging Tiers"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "a30d01d0-38f1-4a91-9cf6-cdb181d676b5",
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_1_Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_1_",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  }
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_2Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_2",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "5adaf9a2-bf95-4de8-8c45-6d7a5d363516"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_3Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_3",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "d0671b49-6bbd-49c3-970c-ff0292fda421"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_4Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_4",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "af237977-f506-4a22-9c3c-98f16792fc11"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_5Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_5",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "3c38683f-5413-46d9-9461-4ca94c519bd5"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_6Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_6",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "01a6cc03-2ed8-4ef6-98e9-11e95c4de191"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_7Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_7",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "3c3c21c8-dbbc-4393-ad67-9f64756f2a50"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_8Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_8",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "685f5307-72af-43a7-be11-750556ac2c0c"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_9Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_9",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "a9f47ba8-5cdd-4ced-9ac3-31eeea813229"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_10Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_10",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "78ed01a9-e093-4a9c-8329-f6f327679bdf"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_11Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_11",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "3194b0b9-682b-4d10-9f90-0f0a4759f2a2"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_12Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_12",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "13b77e95-3ea9-438c-a6ad-271c038ce4fe"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_13Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_13",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "82af4030-3a8e-4dff-a0cd-b19d87d0031c"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_14Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_14",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "0e3afed6-6f8f-46e3-ac0a-a02c381e2b01"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_15Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_15",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "7b964828-c0e2-4442-9a61-607e5a5a6f8d"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_16Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_16",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "6af13af9-3eda-424c-b3df-03598d625aee"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_17Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_17",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "d718e183-c1d8-4a85-a9e3-687636280003"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_18Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_18",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "e714ce9e-651b-4b23-8c9a-0c7f69792515"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL0_19Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL0_19",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "b76fc0c9-3ca9-47cf-af0b-db6d68494b15"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "1",
            "name": "Hidden Parameters"
          },
          {
            "type": 1,
            "content": {
              "json": "## EL0 Controls Mapping\r\n| <strong> Event Logging Requirements </strong> | <strong> Microsoft Controls </strong> | \r\n|:--|:--|\r\n| Identity & Credential Management | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) |\r\n| Privileged Identity & Credential Management | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) |\r\n| IP & Domain Reputation | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender) |\r\n| DHCP Lease Information | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender) |\r\n| DNS | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Azure DNS]( https://azure.microsoft.com/services/dns/) |\r\n| Passive DNS Log | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Azure DNS]( https://azure.microsoft.com/services/dns/) ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)  |\r\n| DNS, DHCP, & Wi-Fi | ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Azure DNS]( https://azure.microsoft.com/services/dns/)|\r\n| IDS / IPS / NTA / NDR / SIEM | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) ‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/) ‚ú≥Ô∏è [Azure DNS]( https://azure.microsoft.com/services/dns/) |\r\n| Router & Switches | ‚ú≥Ô∏è [Virtual Network](https://azure.microsoft.com/services/virtual-network/)  ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/) |\r\n| Load Balancer / Reverse Proxy | ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Azure Load Balancer](https://azure.microsoft.com/services/load-balancer/) |\r\n| Proxies & Web Content Filters | ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) ‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/) ‚ú≥Ô∏è [Application Gateway]( https://azure.microsoft.com/services/application-gateway/) |\r\n| Access, Authorization, & Accounting | ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)  |\r\n| User & Administrator Access to OS Components & Applications (Windows) | ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender) |\r\n| User & Administrator Access to OS Components & Applications (Mac OS) | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) |\r\n| User & Administrator Access to OS Components & Applications (Linux) | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) |\r\n| Cloud Environments (General Logging) | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/)|\r\n| Cloud AWS | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/)|\r\n| Cloud Azure | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Azure Blob Storage](https://azure.microsoft.com/services/storage/blobs/) |\r\n| Cloud GCP | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) |"
            },
            "conditionalVisibility": {
              "parameterName": "Help",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "EL0 Guide"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Identity & Credential Management](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br> \r\nüî∑ [IdentityInfo](https://docs.microsoft.com/azure/azure-monitor/reference/tables/identityinfo) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)<br> \r\nüî∑ [imAuthentication](https://docs.microsoft.com/azure/sentinel/authentication-normalization-schema) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)<br>\r\n\r\n### References\r\n\r\nüí° [Connect Azure Active Directory (Azure AD) data to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-azure-active-directory)<br>\r\nüí° [Audit Microsoft Sentinel queries and activities](https://docs.microsoft.com/azure/sentinel/audit-sentinel-data)<br>\r\nüí° [IdentityInfo table](https://docs.microsoft.com/azure/sentinel/ueba-enrichments#identityinfo-table-public-preview)<br>\r\nüí° [Microsoft Sentinel Authentication normalization schema reference](https://docs.microsoft.com/azure/sentinel/authentication-normalization-schema)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) <br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Identity & Credential Management | Identity & Credential Management ‚Ä¢ Account Creation ‚Ä¢ Manage Credential Type o (PIV or CAC) and Derived Credentials o Cert o MFA o Password ‚Ä¢ Establish/Manage Attributes o Organization o Groups/Roles ‚Ä¢ Manage/Track Changes in Attributes & Credentials ‚Ä¢ Track Usage of Credentials ‚Ä¢ Account Deletion  | Log, Script | 0 | 12 Months Active Storage, 18 Months Cold Storage | 13 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SigninLogs\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Sign In Logs (Azure Active Directory)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AuditLogs\r\n| where Category == \"UserManagement\" or Category == \"EntitlementManagement\" or Category == \"GroupManagement\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Audit Logs > User/Group/Entitlement Management (Azure Active Directory)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IdentityInfo\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Identity Info > User Attributes (Microsoft Sentinel)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imAuthentication\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "imAuthentication > Authentication (Azure Active Directory, Windows, AWS, Okta)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_1_Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Identity & Credential Management",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Privileged Identity & Credential Management](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) üî∑ [AADServicePrincipalSignInLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/aadserviceprincipalsigninlogs) üî∑ [AADManagedIdentitySignInLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/aadmanagedidentitysigninlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br> \r\nüî∑ [IdentityInfo](https://docs.microsoft.com/azure/azure-monitor/reference/tables/identityinfo) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)<br> \r\n\r\n### References\r\nüí° [Start using Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)<br>\r\nüí° [IdentityInfo table](https://docs.microsoft.com/azure/sentinel/ueba-enrichments#identityinfo-table-public-preview)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) <br>\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Privileged Identity & Credential Management |  Privileged Identity & Credential Management ‚Ä¢ Provisioning ‚Ä¢ Manage Credential Type o (PIV or CAC) and Derived Credentials o Cert o MFA o Password ‚Ä¢ Establish/Manage Attributes o Organization o Groups/Roles ‚Ä¢ Manage/Track Changes in Attributes & Credentials ‚Ä¢ Track Usage of Credentials ‚Ä¢ Deprovisioning ‚Ä¢ Establish and Manage Privileges (Privilege Credentials)  ‚Ä¢ Isolate, Monitor, Record, Audit Privilege Sessions ‚Ä¢ Control Privileged Actions o Commands o Tasks ‚Ä¢ Track Privilege Escalation and Delegation ‚Ä¢ Monitor, Alert and Respond to Anomalous Behaviors/Activities| Log, Script | 0 | 12 Months Active Storage, 18 Months Cold Storage | 13 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AuditLogs\r\n| where Identity == \"MS-PIM\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "AuditLogs > Privileged Identity Management",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 604800000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IdentityInfo\r\n| where GroupMembership contains \"admin\" or GroupMembership contains \"contributor\" or AssignedRoles contains \"admin\" or AssignedRoles contains \"contributor\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "IdentityInfo > Privileged Roles/Groups (Microsoft Sentinel)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 604800000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AADServicePrincipalSignInLogs\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Service Principal Logs (Azure Active Directory)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 604800000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AADManagedIdentitySignInLogs\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Managed Identity Logs (Azure Active Directory)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 604800000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Privileged Identity & Credential Management",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [IP & Domain Reputation](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [EmailEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/emailevents) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)<br> \r\nüî∑ [ThreatIntelligenceIndicator](https://docs.microsoft.com/azure/azure-monitor/reference/tables/threatintelligenceindicator) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)<br> \r\n\r\n### References\r\nüí° [Microsoft Defender for Office 365 Connector](https://docs.microsoft.com/azure/sentinel/data-connectors-reference#microsoft-defender-for-office-365)<br>\r\nüí° [Understand threat intelligence in Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/understand-threat-intelligence)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Email Filtering, Spam, & Phishing | IP & Domain Reputation (As Indicated by Mail Server Connection) | Log | 0 | 12 Months Active Storage, 18 Months Cold Storage | 14 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "EmailEvents\r\n| sort by TimeGenerated\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "EmailEvents > Microsoft Defender for Office 365",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ThreatIntelligenceIndicator \r\n| extend Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP, Url, EmailSourceIpAddress, EmailSenderAddress, DomainName)\r\n| sort by TimeGenerated\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "ThreatIntelligenceIndicator > IP/Domain Reputation (Microsoft Sentinel)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "IP & Domain Reputation",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [DHCP Lease Information](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [DeviceNetworkInfo](https://docs.microsoft.com/azure/azure-monitor/reference/tables/devicenetworkinfo) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br> \r\n\r\n### References\r\nüí° [Microsoft Sentinel DHCP normalization schema reference](https://docs.microsoft.com/azure/sentinel/dhcp-normalization-schema)<br>\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Device Infrastructure (For Devices with Multiple Interfaces: Interface MAC - If Correlated to the De-NAT IP Address) | All Devices ‚Ä¢ DHCP Lease Information Including: o MAC o IP | Log | 0 | 12 Months Active Storage, 18 Months Cold Storage | 14 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceNetworkInfo \r\n| summarize FirstObserved=arg_min(TimeGenerated, IPv4Dhcp, IPAddresses, MacAddress, MachineGroup, DnsAddresses) by DeviceName\r\n| sort by FirstObserved desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "DeviceNetworkInfo > DHCP: Lease, IP, MAC (Microsoft Sentinel)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 3"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_4Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "DHCP Lease Information",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [DNS](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [DnsEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/dnsevents) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Azure DNS]( https://azure.microsoft.com/services/dns/)<br> \r\nüî∑ [imDNS](https://github.com/Azure/Azure-Sentinel/tree/master/Parsers/ASimDns) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)<br> \r\n\r\n### References\r\nüí° [Gather insights about your DNS infrastructure with the DNS Analytics Preview solution](https://docs.microsoft.com/azure/azure-monitor/insights/dns-analytics)<br>\r\nüí° [DNS Logging and Diagnostics](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn800669(v=ws.11)<br>\r\nüí° [Microsoft Sentinel DNS normalization schema reference](https://docs.microsoft.com/azure/sentinel/dns-normalization-schema#parsers)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\nüîÄ [Azure DNS](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones)<br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Device Infrastructure | DNS - Source IP and Port, Destination IP and Port Date and Time ‚Ä¢ Content of Query, Response, and Errors ‚Äì All Record Types ‚Ä¢ Zone Transfers Request and Response (Audit Log) ‚Ä¢ Zone Transfers Request and Response (Content)  | Log | 0 | 12 Months Active Storage, 18 Months Cold Storage | 14 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DnsEvents\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "DnsEvents (Azure Monitor & Azure DNS)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 604800000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imDns\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "imDns (Microsoft DNS Server, Cisco Umbrella, Infoblox, GCP, Corelight Zeek, Sysmon for Windows)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 604800000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_5Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "DNS",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Passive DNS Log](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [DnsEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/dnsevents) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Azure DNS]( https://azure.microsoft.com/services/dns/)<br> \r\nüî∑ [DeviceNetworkEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/devicenetworkevents) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)\r\n\r\n### References\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\nüí° [Gather insights about your DNS infrastructure with the DNS Analytics Preview solution](https://docs.microsoft.com/azure/azure-monitor/insights/dns-analytics)<br>\r\nüí° [Microsoft Sentinel RiskIQ Solution: Passive DNS Playbooks](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/RiskIQ/Playbooks/RiskIQ-Data-PassiveDns)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\nüîÄ [Azure DNS](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones)<br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Device Infrastructure | Passive DNS Log ‚Ä¢ Tuple (Rrname, Rrtype, Rdata) ‚Ä¢ Time_First ‚Ä¢ Time_Last ‚Ä¢ Count ‚Ä¢ Bailiwick ‚Ä¢ Sensor_Id ‚Ä¢ Zone_Time_First ‚Ä¢ Zone_Time_Last ‚Ä¢ Time_First_Ms ‚Ä¢ Time_Last_Ms ‚Ä¢ Origin ‚Ä¢ Count of Questions Asked by Source IP ‚Ä¢ Count of Questions Asked Overall ‚Ä¢Count of Responses by Source IP ‚Ä¢ Query Size in Bytes ‚Ä¢ Response Size in Bytes ‚Ä¢ TTL per Record Returned ‚Ä¢ Request Was Made Via UDP, TCP or Both ‚Ä¢ Response Was Made Via UDP, TCP or Both ‚Ä¢ Passive DNS Source (Used to Identify Which Passive DNS Source Data Came From)  | Log, Database Record | 0 | 12 Months Active Storage, 18 Months Cold Storage | 15 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceNetworkEvents\r\n| where RemotePort == \"53\"\r\n| extend Computer = toupper(DeviceName)\r\n| join kind=innerunique(DnsEvents | extend Computer = toupper(Computer)) on Computer\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "DeviceNetworkEvents + DnsEvents (Passive DNS Logs)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 604800000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_6Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Passive DNS Log",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [DNS, DHCP, & Wi-Fi](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [CommonSecurityLog](https://docs.microsoft.com/azure/azure-monitor/reference/tables/commonsecuritylog)\r\n‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/)<br> \r\n\r\n### References\r\nüí° [Get CEF-formatted logs from your device or appliance into Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-common-event-format)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)\r\n\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Device Infrastructure | DNS, DHCP, and Wi-Fi ‚Ä¢ Wi-Fi Supporting Infrastructure Logs Including Security Logs at Info Level ‚Ä¢ Device Authentication Logs with User Agent ‚Ä¢ URL Browsing Logs + HTTP Methods (e.g., Post, Get, etc.) ‚Ä¢ User Authentication Logs ‚Ä¢ DHCP Lease Information Including MAC, IP ‚Ä¢ Timestamps ‚Ä¢ Static Network Address Translation Table Mapping as Well as Port Forwards o Date and Time o Protocol o Port o Inside Local and Global IP and Port o Outside Local and Global IP and Port| Log, Database Record, Script, File, Config, SNMP | 0 | 12 Months Active Storage, 18 Months Cold Storage | 15-16 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "CommonSecurityLog\r\n| project DeviceProduct, DeviceVendor, TenantId, DeviceVersion, DeviceEventClassID, Activity, LogSeverity, AdditionalExtensions, DeviceAction, ApplicationProtocol, SourceTranslatedPort, SourcePort, SourceIP, SourceUserID, SourceUserName, SourceUserPrivileges, DestinationServiceName, DestinationTranslatedAddress, DestinationTranslatedPort, CommunicationDirection, DeviceDnsDomain, DeviceExternalID, DeviceInboundInterface, DeviceOutboundInterface, DestinationHostName, DestinationIP, DestinationPort, FileType, ReceivedBytes, Message, SentBytes, Protocol, RequestURL, RequestClientApplication, RequestContext, RequestMethod, ReceiptTime, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Common Event Format (CommonSecurityLog)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5 - Copy"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_7Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "DNS, DHCP, & Wi-Fi",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [IDS / IPS / NTA / NDR / SIEM](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AzureDiagnostics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azurediagnostics) ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) ‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/) <br>\r\nüî∑ [Usage](https://docs.microsoft.com/azure/azure-monitor/reference/tables/usage) üî∑ [InsightsMetrics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/insightsmetrics)‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\nüî∑ [imAuthentication](https://docs.microsoft.com/Azure/sentinel/authentication-normalization-schema) üî∑ [imProcess](https://docs.microsoft.com/azure/sentinel/process-events-normalization-schema) üî∑ [imNetworkSession](https://docs.microsoft.com/azure/sentinel/network-normalization-schema) üî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)<br>\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\nüî∑ [DnsEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/dnsevents) ‚ú≥Ô∏è [Azure DNS]( https://azure.microsoft.com/services/dns/) \r\n\r\n### References\r\nüí° [Azure Firewall IDS/IPS](https://docs.microsoft.com/azure/firewall/premium-features)<br>\r\nüí° [Microsoft Sentinel Authentication normalization schema reference](https://docs.microsoft.com/Azure/sentinel/authentication-normalization-schema)<br>\r\nüí° [Microsoft Sentinel Network Session normalization schema reference](https://docs.microsoft.com/azure/sentinel/network-normalization-schema)<br>\r\nüí° [Microsoft Sentinel Process Event normalization schema reference](https://docs.microsoft.com/azure/sentinel/process-events-normalization-schema)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Azure Firewall](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FazureFirewalls) <br>\r\nüîÄ [Azure Web Application Firewall](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies) <br>\r\nüîÄ [Azure Resource Graph Explorer](https://portal.azure.com/#blade/HubsExtension/ArgQueryBlade) <br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\nüîÄ [Azure Active Directory](https://portal.azure.com#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) <br>\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> "
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Device Infrastructure: General Logging |  ‚Ä¢ IDS / IPS / NTA / NDR / SIEM Logs ‚Ä¢ API Activity Logs ‚Ä¢ Authentication Logs ‚Ä¢ Firewall Logs ‚Ä¢ Web Proxy/WAF Logs ‚Ä¢ Service Metrics ‚Ä¢ Network Flow Logs ‚Ä¢ Remote Access/VPN Logs ‚Ä¢ System/OS Logs ‚Ä¢ DLP Logs ‚Ä¢ DNS Query/Response Logs | Log, File, Packet Capture | 0 | 12 Months Active Storage, 18 Months Cold Storage | 16 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureDiagnostics\r\n| where Category == \"AzureFirewallNetworkRule\"\r\n| where OperationName == \"AzureFirewallIDSLog\"\r\n| parse msg_s with * \"TCP request from \" Source \" to \" Destination \". Action: \" ActionTaken \". Rule: \" IDPSSig \". IDS: \" IDSMessage \". Priority: \" Priority \". Classification: \" Classification\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†OperationName\r\n| render areachart ",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "IDS / IPS Alerts over Time (Azure Firewall)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityAlert\r\n| summarize count() by AlertName, ProductName\r\n| sort by count_ desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "XDR (EDR + NDR) Alerting (Microsoft 365 Defender + Microsoft Sentinel)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type contains \"api\" or type contains \"endpoint\"\r\n| project id,type,location,resourceGroup\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "APIs & Endpoints (Azure Resource Graph)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 11"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imAuthentication\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Authentication Logs (imAuthentication)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Rule",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 14",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "Usage\r\n| summarize¬†count()¬†by¬†DataType\r\n| sort¬†by¬†count_¬†desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "SIEM Logs by Count (Microsoft Sentinel)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Rule",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 3 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let FakeData = (datatable (Message: string, ruleName_s: string, clientIp_s: string, clientIP_s: string, action_s: string, transactionId_s: string, trackingReference_s: string) [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]);\r\nFakeData\r\n| union AzureDiagnostics\r\n| where (ResourceType == \"APPLICATIONGATEWAYS\" or ResourceType == \"FRONTDOORS\" or ResourceType == \"CDNWEBAPPLICATIONFIREWALLPOLICIES\") and (\"Application Gateway\" == \"All\" or (ResourceType == \"APPLICATIONGATEWAYS\" and \"Application Gateway\" contains \"application gateway\") or (ResourceType == \"FRONTDOORS\" and \"Application Gateway\" contains \"azure front door\") or (ResourceType == \"CDNWEBAPPLICATIONFIREWALLPOLICIES\" and \"Application Gateway\" contains \"cdn\")) and (\"SOC-NS-AG-WAFV2 - 1129440\" == \"All\" or Resource in ('SOC-NS-AG-WAFV2'))\r\n| where Category == \"FrontdoorWebApplicationFirewallLog\" or OperationName == \"ApplicationGatewayFirewall\" or Category == \"WebApplicationFirewallLogs\"\r\n| extend Action = iif(action_s == \"Blocked\", Action = \"Block\", action_s)\r\n| extend Action = iif(Action == \"Detected\", Action = \"Log\", Action)\r\n| where '*' == Action or '*' == \"*\" \r\n| where '*' == requestUri_s or '*' == \"*\"\r\n| extend Rule = strcat(ruleName_s, Message), ClientIP = strcat(clientIp_s, clientIP_s)\r\n| extend Rule= iif(Rule contains \"Mandatory rule. Cannot be disabled.\", strcat_array(split(Rule, \"Mandatory rule. Cannot be disabled. Inbound \", 1), \"\"), Rule) // Removes initial component for mandatory rule \r\n| extend Rule = iif(Rule contains \"Total Inbound Score\", strcat_array(array_concat(split(Rule, \" - SQLI=\", 0), parse_json('[\") -\"]'), split(Rule, \"):\", 1)), \"\"), Rule) // Removes smaller information if more info is available for anomaly score\r\n| summarize count() by Rule\r\n| top 50 by count_ desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Web Application Firewall (Azure WAF)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Rule",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "redDark"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 3",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "InsightsMetrics\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Service Metrics (Azure Monitor)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Rule",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "redDark"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 3 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imNetworkSession\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "imNetworkSession (Flow Logs)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Rule",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "redDark"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 3 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type contains \"network\"\r\n| project id,type,location,resourceGroup\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "VPNs & Network Infrastructure (Azure Resource Graph)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 11 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imProcess\r\n| sort by TimeGenerated \r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "System/OS Logs > Windows/Linux (imProcess)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Rule",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "redDark"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 8 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "InformationProtectionLogs_CL\r\n| sort by TimeGenerated \r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Data Loss Prevention Logs (Microsoft Information Protection)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Rule",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "redDark"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 8",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DnsEvents\r\n| sort by TimeGenerated \r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "DNS Events (Azure DNS / Azure Monitor)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Rule",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "redDark"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 8 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_8Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "IDS / IPS / NTA / NDR / SIEM",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Router & Switches](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Virtual Network](https://azure.microsoft.com/services/virtual-network/) <br>\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>  \r\n\r\n### References\r\nüí° [Azure Activity log](https://docs.microsoft.com/azure/azure-monitor/essentials/activity-log)<br>\r\nüí° [Azure resource logs](https://docs.microsoft.com/azure/azure-monitor/essentials/resource-logs)<br>\r\nüí° [Hybrid Security Monitoring using Microsoft Defender for Cloud and Microsoft Sentinel](https://docs.microsoft.com/azure/architecture/hybrid/hybrid-security-monitoring)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks) <br>\r\nüîÄ [Route Tables](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FrouteTables) <br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Device Infrastructure (For Devices with Multiple Interfaces: Interface MAC - If Correlated to the Device NAT IP Address) | Routers and Switches ‚Ä¢ Routing Tables ‚Ä¢ Routing Changes (Logging All CLI Commands, BGP) ‚Ä¢ IP Addressing Schema and Implementation  | Script, File, Config | 0 | 12 Months Active Storage, 18 Months Cold Storage | 16 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "Resources\r\n| where type contains \"virtualNetworks\"\r\n| extend RG = substring(id, 0, indexof(id, '/providers'))\r\n| extend VNETAddressRange = properties.addressSpace.addressPrefixes\r\n| extend subnets = properties.subnets\r\n| mvexpand bagexpansion=array subnets\r\n| extend SubnetName = tostring(subnets.name)\r\n| extend SubnetAddress = tostring(subnets.properties.addressPrefix)\r\n| extend ServiceEndpoints = subnets.properties.serviceEndpoints.[0]\r\n| extend SubnetIPConfigid = subnets.properties.ipConfigurations.[0].id\r\n| extend VNETPeerings = properties.virtualNetworkPeerings.[0]\r\n| extend VNETPeeringName = VNETPeerings.name\r\n| extend VNETPeerAddress = VNETPeerings.properties.remoteAddressSpace.addressPrefixes\r\n| extend VNETPeerRemoteVNETid = VNETPeerings.properties.remoteVirtualNetwork.id\r\n| extend VNETPeeringState = VNETPeerings.properties.peeringState\r\n| extend AllowVirtualNetworkAccess = VNETPeerings.properties.allowVirtualNetworkAccess\r\n| extend AllowForwardedTraffic = VNETPeerings.properties.allowForwardedTraffic\r\n| extend AllowGatewayTransit = VNETPeerings.properties.allowGatewayTransit\r\n| project-away kind, managedBy, sku, plan, identity, zones, extendedLocation, properties, subnets, VNETPeerings, tenantId, name, tags, resourceGroup",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Virtual Networks, Subnets and Peerings",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "type",
                          "formatter": 16,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "location",
                          "formatter": 17
                        },
                        {
                          "columnMatch": "subscriptionId",
                          "formatter": 15,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "DDoSProtectionEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "false",
                                "representation": "3"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Blank",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "SubnetIPConfigid",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource",
                            "showIcon": true
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "VNetDetails"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "Resources\r\n| where type == \"microsoft.network/routetables\"\r\n| extend RG = substring(id, 0, indexof(id, '/providers'))\r\n| extend SubnetArray = properties.subnets\r\n| mvexpand bagexpansion=array SubnetArray\r\n| extend Subnetid = SubnetArray.id\r\n| extend DisableBGPRoutePropagation = tostring(properties.disableBgpRoutePropagation)\r\n| extend RouteArray = properties.routes\r\n| mvexpand bagexpansion=array RouteArray\r\n| extend RouteName = tostring(RouteArray.name)\r\n| extend Routeid = RouteArray.id\r\n| extend RouteAddressPrefix = tostring(RouteArray.properties.addressPrefix)\r\n| extend RouteHasBGPOverride = tostring(RouteArray.properties.hasBgpOverride)\r\n| extend RouteNextHopType = tostring(RouteArray.properties.nextHopType)\r\n| project-away kind, managedBy, sku, plan, properties, identity, zones, extendedLocation, SubnetArray, RouteArray, name, tenantId, tags, resourceGroup\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Route Tables & BGP",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "type",
                          "formatter": 16,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "location",
                          "formatter": 17
                        },
                        {
                          "columnMatch": "subscriptionId",
                          "formatter": 15,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Subnetid",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource",
                            "showIcon": true,
                            "templateRunContext": {
                              "componentIdSource": "parameter",
                              "templateUriSource": "static",
                              "templateParameters": [],
                              "titleSource": "static",
                              "descriptionSource": "static",
                              "description": "",
                              "runLabelSource": "static"
                            }
                          }
                        },
                        {
                          "columnMatch": "Routeid",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource",
                            "showIcon": true
                          }
                        }
                      ],
                      "filter": true,
                      "labelSettings": [
                        {
                          "columnId": "id",
                          "label": "Name"
                        },
                        {
                          "columnId": "type",
                          "label": "Type"
                        },
                        {
                          "columnId": "location",
                          "label": "Region"
                        },
                        {
                          "columnId": "subscriptionId",
                          "label": "Subscription"
                        },
                        {
                          "columnId": "RG",
                          "label": "Resource Group"
                        },
                        {
                          "columnId": "Subnetid",
                          "label": "Subnet Id"
                        },
                        {
                          "columnId": "RouteName",
                          "label": "Route Name"
                        },
                        {
                          "columnId": "Routeid",
                          "label": "Route Id"
                        }
                      ]
                    }
                  },
                  "name": "RouteTables"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureActivity\r\n| where Category == \"Administrative\"\r\n| where OperationNameValue contains \"Microsoft.Network\"\r\n| where ActivitySubstatusValue in (\"Created\", \"OK\")\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Administrative Changes to Network Infrastructure (Azure Monitor)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "type",
                          "formatter": 16,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "location",
                          "formatter": 17
                        },
                        {
                          "columnMatch": "subscriptionId",
                          "formatter": 15,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Subnetid",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource",
                            "showIcon": true,
                            "templateRunContext": {
                              "componentIdSource": "parameter",
                              "templateUriSource": "static",
                              "templateParameters": [],
                              "titleSource": "static",
                              "descriptionSource": "static",
                              "description": "",
                              "runLabelSource": "static"
                            }
                          }
                        },
                        {
                          "columnMatch": "Routeid",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource",
                            "showIcon": true
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let applications = dynamic([\"Azure Active Directory PowerShell\", \"Microsoft Azure PowerShell\", \"Graph Explorer\", \"ACOM Azure Website\"]);\r\nSigninLogs\r\n| where AppDisplayName in (applications)\r\n| project UserPrincipalName, ResultType, AppDisplayName, IPAddress, Location, UserAgent, TimeGenerated",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Accessing Management CLI/Powershell Functions (Azure Active Directory)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "type",
                          "formatter": 16,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "location",
                          "formatter": 17
                        },
                        {
                          "columnMatch": "subscriptionId",
                          "formatter": 15,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Subnetid",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource",
                            "showIcon": true,
                            "templateRunContext": {
                              "componentIdSource": "parameter",
                              "templateUriSource": "static",
                              "templateParameters": [],
                              "titleSource": "static",
                              "descriptionSource": "static",
                              "description": "",
                              "runLabelSource": "static"
                            }
                          }
                        },
                        {
                          "columnMatch": "Routeid",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource",
                            "showIcon": true
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 6"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_9Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Router & Switches",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Load Balancer / Reverse Proxy](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Load Balancer](https://azure.microsoft.com/services/load-balancer/)<br>\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n### References\r\nüí° [Monitoring load balancer](https://docs.microsoft.com/azure/load-balancer/monitor-load-balancer)<br>\r\nüí° [Monitoring load balancer data reference](https://docs.microsoft.com/azure/load-balancer/monitor-load-balancer-reference)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers) <br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Device Infrastructure (For Devices with Multiple Interfaces: Interface MAC - If Correlated to the Device NAT IP Address) | Load Balancer / Reverse Proxy Access Logs ‚Ä¢ Connection Type ‚Ä¢ Date and Time ‚Ä¢ Resource ID of the Load Balancer ‚Ä¢ Client IP Port ‚Ä¢ Target IP Port ‚Ä¢ Request Processing Time ‚Ä¢ Target Processing Time ‚Ä¢ Response Processing Time ‚Ä¢ Status Code from Load Balancer ‚Ä¢ Target Status Code ‚Ä¢ Received Bytes ‚Ä¢ Bytes Sent ‚Ä¢ Request ‚Ä¢ User Agent ‚Ä¢ SSL Cipher ‚Ä¢ SSL Protocol ‚Ä¢ SNI Domain ‚Ä¢ Matched Rule Priority ‚Ä¢ Actions Executed ‚Ä¢ Redirect URL ‚Ä¢ Error Reason ‚Ä¢ Target IP:Port List ‚Ä¢ Target Status Code List ‚Ä¢ Classification Reason Request Does Not Comply with RFC 7230 ‚Ä¢ Other Implementation Specific Fields| Log | 0 | 12 Months Active Storage, 18 Months Cold Storage | 17 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type contains \"load\" or type contains \"traffic\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Load Balancers",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureActivity\r\n| where Category == \"Administrative\"\r\n| where OperationNameValue contains \"Microsoft.Network/loadBalancers/\"\r\n| where ActivitySubstatusValue in (\"Created\", \"OK\")\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Administrative Changes to Load Balancers (Azure Monitor)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ]
                  },
                  "customWidth": "50",
                  "name": "query - 3"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_10Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Load Balancer / Reverse Proxy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Proxies & Web Content Filters](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AzureDiagnostics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azurediagnostics) ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) ‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/) ‚ú≥Ô∏è [Application Gateway]( https://azure.microsoft.com/services/application-gateway/)<br> \r\n\r\n### References\r\nüí° [Monitor Azure Firewall logs and metrics](https://docs.microsoft.com/azure/firewall/firewall-diagnostics)<br>\r\nüí° [Resource logs for Azure Web Application Firewall](https://docs.microsoft.com/azure/web-application-firewall/ag/web-application-firewall-logs)<br>\r\nüí° [Azure Application Gateway analytics](https://docs.microsoft.com/azure/azure-monitor/insights/azure-networking-analytics#azure-application-gateway-analytics)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Firewalls](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FazureFirewalls) <br>\r\nüîÄ [Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview) <br> \r\nüîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)  <br>\r\nüîÄ [Application Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks) <br>\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Device Infrastructure (For Devices with Multiple Interfaces: Interface MAC - If Correlated to the Device NAT IP Address) | Proxies & Web Content Filters:Provides NAT, User, and Gateway IP Address to Provide Enhanced Reporting of Malicious Domains and IP Addresses. In the Case of Web, W3c Format ‚Ä¢ Date and Time ‚Ä¢ Source o Hostname o IP Address and Port o MAC ‚Ä¢ Destination o Hostname o IP Address and Port o MAC ‚Ä¢ Web URL Methods / User Agent /Decoded Headers ‚Ä¢ URL Categories ‚Ä¢ URL ‚Ä¢ Permitted, Restricted, Denied ‚Ä¢ Policy Updates ‚Ä¢ Software Updates | Log | 0 | 12 Months Active Storage, 18 Months Cold Data Storage | 18 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let materializedData =\r\nmaterialize(\r\nAzureDiagnostics\r\n| where Category == \"AzureFirewallApplicationRule\"\r\n| project ResourceId,ResourceGroup,SubscriptionId, msg_s, Resource, TimeGenerated);\r\nunion\r\n(\r\nmaterializedData\r\n| where msg_s has \"Web Category:\" and msg_s has \". Url\"\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Url:\" Url \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n),\r\n(\r\nmaterializedData\r\n| where msg_s !has \"Web Category:\" and msg_s has \". Url\" and msg_s has \". No rule matched\"\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Url:\" Url \". Action: \" Action \". No rule matched\" *\r\n),\r\n(\r\nmaterializedData\r\n| where msg_s !has \"Web Category:\" and msg_s !has \". Url\" and msg_s has \". No rule matched\"\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". No rule matched\" *\r\n),\r\n(\r\nmaterializedData\r\n| where msg_s has \"Web Category:\" and msg_s !has \". Url\"\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n),\r\n(\r\nmaterializedData\r\n| where msg_s !has \"Web Category:\" and  msg_s !has \". Url\" and msg_s !has \"Rule Collection\" and msg_s !has \" Reason: \"\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". \" RuleCollection \". \" Rule\r\n),\r\n(\r\nmaterializedData\r\n| where msg_s !has \"Web Category:\" and  msg_s !has \". Url\" and msg_s !has \"Rule Collection\" and msg_s !has \"TLS extension was missing\"\r\n| where msg_s has \" Reason:\"\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \". Action: \" Action \". Reason: \" Rule \".\"\r\n),\r\n(\r\nmaterializedData\r\n| where msg_s !has \"Web Category:\" and  msg_s !has \". Url\" and msg_s !has  \"TLS extension was missing\" and msg_s !has \"No rule matched\"\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n),\r\n(\r\nmaterializedData\r\n| where msg_s !has \"Web Category:\" and  msg_s !has \". Url\" and msg_s !has \"Rule Collection\" and msg_s !has \" Reason: \"\r\n| where msg_s has \"Rule Collection Group\"\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Policy:\" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n)\r\n| summarize by TimeGenerated, FQDN, Protocol, Action, SourceIP, SourcePort, DestinationPort , ResourceId , ResourceGroup , RuleCollection, Rule, WebCategory, SubscriptionId\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Proxies & Web Content Filter (Azure Firewall)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_11Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Proxies & Web Content Filters",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Access, Authorization, & Accounting](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\nüî∑ [OfficeActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/officeactivity) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)<br> \r\n\r\n### References\r\nüí° [Azure Activity log](https://docs.microsoft.com/azure/azure-monitor/essentials/activity-log)<br>\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Device Infrastructure (Access, Authorization, & Accounting) | General Information ‚Ä¢ Date and Time ‚Ä¢ Event, Status, or Error Codes ‚Ä¢ Service/Command/Application Name ‚Ä¢ User or System Account Associated with an Event ‚Ä¢ Device Used (e.g., Source and Destination IPs, Terminal Session ID, Web Browser, etc.) Operating System (OS) Events ‚Ä¢ Start-Up and Shutdown of the System ‚Ä¢ Start-Up and Shutdown of a Service ‚Ä¢ Network Connection Changes or Failures ‚Ä¢ Changes to, or Attempts to Change, System Security Settings and Controls OS Audit Records ‚Ä¢ Log-On Attempts (Success/Failure) ‚Ä¢ The Function(s) Performed after Logging On (e.g., Reading or Updating a Critical File, Software Installation) ‚Ä¢ Account Changes (e.g., Account Creation and Deletion, Account Privilege Assignment) ‚Ä¢ Successful/Failed Use of Privileged Accounts Application Account Information ‚Ä¢ Application Authentication Attempts (Success/Failure) ‚Ä¢ Application Account Changes (e.g., Account Creation and Deletion, Account Privilege Assignment) ‚Ä¢ Use of Application Privileges Application Operations ‚Ä¢ Application Startup and Shutdown ‚Ä¢ Application Failures ‚Ä¢ Major Application Configuration Changes ‚Ä¢ Application Transactions, For Example, o Email Servers Recording the Sender, Recipients, Subject Name, and Attachment Names for Each Email o Web Servers Recording Each URL Requested and the Type of Response Provided by the Server o Business Applications Recording Which Financial Records Were Accessed by Each User| Log | 0 | 12 Months Active Storage, 18 Months Cold Data Storage | 18-20 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureActivity\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Access, Authorization, & Accounting (Azure)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "OfficeActivity\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Access, Authorization, & Accounting (Microsoft 365)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_12Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Access, Authorization, & Accounting",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [User & Administrator Access to OS Components & Applications (Windows)](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [SecurityEvent](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityevent) ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br>  \r\n\r\n### References\r\nüí° [Microsoft Defender for Endpoint](https://docs.microsoft.com/azure/sentinel/data-connectors-reference#microsoft-defender-for-endpoint)<br>\r\nüí° [Windows Security Events via AMA](https://docs.microsoft.com/azure/sentinel/data-connectors-reference#windows-security-events-via-ama)<br>\r\nüí° [Security events via Legacy Agent (Windows)](https://docs.microsoft.com/azure/sentinel/data-connectors-reference#security-events-via-legacy-agent-windows)<br>\r\nüí° [Windows agent-based connections](https://docs.microsoft.com/azure/sentinel/connect-azure-windows-microsoft-services?tabs=SA%2CAMA#windows-agent-based-connections)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft 365 Security Center](https://security.microsoft.com/) <br> \r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Operating Systems - Windows Infrastructure & Operating Systems | User and Administrator Access to OS Components and Applications ‚Ä¢ File and Object Access ‚Ä¢ Audit Log Access (Success/Failure) ‚Ä¢ System Access and Log Off (Success/Failure) ‚Ä¢ Privilege Access and Log Off (Success/Failure) ‚Ä¢ RDP Access and Log Off (Success/Failure) ‚Ä¢ SMB Access ‚Ä¢ Installation or Removal of Storage Volumes or Removeable Media System Performance and Operational Characteristics ‚Ä¢ Resource Utilization, Process Status ‚Ä¢ System Events ‚Ä¢ Service Status Changes (Start, Stop, Fail, Restart, etc.) ‚Ä¢ Service Failures and Restarts ‚Ä¢ Process Creation and Termination System Configuration ‚Ä¢ Changes to Security Configuration (Success/Failure) ‚Ä¢ Audit Log Cleared ‚Ä¢ Changes to Accounts ‚Ä¢ User or Group Management Changes ‚Ä¢ Scheduled Task Changes File Access ‚Ä¢ Transfer of Data to External Media or Remote Hosts Communications ‚Ä¢ Listening Network Port and IP Address ‚Ä¢ Active Network Communication with Other Hosts Powershell Execution Commands WMI Events Registry Access Command-Line Interface (CLI) Basic Input Output System (BIOS), Unified Extensible Firmware Interface (UEFI), and Other Firmware ‚Ä¢ Version ‚Ä¢ Created Date ‚Ä¢ Installed Date ‚Ä¢ Manufacturer | Log | 0 | 12 Months Active Storage, 18 Months Cold Data Storage Host Network | 20-21 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityEvent\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Operating System Logs (Windows) ",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_13Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "User & Administrator Access to OS Components & Applications (Windows)",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [User & Administrator Access to OS Components & Applications (Mac OS)](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [Syslog](https://docs.microsoft.com/azure/azure-monitor/reference/tables/syslog) ‚ú≥Ô∏è [Collect Syslog Data Sources with Log Analytics Agent](https://docs.microsoft.com/azure/azure-monitor/agents/data-sources-syslog) <br> \r\n\r\n### References\r\nüí° [Collect data using Syslog](https://docs.microsoft.com/azure/sentinel/connect-syslog)<br>\r\nüí° [Get CEF-formatted logs from your device or appliance into Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-common-event-format)<br>\r\nüí° [NXLog Basic Security Module (BSM) macOS](https://docs.microsoft.com/azure/sentinel/data-connectors-reference)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\n\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Operating Systems - MACOS (Or Other Apple Desktop and Server Operating Systems) | User and Administrator Access to OS Components and Applications ‚Ä¢ File and Object Access ‚Ä¢ Audit Log Access (Success/Failure) ‚Ä¢ System Access and Log Off (Success/Failure) ‚Ä¢ Privilege Access and Log Off (Success/Failure) ‚Ä¢ Remote Terminal or Equivalent Access and Log Off (Success/Failure) ‚Ä¢ Samba/NFS/(S)FTP or Equivalent Access ‚Ä¢ Installation or Removal of Applications ‚Ä¢ Installation or Removal of Storage Volumes or Removeable Media System Performance and Operational Characteristics ‚Ä¢ Resource Utilization, Process Status ‚Ä¢ System Events ‚Ä¢ Service Status Changes (Start, Stop, Fail, Restart, etc.) ‚Ä¢ Service Failures and Restarts ‚Ä¢ Process Creation and Termination System Configuration ‚Ä¢ Changes to Security Configuration (Success/Failure) ‚Ä¢ Audit Log Cleared ‚Ä¢ Changes to Accounts ‚Ä¢ User or Group Management Changes ‚Ä¢ Scheduled Task Changes File Access ‚Ä¢ Transfer of Data to External Media or Remote Hosts Host Network Communications‚Ä¢ Listening Network Port and IP Address ‚Ä¢ Active Network Communication with Other Hosts Command-Line Interface (CLI) ‚Ä¢ System Log Folder: /Var/Log/* ‚Ä¢ System Log: /Var/Log/System.Log ‚Ä¢ Mac Analytics Data: /Var/Log/Diagnosticmessages/* ‚Ä¢ Wi-Fi Log: /Var/Log/Wifi.Log ‚Ä¢ System Application Logs: /Library/Logs/* and /Private/Var/Log/* ‚Ä¢ System Reports: /Library/Logs/Diagnosticreports/ * ‚Ä¢ User Application Logs: /Users/Name/Library/Logs/* ‚Ä¢ User Reports: /Users/Name/Library/Logs/Diag nosticreports/* ‚Ä¢ Audit Log: /Var/Audit/* Basic Input Output System (BIOS), Unified Extensible Firmware Interface (UEFI), and Other Firmware ‚Ä¢ Version ‚Ä¢ Created Date ‚Ä¢ Installed Date ‚Ä¢ Manufacturer| Log | 0 | 12 Months Active Storage, 18 Months Cold Data Storage Host Network | 22-23 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "Syslog\r\n| where SourceSystem contains \"mac\" or SourceSystem contains \"osx\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Mac OS (Syslog Connector)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_14Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "User & Administrator Access to OS Components & Applications (Mac OS)",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [User & Administrator Access to OS Components & Applications (Linux)](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [Syslog](https://docs.microsoft.com/azure/azure-monitor/reference/tables/syslog) ‚ú≥Ô∏è [Collect Syslog Data Sources with Log Analytics Agent](https://docs.microsoft.com/azure/azure-monitor/agents/data-sources-syslog) <br> \r\n\r\n### References\r\nüí° [Collect data using Syslog](https://docs.microsoft.com/azure/sentinel/connect-syslog)<br>\r\nüí° [Get CEF-formatted logs from your device or appliance into Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-common-event-format)<br>\r\nüí° [Deploy a log forwarder to ingest Syslog and CEF logs to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-log-forwarder?tabs=rsyslog)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Operating Systems - BSD (Linux) | User and Administrator Access to OS Components and Applications ‚Ä¢ File and Object Access ‚Ä¢ Audit Log Access (Success/Failure) ‚Ä¢ System Access and Log Off (Success/Failure) ‚Ä¢ Privilege Access and Log Off (Success/Failure) ‚Ä¢ Remote Terminal or Equivalent Access and Log Off (Success/Failure) ‚Ä¢ Samba/NFS/(S)FTP or Equivalent Access ‚Ä¢ Installation or Removal of Storage Volumes or Removeable Media System Performance and Operational Characteristics ‚Ä¢ Resource Utilization, Process Status ‚Ä¢ System Events ‚Ä¢ Service Status Changes (Start, Stop, Fail, Restart, Etc.) ‚Ä¢ Service Failures and Restarts ‚Ä¢ Process Creation and Termination System Configuration ‚Ä¢ Changes to Security Configuration (Success/Failure) ‚Ä¢ Audit Log Cleared ‚Ä¢ Changes to Accounts ‚Ä¢ User or Group Management Changes ‚Ä¢ Scheduled Task Changes File Access ‚Ä¢ Transfer of Data to External Media or Remote Hosts Host Network Communications ‚Ä¢ Listening Network Port and IP Address ‚Ä¢ Active Network Communication with Other Hosts Command-Line Interface (CLI) Security Enhanced Linux (SELinux) AppArmor or Equivalent ‚Ä¢ Warning Logs ‚Ä¢ Violation Logs System ‚Ä¢ /Var/Log/Messages ‚Ä¢ /Var/Log/Dmesg ‚Ä¢ /Var/Log/Syslog ‚Ä¢ /Var/Log/Daemon.Log ‚Ä¢ /Var/Log/Cron ‚Ä¢ /Var/Log/Kern.Log ‚Ä¢ /Var/Log/Boot.Log Access And Authentication ‚Ä¢ /Var/Log/Auth.Log ‚Ä¢ /Var/Log/Secure ‚Ä¢ /Var/Log/Faillog ‚Ä¢ /Var/Log/Btmp ‚Ä¢ /Var/Log/Wtmp or /Var/Log/Utmp Applications ‚Ä¢ /Var/Log/Mail.Log or /Var/Log/Maillog ‚Ä¢ /Var/Log/Xorg.X.Log Package Install/Uninstall ‚Ä¢ /Var/Log/Dpkg.Log ‚Ä¢ /Var/Log/Yum.Log Basic Input Output System (BIOS), Unified Extensible Firmware Interface (UEFI), and Other Firmware ‚Ä¢ Version ‚Ä¢ Created Date ‚Ä¢ Installed Date ‚Ä¢ Manufacturer | Log | 0 | 12 Months Active Storage, 18 Months Cold Data Storage Host Network | 24-26 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": null
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "Syslog\r\n| where SourceSystem == \"Linux\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Linux OS (Syslog Connector)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "CommonSecurityLog\r\n| project DeviceProduct, DeviceVendor, TenantId, DeviceVersion, DeviceEventClassID, Activity, LogSeverity, AdditionalExtensions, DeviceAction, ApplicationProtocol, SourceTranslatedPort, SourcePort, SourceIP, SourceUserID, SourceUserName, SourceUserPrivileges, DestinationServiceName, DestinationTranslatedAddress, DestinationTranslatedPort, CommunicationDirection, DeviceDnsDomain, DeviceExternalID, DeviceInboundInterface, DeviceOutboundInterface, DestinationHostName, DestinationIP, DestinationPort, FileType, ReceivedBytes, Message, SentBytes, Protocol, RequestURL, RequestClientApplication, RequestContext, RequestMethod, ReceiptTime, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Common Event Format (CommonSecurityLog)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5 - Copy"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_15Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "User & Administrator Access to OS Components & Applications (Linux)",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Cloud Environments (General Logging)](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\nüî∑ [AWSCloudTrail](https://docs.microsoft.com/azure/azure-monitor/reference/tables/awscloudtrail)<br>\r\nüî∑ [GWorkspaceActivityReports](https://developers.google.com/admin-sdk/reports/reference/rest/v1/activities)<br>\r\n\r\n### References\r\nüí° [Enable Azure Activity Logging](https://docs.microsoft.com/azure/azure-monitor/essentials/diagnostic-settings?tabs=CMD)<br>\r\nüí° [Connect AWS CloudTrail to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-aws)<br>\r\nüí° [Google Workspace (G-Suite) Connector](https://docs.microsoft.com/azure/sentinel/data-connectors-reference#google-workspace-g-suite-preview)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\n\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Cloud Environments (General Events) | Nearly all successful attacks on cloud services result from customer misconfigurations. With that in mind, the logging and monitoring focus should be on: ‚Ä¢ Any Activity on Breakglass Account(s) (which should never have to be used) ‚Ä¢ Conditional Access Policy Changes ‚Ä¢ Changes to Environment Policies (e.g., Azure Subscription, AWS Services, Google Solutions, etc.) in Management Logs ‚Ä¢ Privileged Role Changes ‚Ä¢ Virtual Network (VNet) Changes ‚Ä¢ Deletions of Delete Locks ‚Ä¢ Changes to Logging Policies ‚Ä¢ Privileged Identity Management (PIM) and Identity Protection Changes ‚Ä¢ Changes to Alert Rules (Audit the Auditor) ‚Ä¢ Key Vault/Key Management Changes ‚Ä¢ Storage File Access Logs, File, File Hashes ‚Ä¢ Baseline Deviations for Prod App Tiers ‚Ä¢ Baseline Deviations for Prod Data Tiers ‚Ä¢ IDS / IPS / NTA / NDR / SIEM Logs ‚Ä¢API Activity Logs ‚Ä¢ Authentication Logs ‚Ä¢ Firewall Logs ‚Ä¢ Web Proxy/WAF Logs ‚Ä¢ Service Metrics ‚Ä¢ Billing Data ‚Ä¢ Flow Logs ‚Ä¢ Remote Access/VPN Logs ‚Ä¢ System/OS Logs ‚Ä¢ DLP Logs ‚Ä¢ DNS Query/Response Logs| Log | 0 | 12 Months Active Storage, 18 Months Cold Data Storage | 26-27 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureActivity\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Azure Logs (AzureActivity)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AWSCloudTrail\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "AWS Logs (AWSCloudTrail)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "GWorkspaceActivityReports\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Google Cloud Logs (GWorkspaceActivityReports)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_16Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Cloud Environments (General Logging)",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Cloud AWS](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AWSCloudTrail](https://docs.microsoft.com/azure/azure-monitor/reference/tables/awscloudtrail) üî∑ [AWSGuardDuty](https://docs.microsoft.com/azure/azure-monitor/reference/tables/awsguardduty) üî∑ [AWSVPCFlow](https://docs.microsoft.com/azure/azure-monitor/reference/tables/awsvpcflow)<br>\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n### References\r\nüí° [Azure security solutions for AWS](https://docs.microsoft.com/azure/architecture/reference-architectures/aws/aws-azure-security-solutions)<br>\r\nüí° [Connect AWS CloudTrail to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-aws)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Cloud AWS | ‚Ä¢ AWS Cloudtrail ‚Ä¢Amazon Cloudwatch Logs ‚Ä¢ AWS Config ‚Ä¢ Amazon S3 Access Logs ‚Ä¢ Amazon VPC Flow Logs ‚Ä¢ AWS WAF Logs ‚Ä¢ AWS Shield ‚Ä¢ AWS Guardduty ‚Ä¢ AWS Security Hub | Log | 0 | 12 Months Active Storage, 18 Months Cold Data Storage | 27 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AWSCloudTrail\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "AWS Logs (AWSCloudTrail)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityRecommendation\r\n| where RemediationDescription contains \"aws\"\r\n| summarize count() by RecommendationName\r\n| sort by count_ desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "AWS Recommendations (SecurityRecommendation: Microsoft Defender for Cloud)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 6 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityAlert\r\n| where AlertName contains \"AWS\"\r\n| summarize count() by AlertName\r\n| sort by count_ desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "AWS Alerts (SecurityAlert: Microsoft Sentinel)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 6",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AWSGuardDuty\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "AWS Logs (AWSGuardDuty)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AWSVPCFlow\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "AWS Logs (AWSVPCFlow)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_17Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Cloud AWS",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Cloud Azure](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) üî∑ [AzureMetrics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azuremetrics)  ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\nüî∑ [OfficeActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/officeactivity) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)<br> \r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) üî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\nüî∑ [StorageBlobLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/storagebloblogs) üî∑ [StorageFileLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/storagefilelogs) ‚ú≥Ô∏è [Azure Blob Storage](https://azure.microsoft.com/services/storage/blobs/)<br>\r\n\r\n### References\r\nüí° [Connect Azure Activity Data](https://docs.microsoft.com/azure/sentinel/data-connectors-reference#azure-activity)<br>\r\nüí° [Connect Azure Active Directory (Azure AD) data to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-azure-active-directory)<br>\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\nüí° [Connect Azure Storage Account Data](https://docs.microsoft.com/azure/sentinel/data-connectors-reference#azure-storage-account)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Azure Active Directory](https://portal.azure.com#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) <br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Cloud Azure | ‚Ä¢ Azure Active Directory Logs ‚Ä¢ Activity Logs ‚Ä¢ Unified Audit Logs (w/Advanced Audit Features) | Log | 0 | 12 Months Active Storage, 18 Months Cold Data Storage | 27 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureActivity\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Azure Logs (AzureActivity)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SigninLogs\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Azure Active Directory (SigninLogs)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AuditLogs\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Audit Logs (Azure Active Directory)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "OfficeActivity\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Unified Audit Logs (Microsoft 365)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "StorageBlobLogs\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Storage Blob Logs (Azure Blob Storage)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 7",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "StorageFileLogs\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Storage File Logs (Azure Blob Storage)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 7 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureMetrics\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Azure Metrics",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 9"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_18Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Cloud Azure",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Cloud GCP](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [GWorkspaceActivityReports](https://developers.google.com/admin-sdk/reports/reference/rest/v1/activities)<br>\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert)‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)<br>\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-cloud/continuous-export?tabs=azure-portal#what-data-types-can-be-exported) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/) <br>  \r\n\r\n### References\r\nüí° [Google Workspace (G-Suite) Connector](https://docs.microsoft.com/azure/sentinel/data-connectors-reference#google-workspace-g-suite-preview)<br>\r\nüí° [Connect your GCP accounts to Microsoft Defender for Cloud](https://docs.microsoft.com/azure/defender-for-cloud/quickstart-onboard-gcp)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Cloud GCP | ‚Ä¢ Access Transparency Audit Log ‚Ä¢ Admin Audit Log ‚Ä¢ Data Studio Audit Log ‚Ä¢ Drive Audit Log ‚Ä¢ Email Audit Log ‚Ä¢ Groups Audit Log ‚Ä¢ LDAP Audit Log ‚Ä¢ Login Audit Log ‚Ä¢ Devices Audit Log ‚Ä¢ Sail Audit Log ‚Ä¢ Token Audit Log ‚Ä¢ User Accounts Audit Log ‚Ä¢ OAuth Token Audit Log ‚Ä¢ Security Reports ‚Ä¢ Usage Logs ‚Ä¢ Storage Logs ‚Ä¢ Data Access Logs For Organizational and Default Configuration Settings Enable: ‚Ä¢ Admin Read ‚Ä¢ Data Read ‚Ä¢ Data Write | Log | 0 | 12 Months Active Storage, 18 Months Cold Data Storage | 27 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "GWorkspaceActivityReports\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Google Cloud Logs (GWorkspaceActivityReports)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityAlert\r\n| where Description contains \"Google\"\r\n| summarize count() by AlertName\r\n| sort by count_ desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Google Cloud Alerts (SecurityAlert: Microsoft Sentinel)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityRecommendation\r\n| where RemediationDescription contains \"google\"\r\n| summarize count() by RecommendationName\r\n| sort by count_ desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Google Cloud Recommendations (Microsoft Defender for Cloud)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL0_19Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Cloud GCP",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEL0Visible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Event Logging (EL0)"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Basic Log Event Management (EL1)\r\n---\r\nOnly logging requirements of highest criticality are met. The agency and all of its components meet the following requirements, as detailed in Table 2 EL1 Basic Requirements) within Appendix A (Implementation and Centralized Access Requirements). For more information, see üí°[Improving the Federal Government‚Äôs Investigative and Remediation Capabilities Related to Cybersecurity Incidents (M-21-31)](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf).\r\n\r\n    ‚Ä¢ Basic Logging Categories \r\n    ‚Ä¢ Minimum Logging Data \r\n    ‚Ä¢ Time Standard \r\n    ‚Ä¢ Event Forwarding \r\n    ‚Ä¢ Protecting and Validating Log Information \r\n    ‚Ä¢ Passive DNS \r\n    ‚Ä¢ Cybersecurity Infrastructure Security Agency (CISA) and Federal Bureau of Investigations (FBI) Access Requirements \r\n    ‚Ä¢ Logging Orchestration, Automation, and Response ‚Äì Planning \r\n    ‚Ä¢ User Behavior Monitoring ‚Äì Planning \r\n    ‚Ä¢ Basic Centralized Access"
            },
            "customWidth": "45",
            "name": "EL1 Guide"
          },
          {
            "type": 1,
            "content": {
              "json": ""
            },
            "customWidth": "5",
            "name": "text - 10"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "{\"version\":\"1.0.0\",\"content\":\"\\t[\\r\\n\\t\\t{ \\\"Section\\\": \\\"Configuration\\\", \\\"tab\\\": \\\"EL1_1_\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Endpoint Detection & Response (EDR)\\\", \\\"tab\\\": \\\"EL1_2_\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Configuration Changes\\\", \\\"tab\\\": \\\"EL1_3\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Administrative\\\", \\\"tab\\\": \\\"EL1_4\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Authorization\\\", \\\"tab\\\": \\\"EL1_5\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Content Filtering Policy Updates\\\", \\\"tab\\\": \\\"EL1_6\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"AV & Behavior Based Malware Protection\\\", \\\"tab\\\": \\\"EL1_7\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Host Connections to Specific URLs\\\", \\\"tab\\\": \\\"EL1_8\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"All Devices\\\", \\\"tab\\\": \\\"EL1_9\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Firewalls\\\", \\\"tab\\\": \\\"EL1_10\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"IDS/IPS Alerts & Events\\\", \\\"tab\\\": \\\"EL1_11\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"VPN Gateway\\\", \\\"tab\\\": \\\"EL1_12\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"PKI Infrastructure\\\", \\\"tab\\\": \\\"EL1_13\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Vulnerability Assessments\\\", \\\"tab\\\": \\\"EL1_14\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Database Level\\\", \\\"tab\\\": \\\"EL1_15\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Web Applications\\\", \\\"tab\\\": \\\"EL1_16\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Web Application Crashes\\\", \\\"tab\\\": \\\"EL1_17\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Web Application & Middleware\\\", \\\"tab\\\": \\\"EL1_18\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Virtualization on System\\\", \\\"tab\\\": \\\"EL1_19\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Mobile EMM (UEM) / MTD Agent Logs\\\", \\\"tab\\\": \\\"EL1_21\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Container Supply Chain\\\", \\\"tab\\\": \\\"EL1_22\\\" }\\r\\n\\t]\",\"transformers\":null}",
              "size": 3,
              "title": "EL1 Requirements",
              "exportMultipleValues": true,
              "exportedParameters": [
                {
                  "fieldName": "tab",
                  "parameterName": "Tab",
                  "parameterType": 1
                }
              ],
              "queryType": 8,
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Section",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  },
                  {
                    "columnMatch": "tab",
                    "formatter": 5
                  }
                ],
                "filter": true
              }
            },
            "customWidth": "35",
            "name": "Event Logging Tiers"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "a30d01d0-38f1-4a91-9cf6-cdb181d676b5",
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_1_Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_1_",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  }
                },
                {
                  "id": "5adaf9a2-bf95-4de8-8c45-6d7a5d363516",
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_2_Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_2_",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  }
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_3Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_3",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "d0671b49-6bbd-49c3-970c-ff0292fda421"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_4Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_4",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "af237977-f506-4a22-9c3c-98f16792fc11"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_5Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_5",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "3c38683f-5413-46d9-9461-4ca94c519bd5"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_6Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_6",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "01a6cc03-2ed8-4ef6-98e9-11e95c4de191"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_7Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_7",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "3c3c21c8-dbbc-4393-ad67-9f64756f2a50"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_8Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_8",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "685f5307-72af-43a7-be11-750556ac2c0c"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_9Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_9",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "a9f47ba8-5cdd-4ced-9ac3-31eeea813229"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_10Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_10",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "78ed01a9-e093-4a9c-8329-f6f327679bdf"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_11Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_11",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "3194b0b9-682b-4d10-9f90-0f0a4759f2a2"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_12Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_12",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "13b77e95-3ea9-438c-a6ad-271c038ce4fe"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_13Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_13",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "82af4030-3a8e-4dff-a0cd-b19d87d0031c"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_14Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_14",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "0e3afed6-6f8f-46e3-ac0a-a02c381e2b01"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_15Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_15",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "7b964828-c0e2-4442-9a61-607e5a5a6f8d"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_16Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_16",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "6af13af9-3eda-424c-b3df-03598d625aee"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_17Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_17",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "d718e183-c1d8-4a85-a9e3-687636280003"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_18Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_18",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "e714ce9e-651b-4b23-8c9a-0c7f69792515"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_19Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_19",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "b76fc0c9-3ca9-47cf-af0b-db6d68494b15"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_20Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_20",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "5e519f2e-3a6c-400a-84c3-a7a13b406a5e"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_21Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_21",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "0d422990-5313-4b23-852b-53007151cd66"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL1_22Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL1_22",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "a1bdc637-dfbc-4f91-9100-cc11912fc022"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "1",
            "name": "Hidden Parameters"
          },
          {
            "type": 1,
            "content": {
              "json": "## EL1 Controls Mapping\r\n| <strong> Event Logging Requirements </strong> | <strong> Microsoft Controls </strong> | \r\n|:--|:--|\r\n| Configuration | ‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) |\r\n| Endpoint Detection & Response (EDR) | ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)  |\r\n| Configuration Changes | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender) ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender) |\r\n| Administrative | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) |\r\n| Authorization | ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender) |\r\n| Content Filtering Policy Updates | ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender) |\r\n| Anti-Virus & Behavior Based Malware Protection | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender) ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender) ‚ú≥Ô∏è[Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)|\r\n| Indication of the Host that Connected to a Specific URL | ‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender) ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) |\r\n| All Devices | ‚ú≥Ô∏è [Automation]( https://azure.microsoft.com/services/automation/) ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)  |\r\n| Firewalls | ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) |\r\n| IDs /IPs Alerts & Events | ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) |\r\n| VPN Gateway | ‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)  |\r\n| PKI Infrastructure | ‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center) |\r\n| Vulnerability Assessments | ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center) ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender) |\r\n| Database Level | ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/) ‚ú≥Ô∏è [Azure SQL Database](https://azure.microsoft.com/products/azure-sql/database/) ‚ú≥Ô∏è [Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/) ‚ú≥Ô∏è [Azure Database for MariaDB](https://azure.microsoft.com/services/mariadb/)‚ú≥Ô∏è [Azure Database for PostgreSQL](https://azure.microsoft.com/services/postgresql/) ‚ú≥Ô∏è [Azure Database for MySQL](https://azure.microsoft.com/services/mysql/) ‚ú≥Ô∏è [Azure Cache for Redis](https://azure.microsoft.com/services/cache/) |\r\n| Web Applications | ‚ú≥Ô∏è [Azure Web Application Firewall](https://azure.microsoft.com/services/web-application-firewall/) |\r\n| Web Application Crashes | ‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/) |\r\n| Web Application & Middleware | ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/) ‚ú≥Ô∏è [App Service](https://azure.microsoft.com/services/app-service/) |\r\n| Virtualization on System | ‚ú≥Ô∏è [Azure VMware Solution](https://azure.microsoft.com/services/azure-vmware/)  ‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/)  |\r\n| Mobile (Smart Phones & Tablets) EMM (UEM) / MTD Agent Logs | ‚ú≥Ô∏è [Microsoft Endpoint Manager](https://www.microsoft.com/security/business/microsoft-endpoint-manager) |\r\n| Container Supply Chain | ‚ú≥Ô∏è [Azure Kubernetes Service (AKS)](https://azure.microsoft.com/services/kubernetes-service/) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/) ‚ú≥Ô∏è [Azure Monitor](https://azure.microsoft.com/services/monitor/) |"
            },
            "conditionalVisibility": {
              "parameterName": "Help",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "EL1 Guide"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Configuration](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) üî∑ [Perf](https://docs.microsoft.com/azure/azure-monitor/reference/tables/perf) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\nüî∑ [OfficeActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/officeactivity) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)<br> \r\nüî∑ [SentinelHealth](https://docs.microsoft.com/azure/azure-monitor/reference/tables/sentinelhealth) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\n\r\n### References\r\nüí° [Connect Azure Activity Data](https://docs.microsoft.com/azure/sentinel/data-connectors-reference#azure-activity)<br>\r\nüí° [Connect Azure Active Directory (Azure AD) data to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-azure-active-directory)<br>\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\nüí° [Collect Windows and Linux performance data sources with Log Analytics agent](https://docs.microsoft.com/azure/azure-monitor/agents/data-sources-performance-counters)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| System & Configuration Performance | Configuration ‚Äì Scripts or Database Changes Used to Configure Systems, Services on a System, or Applications | Database Record, Script | 1 | 12 Months Active Storage, 18 Months Cold Storage | 28 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureActivity\r\n| where Category == \"Administrative\"\r\n| project OperationName, OperationNameValue, ResourceGroup, Caller, TimeGenerated, CallerIpAddress, Category\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "System & Application Configuration Changes (Azure Monitor)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "OfficeActivity\r\n| where UserType <> \"Regular\"\r\n| project Operation, RecordType, UserId, UserType, OfficeWorkload, ResultStatus, Parameters, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "System & Application Configuration Changes (Microsoft 365)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "Perf\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "System/Service Performance Logging",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SentinelHealth\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "SIEM/Log Health Performance Monitoring",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 6",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_1_Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Configuration",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Endpoint Detection & Response (EDR)](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) üî∑ [DeviceEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/deviceevents) üî∑ [DeviceNetworkEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/devicenetworkevents) üî∑ [DeviceLogonEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/devicelogonevents) üî∑ [DeviceFileEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/devicefileevents)üî∑ [DeviceRegistryEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/deviceregistryevents) üî∑ [DeviceProcessEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/deviceprocessevents) ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br> \r\n\r\n### References\r\nüí° [Microsoft 365 Defender integration with Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/microsoft-365-defender-sentinel-integration)<br>\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| System & Configuration Performance | Endpoint Detection & Response (EDR) | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 28 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": "Implemented"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "21NOV21",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "Review SSP at www.ssp.com",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityAlert\r\n| where ProductName == \"Microsoft Defender Advanced Threat Protection\"\r\n| project AlertName, AlertSeverity, AlertType, AlertLink, CompromisedEntity, Status, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250 ",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Endpoint Detection & Response (Microsoft Defender for Endpoint)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceEvents\r\n| project DeviceName, ActionType, InitiatingProcessFileName, InitiatingProcessAccountName, AdditionalFields, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Device Events  (Microsoft Defender for Endpoint)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceFileEvents\r\n| project DeviceName, ActionType, FileName, FolderPath, InitiatingProcessAccountName, InitiatingProcessParentFileName, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Device File Events (Microsoft Defender for Endpoint)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceLogonEvents\r\n| project AccountName, AccountDomain, ActionType, DeviceName, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Device Logon Events (Microsoft Defender for Endpoint)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_2_Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Endpoint Detection & Response (EDR)",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Configuration Changes](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) üî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br> \r\nüî∑ [OfficeActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/officeactivity) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)<br> \r\nüî∑ [SecurityEvent](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityevent) ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br> \r\nüî∑ [IdentityInfo](https://docs.microsoft.com/azure/azure-monitor/reference/tables/identityinfo) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br>\r\n\r\n### References\r\nüí° [Connect Azure Active Directory (Azure AD) data to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-azure-active-directory)<br>\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\nüí° [Connect Windows data to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/data-connectors-reference#windows-dns-server-preview)<br>\r\nüí° [IdentityInfo table](https://docs.microsoft.com/azure/sentinel/ueba-enrichments#identityinfo-table-public-preview)<br>\r\nüí° [Start using Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart) <br>\r\nüîÄ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) <br>\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| System & Configuration Performance | Configuration Changes ‚Ä¢ Management Action (Success/Failure) ‚Ä¢ Admin Login (Success/Failure)  | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 28 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AuditLogs\r\n| where Identity == \"MS-PIM\"\r\n| extend UserPrincipalName = tostring(TargetResources[0].userPrincipalName)\r\n| extend PIM_Role = tostring(parse_json(tostring(parse_json(tostring(TargetResources[0].modifiedProperties))[1].newValue)))\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Management Actions (Privileged Identity Management)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityEvent\r\n| where Account contains \"admin\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Endpoint Admin Events (Microsoft Defender for Endpoint)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "OfficeActivity\r\n| where RecordType contains \"Admin\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Exchange Admin Events (Microsoft Defender for Office 365)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IdentityInfo\r\n| where AssignedRoles contains \"Admin\" or AssignedRoles contains \"owner\" or AssignedRoles contains \"contributor\"\r\n| join (SigninLogs) on $left.AccountUPN == $right.UserPrincipalName\r\n| extend Country = tostring(LocationDetails.countryOrRegion)\r\n| where ResultType == 0\r\n| project UserPrincipalName, AssignedRoles, Department, JobTitle, Country, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Admin Sign Ins (Azure Active Directory)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Configuration Changes",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Administrative](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) üî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br> \r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) üî∑ [IdentityInfo](https://docs.microsoft.com/azure/azure-monitor/reference/tables/identityinfo) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br>\r\n\r\n### References\r\nüí° [Connect Azure Active Directory (Azure AD) data to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-azure-active-directory)<br>\r\nüí° [Automatically create incidents from Microsoft security alerts](https://docs.microsoft.com/azure/sentinel/create-incidents-from-alerts)<br>\r\nüí° [IdentityInfo table](https://docs.microsoft.com/azure/sentinel/ueba-enrichments#identityinfo-table-public-preview)<br>\r\nüí° [Start using Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart) <br>\r\nüîÄ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) <br>\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Authentication & Authorization | Administrative ‚Ä¢ Authentication Logons (Success/Failure) ‚Ä¢ Authentication Logoffs ‚Ä¢ Privilege Elevation (Success/Failure) ‚Ä¢ Security Related System Alerts and Failures ‚Ä¢ User and Group o Additions o Deletions o Modification to Permissions ‚Ä¢ Unauthorized Access Attempts to Critical Systems and File | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 29 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IdentityInfo\r\n| where AssignedRoles contains \"Admin\" or AssignedRoles contains \"owner\" or AssignedRoles contains \"contributor\"\r\n| join (SigninLogs) on $left.AccountUPN == $right.UserPrincipalName\r\n| extend Country = tostring(LocationDetails.countryOrRegion)\r\n| project UserPrincipalName, ResultType, AssignedRoles, Country, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Authentication Logon/Logoffs: Success/Failure (Azure Active Directory)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AuditLogs\r\n| where Identity == \"MS-PIM\"\r\n| extend UserPrincipalName = tostring(TargetResources[0].userPrincipalName)\r\n| extend PIM_Role = tostring(parse_json(tostring(parse_json(tostring(TargetResources[0].modifiedProperties))[1].newValue)))\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Privilege Elevation (Privileged Identity Management)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityAlert\r\n| where Tactics contains \"InitialAccess\"\r\n| summarize count() by AlertName, ProviderName\r\n| sort by count_ desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Security Alerts & Unauthorized Access Attempts (Microsoft Sentinel)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AuditLogs\r\n| where OperationName contains \"role\" or OperationName contains \"user\" or OperationName contains \"principal\" or OperationName contains \"member\" or OperationName contains \"group\"\r\n| where OperationName !contains \"invite\" \r\n| where OperationName !contains \"external\" \r\n| where OperationName !contains \"licnense\" \r\n| project OperationName, Category, InitiatedBy, TargetResources, TimeGenerated\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "User/Group Changes (Azure Active Directory)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_4Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Administrative",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Authorization](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\nüî∑ [VMProcess](https://docs.microsoft.com/azure/azure-monitor/reference/tables/vmprocess) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\nüî∑ [DeviceProcessEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/deviceprocessevents) ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br> \r\nüî∑ [Syslog](https://docs.microsoft.com/azure/azure-monitor/reference/tables/syslog) ‚ú≥Ô∏è [Collect Syslog Data Sources with Log Analytics Agent](https://docs.microsoft.com/azure/azure-monitor/agents/data-sources-syslog) <br> \r\n\r\n### References\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\nüí° [Using Service Map solution in Azure](https://docs.microsoft.com/azure/azure-monitor/vm/service-map)<br>\r\nüí° [Connect Windows data to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/data-connectors-reference#windows-dns-server-preview)<br>\r\nüí° [Deploy a log forwarder to ingest Syslog and CEF logs to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-log-forwarder?tabs=rsyslog)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Azure Active Directory](https://portal.azure.com#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) <br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview) <br>\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Authentication & Authorization | Authorization: All Privileged Operations Including: ‚Ä¢ ‚Äúsudo‚Äù or runas ‚Ä¢ Enabling CLI Access ‚Ä¢ System Administrative Commands ‚Ä¢ Powershell Execution Commands ‚Ä¢ Powershell Script Block Logging | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 29 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SigninLogs\r\n| where AppDisplayName == \"Azure Active Directory PowerShell\" or AppDisplayName == \"Microsoft Azure CLI\" or AppDisplayName contains \"command\" or AppDisplayName contains \"ACOM\" or AppDisplayName contains \"graph\" or AppDisplayName contains \"PowerShell\" or AppDisplayName contains \" CLI \"\r\n| project TimeGenerated, UserPrincipalName, ResultType, AppDisplayName, IPAddress, Location, UserAgent\r\n| summarize count() by UserPrincipalName, AppDisplayName\r\n| sort by count_ desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Usage of Privileged Management Functions (Azure Active Directory)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceProcessEvents\r\n| where ProcessCommandLine <> \"\"\r\n| summarize count() by ProcessCommandLine \r\n| sort by count_ desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Commands Executed (Device Process Events)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "Syslog\r\n| where SyslogMessage <> \"\"\r\n| where SyslogMessage contains \"sudo\" or SyslogMessage contains \"runas\"\r\n| summarize count() by SyslogMessage\r\n| sort by count_ desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Sudo Activity (Syslog)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "VMProcess\r\n| where CommandLine <> \"\"\r\n| summarize count() by CommandLine\r\n| sort by count_ desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Commands Executed (Virtual Machines)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_5Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Authorization",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Content Filtering Policy Updates](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [OfficeActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/officeactivity) üî∑ [EmailEvents](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-emailevents-table) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)<br> \r\n\r\n### References\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Email Filtering, Spam, and Phishing | Content Filtering Policy Updates | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 29 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "OfficeActivity\r\n| where Operation contains \"policy\"\r\n| where Operation !contains \"access\"\r\n| project Operation, RecordType, UserId, UserType, OfficeWorkload, ResultStatus, Parameters, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Content Filtering Policy Updates (Microsoft 365)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "EmailEvents\r\n| summarize count() by ConfidenceLevel, DetectionMethods, DeliveryAction, EmailActionPolicy\r\n| sort by count_ desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Configured Email Filtering Policies (Microsoft 365)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_6Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Content Filtering Policy Updates",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Anti-Virus & Behavior Based Malware Protection](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) üî∑ [SecurityEvent](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityevent) ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br> \r\nüî∑ [EmailEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) üî∑ [EmailAttachmentInfo](https://docs.microsoft.com/azure/azure-monitor/reference/tables/emailattachmentinfo)‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)<br> \r\nüî∑ [ThreatIntelligenceIndicator](https://docs.microsoft.com/azure/azure-monitor/reference/tables/threatintelligenceindicator) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br> \r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n### References\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\nüí° [Understand threat intelligence in Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/understand-threat-intelligence)<br>\r\nüí° [Review event logs and error codes to troubleshoot issues with Microsoft Defender Antivirus](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/troubleshoot-microsoft-defender-antivirus)<br>\r\nüí° [Continuously export Microsoft Defender for Cloud data](https://docs.microsoft.com/azure/defender-for-cloud/continuous-export?tabs=azure-portal)<br>\r\n\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Anti-Virus & Behavior Based Malware Protection | ‚Ä¢ Date and Time Source Hostname o IP o Port ‚Ä¢ Destination Hostname o IP o Port ‚Ä¢ Description of Malicious Code or Action and Severity ‚Ä¢ Identity or (Hash) Identifier of the File(s) ‚Ä¢ Description of the Action Taken (Clean, Quarantine, Delete) ‚Ä¢ Signature Updates| Log, Email Attachments | 1 | 12 Months Active Storage, 18 Months Cold Storage | 29-30 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityAlert\r\n| where ProductName == \"Microsoft Defender Advanced Threat Protection\" or ProductName == \"Microsoft Defender ATP\" or ProductName == \"Microsoft Antimalware\"\r\n| summarize count() by AlertName, ProductName\r\n| sort by count_ desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Malware & AV Alerts (Microsoft Defender for Endpoint)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "AlertSeverity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "AlertLink",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": ""
                          }
                        },
                        {
                          "columnMatch": "Location",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Uri",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go To: Storage Blob >"
                          }
                        },
                        {
                          "columnMatch": "UserPrincipalName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "DeviceId",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Caller",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 17"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let AVEvents = dynamic([\"1000\",\"1001\",\"1002\",\"1003\",\"1004\",\"1005\",\"1006\",\"1007\",\"1008\",\"1009\",\"1010\",\"1011\",\"1012\",\"1013\",\"1014\",\"1015\",\"1116\",\"1117\",\"1118\",\"1119\",\"1120\",\"1150\",\"1151\",\"2000\",\"2001\",\"2002\",\"2003\",\"2004\",\"2005\",\"2006\",\"2007\",\"2010\",\"2011\",\"2012\",\"2013\",\"2020\",\"2021\",\"2030\",\"2040\",\"2041\",\"2042\",\"3002\",\"3007\",\"5000\",\"5001\",\"5004\",\"5007\",\"5008\",\"5009\",\"5010\",\"5011\",\"5012\",\"5100\",\"5101\"]);\r\nSecurityEvent\r\n| where EventID in (AVEvents)\r\n| summarize count() by Activity, EventID, Computer\r\n| sort by count_ desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Malware/Anti-virus Logs, Actions, Signature Updates (Microsoft Defender for Endpoints)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "redBright"
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 41 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "EmailAttachmentInfo\r\n| join (EmailEvents) on NetworkMessageId\r\n| where DeliveryAction <> \"Delivered\"\r\n| project Subject, SenderMailFromAddress, RecipientEmailAddress, DeliveryAction, FileName, SHA256, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Email Malware Attachment Blocks (Microsoft Defender for Office 365)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "redBright"
                          }
                        },
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 7"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "imNetworkSession\r\n| extend Indicator = strcat(SrcIpAddr)\r\n| where Indicator <> \"\"\r\n| where Indicator !startswith \"192.\"\r\n| where Indicator !startswith \"10.\"\r\n| where Indicator !startswith \"127.\"\r\n| where Indicator !startswith \"171.\"\r\n| where Indicator !startswith \"fe80\"\r\n| join (ThreatIntelligenceIndicator| extend Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP)| where Indicator <> \"\") on Indicator\r\n| project Indicator, ThreatType, SrcIpAddr, SrcPortNumber, DstIpAddr, DstPortNumber, NetworkProtocol, NetworkDirection, Type, EventVendor, EventResult, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Host Communication with Threat IP (Microsoft Sentinel)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "IndicatorProvider",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Indicator",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Pre attack",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "RemoteCountry",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Globe",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 41"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "// Regulatory compliance CSV report query for standard \"Azure Security Benchmark\" \r\n// Change the 'complianceStandardId' column condition to select a different standard\r\n    securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"Azure Security Benchmark\"\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId == \"Azure Security Benchmark\"\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where complianceControlId contains \"ES.\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Anti-Virus & EDR Recommendations (Microsoft Defender for Cloud) ",
                    "noDataMessage": "No Current ASB Recommendations in this Area. Confirm the Azure Security Benchmark Assessment is Enabled in Microsoft Defender for Cloud: Regulatory Compliance Blade.",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationDisplayName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "State",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "ControlID",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Recommendation",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Recommendation >"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 3"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_7Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Anti-Virus & Behavior Based Malware Protection",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Indication of the Host that Connected to a Specific URL](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [DeviceNetworkEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/devicenetworkevents) üî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br>\r\nüî∑ [AzureDiagnostics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azurediagnostics) ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/)<br>\r\nüî∑ [VMConnection](https://docs.microsoft.com/azure/azure-monitor/reference/tables/vmconnection) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n### References\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\nüí° [Using Service Map solution in Azure](https://docs.microsoft.com/azure/azure-monitor/vm/service-map)<br>\r\nüí° [Deploy and configure Azure Firewall Premium](https://docs.microsoft.com/azure/firewall/premium-deploy)<br>\r\nüí° [Web content filtering](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/web-content-filtering)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview) <br>\r\nüîÄ [Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FfirewallPolicies)<br>\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Anti-Virus & Behavior Based Malware Protection | Indication of the Host that Connected to a Specific URL ‚Ä¢ Date and Time ‚Ä¢ IP and Domain Reputation ‚Ä¢ URL ‚Ä¢ Categorization| Log  | 1 | 12 Months Active Storage, 18 Months Cold Storage | 30 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "VMConnection\r\n| where DestinationPort == 80 or DestinationPort == 443\r\n| where Direction == \"outbound\"\r\n| where RemoteDnsQuestions <> \"\"\r\n| summarize count() by Computer, RemoteDnsQuestions, RemoteDnsCanonicalNames\r\n| sort by count_ desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Host to URL Correlations (Service Map)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityAlert\r\n| where AlertName contains \"URL\"\r\n| extend HostName = tostring(parse_json(ExtendedProperties).HostName)\r\n| project AlertName, ProductName, HostName, CompromisedEntity, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Malicious URL Alerts (Microsoft Defender for Endpoint)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceNetworkEvents\r\n| where RemoteUrl <> \"\"\r\n| summarize count() by DeviceName, RemoteUrl\r\n| sort by count_ desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Host to URL Logging (Microsoft Defender for Endpoint)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let materializedData =\r\n(\r\nAzureDiagnostics\r\n| where Category == \"AzureFirewallApplicationRule\"\r\n| project ResourceId,ResourceGroup,SubscriptionId, msg_s, Resource, TimeGenerated);\r\nunion(\r\n    materializedData\r\n    | where msg_s has \"Web Category:\" and msg_s has \". Url\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Url:\" Url \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \". Url\"\r\n        and msg_s has \". No rule matched\"\r\n        and msg_s !has \"Web Category:\" \r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Url:\" Url \". Action: \" Action \". No rule matched\" *\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \". No rule matched\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Web Category:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". No rule matched\" *\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \"Web Category:\" \r\n        and msg_s !has \". Url\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Rule Collection\"\r\n        and msg_s !has \" Reason: \"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". \" RuleCollection \". \" Rule\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \" Reason:\"\r\n        and msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Rule Collection\"\r\n        and msg_s !has \"TLS extension was missing\"\r\n     | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \". Action: \" Action \". Reason: \" Rule \".\"\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"TLS extension was missing\"\r\n        and msg_s !has \"No rule matched\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \"Rule Collection Group\"\r\n        and msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Rule Collection\"\r\n        and msg_s !has \" Reason: \"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Policy:\" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    )\r\n| summarize by TimeGenerated, FQDN, Protocol, Action, SourceIP, SourcePort, DestinationPort , ResourceId , ResourceGroup , RuleCollection, Rule, WebCategory, SubscriptionId\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Web Categorization (Azure Firewall)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_8Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Indication of the Host that Connected to a Specific URL",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [All Devices](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [DeviceProcessEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/deviceprocessevents) ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)<br>\r\nüî∑ [ConfigurationData](https://docs.microsoft.com/azure/azure-monitor/reference/tables/configurationdata) ‚ú≥Ô∏è [Automation]( https://azure.microsoft.com/services/automation/) <br>\r\nüî∑ [ConfigurationChange](https://docs.microsoft.com/azure/azure-monitor/reference/tables/configurationchange) ‚ú≥Ô∏è [Automation]( https://azure.microsoft.com/services/automation/) <br>\r\n\r\n### References\r\nüí° [Change Tracking and Inventory overview](https://docs.microsoft.com/azure/automation/change-tracking/overview)<br>\r\nüí° [Support for alerts on configuration state](https://docs.microsoft.com/azure/automation/change-tracking/overview#support-for-alerts-on-configuration-state)<br>\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Automation Accounts](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Automation%2FAutomationAccounts) <br>\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Device Infrastructure | All Devices ‚Ä¢ Hash of the Binary / Binaries Running on the Device ‚Ä¢ Hash of Configs ‚Ä¢ Firmware o Version o Created Date o Installed Date o Manufacturer| Log  | 1 | 12 Months Active Storage, 18 Months Cold Storage | 30 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ConfigurationData\r\n| where ConfigDataType == \"Registry\"\r\n| where Hive == \"HKEY_LOCAL_MACHINE\"\r\n| search \"hardware\"\r\n| project _ResourceId, RegistryKey, Hive, ValueName, ValueType, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Hardware/Firmware Configuration Data (Registry)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ConfigurationChange\r\n| where ConfigChangeType == \"Registry\"\r\n| where Hive == \"HKEY_LOCAL_MACHINE\"\r\n| search \"hardware\"\r\n| project _ResourceId, RegistryKey, Hive, ChangeCategory, ValueName, ValueType, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Hardware/Firmware Configuration Change (Registry)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "DeviceProcessEvents\r\n| where FileName <> \"\"\r\n| summarize count() by DeviceName, FileName, SHA256, SHA1\r\n| sort by count_ desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Files, Binaries, and Hahses (DeviceProcessEvents)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5 - Copy - Copy"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_9Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "All Devices",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Firewalls](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AzureDiagnostics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azurediagnostics) ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/)\r\n\r\n### References\r\nüí° [Monitor Azure Firewall logs and metrics](https://docs.microsoft.com/azure/firewall/firewall-diagnostics)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview) <br> \r\n\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Device Infrastructure (for Devices with Multiple Interfaces: Interface MAC - If Correlated to the Device NAT IP Address) | Firewalls: All Events from Firewall. At the very least, if access control lists (ACL) are enabled and the device is filtering traffic: ‚Ä¢ Action Permit, Teardowns, Closes, Denies, and Drops ‚Ä¢ Interface ‚Ä¢ Source o Hostname o IP Address and Port oMAC ‚Ä¢ Destination o Hostname o IP Address and Port o MAC ‚Ä¢ Protocol Type ‚Ä¢ Rule Name and Number Triggered ‚Ä¢URL if Applicable, Associated User and User Agent ‚Ä¢ Date and Time | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 30 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let materializedData =\r\n(\r\nAzureDiagnostics\r\n| project ResourceId,ResourceGroup,SubscriptionId, msg_s, Resource, TimeGenerated);\r\nunion(\r\n    materializedData\r\n    | where msg_s has \"Web Category:\" and msg_s has \". Url\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Url:\" Url \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \". Url\"\r\n        and msg_s has \". No rule matched\"\r\n        and msg_s !has \"Web Category:\" \r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Url:\" Url \". Action: \" Action \". No rule matched\" *\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \". No rule matched\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Web Category:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". No rule matched\" *\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \"Web Category:\" \r\n        and msg_s !has \". Url\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Rule Collection\"\r\n        and msg_s !has \" Reason: \"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". \" RuleCollection \". \" Rule\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \" Reason:\"\r\n        and msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Rule Collection\"\r\n        and msg_s !has \"TLS extension was missing\"\r\n     | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \". Action: \" Action \". Reason: \" Rule \".\"\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"TLS extension was missing\"\r\n        and msg_s !has \"No rule matched\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \"Rule Collection Group\"\r\n        and msg_s !has \"Web Category:\"\r\n        and msg_s !has \". Url\"\r\n        and msg_s !has \"Rule Collection\"\r\n        and msg_s !has \" Reason: \"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Policy:\" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    )\r\n| summarize by TimeGenerated, FQDN, Protocol, Action, SourceIP, SourcePort, DestinationPort , ResourceId , ResourceGroup , RuleCollection, Rule, WebCategory, SubscriptionId\r\n| where Action <> \"\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Firewall Traffic (Azure Firewall)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_10Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Firewalls",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [IDS/IPS Alerts & Events](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AzureDiagnostics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azurediagnostics) ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/)\r\n\r\n### References\r\nüí° [Monitor Azure Firewall logs and metrics](https://docs.microsoft.com/azure/firewall/firewall-diagnostics)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FfirewallPolicies) <br> \r\n\r\n\r\n\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Device Infrastructure (for Devices with Multiple Interfaces: Interface MAC - If Correlated to the Device NAT IP Address) | All Devices: IDs / IPs Alerts and Events ‚Ä¢ Date and Time ‚Ä¢ Source o Hostname o IP Address and Port oMAC ‚Ä¢Destination o Hostname o IP Address and Port oMAC ‚Ä¢ Signature Triggered and Associated Details Including: o Signature o Anomaly ‚Ä¢ Rate Threshold ‚Ä¢ Device Name ‚Ä¢ Type of Event and Category ‚Ä¢ In the Case of Fortinet Network IPs, Attack Context ‚Ä¢(Web / Device) User Agent if Available ‚Ä¢ Wi-Fi Channel ‚Ä¢ Wi-Fi Extended Service Set Identifier (ESSID) | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 31 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureDiagnostics\r\n| where ResourceType == \"AZUREFIREWALLS\"\r\n| where OperationName == \"AzureFirewallIDSLog\"\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" DestIP \":\" DestPort \". Action: \" Action \". Signature: \" SignatureID \". IDS:\" Message \". Priority:\" Priority \". Classification:\" Classification\r\n| project TimeGenerated, SignatureID, Message, Priority, Classification, Protocol, SourceIP, SourcePort, DestIP, DestPort, Action, Resource\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Intrusion Detection & Preventions (Azure Firewall)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_11Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "IDs /IPs Alerts & Events",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [VPN Gateway](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [GatewayDiagnosticLog](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-setup-alerts-virtual-network-gateway-log) üî∑ [TunnelDiagnosticLog](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-setup-alerts-virtual-network-gateway-log) üî∑ [IKEDiagnosticLog](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-setup-alerts-virtual-network-gateway-log) üî∑ [RouteDiagnosticLog](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-setup-alerts-virtual-network-gateway-log) üî∑ [P2SDiagnosticLog](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-setup-alerts-virtual-network-gateway-log) ‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/) <br> \r\n\r\n### References\r\nüí° [Set up alerts on resource log events from VPN Gateway](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-setup-alerts-virtual-network-gateway-log)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways) \r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Device Infrastructure (for Devices with Multiple Interfaces: Interface MAC - If Correlated to the Device NAT IP Address) | VPN Gateway ‚Äì All Events At the very least, for Accepts, Teardowns, Closes, Denies, and Drops: ‚Ä¢ Date and Time ‚Ä¢ Source o Hostname o IP Address and Port o MAC ‚Ä¢ Destination o Hostname o IP Address and Port oMAC ‚Ä¢ Source IP Address and Port, MAC (Inside Tunnel) ‚Ä¢ Destination IP Address and Port, MAC (Inside Tunnel) ‚Ä¢ Authentication Information (Success/Fail with Username and Device with User Agent) ‚Ä¢ Change in Status of Connections / Tunnel Status ‚Ä¢ VPN Certificate Status Validation | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 31-32 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "GatewayDiagnosticLog\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "VPN Gateway Configuration Logs (VPN Gateway)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "TunnelDiagnosticLog\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Tunnel State Change & Connections Logs (VPN Gateway)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "RouteDiagnosticLog\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Changes to Static Routes and BGP Events (VPN Gateway)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IKEDiagnosticLog\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "IKE Control Messages & Events (VPN Gateway)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "P2SDiagnosticLog\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Gateway Point-To-Site Control Messages (VPN Gateway)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 7",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_12Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "VPN Gateway",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [PKI Infrastructure](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/) <br> \r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-cloud/continuous-export?tabs=azure-portal#what-data-types-can-be-exported) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\n\r\n### References\r\nüí° [Azure Key Vault logging](https://docs.microsoft.com/azure/key-vault/general/logging?tabs=Vault)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults)  <br>\r\nüîÄ [Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| PKI Infrastructure | All Events Related to: ‚Ä¢ Generation ‚Ä¢ Revocation ‚Ä¢ Access ‚Ä¢ Update ‚Ä¢ Expiry ‚Ä¢ Recover ‚Ä¢ Authentication Success ‚Ä¢ Authentication Fail ‚Ä¢ LDAP Logs  | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 32 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type contains \"key\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "PKI Infrastructure (Azure Key Vault)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureActivity\r\n| where OperationNameValue startswith \"Microsoft.KeyVault/vaults/\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "PKI Infrastructure Events (Azure Key Vault)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId == \"Azure Security Benchmark\"\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where RecommendationDisplayName contains \"vault\" or RecommendationDisplayName contains \"encrypt\" or RecommendationDisplayName contains \"certificate\" or RecommendationDisplayName contains \"key\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "PKI Recommendations (Microsoft Defender for Cloud) ",
                    "noDataMessage": "No current recommendations in this area. Confirm the Azure Security Benchmark Assessment is enabled in Microsoft Defender for Cloud: Regulatory Compliance blade.",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationDisplayName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "State",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "ControlID",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Recommendation",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Recommendation >"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_13Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "PKI Infrastructure",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Vulnerability Assessments](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) \r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-cloud/continuous-export?tabs=azure-portal#what-data-types-can-be-exported) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n### References\r\nüí° [Threat and vulnerability management](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/next-gen-threat-and-vuln-mgt)<br>\r\nüí° [Vulnerability assessment and management](https://docs.microsoft.com/azure/defender-for-cloud/defender-for-cloud-introduction#vulnerability-assessment-and-management)<br>\r\nüí° [Investigate weaknesses with Microsoft Defender for Endpoint's threat and vulnerability management](https://docs.microsoft.com/azure/defender-for-cloud/deploy-vulnerability-assessment-tvm)<br>\r\nüí° [Continuously export Microsoft Defender for Cloud data](https://docs.microsoft.com/azure/defender-for-cloud/continuous-export?tabs=azure-portal)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Vulnerability Assessments | ‚Ä¢ Date and Time ‚Ä¢ Hostname, IP Address, and OS Version ‚Ä¢ Installed Applications ‚Ä¢ Version of Installed Applications ‚Ä¢ Vulnerabilities Listed in Installed Applications ‚Ä¢ Source of Vulnerability and Severity  | Log: Logs are kept for ALL assessments, even if there are 0 vulnerabilities identified during the assessment  | 1 | 12 Months Active Storage, 18 Months Cold Storage | 32 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n| project Resource = tostring(properties.resourceDetails.id), subscriptionId, Severity = tostring(properties.status.severity), Status = tostring(properties.status.code), VulnId = tostring(properties.id)\r\n| where Status == 'Unhealthy'\r\n| summarize dcount(VulnId) by Resource, Severity, VulnId\r\n| summarize Total=count(Severity), High=countif(Severity=='High'), Medium=countif(Severity=='Medium'), Low=countif(Severity=='Low') by Resource\r\n| order by High desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Vulnerabilities by Asset",
                    "noDataMessage": "No current recommendations in this area. Confirm the Azure Security Benchmark Assessment is enabled in Microsoft Defender for Cloud: Regulatory Compliance blade.",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Resource",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "22ch"
                          },
                          "tooltipFormat": {
                            "tooltip": "[\"Total\"] fndings in total"
                          }
                        },
                        {
                          "columnMatch": "High",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "redBright"
                          }
                        },
                        {
                          "columnMatch": "Medium",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "orange"
                          }
                        },
                        {
                          "columnMatch": "Low",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellow"
                          }
                        },
                        {
                          "columnMatch": "sevH",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "palette": "redBright",
                            "compositeBarSettings": {
                              "labelText": "",
                              "columnSettings": []
                            },
                            "customColumnWidthSetting": "15ch"
                          }
                        },
                        {
                          "columnMatch": "sevM",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "palette": "yellow",
                            "customColumnWidthSetting": "15ch"
                          }
                        },
                        {
                          "columnMatch": "sevL",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blueDark",
                            "customColumnWidthSetting": "15ch"
                          }
                        }
                      ],
                      "filter": true
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "query - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| project Resource = tolower(extract(\"([\\\\s\\\\S]*?)(/providers/Microsoft.Security.*)\",1,id)), ResourceGroup = trim_end(\"/\",extract(\".*resourceGroups/(.+?)/\",0,id)), ResourceType = tolower(split(id,\"/\").[6]), subscriptionId, Severity = tostring(parse_json(properties).status.severity), Status = tostring(parse_json(properties).status.code), VulnId = tostring(parse_json(properties).id), Description = tostring(parse_json(properties).displayName), Patchable = parse_json(properties.additionalData).patchable, CVE = properties.additionalData.cve, Category = tostring(properties.category), TimeGenerated = tostring(properties.timeGenerated), Remediation = tostring(properties.remediation), Impact = tostring(properties.impact), Threat = tostring(properties.additionalData.threat)\r\n| where Status == 'Unhealthy'\r\n| project Severity, VulnId, Description, tostring(Patchable), Category, Resource, ResourceGroup, CVE, TimeGenerated, Remediation, Impact, Threat\r\n| mvexpand CVE\r\n| extend CVEs = parse_json(CVE['title'])\r\n| summarize CVEs = tostring(make_list(CVEs)) by Description, Severity, Resource, ResourceGroup, TimeGenerated\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Vulnerability Details",
                    "noDataMessage": "No current recommendations in this area. Confirm the Azure Security Benchmark Assessment is enabled in Microsoft Defender for Cloud: Regulatory Compliance blade.",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Resource",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "22ch"
                          },
                          "tooltipFormat": {
                            "tooltip": "[\"Total\"] fndings in total"
                          }
                        },
                        {
                          "columnMatch": "High",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "redBright"
                          }
                        },
                        {
                          "columnMatch": "Medium",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "orange"
                          }
                        },
                        {
                          "columnMatch": "Low",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellow"
                          }
                        },
                        {
                          "columnMatch": "sevH",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "palette": "redBright",
                            "compositeBarSettings": {
                              "labelText": "",
                              "columnSettings": []
                            },
                            "customColumnWidthSetting": "15ch"
                          }
                        },
                        {
                          "columnMatch": "sevM",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "palette": "yellow",
                            "customColumnWidthSetting": "15ch"
                          }
                        },
                        {
                          "columnMatch": "sevL",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blueDark",
                            "customColumnWidthSetting": "15ch"
                          }
                        }
                      ],
                      "filter": true
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "query - 4 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId == \"Azure Security Benchmark\"\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where controlId contains \"PV.\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Vulnerability Recommendations (Microsoft Defender for Cloud) ",
                    "noDataMessage": "No current recommendations in this area. Confirm the Azure Security Benchmark Assessment is enabled in Microsoft Defender for Cloud: Regulatory Compliance blade.",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationDisplayName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "State",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "ControlID",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Recommendation",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Recommendation >"
                          }
                        }
                      ],
                      "filter": true,
                      "sortBy": [
                        {
                          "itemKey": "$gen_thresholds_Severity_4",
                          "sortOrder": 1
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "$gen_thresholds_Severity_4",
                        "sortOrder": 1
                      }
                    ]
                  },
                  "name": "query - 5"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityRecommendation\r\n| where RecommendationState == \"Unhealthy\"\r\n| make-series count() default=0 on TimeGenerated from startofday({TimeRange:start}) to startofday({TimeRange:end}) step 1d by RecommendationName\r\n| render timechart ",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Vulnerability Logging over Time (Microsoft Defender for Cloud)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ]
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_14Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Vulnerability Assessments",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Database Level](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-iot/how-to-security-data-access#security-recommendations) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\nüî∑ [Event](https://docs.microsoft.com/azure/azure-monitor/reference/tables/event) üî∑ [SqlAtpStatus](https://docs.microsoft.com/azure/azure-sql/database/threat-detection-overview) ‚ú≥Ô∏è [Azure SQL Database](https://azure.microsoft.com/products/azure-sql/database/) ‚ú≥Ô∏è [Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/) ‚ú≥Ô∏è [Azure Database for MariaDB](https://azure.microsoft.com/services/mariadb/)‚ú≥Ô∏è [Azure Database for PostgreSQL](https://azure.microsoft.com/services/postgresql/) ‚ú≥Ô∏è [Azure Database for MySQL](https://azure.microsoft.com/services/mysql/) ‚ú≥Ô∏è [Azure Cache for Redis](https://azure.microsoft.com/services/cache/) ‚ú≥Ô∏è [Azure Managed Instance for Apache Cassandra](https://azure.microsoft.com/services/managed-instance-apache-cassandra/)<br> \r\n\r\n\r\n### References\r\nüí° [Types of Databases on Azure](https://azure.microsoft.com/product-categories/databases/)<br>\r\nüí° [SQL Advanced Threat Protection](https://docs.microsoft.com/azure/azure-sql/database/threat-detection-overview)<br>\r\nüí° [Monitoring SQL Server with Microsoft Sentinel](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/monitoring-sql-server-with-azure-sentinel/ba-p/1502960)<br>\r\nüí° [Auditing for Azure SQL Database and Azure Synapse Analytics](https://docs.microsoft.com/azure/azure-sql/database/auditing-overview)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) <br>\r\nüîÄ [SQL Databases](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Sql%2Fservers%2Fdatabases) <br>\r\nüîÄ [SQL Servers](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Sql%2Fservers) <br>\r\nüîÄ [SQL Managed Instances](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Sql%2FmanagedInstances) <br>\r\nüîÄ [Azure Cosmos DB](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.DocumentDb%2FdatabaseAccounts) <br>\r\nüîÄ [Azure Cache for Redis](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Cache%2FRedis) <br>\r\nüîÄ [Azure Database for MariaDB Servers](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.DBforMariaDB%2Fservers) <br>\r\nüîÄ [Azure Database for MySQL Servers](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.DBforMySQL%2Fservers) <br>\r\nüîÄ [Azure Managed Instance for Apache Cassandra](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.DocumentDB%2FcassandraClusters) <br>"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Database Level | ‚Ä¢ Addition of New Users, Especially Privileged Users ‚Ä¢ Query Being Executed ‚Ä¢ Query, Status (Response), and Traceback o Method o Comments or Variables o Multiple Embedded Queries o Database Alerts or Failures o Time to Execute Query ‚Ä¢ Attempts to Elevate Privileges (Success/Failure) ‚Ä¢ Changes to the Database Structure ‚Ä¢ Changes to User Roles or Database Permissions ‚Ä¢ Database Administrator Actions ‚Ä¢ Database Logons (Success/Failure) ‚Ä¢ Failed Logons ‚Ä¢ Use of Executable Commands ‚Ä¢ CLI Commands against the Data Base ‚Ä¢ Database Configuration and Version ‚Ä¢ Access to Sensitive Information within the Databases such as Keys, Passwords, Privacy Related Data  | Log, Database Query  | 1 | 12 Months Active Storage, 18 Months Cold Storage | 33 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SigninLogs\r\n| where AppDisplayName contains \"SQL\" or AppDisplayName contains \"database\" or AppDisplayName contains \"DB\"\r\n| project UserPrincipalName, AppDisplayName, ResultType, TimeGenerated",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Database Access (Azure Active Directory)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureActivity\r\n| where ResourceProvider == \"Microsoft SQL\"\r\n| project Caller, OperationName, ActivityStatus, Category, TimeGenerated",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Database Activity Logs (Azure Monitor)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 7",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId == \"Azure Security Benchmark\"\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where resourceType == \"databases\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Database Security Recommendations (Microsoft Defender for Cloud) ",
                    "noDataMessage": "No current recommendations in this area. Confirm the Azure Security Benchmark Assessment is enabled in Microsoft Defender for Cloud: Regulatory Compliance blade.",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationDisplayName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "State",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "ControlID",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Recommendation",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Recommendation >"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "Event\r\n| where Source has \"SQL\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Database Logging (Azure SQL, SQL, MSSQL, DBs)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SqlAtpStatus \r\n| sort by TimeGenerated desc\r\n| limit 250\r\n\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "SQL Advanced Threat Protection Logging (Azure SQL)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_15Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Database Level",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Web Applications](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AzureDiagnostics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azurediagnostics) ‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/) <br>\r\n\r\n### References\r\nüí° [Azure Web Application Firewall monitoring and logging](https://docs.microsoft.com/azure/web-application-firewall/afds/waf-front-door-monitor)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)  <br> \r\nüîÄ [Application Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks) <br> \r\n\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Application Level | Web Applications ‚Ä¢ URL ‚Ä¢ Headers ‚Ä¢ HTTP Methods - Request with Body of Data ‚Ä¢ HTTP Response with Body of DataWeb Application ‚Ä¢ Database Queries ‚Ä¢ Response Codes  | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 33-34 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let FakeData = (datatable (Message:string,ruleName_s:string,clientIp_s:string,clientIP_s:string,action_s:string,transactionId_s:string,site_s:string,details_message_sRole:string,details_file_sRole:string,hostname_sRole:string,Role:string,trackingReference_s:string,requestUri_s:string,ruleSetType_s:string,details_message_s:string,details_data_s:string,details_file_s:string,hostname_s:string,instanceId_s:string) [ \"\", \"\", \"\", \"\", \"\", \"\", \"\",\"\", \"\", \"\", \"\", \"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\" ]);\r\nFakeData | union AzureDiagnostics\r\n| where Category == \"FrontdoorWebApplicationFirewallLog\" or OperationName == \"ApplicationGatewayFirewall\" or Category == \"WebApplicationFirewallLogs\"\r\n| extend Rule = strcat(ruleName_s, Message), ClientIP = strcat(clientIp_s, clientIP_s)\r\n| extend Action = iif(action_s == \"Blocked\", Action = \"Block\", action_s)\r\n| extend Action = iif(Action == \"Detected\", Action = \"Log\", Action)\r\n| extend Role =  extract(\"ApplicationGateway([a-zA-Z_a-zA-Z_0-9]*)\",1,instanceId_s) \r\n| extend RequestUri = requestUri_s, RuleSetType = ruleSetType_s, Message_Details = details_message_s, Data_Details = details_data_s, File_Details = details_file_s, Hostname = hostname_s, Site = site_s\r\n| project Rule, TimeGenerated, SourceSystem, Hostname, ResourceId, ResourceGroup, ResourceProvider, Category, Role, Action, Site, Message_Details, File_Details, ClientIP, RequestUri\r\n| sort by TimeGenerated\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Application Logging (Azure Web Application Firewall)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_16Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Web Applications",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Web Application Crashes](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [Requests](https://docs.microsoft.com/azure/azure-monitor/reference/tables/apprequests)  ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/)<br> \r\n\r\n### References\r\nüí° [Enable diagnostics logging for apps in Azure App Service](https://docs.microsoft.com/azure/app-service/troubleshoot-diagnostic-logs)<br>\r\nüí° [App Service Integration with Azure Monitor](https://azure.github.io/AppService/2019/11/01/App-Service-Integration-with-Azure-Monitor.html)<br>\r\nüí° [Log Types for Azure Monitor Integration](https://azure.github.io/AppService/2020/06/25/New-Logs-Available-for-Azure-Monitor-Integration.html)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Application Services](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Azure.TestMarketPlaceRP%2FMarketPlaceResource) <br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview) <br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Application Level | Web Application Crashes ‚Ä¢ Processes ‚Ä¢ Applications | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 34 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "parameters": [
                      {
                        "id": "e94aafa3-c5d9-4523-89f0-4e87aa754511",
                        "version": "KqlParameterItem/1.0",
                        "name": "Apps",
                        "type": 5,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "where type =~ 'microsoft.insights/components'\n| project id",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "value": [
                          "value::all"
                        ],
                        "typeSettings": {
                          "resourceTypeFilter": {
                            "microsoft.insights/components": true
                          },
                          "additionalResourceOptions": [
                            "value::all"
                          ],
                          "showDefault": false
                        },
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources"
                      }
                    ],
                    "style": "pills",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources"
                  },
                  "name": "parameters - 1"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let apps = range i from 1 to 1 step 1\r\n| extend x = '{Apps:name}'\r\n| extend x = split(x, ', ')\r\n| mvexpand x to typeof(string) limit 100\r\n| project appName = x;\r\nrequests\r\n| summarize FailedRequests = countif(success == false), Count = count() by appName\r\n| join kind = inner (\r\n    requests\r\n    | make-series Trend = countif(success == false) default = 0 on timestamp from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain} by appName\r\n) on appName\r\n| project-away appName1, timestamp\r\n| join kind = fullouter (apps) on appName\r\n| extend appName = appName1, FailedRequests = iff(appName == '', 0, FailedRequests), Count = iff(appName == '', 0, Count), Trend = iff(appName == '', repeat(0, toint(({TimeRange:end} - {TimeRange:start}) / {TimeRange:grain})), Trend)\r\n| extend MetricKind = 'Failures'\r\n| order by FailedRequests desc\r\n",
                    "size": 3,
                    "showAnalytics": true,
                    "title": "Application Failures",
                    "noDataMessage": "The Application Insights resource you selected has no data.",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "crossComponentResources": [
                      "{Apps}"
                    ],
                    "visualization": "tiles",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ]
                    },
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "appName",
                        "formatter": 1,
                        "formatOptions": {
                          "showIcon": true
                        }
                      },
                      "subtitleContent": {
                        "columnMatch": "MetricKind",
                        "formatter": 1,
                        "formatOptions": {
                          "showIcon": true
                        }
                      },
                      "leftContent": {
                        "columnMatch": "FailedRequests",
                        "formatter": 12,
                        "formatOptions": {
                          "min": 0,
                          "palette": "red",
                          "showIcon": true
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Trend",
                        "formatter": 9,
                        "formatOptions": {
                          "palette": "red",
                          "showIcon": true
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let appCount = 5;\r\nlet requestCount = 5;\r\nlet selectedApps = range i from 1 to 1 step 1\r\n| extend x = '{Apps:name}'\r\n| extend x = split(x, ', ')\r\n| mvexpand x to typeof(string) limit 100\r\n| project appName = x;\r\nlet topItems = requests\r\n| top-nested appCount of appName by AppMetric = countif(success == false) desc, top-nested requestCount of name by RequestMetric = countif(success == false) desc;\r\nlet topApps = topItems | summarize by appName;\r\nlet topRequests = topItems | summarize by strcat(appName, '::', name);\r\nlet rawData = requests\r\n| extend name = iff(strcat(appName, '::', name) in (topRequests), name, 'Other Requests'), appName = iff(appName in (topApps), appName, 'Other Apps');\r\nlet apps = rawData\r\n| summarize FailedRequests = countif(success == false), AllRequests = count(), Users = dcount(user_Id) by appName\r\n| project Id = appName, ParentId = '', Name = strcat('‚òÅÔ∏è ', appName), Kind = 'Application', FailedRequests, AllRequests, Users\r\n| join kind = inner (\r\n    rawData\r\n    | make-series Trend = countif(success == false) default = 0 on timestamp from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain} by Id = appName\r\n) on Id\r\n| project-away Id1, timestamp\r\n| join kind = fullouter (selectedApps) on $left.Id == $right.appName\r\n| extend Id = appName, Name = strcat('‚òÅÔ∏è ', appName), Kind = 'Application', FailedRequests = iff(Id == '', 0, FailedRequests), AllRequests = iff(Id == '', 0, AllRequests), Users = iff(Id == '', 0, Users), Trend = iff(Id == '', repeat(0, toint(({TimeRange:end} - {TimeRange:start}) / {TimeRange:grain})), Trend);\r\nlet requests = rawData\r\n| summarize FailedRequests = countif(success == false), AllRequests = count(), Users = dcount(user_Id) by appName, name\r\n| project Id = strcat(appName, '::', name), ParentId = appName, Name = strcat('üåê ', name), Kind = 'Request', FailedRequests, AllRequests, Users\r\n| join kind = inner (\r\n    rawData\r\n    | make-series Trend = countif(success == false) default = 0 on timestamp from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain} by Id = strcat(appName, '::', name)\r\n) on Id\r\n| project-away Id1, timestamp;\r\nrequests\r\n| union (apps)\r\n| extend Rank = iff(Name contains 'Other Apps' or Name contains 'Other Requests', 2, 1)\r\n| order by Rank asc, FailedRequests desc\r\n| project Id, ParentId, Name, Kind, ['Failed Requests'] = FailedRequests, ['Failed Request Trend'] = Trend, ['All Requests'] = AllRequests, ['Success Rate'] = 1.0 * (AllRequests - FailedRequests) / AllRequests, Users",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Application Request Failures",
                    "noDataMessage": "The Application Insights resource you selected has no data.",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "exportParameterName": "Row",
                    "exportDefaultValue": "{}",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "crossComponentResources": [
                      "{Apps}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Id",
                          "formatter": 5,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "ParentId",
                          "formatter": 5,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Failed Requests",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "palette": "red",
                            "showIcon": true
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Failed Request Trend",
                          "formatter": 9,
                          "formatOptions": {
                            "min": 0,
                            "max": 1,
                            "palette": "greenRed",
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "All Requests",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blue",
                            "showIcon": true
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Success Rate",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "max": 1,
                            "palette": "green",
                            "showIcon": true
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "percent",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "Users",
                          "formatter": 0,
                          "formatOptions": {
                            "showIcon": true
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 1
                            }
                          }
                        }
                      ],
                      "filter": true,
                      "hierarchySettings": {
                        "idColumn": "Id",
                        "parentColumn": "ParentId",
                        "treeType": 0,
                        "expanderColumn": "Name",
                        "expandTopLevel": true
                      }
                    },
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "appName",
                        "formatter": 1,
                        "formatOptions": {
                          "showIcon": true
                        }
                      },
                      "subtitleContent": {
                        "columnMatch": "MetricKind",
                        "formatter": 1,
                        "formatOptions": {
                          "showIcon": true
                        }
                      },
                      "leftContent": {
                        "columnMatch": "FailedRequests",
                        "formatter": 12,
                        "formatOptions": {
                          "min": 0,
                          "palette": "red",
                          "showIcon": true
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Trend",
                        "formatter": 9,
                        "formatOptions": {
                          "palette": "red",
                          "showIcon": true
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_17Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Web Application Crashes",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Web Application & Middleware](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\n\r\n### References\r\nüí° [Web application monitoring on Azure](https://docs.microsoft.com/azure/architecture/reference-architectures/app-service-web-app/app-monitoring)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Application Services](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Azure.TestMarketPlaceRP%2FMarketPlaceResource) <br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Application Level | Web Applications & Middleware ‚Ä¢ Configuration ‚Ä¢ Version  | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 34 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type contains \"application\"\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Web Applications & Middleware (Select Asset for Configurations)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_18Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Web Application & Middleware",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Virtualization on System](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüí° [Download and install the MMA agent on virtual assets](https://docs.microsoft.com/azure/azure-monitor/agents/log-analytics-agent#installation-options)<br>\r\nüí° [Enable Azure Diagnostics Extension](https://docs.microsoft.com/azure/azure-monitor/agents/diagnostics-extension-overview)<br>\r\n\r\n### References\r\nüí° [What is Azure VMware Solution?](https://docs.microsoft.com/azure/azure-vmware/introduction)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Azure VMware Solution](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.AVS%2FprivateClouds) <br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview) <br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Virtualization on System | ‚Ä¢ User Authentication o Logon (Success and Failure) o Attempts to Obtain Privileged Access (Success and Failure) ‚Ä¢ User and Administrator/Root Access and Actions of Components and Applications o File and Object Access o Audit Log Access (Success and Failure) o System Access (Failure) ‚Ä¢ System Performance and Operational Characteristics o Resource Utilization, Process Status o System Events o Service Status Changes (e.g., Started, Stopped) ‚Ä¢ System Configuration o Changes to Security Configuration (Success/Failure) o Changes to Hypervisor o Changes to VMS o Changes Made within VMS o Audit Log Cleared ‚Ä¢ Creation and Deployment of VMS ‚Ä¢ Migration of VMS (e.g., Source and Target Systems, Time, Authorization) ‚Ä¢ Creation and Deletion of System-Level Objects | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 35 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "![Image Name](https://docs.microsoft.com/azure/azure-vmware/media/adjacency-overview-drawing-final.png) \r\nüí° [What is Azure VMware Solution?](https://docs.microsoft.com/azure/azure-vmware/introduction)<br>"
                  },
                  "customWidth": "50",
                  "name": "text - 2"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_19Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Virtualization on System",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Mobile (Smart Phones & Tablets) EMM (UEM) / MTD Agent Logs](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [IntuneAuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/intuneauditlogs) üî∑ [IntuneDevices](https://docs.microsoft.com/azure/azure-monitor/reference/tables/intunedevice) üî∑ [IntuneOperationalLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/intuneoperationallogs) üî∑ [IntuneDeviceComplianceOrg](https://docs.microsoft.com/azure/azure-monitor/reference/tables/intunedevicecomplianceorg) ‚ú≥Ô∏è [Microsoft Endpoint Manager](https://www.microsoft.com/security/business/microsoft-endpoint-manager)<br> \r\n\r\n### References\r\nüí° [Use audit logs to track and monitor events in Microsoft Intune](https://docs.microsoft.com/mem/intune/fundamentals/monitor-audit-logs)<br>\r\nüí° [Send log data to storage, event hubs, or log analytics in Intune](https://docs.microsoft.com/mem/intune/fundamentals/review-logs-using-azure-monitor)<br>\r\nüí° [Intune reports](https://docs.microsoft.com/mem/intune/fundamentals/reports)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/) <br>\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Mobile (Smart-phones and Tablets) EMM (UEM) / MTD Server Logs | EMM (UEM)/MTD Alerts ‚Ä¢ Date and Time ‚Ä¢ Alert Type ‚Ä¢ Failure of Cryptographic Protocols ‚Ä¢ Failure of Device Cryptographic Capabilities (e.g., Trusted Boot Process)‚Ä¢ Certificate Validation Failure (Defined in MDM Server Protection Profile) ‚Ä¢ Alerts from Agent to Server Defined MDM Agent Protection Profile. General: ‚Ä¢ Date and Time Device Data ‚Ä¢ Device Name ‚Ä¢ Device Manufacturer and Model ‚Ä¢ Serial # ‚Ä¢ Phone # ‚Ä¢ IMEI, IMSI, OS Version, OS Build ‚Ä¢ Firmware Version ‚Ä¢ Device IP Address, Device Root/Jailbreak Status and Reasons ‚Ä¢ Developer Mode Enabled ‚Ä¢ Battery/Power Information ‚Ä¢ Hardware Info (Processor, Memory, Storage) ‚Ä¢Last Time Device Synched with Enterprise Application Data ‚Ä¢ Application Manifest (Installed Apps, App Version, Version History and Installation Timestamps), Installation and Data Storage Location ‚Ä¢ Application Permissions ‚Ä¢ Application Hash (e.g., SHA\u0002256) ‚Ä¢ Running Apps and Processes Device Policy Settings ‚Ä¢ Enrollment Policies ‚Ä¢ Policies Successfully/Unsuccessfully Applied ‚Ä¢Authentication Policies (Password/Pin/Biometric, etc.) Device Configuration ‚Ä¢ Certificates end Related Information (Validity Period, Revocation, etc.) ‚Ä¢ Device Encryption Configuration ‚Ä¢ Android Enterprise Settings ‚Ä¢ System Integrity Status Network Configuration ‚Ä¢ Allowed/Disallowed Networks ‚Ä¢ Currently Connected Network ‚Ä¢ Proxy/Tunnel and Per-App VPN Info ‚Ä¢ Telephony Info (Some of This Is Covered by Carrier Data) ‚Ä¢ Captive Portals ‚Ä¢ Wi-Fi SSID ‚Ä¢ Network MAC Address ‚Ä¢ Bluetooth Event / Audit / Crash Logs ‚Ä¢ Event Type and ID ‚Ä¢ Event Date/Timestamp ‚Ä¢ Success/Failure of Various Services ‚Ä¢ User Authentication (Success/Failure) ‚Ä¢ Event Actor and ID (e.g., Admin, System, Device) ‚Ä¢ Event Change Type (CRUD) MTD Agent Info ‚Ä¢ Agent Activation Status ‚Ä¢ Threat Detection of Variety of Vulns ‚Ä¢ Phishing Protection Status ‚Ä¢ Tampering of Agent, App, or System ‚Ä¢ Privilege Escalation ‚Ä¢ MITM Activities ‚Ä¢ Remediation Actions Taken ‚Ä¢ Last Time Device Synched with Enterprise | Log | 1 | 12 Months Active Storage, 18 Months Cold Storage | 36-38 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneDevices\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "EMM/MTD Devices (Intune/Microsoft Endpoint Manager)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneAuditLogs \r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "EMM/MTD Audit Logs (Intune/Microsoft Endpoint Manager)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneOperationalLogs \r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "EMM/MTD Operational Logs (Intune/Microsoft Endpoint Manager)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "IntuneDeviceComplianceOrg \r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "EMM/MTD Device Compliance Logs (Intune/Microsoft Endpoint Manager)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_21Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Mobile (Smart Phones & Tablets) EMM (UEM) / MTD Agent Logs",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Container Supply Chain](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [ContainerInventory](https://docs.microsoft.com/azure/azure-monitor/reference/tables/containerinventory) üî∑ [AzureDiagnostics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azurediagnostics) ‚ú≥Ô∏è [Azure Kubernetes Service (AKS)](https://azure.microsoft.com/services/kubernetes-service/) <br> \r\nüî∑ [ContainerInstanceLog_CL](https://docs.microsoft.com/azure/container-instances/container-instances-log-analytics#containerinstancelog_cl) üî∑ [ContainerEvent_CL](https://docs.microsoft.com/azure/container-instances/container-instances-log-analytics#containerevent_cl)  ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\n\r\n### References\r\nüí° [Retrieve container logs and events in Azure Container Instances](https://docs.microsoft.com/azure/container-instances/container-instances-get-logs)<br>\r\nüí° [Monitor container resources in Azure Container Instances](https://docs.microsoft.com/azure/container-instances/container-instances-monitor)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Kubernetes Services](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.ContainerService%2FmanagedClusters) <br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Container Supply Chain | ‚Ä¢ Log Container Image Sources ‚Ä¢ Log Changes / Deltas Between Image Source Versions ‚Ä¢ Log Vulnerability Scan of Container Images, even if No Vulnerabilities Are Discovered ‚Ä¢ Log Where Containers Are Deployed and Which System They Support | Script, Manual Log Entry | 1 | 12 Months Active Storage, 18 Months Cold Storage | 38 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type contains \"container\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Container Assets (Azure Resource Graph)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityRecommendation\r\n| where RecommendationName contains \"container\" or RecommendationName contains \"kubernetes\" or RecommendationName contains \"pod\"\r\n| where RecommendationState == \"Unhealthy\"\r\n| summarize count() by RecommendationName\r\n| sort by count_ desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Container Recommendations (Microsoft Defender for Cloud)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "redBright"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 7 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureDiagnostics\r\n| where Category == \"kube-audit\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Container Logging (Azure Diagnostics)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "filter": true
                    }
                  },
                  "name": "query - 7"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ContainerInstanceLog_CL\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Container Instance Logging (Azure Monitor)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ContainerEvent_CL\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Container Event Logging (Azure Monitor)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ContainerInventory\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Container Inventory (Azure Kubernetes Service)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "KubeEvents\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Kubernetes Events (Azure Kubernetes Service)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 7",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL1_22Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Container Supply Chain",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEL1Visible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Basic Event Logging (EL1)"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Intermediate Log Event Management (EL2)\r\n---\r\nLogging requiremetns of highest and intermediate criticality are met. The agency and all of its components meet the following requirements, as detailed in Table 3 (EL2 Intermediate Requirements) within Appendix A (Implementation and Centralized Access Requirements). For more information, see üí°[Improving the Federal Government‚Äôs Investigative and Remediation Capabilities Related to Cybersecurity Incidents (M-21-31)](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n    ‚Ä¢ Meeting EL1 maturity level \r\n    ‚Ä¢ Intermediate Logging Categories \r\n    ‚Ä¢ Publication of Standardized Log Structure \r\n    ‚Ä¢ Inspection of Encrypted Data \r\n    ‚Ä¢ Intermediate Centralized Access  "
            },
            "customWidth": "45",
            "name": "EL2 Guide"
          },
          {
            "type": 1,
            "content": {
              "json": ""
            },
            "customWidth": "5",
            "name": "text - 10"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "{\"version\":\"1.0.0\",\"content\":\"\\t[\\r\\n\\t\\t{ \\\"Section\\\": \\\"System Status\\\", \\\"tab\\\": \\\"EL2_1\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Raw & Metadata - Filtering Events\\\", \\\"tab\\\": \\\"EL2_2\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Data Loss Prevention\\\", \\\"tab\\\": \\\"EL2_3\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Full Packet Capture Data\\\", \\\"tab\\\": \\\"EL2_4\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"COTS, Non-COTS, & Custom Applications\\\", \\\"tab\\\": \\\"EL2_5\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Container - Image, Mgmt, Orchestration, OS\\\", \\\"tab\\\": \\\"EL2_7\\\" }\\r\\n\\t]\",\"transformers\":null}",
              "size": 3,
              "title": "EL2 Requirements",
              "exportMultipleValues": true,
              "exportedParameters": [
                {
                  "fieldName": "tab",
                  "parameterName": "Tab",
                  "parameterType": 1
                }
              ],
              "queryType": 8,
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Section",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  },
                  {
                    "columnMatch": "tab",
                    "formatter": 5
                  }
                ],
                "filter": true
              }
            },
            "customWidth": "35",
            "name": "Event Logging Tiers"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "a30d01d0-38f1-4a91-9cf6-cdb181d676b5",
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL2_1Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL2_1",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  }
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL2_2Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL2_2",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "bda0d4ae-745f-4f78-8188-712e9b6dd932"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL2_3Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL2_3",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "80aed847-ac84-45b5-b278-a4f0bbf08bc5"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL2_4Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL2_4",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "c46bd38b-aaae-4eaf-b04f-19e14d17ee5a"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL2_5Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL2_5",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "20c550f4-d9aa-49d0-b6ed-6b5d9b86522e"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL2_7Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL2_7",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "fe680c5e-18a3-455c-8c23-cbcc31c78bb3"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "1",
            "name": "Hidden Parameters"
          },
          {
            "type": 1,
            "content": {
              "json": "## EL2 Controls Mapping\r\n| <strong> Event Logging Requirements </strong> | <strong> Microsoft Controls </strong> | \r\n|:--|:--|\r\n| System Status | ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) |\r\n| Raw & Metadata - Filtering Events | ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender) |\r\n| Data Loss Prevention | ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/) ‚ú≥Ô∏è [Microsoft Information Protection](https://www.microsoft.com/security/business/compliance/information-protection) |\r\n| Full Packet Capture Data | ‚ú≥Ô∏è [Network Watcher](https://azure.microsoft.com/services/network-watcher/) ‚ú≥Ô∏è [Virtual Network](https://azure.microsoft.com/services/virtual-network/) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) |\r\n| Commercial Off the Shelf (COTS), Non-COTS, Custom Applications |‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Azure Web Application Firewall](https://azure.microsoft.com/services/web-application-firewall/) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/) ‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security) ‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender) |\r\n| Container - Image, Management, Orchestration, OS | ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Azure Kubernetes Service (AKS)](https://azure.microsoft.com/services/kubernetes-service/)|"
            },
            "conditionalVisibility": {
              "parameterName": "Help",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "EL2 Guide"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [System Status](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [InsightsMetrics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/insightsmetrics) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br> \r\n\r\n### References\r\nüí° [Tutorial: Enable monitoring for Azure virtual machine](https://docs.microsoft.com/azure/azure-monitor/vm/tutorial-monitor-vm-enable)<br>\r\nüí° [Azure Monitor Network Insights](https://docs.microsoft.com/azure/azure-monitor/insights/network-insights-overview)<br>\r\nüí° [Application Insights standard metrics](https://docs.microsoft.com/azure/azure-monitor/app/standard-metrics)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview) <br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| System & Configuration Performance | System Status ‚Äì Resource Utilization, Performance | Log, Database Record, Script | 2 | 12 Months Active Storage, 18 Months Cold Storage | 38-39 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let cpuSummary=totable(InsightsMetrics\r\n    | where TimeGenerated > ago(7d) \r\n    | where (Namespace == 'Processor' and Name == 'UtilizationPercentage')\r\n    | summarize hint.shufflekey=Computer P95th = round(percentile(Val, 95), 2) by Computer, Name\r\n    | top 10 by P95th desc);\r\nlet computerList=(cpuSummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer: string, NodeId: string, NodeProps: dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer\r\n    | extend ResourceId=strcat('machines/', Machine)\r\n    | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated > ago(7d)\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend\r\n        AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|', AzureCloudServiceDeployment), ''),\r\n        AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName), strcat(AzureVmScaleSetInstanceId, '|', AzureVmScaleSetDeployment), ''),\r\n        ComputerProps =              pack('type', 'StandAloneNode', 'name', Computer, 'mappingResourceId', ResourceId, 'subscriptionId', AzureSubscriptionId, 'resourceGroup', AzureResourceGroup, 'azureResourceId', columnifexists('_ResourceId', '')),\r\n        AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode', 'cloudServiceInstanceId', AzureCloudServiceInstanceId, 'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''), 'cloudServiceDeploymentId', AzureCloudServiceDeployment, 'cloudServiceName', AzureCloudServiceName, 'mappingResourceId', ResourceId),\r\n        AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode', 'scaleSetInstanceId', columnifexists('Computer', ''), 'vmScaleSetDeploymentId', AzureVmScaleSetDeployment, 'vmScaleSetName', AzureVmScaleSetName, 'serviceFabricClusterName', AzureServiceFabricClusterName, 'vmScaleSetResourceId', AzureVmScaleSetResourceId, 'resourceGroupName', columnifexists('AzureResourceGroup', ''), 'subscriptionId', columnifexists('AzureSubscriptionId', ''), 'mappingResourceId', ResourceId)\r\n    | project\r\n        Computer,\r\n        NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity, isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),\r\n        NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps, isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),\r\n        Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true\r\n        EmptyNodeIdentityAndProps,\r\n        OmsNodeIdentityAndProps,\r\n        ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n        ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n        ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n| where TimeGenerated > ago(7d)\r\n| where (Namespace == 'Processor' and Name == 'UtilizationPercentage')\r\n| where Computer in (computerList)\r\n| join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n| summarize P95th = round(percentile(Val, 95), 2) by bin(TimeGenerated, (now() - ago(7d)) / 100), ResourceName",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "CPU Utilization % (Last Week)",
                    "noDataMessage": "There is no data for this counter, either enable the counter or onboard machines to this workspace",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "linechart",
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "Computer",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "value",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    },
                    "chartSettings": {
                      "ySettings": {
                        "unit": 1,
                        "min": 0,
                        "max": 100
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let memorySummary=totable(InsightsMetrics\r\n| where TimeGenerated > ago(7d) \r\n| where Namespace == 'Memory' and Name == 'AvailableMB'\r\n| summarize hint.shufflekey=Computer P5th = round(percentile(Val, 5), 2) by Computer, Name\r\n| top 10 by P5th asc);\r\nlet computerList=(memorySummary \r\n| project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer:string, NodeId:string, NodeProps:dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n| extend NodeId = Computer\r\n| extend Priority = 1\r\n| extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer | extend ResourceId=strcat('machines/', Machine) | extend Bitness=columnifexists('Bitness', '')\r\n| where TimeGenerated > ago(7d)\r\n| where Computer in (computerList)\r\n| summarize arg_max(TimeGenerated, *) by Computer\r\n| extend AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|',                     AzureCloudServiceDeployment), ''),          AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName),              strcat(AzureVmScaleSetInstanceId, '|',                     AzureVmScaleSetDeployment), ''),          ComputerProps =              pack('type', 'StandAloneNode',                   'name', Computer,                   'mappingResourceId', ResourceId,                   'subscriptionId', AzureSubscriptionId,                   'resourceGroup', AzureResourceGroup,                   'azureResourceId', columnifexists('_ResourceId', '')),          AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode',                   'cloudServiceInstanceId', AzureCloudServiceInstanceId,                   'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''),                   'cloudServiceDeploymentId', AzureCloudServiceDeployment,                   'cloudServiceName', AzureCloudServiceName,                   'mappingResourceId', ResourceId),          AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode',                   'scaleSetInstanceId', columnifexists('Computer', ''),                   'vmScaleSetDeploymentId', AzureVmScaleSetDeployment,                   'vmScaleSetName', AzureVmScaleSetName,                   'serviceFabricClusterName', AzureServiceFabricClusterName,                   'vmScaleSetResourceId', AzureVmScaleSetResourceId,                   'resourceGroupName', columnifexists('AzureResourceGroup', ''),                   'subscriptionId', columnifexists('AzureSubscriptionId', ''),                   'mappingResourceId', ResourceId)| project   Computer,            NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity,                       isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),            NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps,                          isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),            Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true                                  EmptyNodeIdentityAndProps, OmsNodeIdentityAndProps, ServiceMapNodeIdentityAndProps                            \r\n| summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n| extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n    ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n    ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n| project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n| where TimeGenerated > ago(7d)\r\n| where Namespace == 'Memory' and Name == 'AvailableMB'\r\n| where Computer in (computerList)\r\n| join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n| summarize P5th = round(percentile(Val, 5), 2) by bin(TimeGenerated, (now() - ago(7d))/100), ResourceName",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Available Memory (Last Week)",
                    "noDataMessage": "There is no data for this counter, either enable the counter or onboard machines to this workspace",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 4,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let memorySummary=totable(InsightsMetrics\r\n    | where TimeGenerated > ago(7d) \r\n    | where Namespace == 'Network' and Name == 'WriteBytesPerSecond'\r\n    | summarize hint.shufflekey=Computer P95th = round(percentile(Val, 95), 2) by Computer, Name\r\n    | top 10 by P95th desc);\r\nlet computerList=(memorySummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer: string, NodeId: string, NodeProps: dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer\r\n    | extend ResourceId=strcat('machines/', Machine)\r\n    | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated > ago(7d)\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend\r\n        AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|', AzureCloudServiceDeployment), ''),\r\n        AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName), strcat(AzureVmScaleSetInstanceId, '|', AzureVmScaleSetDeployment), ''),\r\n        ComputerProps =              pack('type', 'StandAloneNode', 'name', Computer, 'mappingResourceId', ResourceId, 'subscriptionId', AzureSubscriptionId, 'resourceGroup', AzureResourceGroup, 'azureResourceId', columnifexists('_ResourceId', '')),\r\n        AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode', 'cloudServiceInstanceId', AzureCloudServiceInstanceId, 'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''), 'cloudServiceDeploymentId', AzureCloudServiceDeployment, 'cloudServiceName', AzureCloudServiceName, 'mappingResourceId', ResourceId),\r\n        AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode', 'scaleSetInstanceId', columnifexists('Computer', ''), 'vmScaleSetDeploymentId', AzureVmScaleSetDeployment, 'vmScaleSetName', AzureVmScaleSetName, 'serviceFabricClusterName', AzureServiceFabricClusterName, 'vmScaleSetResourceId', AzureVmScaleSetResourceId, 'resourceGroupName', columnifexists('AzureResourceGroup', ''), 'subscriptionId', columnifexists('AzureSubscriptionId', ''), 'mappingResourceId', ResourceId)\r\n    | project\r\n        Computer,\r\n        NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity, isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),\r\n        NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps, isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),\r\n        Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true\r\n        EmptyNodeIdentityAndProps,\r\n        OmsNodeIdentityAndProps,\r\n        ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n        ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n        ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n| where TimeGenerated > ago(7d)\r\n| where Namespace == 'Network' and Name == 'WriteBytesPerSecond'\r\n| where Computer in (computerList)\r\n| join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n| summarize P95th = round(percentile(Val, 95), 2) by bin(TimeGenerated, (now() - ago(7d)) / 100), ResourceName",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Bytes Sent Rate (Last Week)",
                    "noDataMessage": "There is no data for this counter, either enable the counter or onboard machines to this workspace",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 2,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 6"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let memorySummary=totable(InsightsMetrics\r\n    | where TimeGenerated > ago(7d) \r\n    | where Namespace == 'Network' and Name == 'WriteBytesPerSecond'\r\n    | summarize hint.shufflekey=Computer P95th = round(percentile(Val, 95), 2) by Computer, Name\r\n    | top 10 by P95th desc);\r\nlet computerList=(memorySummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer: string, NodeId: string, NodeProps: dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer\r\n    | extend ResourceId=strcat('machines/', Machine)\r\n    | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated > ago(7d)\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend\r\n        AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|', AzureCloudServiceDeployment), ''),\r\n        AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName), strcat(AzureVmScaleSetInstanceId, '|', AzureVmScaleSetDeployment), ''),\r\n        ComputerProps =              pack('type', 'StandAloneNode', 'name', Computer, 'mappingResourceId', ResourceId, 'subscriptionId', AzureSubscriptionId, 'resourceGroup', AzureResourceGroup, 'azureResourceId', columnifexists('_ResourceId', '')),\r\n        AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode', 'cloudServiceInstanceId', AzureCloudServiceInstanceId, 'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''), 'cloudServiceDeploymentId', AzureCloudServiceDeployment, 'cloudServiceName', AzureCloudServiceName, 'mappingResourceId', ResourceId),\r\n        AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode', 'scaleSetInstanceId', columnifexists('Computer', ''), 'vmScaleSetDeploymentId', AzureVmScaleSetDeployment, 'vmScaleSetName', AzureVmScaleSetName, 'serviceFabricClusterName', AzureServiceFabricClusterName, 'vmScaleSetResourceId', AzureVmScaleSetResourceId, 'resourceGroupName', columnifexists('AzureResourceGroup', ''), 'subscriptionId', columnifexists('AzureSubscriptionId', ''), 'mappingResourceId', ResourceId)\r\n    | project\r\n        Computer,\r\n        NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity, isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),\r\n        NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps, isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),\r\n        Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true\r\n        EmptyNodeIdentityAndProps,\r\n        OmsNodeIdentityAndProps,\r\n        ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n        ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n        ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n| where TimeGenerated > ago(7d)\r\n| where Namespace == 'Network' and Name == 'WriteBytesPerSecond'\r\n| where Computer in (computerList)\r\n| join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n| summarize P95th = round(percentile(Val, 95), 2) by bin(TimeGenerated, (now() - ago(7d)) / 100), ResourceName",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Bytes Recieved Rate (Last Week)",
                    "noDataMessage": "There is no data for this counter, either enable the counter or onboard machines to this workspace",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 2,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 6"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let memorySummary=totable(InsightsMetrics\r\n    | where TimeGenerated > ago(7d) \r\n    | where Namespace == 'LogicalDisk' and Name == 'FreeSpacePercentage'\r\n    | extend Val = 100 - Val\r\n    | summarize hint.shufflekey=Computer P95th = round(percentile(Val, 95), 2) by Computer, Name\r\n    | top 10 by P95th desc);\r\nlet computerList=(memorySummary \r\n    | project Computer);\r\nlet EmptyNodeIdentityAndProps = datatable(Computer: string, NodeId: string, NodeProps: dynamic, Priority: long) [];\r\nlet OmsNodeIdentityAndProps = computerList\r\n    | extend NodeId = Computer\r\n    | extend Priority = 1\r\n    | extend NodeProps = pack('type', 'StandAloneNode', 'name', Computer);\r\nlet ServiceMapNodeIdentityAndProps = VMComputer\r\n    | extend ResourceId=strcat('machines/', Machine)\r\n    | extend Bitness=columnifexists('Bitness', '')\r\n    | where TimeGenerated > ago(7d)\r\n    | where Computer in (computerList)\r\n    | summarize arg_max(TimeGenerated, *) by Computer\r\n    | extend\r\n        AzureCloudServiceNodeIdentity = iif(isnotempty(AzureCloudServiceName), strcat(AzureCloudServiceInstanceId, '|', AzureCloudServiceDeployment), ''),\r\n        AzureScaleSetNodeIdentity = iif(isnotempty(AzureVmScaleSetName), strcat(AzureVmScaleSetInstanceId, '|', AzureVmScaleSetDeployment), ''),\r\n        ComputerProps =              pack('type', 'StandAloneNode', 'name', Computer, 'mappingResourceId', ResourceId, 'subscriptionId', AzureSubscriptionId, 'resourceGroup', AzureResourceGroup, 'azureResourceId', columnifexists('_ResourceId', '')),\r\n        AzureCloudServiceNodeProps =              pack('type', 'AzureCloudServiceNode', 'cloudServiceInstanceId', AzureCloudServiceInstanceId, 'cloudServiceRoleName', columnifexists('AzureCloudServiceRoleName', ''), 'cloudServiceDeploymentId', AzureCloudServiceDeployment, 'cloudServiceName', AzureCloudServiceName, 'mappingResourceId', ResourceId),\r\n        AzureScaleSetNodeProps =               pack('type', 'AzureScaleSetNode', 'scaleSetInstanceId', columnifexists('Computer', ''), 'vmScaleSetDeploymentId', AzureVmScaleSetDeployment, 'vmScaleSetName', AzureVmScaleSetName, 'serviceFabricClusterName', AzureServiceFabricClusterName, 'vmScaleSetResourceId', AzureVmScaleSetResourceId, 'resourceGroupName', columnifexists('AzureResourceGroup', ''), 'subscriptionId', columnifexists('AzureSubscriptionId', ''), 'mappingResourceId', ResourceId)\r\n    | project\r\n        Computer,\r\n        NodeId = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeIdentity, isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeIdentity, Computer),\r\n        NodeProps = case(isnotempty(AzureCloudServiceNodeIdentity), AzureCloudServiceNodeProps, isnotempty(AzureScaleSetNodeIdentity), AzureScaleSetNodeProps, ComputerProps),\r\n        Priority = 2;\r\nlet NodeIdentityAndProps = union kind=inner isfuzzy = true\r\n        EmptyNodeIdentityAndProps,\r\n        OmsNodeIdentityAndProps,\r\n        ServiceMapNodeIdentityAndProps                            \r\n    | summarize arg_max(Priority, *) by Computer; \r\nlet NodeIdentityAndPropsMin = NodeIdentityAndProps\r\n    | extend Kind = iff(NodeProps.type == \"StandAloneNode\", iff(NodeProps.azureResourceId == \"\", \"Non-Azure Virtual Machine\", \"Azure Virtual Machine\"), NodeProps.type), \r\n        ResourceId = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.vmScaleSetResourceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceDeploymentId, Computer)),\r\n        ResourceName = iff(NodeProps.type == \"AzureScaleSetNode\", NodeProps.scaleSetInstanceId, \r\n        iff(NodeProps.type == \"AzureCloudServiceNode\", NodeProps.cloudServiceInstanceId, Computer))\r\n    | project Computer, Kind, ResourceId, ResourceName;\r\nInsightsMetrics\r\n| where TimeGenerated > ago(7d)\r\n| where Namespace == 'LogicalDisk' and Name == 'FreeSpacePercentage'\r\n| extend Val = 100 - Val\r\n| where Computer in (computerList)\r\n| join kind=leftouter (NodeIdentityAndPropsMin) on Computer\r\n| summarize P95th = round(percentile(Val, 95), 2) by bin(TimeGenerated, (now() - ago(7d)) / 100), ResourceName",
                    "size": 0,
                    "aggregation": 3,
                    "showAnnotations": true,
                    "showAnalytics": true,
                    "title": "Logical Disk Space Used % (Last Week)",
                    "noDataMessage": "There is no data for this counter, either enable the counter or onboard machines to this workspace",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "linechart",
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "Computer",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "value",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    },
                    "chartSettings": {
                      "ySettings": {
                        "unit": 1,
                        "min": 0,
                        "max": 100
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 28"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL2_1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "System Status",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Raw & Metadata - Filtering Events](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [EmailEvents](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) üî∑ [EmailAttachmentInfo](https://docs.microsoft.com/azure/azure-monitor/reference/tables/emailattachmentinfo) üî∑ [EmailUrlInfo](https://docs.microsoft.com/azure/azure-monitor/reference/tables/emailurlinfo) üî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)<br>  \r\n\r\n### References\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Email Filtering, Spam, and Phishing | Raw and Metadata - Filtering Events ‚Ä¢ Date and Time ‚Ä¢ Sent from Sender, from Sender ‚Ä¢ Recipient ‚Ä¢ Subject ‚Ä¢ Email Headers ‚Ä¢ Rule Triggered ‚Äì Log of Policies along with Actual Values Including but Not Limited to: o DNS Records o Phish Campaign Identifier o Domain URL | Log, Email Attachments | 2 | 12 Months Active Storage, 18 Months Cold Storage | 39 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "EmailEvents\r\n| join kind=leftanti(EmailAttachmentInfo) on NetworkMessageId\r\n| join kind=leftanti(EmailUrlInfo) on NetworkMessageId\r\n| project TimeGenerated, SenderMailFromAddress, RecipientEmailAddress, EmailDirection, Subject, NetworkMessageId, DeliveryAction, EmailActionPolicy, OrgLevelPolicy, ConfidenceLevel, ThreatTypes\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Email: Raw & Metadata Filtering Events (Microsoft Defender for Office365)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityAlert\r\n| where ProviderName == \"OATP\"\r\n| summarize count() by AlertName\r\n| sort by count_ desc\r\n| limit 250\r\n\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Email Security Alerts (Microsoft Defender for Office 365)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "OfficeActivity\r\n| where OfficeWorkload == \"Exchange\"\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Exchange Logs (Microsoft Defender for Office365)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL2_2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Raw & Metadata - Filtering Events",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Data Loss Prevention](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [InformationProtectionLogs_CL](https://docs.microsoft.com/azure/information-protection/audit-logs) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)<br>\r\n\r\n### References\r\nüí° [Logging and analyzing the protection usage from Azure Information Protection](https://docs.microsoft.com/azure/information-protection/log-analyze-usage)<br>\r\nüí° [Analytics and central reporting for Azure Information Protection](https://docs.microsoft.com/azure/information-protection/reports-aip#how-to-modify-the-reports-and-create-custom-queries)<br>\r\nüí° [Azure Information Protection Connector](https://docs.microsoft.com/azure/sentinel/data-connectors-reference#azure-information-protection)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade) <br>\r\nüîÄ [Microsoft Information Protection](https://compliance.microsoft.com/informationprotection?viewid=sensitivitylabels) <br> \r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Data Loss Prevention | ‚Ä¢ Date and Time ‚Ä¢ Source Hostname o IP o Port ‚Ä¢ Destination Hostname o IPo Port ‚Ä¢ Description of Malicious Code or Action and Severity ‚Ä¢ Identity or Identifier of the File(s) ‚Ä¢ Description of the Action Taken (Clean, Quarantine, Delete) ‚Ä¢ Signature Updates | Log, Email Attachments | 2 | 12 Months Active Storage, 18 Months Cold Storage | 39 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "InformationProtectionLogs_CL\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Data Loss Prevention Logs (Azure Information Protection)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL2_3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Data Loss Prevention",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Full Packet Capture Data](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### References\r\nüí° [Virtual network TAP](https://docs.microsoft.com/azure/virtual-network/virtual-network-tap-overview)<br>\r\nüí° [Virtual network TAP partner solutions](https://docs.microsoft.com/azure/virtual-network/virtual-network-tap-overview#virtual-network-tap-partner-solutions)<br>\r\nüí° [Manage packet captures with Azure Network Watcher using the portal](https://docs.microsoft.com/azure/network-watcher/network-watcher-packet-capture-manage-portal)<br>\r\nüí° [Use packet capture for proactive network monitoring with alerts and Azure Functions](https://docs.microsoft.com/azure/network-watcher/network-watcher-alert-triggered-packet-capture)<br>\r\nüí° [Traffic Analytics](https://docs.microsoft.com/azure/networking/network-monitoring-overview#traffic-analytics)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Network Watcher](https://portal.azure.com/#blade/Microsoft_Azure_Network/NetworkWatcherMenuBlade/overview) <br>\r\nüîÄ [Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks) <br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview) <br>"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Network Traffic | Full Packet Capture Data ‚Ä¢ Decrypted Plaintext ‚Ä¢ Cleartext | Log, Email Attachments | 2 | 72 Hours Packet Capture | 39 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "![Image Name](https://docs.microsoft.com/azure/virtual-network/media/virtual-network-tap/architecture.png) "
                  },
                  "name": "text - 2"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL2_4Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Full Packet Capture Data",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Commercial Off the Shelf (COTS), Non-COTS, & Custom Applications](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [SigninLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/signinlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br>  üî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityrecommendation) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)<br>  üî∑ [CloudAppEvents](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-cloudappevents-table) ‚ú≥Ô∏è [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)  <br> \r\nüî∑ [resources](https://docs.microsoft.com/azure/azure-monitor/app/app-insights-overview) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/)<br> \r\nüî∑ [AzureDiagnostics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azurediagnostics)  ‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/) <br>\r\n\r\n### References\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\nüí° [Implement security recommendations in Microsoft Defender for Cloud](https://docs.microsoft.com/azure/defender-for-cloud/implement-security-recommendations)<br>\r\nüí° [What is Application Insights?](https://docs.microsoft.com/azure/azure-monitor/app/app-insights-overview)<br>\r\nüí° [Resource logs for Azure Web Application Firewall](https://docs.microsoft.com/azure/web-application-firewall/ag/web-application-firewall-logs)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Azure Active Directory](https://portal.azure.com#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) <br>\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\nüîÄ [Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\nüîÄ [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies) <br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Application Level | ‚Ä¢ Commercial Off the Shelf (COTS) and Custom Applications ‚Ä¢ User Authentication (Success/Failure) ‚Ä¢ User and Administrator Application Use: o File and Object Access o Audit Log Access (Success/Failure) o System Access (Failure) o Application Transactions (Web Page Hits, Email Sent/Received, File Transfers Completed) ‚Ä¢ Transaction Logs ‚Ä¢ System Performance and Operational Characteristics o Resource Utilization o Process Status o Errors (Input Validation, Disallowed Operations) o System Events o Service Status Changes (e.g., Started, Stopped) ‚Ä¢ Application Configuration and Version | Log, Application Monitoring Dashboards | 2 | 12 Months Active Storage, 18 Months Cold Data Storage | 40-41 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "parameters": [
                      {
                        "id": "e94aafa3-c5d9-4523-89f0-4e87aa754511",
                        "version": "KqlParameterItem/1.0",
                        "name": "Apps",
                        "type": 5,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "where type =~ 'microsoft.insights/components'\n| project id",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "value": [
                          "value::5"
                        ],
                        "typeSettings": {
                          "resourceTypeFilter": {
                            "microsoft.insights/components": true
                          },
                          "limitSelectTo": 5,
                          "additionalResourceOptions": [
                            "value::5"
                          ],
                          "showDefault": false
                        },
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources"
                      },
                      {
                        "id": "9fb8e529-2818-4000-bdf0-48808de48eb7",
                        "version": "KqlParameterItem/1.0",
                        "name": "Metric",
                        "type": 2,
                        "isRequired": true,
                        "value": "percentile(duration, 99)",
                        "typeSettings": {
                          "additionalResourceOptions": []
                        },
                        "jsonData": "[\r\n    { \"value\":\"avg(duration)\", \"label\":\"Mean\", \"selected\":true},\r\n    { \"value\":\"percentile(duration, 50)\", \"label\":\"Median\", \"selected\":false},\r\n    { \"value\":\"percentile(duration, 80)\", \"label\":\"p80\", \"selected\":false},\r\n    { \"value\":\"percentile(duration, 95)\", \"label\":\"p95\", \"selected\":false},\r\n    { \"value\":\"percentile(duration, 99)\", \"label\":\"p99\", \"selected\":false}\r\n]"
                      }
                    ],
                    "style": "pills",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources"
                  },
                  "name": "parameters - 1"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SigninLogs\r\n| project AppDisplayName, UserPrincipalName, Category, ResultType, ResultDescription, TimeGenerated\r\n| limit 250\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Application Authentications (Azure Active Directory)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "CloudAppEvents \r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Application Events (Microsoft 365 Defender)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where RecommendationDisplayName contains \"application\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Application Configuration Recommendations (Microsoft Defender for Cloud)",
                    "noDataMessage": "No current recommendations in this area",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationDisplayName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "State",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "ControlID",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Recommendation",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Recommendation >"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 12"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let FakeData = (datatable (Message:string,ruleName_s:string,clientIp_s:string,clientIP_s:string,action_s:string,transactionId_s:string,site_s:string,details_message_sRole:string,details_file_sRole:string,hostname_sRole:string,Role:string,trackingReference_s:string,requestUri_s:string,ruleSetType_s:string,details_message_s:string,details_data_s:string,details_file_s:string,hostname_s:string,instanceId_s:string) [ \"\", \"\", \"\", \"\", \"\", \"\", \"\",\"\", \"\", \"\", \"\", \"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\" ]);\r\nFakeData | union AzureDiagnostics\r\n| where (ResourceType == \"APPLICATIONGATEWAYS\" or ResourceType == \"FRONTDOORS\" or ResourceType == \"CDNWEBAPPLICATIONFIREWALLPOLICIES\") and ResourceType == \"APPLICATIONGATEWAYS\"  or ResourceType == \"FRONTDOORS\"  or ResourceType==\"CDNWEBAPPLICATIONFIREWALLPOLICIES\"\r\n| where Category == \"FrontdoorWebApplicationFirewallLog\" or OperationName == \"ApplicationGatewayFirewall\" or Category == \"WebApplicationFirewallLogs\"\r\n| extend Rule = strcat(ruleName_s, Message), ClientIP = strcat(clientIp_s, clientIP_s)\r\n| extend Action = iif(action_s == \"Blocked\", Action = \"Block\", action_s)\r\n| extend Action = iif(Action == \"Detected\", Action = \"Log\", Action)\r\n| extend Role =  extract(\"ApplicationGateway([a-zA-Z_a-zA-Z_0-9]*)\",1,instanceId_s) \r\n| extend RequestUri = requestUri_s, RuleSetType = ruleSetType_s, Message_Details = details_message_s, Data_Details = details_data_s, File_Details = details_file_s, Hostname = hostname_s, Site = site_s\r\n| project Rule, TimeGenerated, SourceSystem, Hostname, ResourceId, ResourceGroup, ResourceProvider, Category, Role, Action, Site, Message_Details, File_Details, ClientIP, RequestUri\r\n| sort by TimeGenerated\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Web Application Firewall Logs (Azure WAF)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationDisplayName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "State",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "ControlID",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Recommendation",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Recommendation >"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 12 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityAlert\r\n| where ProviderName == \"MCAS\" \r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Application Security Alerts (Microsoft Defender for Cloud Apps)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 11"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let apps = range i from 1 to 1 step 1\r\n| extend x = '{Apps:name}'\r\n| extend x = split(x, ', ')\r\n| mvexpand x to typeof(string) limit 100\r\n| project appName = x;\r\nrequests\r\n| summarize Metric = {Metric}, Count = count() by appName\r\n| join kind = inner (\r\n    requests\r\n    | make-series Trend = {Metric} default = 0 on timestamp from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain} by appName\r\n) on appName\r\n| project-away appName1, timestamp\r\n| join kind = fullouter (apps) on appName\r\n| extend appName = appName1, Metric = iff(appName == '', 0.0, Metric), Count = iff(appName == '', 0, Count), Trend = iff(appName == '', repeat(0, toint(({TimeRange:end} - {TimeRange:start}) / {TimeRange:grain})), Trend)\r\n| extend MetricKind = '{Metric:label}', Relevance = Metric * Count\r\n| order by Relevance desc\r\n",
                    "size": 3,
                    "title": "Application Performance (Azure Monitor: Application Insights)",
                    "noDataMessage": "The Application Insights resource you selected has no data.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "crossComponentResources": [
                      "{Apps}"
                    ],
                    "visualization": "tiles",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ]
                    },
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "appName",
                        "formatter": 1,
                        "formatOptions": {
                          "showIcon": true
                        }
                      },
                      "subtitleContent": {
                        "columnMatch": "MetricKind",
                        "formatter": 1,
                        "formatOptions": {
                          "showIcon": true
                        }
                      },
                      "leftContent": {
                        "columnMatch": "Metric",
                        "formatter": 12,
                        "formatOptions": {
                          "min": 0,
                          "palette": "blue",
                          "showIcon": true
                        },
                        "numberFormat": {
                          "unit": 23,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Trend",
                        "formatter": 9,
                        "formatOptions": {
                          "palette": "blue",
                          "showIcon": true
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let appCount = 5;\r\nlet requestCount = 5;\r\nlet selectedApps = range i from 1 to 1 step 1\r\n| extend x = '{Apps:name}'\r\n| extend x = split(x, ', ')\r\n| mvexpand x to typeof(string) limit 100\r\n| project appName = x;\r\nlet topItems = requests\r\n| top-nested appCount of appName by AppMetric = {Metric} * count() desc, top-nested requestCount of name by RequestMetric = {Metric} * count() desc;\r\nlet topApps = topItems | summarize by appName;\r\nlet topRequests = topItems | summarize by strcat(appName, '::', name);\r\nlet rawData = requests\r\n| extend name = iff(strcat(appName, '::', name) in (topRequests), name, 'Other Requests'), appName = iff(appName in (topApps), appName, 'Other Apps');\r\nlet apps = rawData\r\n| summarize Metric = {Metric}, Count = count(), Users = dcount(user_Id) by appName\r\n| project Id = appName, ParentId = '', Name = strcat('‚òÅÔ∏è ', appName), Kind = 'Application', Metric, Count, Users\r\n| join kind = inner (\r\n    rawData\r\n    | make-series Trend = {Metric} default = 0 on timestamp from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain} by Id = appName\r\n) on Id\r\n| project-away Id1, timestamp\r\n| join kind = fullouter (selectedApps) on $left.Id == $right.appName\r\n| extend Id = appName, Name = strcat('‚òÅÔ∏è ', appName), Kind = 'Application', Metric = iff(Id == '', 0.0, Metric), Count = iff(Id == '', 0, Count), Users = iff(Id == '', 0, Users), Trend = iff(Id == '', repeat(0, toint(({TimeRange:end} - {TimeRange:start}) / {TimeRange:grain})), Trend);\r\nlet requests = rawData\r\n| summarize Metric = {Metric}, Count = count(), Users = dcount(user_Id) by appName, name\r\n| project Id = strcat(appName, '::', name), ParentId = appName, Name = strcat('üåê ', name), Kind = 'Request', Metric, Count, Users\r\n| join kind = inner (\r\n    rawData\r\n    | make-series Trend = {Metric} default = 0 on timestamp from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain} by Id = strcat(appName, '::', name)\r\n) on Id\r\n| project-away Id1, timestamp;\r\nrequests\r\n| union (apps)\r\n| extend Rank = iff(Name contains 'Other Apps' or Name contains 'Other Requests', 2, 1), \r\n         Relevance = Metric * Count\r\n| order by Rank asc, Relevance desc\r\n| project Id, ParentId, Name, Kind, {Metric:label} = Metric, ['Trend'] = Trend, Count, Users",
                    "size": 0,
                    "title": "Application Usage  (Azure Monitor: Application Insights)",
                    "noDataMessage": "The Application Insights resource you selected has no data.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "exportParameterName": "Row",
                    "exportDefaultValue": "{}",
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "crossComponentResources": [
                      "{Apps}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Id",
                          "formatter": 5,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "ParentId",
                          "formatter": 5,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Mean|Median|p80|p95|p99",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blue",
                            "showIcon": true
                          },
                          "numberFormat": {
                            "unit": 23,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 9,
                          "formatOptions": {
                            "min": 0,
                            "palette": "blue",
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Count",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "palette": "green",
                            "showIcon": true
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Users",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "palette": "yellow",
                            "showIcon": true
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        }
                      ],
                      "filter": true,
                      "hierarchySettings": {
                        "idColumn": "Id",
                        "parentColumn": "ParentId",
                        "treeType": 0,
                        "expanderColumn": "Name",
                        "expandTopLevel": true
                      }
                    },
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "appName",
                        "formatter": 1,
                        "formatOptions": {
                          "showIcon": true
                        }
                      },
                      "subtitleContent": {
                        "columnMatch": "MetricKind",
                        "formatter": 1,
                        "formatOptions": {
                          "showIcon": true
                        }
                      },
                      "leftContent": {
                        "columnMatch": "Metric",
                        "formatter": 12,
                        "formatOptions": {
                          "min": 0,
                          "palette": "blue",
                          "showIcon": true
                        },
                        "numberFormat": {
                          "unit": 23,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Trend",
                        "formatter": 9,
                        "formatOptions": {
                          "palette": "blue",
                          "showIcon": true
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let row = dynamic({Row});\r\nrequests\r\n| where '{Row}' == '{}' or (row.Kind == 'Application' and row.Id == appName) or (row.Kind == 'Request' and row.Id == strcat(appName, \"::\", name))\r\n| make-series Metric = {Metric} default = 0 on timestamp from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain}\r\n| mvexpand timestamp to typeof(datetime), Metric to typeof(real) limit 1000\r\n| project timestamp, {Metric:label} = Metric",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Applicaton Request Duration  (Azure Monitor: Application Insights)",
                    "noDataMessage": "The Application Insights resource you selected has no data.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "crossComponentResources": [
                      "{Apps}"
                    ],
                    "visualization": "areachart"
                  },
                  "customWidth": "50",
                  "name": "query - 8"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let row = dynamic({Row});\r\nrequests\r\n| where '{Row}' == '{}' or (row.Kind == 'Application' and row.Id == appName) or (row.Kind == 'Request' and row.Id == strcat(appName, \"::\", name))\r\n| make-series Metric = count() default = 0 on timestamp from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain}\r\n| mvexpand timestamp to typeof(datetime), Metric to typeof(real) limit 1000\r\n| project timestamp, ['Request Counts'] = Metric",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Application Request Count  (Azure Monitor: Application Insights)",
                    "color": "green",
                    "noDataMessage": "The Application Insights resource you selected has no data.",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "crossComponentResources": [
                      "{Apps}"
                    ],
                    "visualization": "areachart"
                  },
                  "customWidth": "50",
                  "name": "query - 9"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL2_5Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Commercial Off the Shelf (COTS) & Custom Applications",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Container - Image](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [ContainerInventory](https://docs.microsoft.com/azure/azure-monitor/reference/tables/containerinventory) üî∑ [AzureDiagnostics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azurediagnostics) ‚ú≥Ô∏è [Azure Kubernetes Service (AKS)](https://azure.microsoft.com/services/kubernetes-service/) <br> \r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity)  ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/)  <br>\r\nüî∑ [AuditLogs](https://docs.microsoft.com/azure/azure-monitor/reference/tables/auditlogs) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)<br> \r\nüî∑ [Resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)<br>\r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/defender-for-cloud/continuous-export?tabs=azure-portal#what-data-types-can-be-exported) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br>  \r\n\r\n### References\r\nüí° [Retrieve container logs and events in Azure Container Instances](https://docs.microsoft.com/azure/container-instances/container-instances-get-logs)<br>\r\nüí° [Monitor container resources in Azure Container Instances](https://docs.microsoft.com/azure/container-instances/container-instances-monitor)<br>\r\nüí° [Continuously export Microsoft Defender for Cloud data](https://docs.microsoft.com/azure/defender-for-cloud/continuous-export?tabs=azure-portal)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Kubernetes Services](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.ContainerService%2FmanagedClusters) <br>\r\nüîÄ [Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Container - Image | ‚Ä¢ Vulnerability Scan Log ‚Ä¢ Hash of the Binary ‚Ä¢ Hash of the Executables ‚Ä¢ Container-Aware Network Monitoring ‚Ä¢ Container-Aware Process Monitoring ‚Ä¢ Container-Aware Malware Detection ‚Ä¢ Filesystem Changes Log ‚Ä¢ Data Monitoring ‚Ä¢ Read and/or Writes to Well\u0002Known Directories (e.g., /ETC, /USR/BIN, USR/SBIN, etc.) ‚Ä¢ Creating Simulink ‚Ä¢ Changes in File/Resource Ownership or Mode Changes (CHMOD) ‚Ä¢ Access Control Log ‚Ä¢ Runtime Vulnerability Scan Log Scan for Malware Log ‚Ä¢ Digital Signature Verification ‚Ä¢ Unexpected Network Connections or Socket Mutations ‚Ä¢ Spawned Processes Using Things Like 'Execve' ‚Ä¢ Executing Shell and/or SSH Binaries  | Log, File, Script | 2 | 12 Months Active Storage, 18 Months Cold Data Storage | 41 |\r\n| Container - Management / Orchestration | ‚Ä¢ Audit Log ‚Ä¢ Account Access Log ‚Ä¢ Account Permission Changes ‚Ä¢ Configuration Log ‚Ä¢ Resource Allocation and Consumption ‚Ä¢ Registration Changes  | Log, Application Monitoring Dashboards | 2 | 12 Months Active Storage, 18 Months Cold Data Storage | 42 |\r\n| Container - OS| ‚Ä¢ User and Administrator Access to OS Components and Applications o File and Object Access o Audit Log Access (Success/Failure) o System Access and Log Off (Success/Failure) o Privilege Access and Log Off (Success/Failure) o RDP Access and Log Off (Success/Failure) o SMB Access ‚Ä¢ System Performance and Operational Characteristics o Resource Utilization, Process Status o System Events o Service Status Changes (Start, Stop, Fail, Restart, etc.) o Service Failures and Restarts o Process Creation and Termination ‚Ä¢ System Configuration o Changes to Security Configuration (Success/Failure) o Audit Log Cleared o Changes to Accounts User or Group Management Changes o Scheduled Task Changes ‚Ä¢ File Access  o Transfer of Data to External Media ‚Ä¢ Powershell Execution Commands ‚Ä¢ WMI Events ‚Ä¢ Registry Access ‚Ä¢ Command-Line Interface (CLI) | Log | 2 | 12 Months Active Storage, 18 Months Cold Data Storage | 42-43 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "// Run query to see results.\r\nresources\r\n| where type in~ (\"microsoft.kubernetes/connectedclusters\", \"microsoft.containerservice/managedclusters\")\r\n| extend kubernetesVersion = properties.kubernetesVersion\r\n| project id, name, type, location, resourceGroup, tags, kind, kubernetesVersion\r\n| extend typeDisplayName=case(type =~ 'microsoft.containerservice/managedclusters','Kubernetes service',type =~ 'microsoft.kubernetes/connectedclusters','Kubernetes - Azure Arc',type)\r\n| extend locationDisplayName=case(location =~ 'eastus','East US',location =~ 'eastus2','East US 2',location =~ 'southcentralus','South Central US',location =~ 'westus2','West US 2',location =~ 'westus3','West US 3',location =~ 'australiaeast','Australia East',location =~ 'southeastasia','Southeast Asia',location =~ 'northeurope','North Europe',location =~ 'swedencentral','Sweden Central',location =~ 'uksouth','UK South',location =~ 'westeurope','West Europe',location =~ 'centralus','Central US',location =~ 'northcentralus','North Central US',location =~ 'westus','West US',location =~ 'southafricanorth','South Africa North',location =~ 'centralindia','Central India',location =~ 'eastasia','East Asia',location =~ 'japaneast','Japan East',location =~ 'jioindiawest','Jio India West',location =~ 'koreacentral','Korea Central',location =~ 'canadacentral','Canada Central',location =~ 'francecentral','France Central',location =~ 'germanywestcentral','Germany West Central',location =~ 'norwayeast','Norway East',location =~ 'switzerlandnorth','Switzerland North',location =~ 'uaenorth','UAE North',location =~ 'brazilsouth','Brazil South',location =~ 'centralusstage','Central US (Stage)',location =~ 'eastusstage','East US (Stage)',location =~ 'eastus2stage','East US 2 (Stage)',location =~ 'northcentralusstage','North Central US (Stage)',location =~ 'southcentralusstage','South Central US (Stage)',location =~ 'westusstage','West US (Stage)',location =~ 'westus2stage','West US 2 (Stage)',location =~ 'asia','Asia',location =~ 'asiapacific','Asia Pacific',location =~ 'australia','Australia',location =~ 'brazil','Brazil',location =~ 'canada','Canada',location =~ 'europe','Europe',location =~ 'france','France',location =~ 'germany','Germany',location =~ 'global','Global',location =~ 'india','India',location =~ 'japan','Japan',location =~ 'korea','Korea',location =~ 'norway','Norway',location =~ 'southafrica','South Africa',location =~ 'switzerland','Switzerland',location =~ 'uae','United Arab Emirates',location =~ 'uk','United Kingdom',location =~ 'unitedstates','United States',location =~ 'eastasiastage','East Asia (Stage)',location =~ 'southeastasiastage','Southeast Asia (Stage)',location =~ 'westcentralus','West Central US',location =~ 'southafricawest','South Africa West',location =~ 'australiacentral','Australia Central',location =~ 'australiacentral2','Australia Central 2',location =~ 'australiasoutheast','Australia Southeast',location =~ 'japanwest','Japan West',location =~ 'jioindiacentral','Jio India Central',location =~ 'koreasouth','Korea South',location =~ 'southindia','South India',location =~ 'westindia','West India',location =~ 'canadaeast','Canada East',location =~ 'francesouth','France South',location =~ 'germanynorth','Germany North',location =~ 'norwaywest','Norway West',location =~ 'switzerlandwest','Switzerland West',location =~ 'ukwest','UK West',location =~ 'uaecentral','UAE Central',location =~ 'brazilsoutheast','Brazil Southeast',location)\r\n| where (type !~ ('dynatrace.observability/monitors'))\r\n| where (type !~ ('nginx.nginxplus/nginxdeployments'))\r\n| where (type !~ ('microsoft.agfoodplatform/farmbeats'))\r\n| where (type !~ ('microsoft.cdn/profiles/afdendpoints'))\r\n| where (type !~ ('microsoft.cdn/profiles/customdomains'))\r\n| where (type !~ ('microsoft.cdn/profiles/origingroups'))\r\n| where (type !~ ('microsoft.cdn/profiles/rulesets'))\r\n| where (type !~ ('microsoft.cdn/profiles/secrets'))\r\n| where (type !~ ('microsoft.cdn/profiles/securitypolicies'))\r\n| where (type !~ ('microsoft.cdn/profiles/afdendpoints/routes'))\r\n| where (type !~ ('microsoft.cdn/profiles/origingroups/origins'))\r\n| where (type !~ ('microsoft.cdn/profiles/rulesets/rules'))\r\n| where (type !~ ('microsoft.kubernetes/connectedclusters/microsoft.kubernetesconfiguration/fluxconfigurations'))\r\n| where (type !~ ('microsoft.containerservice/managedclusters/microsoft.kubernetesconfiguration/fluxconfigurations'))\r\n| where (type !~ ('microsoft.portal/extensions/deployments'))\r\n| where (type !~ ('microsoft.portal/extensions'))\r\n| where (type !~ ('microsoft.portal/extensions/slots'))\r\n| where (type !~ ('microsoft.portal/extensions/versions'))\r\n| where (type !~ ('microsoft.datacollaboration/workspaces'))\r\n| where (type !~ ('microsoft.azurestack/registrations'))\r\n| where (type !~ ('microsoft.hdinsight/clusterpools/clusters'))\r\n| where (type !~ ('microsoft.hdinsight/clusterpools/clusters/sessionclusters'))\r\n| where (type !~ ('microsoft.hdinsight/clusterpools'))\r\n| where (type !~ ('microsoft.hpcworkbench/instances'))\r\n| where (type !~ ('microsoft.connectedvmwarevsphere/vcenters'))\r\n| where (type !~ ('microsoft.intelligentitdigitaltwin/digitaltwins/assets'))\r\n| where (type !~ ('microsoft.intelligentitdigitaltwin/digitaltwins/tests'))\r\n| where (type !~ ('microsoft.intelligentitdigitaltwin/digitaltwins/executionplans'))\r\n| where (type !~ ('microsoft.intelligentitdigitaltwin/digitaltwins/testplans'))\r\n| where (type !~ ('microsoft.intelligentitdigitaltwin/digitaltwins'))\r\n| where not((type =~ ('microsoft.network/serviceendpointpolicies')) and ((kind =~ ('internal'))))\r\n| where (type !~ ('microsoft.openlogisticsplatform/workspaces'))\r\n| where (type !~ ('microsoft.scom/managedinstances'))\r\n| where (type !~ ('microsoft.orbital/spacecrafts/contacts'))\r\n| where (type !~ ('microsoft.orbital/contactprofiles'))\r\n| where (type !~ ('microsoft.orbital/edgesites'))\r\n| where (type !~ ('microsoft.orbital/groundstations'))\r\n| where (type !~ ('microsoft.orbital/l2connections'))\r\n| where (type !~ ('microsoft.orbital/spacecrafts'))\r\n| where (type !~ ('microsoft.azurepercept/accounts'))\r\n| where (type !~ ('microsoft.playfab/playeraccountpools'))\r\n| where (type !~ ('microsoft.playfab/playfabresources'))\r\n| where (type !~ ('microsoft.playfab/titles'))\r\n| where (type !~ ('microsoft.recommendationsservice/accounts/modeling'))\r\n| where (type !~ ('microsoft.recommendationsservice/accounts/serviceendpoints'))\r\n| where (type !~ ('microsoft.recoveryservicesbvtd2/vaults'))\r\n| where (type !~ ('microsoft.recoveryservicesbvtd/vaults'))\r\n| where (type !~ ('microsoft.recoveryservicesintd/vaults'))\r\n| where (type !~ ('microsoft.recoveryservicesintd2/vaults'))\r\n| where (type !~ ('providers.test/statefulibizaengines'))\r\n| where (type !~ ('microsoft.datareplication/replicationvaults'))\r\n| where (type !~ ('microsoft.storagecache/amlfilesystems'))\r\n| where not((type =~ ('microsoft.synapse/workspaces/sqlpools')) and ((kind =~ ('v3'))))\r\n| where (type !~ ('microsoft.mobilenetwork/mobilenetworks'))\r\n| where (type !~ ('microsoft.mobilenetwork/mobilenetworks/sites'))\r\n| where (type !~ ('microsoft.mobilenetwork/packetcorecontrolplanes'))\r\n| where (type !~ ('microsoft.mobilenetwork/mobilenetworks/services'))\r\n| where (type !~ ('microsoft.mobilenetwork/sims'))\r\n| where not((type =~ ('microsoft.sql/servers/databases')) and ((kind in~ ('system','v2.0,system','v12.0,system','v12.0,user,datawarehouse,gen2,analytics'))))\r\n| where not((type =~ ('microsoft.sql/servers')) and ((kind =~ ('v12.0,analytics'))))\r\n| where (type in~ ('Microsoft.ContainerService/managedClusters','Microsoft.Kubernetes/connectedClusters'))\r\n| project name,typeDisplayName,resourceGroup,kubernetesVersion,locationDisplayName,id,type,kind,location,tags\r\n| sort by (tolower(tostring(name))) asc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Container Image Details (Azure Resource Graph)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureActivity\r\n| where ResourceProviderValue == \"MICROSOFT.CONTAINERSERVICE\"\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Container Activity Logs (Azure Monitor)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureDiagnostics\r\n| where ResourceProvider == \"MICROSOFT.CONTAINERSERVICE\"\r\n| project TenantId, TimeGenerated, ResourceId, Category, ResourceGroup, SubscriptionId, ResourceProvider, Resource, ResourceType, OperationName\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Container Diagnostics (Azure Monitor)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AuditLogs\r\n| extend ResourceName = tostring(TargetResources[0].displayName)\r\n| where ResourceName <> \"\"\r\n| join kind=leftouter (AzureActivity| where ResourceProviderValue == \"MICROSOFT.CONTAINERSERVICE\"  | extend ResourceName = tostring(parse_json(Properties).resource) | where ResourceName <> \"\") on ResourceName\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Container Asset Audit Logs (Azure Monitor)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 7"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId == \"Azure Security Benchmark\"\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where RecommendationDisplayName contains \"container\" or RecommendationDisplayName contains \"kubernetes\" or RecommendationDisplayName contains \"pod\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Container Vulnerabilities (Microsoft Defender for Cloud)",
                    "noDataMessage": "No Current Recommendations in this Area. Confirm the Azure Security Benchmark Assessment is Enabled in Microsoft Defender for Cloud: Regulatory Compliance Blade.",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationDisplayName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "State",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "ControlID",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Recommendation",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Recommendation >"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL2_7Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Container - Image",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEL2Visible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Intermediate Event Logging (EL2)"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Advanced Log Event Management (EL3)\r\n---\r\nLogging requiremetns at all criticality levels are met. The agency and all its components meet the following requirements, as detailed in in Table 4 (EL3 Advanced Requirements) within Appendix A (Implementation and Centralized Access Requirements). For more information, see üí°[Improving the Federal Government‚Äôs Investigative and Remediation Capabilities Related to Cybersecurity Incidents (M-21-31)](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf).\r\n\r\n    ‚Ä¢ Meeting EL2 maturity level \r\n    ‚Ä¢ Advanced Logging Categories \r\n    ‚Ä¢ Logging Orchestration, Automation, and Response ‚Äì Finalizing Implementation \r\n    ‚Ä¢ User Behavior Monitoring ‚Äì Finalizing Implementation \r\n    ‚Ä¢ Application Container Security, Operations, and Management \r\n    ‚Ä¢ Advanced Centralized Access"
            },
            "customWidth": "45",
            "name": "EL3 Guide"
          },
          {
            "type": 1,
            "content": {
              "json": ""
            },
            "customWidth": "5",
            "name": "text - 10"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "{\"version\":\"1.0.0\",\"content\":\"\\t[\\r\\n\\t\\t{ \\\"Section\\\": \\\"Software Updates\\\", \\\"tab\\\": \\\"EL3_1\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Spam Dictionary Modifications\\\", \\\"tab\\\": \\\"EL3_2\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Mainframes\\\", \\\"tab\\\": \\\"EL3_3\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Container - Cluster/Pod Events\\\", \\\"tab\\\": \\\"EL3_4\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Logging Orchestration, Automation & Response\\\", \\\"tab\\\": \\\"EL3_5\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"User Behavior Monitoring\\\", \\\"tab\\\": \\\"EL3_6\\\" },\\r\\n\\t\\t{ \\\"Section\\\": \\\"Application Container Security\\\", \\\"tab\\\": \\\"EL3_7\\\" }\\r\\n\\t]\",\"transformers\":null}",
              "size": 3,
              "title": "EL3 Requirements",
              "exportMultipleValues": true,
              "exportedParameters": [
                {
                  "fieldName": "tab",
                  "parameterName": "Tab",
                  "parameterType": 1
                }
              ],
              "queryType": 8,
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Section",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  },
                  {
                    "columnMatch": "tab",
                    "formatter": 5
                  }
                ],
                "filter": true
              }
            },
            "customWidth": "35",
            "name": "Event Logging Tiers"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "a30d01d0-38f1-4a91-9cf6-cdb181d676b5",
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL3_1Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL3_1",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  }
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL3_2Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL3_2",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "2609fc0f-e8de-4955-9c65-6a901ba74088"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL3_3Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL3_3",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "c4e803dc-56c8-4732-b207-5cddcb6d0a08"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL3_4Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL3_4",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "7b362e8d-6cb2-4a82-ae58-b345af2e8a39"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL3_5Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL3_5",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "ca37f85e-79c5-44bf-9f80-b58a6ac6a491"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL3_6Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL3_6",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "44294a7c-42db-4769-8f21-7fd81459781b"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "isEL3_7Visible",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Tab",
                        "operator": "contains",
                        "rightValType": "static",
                        "rightVal": "EL3_7",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "e1bb5e69-df08-4117-a276-4535973d4230"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "1",
            "name": "Hidden Parameters"
          },
          {
            "type": 1,
            "content": {
              "json": "## EL3 Controls Mapping\r\n| <strong> Event Logging Requirements </strong> | <strong> Microsoft Controls </strong> | \r\n|:--|:--|\r\n| Software Updates | ‚ú≥Ô∏è [Automation]( https://azure.microsoft.com/services/automation/)  ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/) |\r\n| Spam Dictionary Modifications | ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender) |\r\n| Mainframes | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/) |\r\n| Container - Cluster/Pod Events | ‚ú≥Ô∏è [Azure Kubernetes Service (AKS)](https://azure.microsoft.com/services/kubernetes-service/) ‚ú≥Ô∏è [Container Instances](https://azure.microsoft.com/services/container-instances/) ‚ú≥Ô∏è [Azure Red Hat OpenShift](https://azure.microsoft.com/services/openshift/)|\r\n| Logging Orchestration, Automation & Response | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)  ‚ú≥Ô∏è [Logic Apps](https://azure.microsoft.com/services/logic-apps/)  |\r\n| User Behavior Monitoring | ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft 365: Insider Risk Management](https://www.microsoft.com/microsoft-365/business/compliance-solutions) |\r\n| Application Container Security, Operations, and Management | ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/) |"
            },
            "conditionalVisibility": {
              "parameterName": "Help",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "EL3 Guide"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Software Updates](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [Update](https://docs.microsoft.com/azure/azure-monitor/reference/tables/update) ‚ú≥Ô∏è [Automation](https://azure.microsoft.com/services/automation/)<br> \r\nüî∑ [SecurityRecommendation](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityrecommendation) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br>  \r\n\r\n### References\r\nüí° [Azure Automation update management](https://docs.microsoft.com/azure/architecture/hybrid/azure-update-mgmt)<br>\r\nüí° [Use asset inventory to manage your resources' security posture](https://docs.microsoft.com/azure/defender-for-cloud/asset-inventory#access-a-software-inventory)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Automation Accounts](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Automation%2FAutomationAccounts) <br>\r\nüîÄ [Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| System & Configuration Performance | Software Updates ‚Ä¢ User Agent | Log, Database Record, Script | 3 | 12 Months Active Storage, 18 Months Cold Storage | 43 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "Update\r\n| project _ResourceId, Classification, Title, PublishedDate, KBID, RevisionNumber, Optional, RebootBehavior, Approved, ApprovalSource, ProductVersion, PackageRepository, Type, ResourceGroup, ResourceType, OSType, ProductArch, CVENumbers, UpdateState, Product, SourceSystem, TimeGenerated\r\n| where Classification <> \"Others\"\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Updates (Azure Automation Update Management)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId == \"Azure Security Benchmark\"\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where RecommendationDisplayName contains \"update\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Update Recommendations (Microsoft Defender for Cloud)",
                    "noDataMessage": "No Current Recommendations in this Area. Confirm the Azure Security Benchmark Assessment is Enabled in Microsoft Defender for Cloud: Regulatory Compliance Blade.",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationDisplayName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "State",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "ControlID",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Recommendation",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Recommendation >"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL3_1Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Software Updates",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Spam Dictionary Modifications](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [OfficeActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/officeactivity) üî∑ [EmailEvents](https://docs.microsoft.com/microsoft-365/security/defender/advanced-hunting-emailevents-table) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)<br> \r\n\r\n### References\r\nüí° [Connect data from Microsoft 365 Defender to Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)<br>\r\nüí° [Configure anti-spam policies in EOP](https://docs.microsoft.com/microsoft-365/security/office-365-security/configure-your-spam-filter-policies)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft 365 Defender](https://security.microsoft.com/) <br> \r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Email Filtering, Spam, and Phishing | Spam Dictionary Modifications | Log | 3 | 12 Months Active Storage, 18 Months Cold Storage | 43 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "OfficeActivity\r\n| where RecordType == \"ExchangeAdmin\"\r\n| where Operation contains \"policy\"\r\n| where Operation !contains \"access\"\r\n| project Operation, RecordType, UserId, UserType, OfficeWorkload, ResultStatus, Parameters, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Exchange Policy Changes (Microsoft 365)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "EmailEvents\r\n| where ConfidenceLevel contains \"spam\" or DetectionMethods contains \"spam\" or DeliveryAction == \"Junked\"\r\n| summarize count() by ConfidenceLevel, DetectionMethods, DeliveryAction, EmailActionPolicy\r\n| sort by count_ desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Configured Spam Filtering Policies (Microsoft 365)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL3_2Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Spam Dictionary Modifications",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Mainframes](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### References\r\nüí° [Mainframe rehosting on Azure virtual machines](https://docs.microsoft.com/azure/virtual-machines/workloads/mainframe-rehosting/overview)<br>\r\nüí° [Mainframe and midrange migration](https://azure.microsoft.com/migration/mainframe/#overview)<br>\r\nüí° [Hybrid Security Monitoring using Microsoft Defender for Cloud and Microsoft Sentinel](https://docs.microsoft.com/azure/architecture/hybrid/hybrid-security-monitoring)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Mainframes | ‚Ä¢ Syslog & Syslogd Data ‚Ä¢ Log4j Data ‚Ä¢ Sysout Data Resource Measurement Facility (RMF) Data ‚Ä¢ System Management Facility (SMF)16 ‚Ä¢ Output from Integrated Intrusion Detection Services | Log | 3 | 12 Months Active Storage, 18 Months Cold Storage | 43 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "## ‚ú≥Ô∏è [Hybrid Security Monitoring](https://docs.microsoft.com/azure/architecture/hybrid/hybrid-security-monitoring)\r\n\r\n![ImageName](https://docs.microsoft.com/azure/architecture/hybrid/images/hybrid-security-monitoring.png)"
                  },
                  "customWidth": "45",
                  "name": "text - 2"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 4"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "## ‚ú≥Ô∏è [Mainframe Rehosting on Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/mainframe-rehosting/overview)\r\n\r\n![ImageName](https://docs.microsoft.com/azure/virtual-machines/workloads/mainframe-rehosting/media/01-overview.png)"
                  },
                  "customWidth": "40",
                  "name": "text - 2 - Copy"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL3_3Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Mainframes",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Container - Cluster/Pod Events](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [AzureDiagnostics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azurediagnostics)  ‚ú≥Ô∏è [Azure Kubernetes Service (AKS)](https://azure.microsoft.com/services/kubernetes-service/) ‚ú≥Ô∏è [Container Instances](https://azure.microsoft.com/services/container-instances/) ‚ú≥Ô∏è [Azure Red Hat OpenShift](https://azure.microsoft.com/services/openshift/)<br> \r\n\r\n### References\r\nüí° [Monitoring a microservices architecture in Azure Kubernetes Service (AKS)](https://docs.microsoft.com/azure/architecture/microservices/logging-monitoring)<br>\r\nüí° [How to query logs from Container insights](https://docs.microsoft.com/azure/azure-monitor/containers/container-insights-log-query)<br>\r\nüí° [Microsoft Sentinel Azure Kubernetes Service Connector](https://docs.microsoft.com/azure/sentinel/data-connectors-reference#azure-kubernetes-service-aks)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Kubernetes Services](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.ContainerService%2FmanagedClusters) <br>\r\nüîÄ [Container Instances](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.ContainerInstance%2FcontainerGroups) <br>\r\nüîÄ [Azure Red Hat OpenShift](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.RedHatOpenShift%2FOpenShiftClusters) <br>\r\n\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Container - Cluster/Pod Events | ‚Ä¢ Container User and Service Logs ‚Ä¢ Container and Application API Audit Logs ‚Ä¢ Container Management Access Logs ‚Ä¢ Changes to Container Resources Across Containers and Container Management Environment  | Log | 3 | 12 Months Active Storage, 18 Months Cold Storage | 44 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureDiagnostics\r\n| where ResourceProvider == \"MICROSOFT.CONTAINERSERVICE\"\r\n| extend Cluster = tostring(parse_json(tostring(parse_json(tostring(parse_json(tostring(parse_json(log_s).responseObject)).metadata)).labels)).[\"kubernetes.azure.com/cluster\"])\r\n| where Cluster <> \"\"\r\n| project Cluster, log_s, ResourceId, Category, ResourceGroup, SubscriptionId, ResourceProvider, TenantId, Resource, ResourceType, OperationName, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Container - Cluster/Pod Events",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL3_4Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Container - Cluster/Pod Events",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Logging Orchestration, Automation & Response](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [resources](https://docs.microsoft.com/azure/governance/resource-graph/samples/starter)  ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) <br>\r\nüî∑ [AzureActivity](https://docs.microsoft.com/azure/azure-monitor/reference/tables/azureactivity) ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) <br>\r\n\r\n### References\r\nüí°¬†[Tutorial: Setup Automated Threat Responses in Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/tutorial-respond-threats-playbook)<br>\r\nüí°¬†[Set up Azure Monitor logs and collect diagnostics data for Azure Logic Apps](https://docs.microsoft.com/azure/logic-apps/monitor-logic-apps-log-analytics)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Logic Apps](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Logic%2Fworkflows) <br>\r\nüîÄ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview) <br>\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Logging Orchestration, Automation & Response | Agencies shall finalize and implement automated hunt and incident response playbooks. Federal agencies shall also provide any updates to the playbooks and automation integrations to CISA no later than one business day after they are finalized. | Log | 3 | 12 Months Active Storage, 18 Months Cold Storage | 9-10 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n|¬†where¬†type¬†==¬†\"microsoft.logic/workflows\"\r\n|¬†extend¬†Connection¬†=¬†parse_json(properties)[\"parameters\"][\"$connections\"][\"value\"]\r\n|¬†where¬†Connection¬†has¬†\"managedApis/azuresentinel\"\r\n| project id, type, resourceGroup",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Orchestration, Automation & Response (Microsoft Sentinel)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellowOrangeRed"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 3",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "AzureActivity\r\n| where ResourceProviderValue == \"MICROSOFT.LOGIC\"\r\n| where ActivityStatusValue == \"Success\"\r\n| extend Playbook = tostring(parse_json(Properties).resource)\r\n| summarize count() by Playbook\r\n| sort by count_ desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Playbooks Triggered (Microsoft Sentinel)",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "orangeBlue"
                          }
                        },
                        {
                          "columnMatch": "RecommendationName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Fired",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 3 - Copy",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL3_5Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Logging Orchestration, Automation & Response",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [User Behavior Monitoring](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [BehaviorAnalytics](https://docs.microsoft.com/azure/azure-monitor/reference/tables/behavioranalytics) ‚ú≥Ô∏è [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)<br>\r\nüî∑ [SecurityAlert](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityalert) ‚ú≥Ô∏è [Microsoft 365: Insider Risk Management](https://www.microsoft.com/microsoft-365/business/compliance-solutions) <br>\r\n\r\n### References\r\nüí°¬†[Enable User and Entity Behavior Analytics (UEBA) in Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/enable-entity-behavior-analytics)<br>\r\nüí°¬†[Insider risk management in Microsoft 365](https://docs.microsoft.com/microsoft-365/compliance/insider-risk-management-solution-overview)<br>\r\nüí°¬†[Tutorial: Detect suspicious user activity with UEBA](https://docs.microsoft.com/cloud-app-security/tutorial-suspicious-activity)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) <br>\r\nüîÄ [Microsoft 365 Insider Risk Management](https://compliance.microsoft.com/insiderriskmgmt)<br>\r\nüîÄ [Microsoft Defender for Cloud Apps Portal](https://portal.cloudappsecurity.com/)<br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| User Behavior Monitoring | User behavioral analytics must be implemented in order to allow for early detection of malicious behavior. This technology leverages machine learning and artificial intelligence techniques to detect anomalous user actions and help combat advanced threats. Agenciesshall implement a user behavior analytics capability, leveraging the logging requirements, in order identify potentially malicious or malicious activity. This capability shall monitor all user and non-user accounts. This capability shall be monitored and triaged by component\u0002and top-level agency Security Operations Centers (SOC). At a minimum, user Behavior Monitoring should be configured to detect and alert on: ‚Ä¢ Compromised user credentials ‚Ä¢ Privileged-user compromise ‚Ä¢ Improper asset access ‚Ä¢ Compromised system/host/device ‚Ä¢ Lateral movement of threat actor | Log | 3 | 12 Months Active Storage, 18 Months Cold Storage | 10 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "ac6f7462-59ff-4d82-86b0-0a6eccc35a51",
                        "version": "KqlParameterItem/1.0",
                        "name": "UserPrincipalName",
                        "label": "üîÄ User Selector",
                        "type": 2,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "SigninLogs\r\n| summarize by UserPrincipalName ",
                        "value": [
                          "value::all"
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::all"
                          ],
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 7776000000
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "User Selector Parameter - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//If query errors for \"where\" statement, comment out respective columns\r\nunion withsource= Table_Name *\r\n| where column_ifexists('AADEmail', '') in ({UserPrincipalName})\r\nor column_ifexists('Account', '') in ({UserPrincipalName})\r\nor column_ifexists('AccountName', '') in ({UserPrincipalName})\r\nor column_ifexists('AccountUpn', '') in ({UserPrincipalName})\r\nor column_ifexists('AccountUPN', '') in ({UserPrincipalName})\r\nor column_ifexists('Caller', '') in ({UserPrincipalName})\r\nor column_ifexists('CompromisedEntity', '') in ({UserPrincipalName})\r\nor column_ifexists('DestinationUserID', '') in ({UserPrincipalName})\r\nor column_ifexists('DestinationUserName', '') in ({UserPrincipalName})\r\nor column_ifexists('DisplayName', '') in ({UserPrincipalName})\r\nor column_ifexists('Email_s', '') in ({UserPrincipalName})\r\nor column_ifexists('FullyQualifiedSubjectUserName', '') in ({UserPrincipalName})\r\nor column_ifexists('InitiatingProcessAccountUpn', '') in ({UserPrincipalName}) \r\nor column_ifexists('MailboxOwnerUPN', '') in ({UserPrincipalName})\r\nor column_ifexists('Owner', '') in ({UserPrincipalName})\r\nor column_ifexists('RecipientEmailAddress', '') in ({UserPrincipalName})\r\nor column_ifexists('RequesterUpn', '') in ({UserPrincipalName})\r\nor column_ifexists('SenderMailFromAddress', '') in ({UserPrincipalName})\r\nor column_ifexists('SourceIdentity', '') in ({UserPrincipalName})\r\nor column_ifexists('SourceUserID', '') in ({UserPrincipalName})\r\nor column_ifexists('SourceUserName', '') in ({UserPrincipalName})\r\nor column_ifexists('SubjectUserName', '') in ({UserPrincipalName})\r\nor column_ifexists('TargetUser', '') in ({UserPrincipalName})\r\nor column_ifexists('TargetUserName', '') in ({UserPrincipalName})\r\nor column_ifexists('Upn', '') in ({UserPrincipalName})\r\nor column_ifexists('User_s', '') in ({UserPrincipalName})\r\nor column_ifexists('UserId', '') in ({UserPrincipalName}) \r\nor column_ifexists('UserId_', '') in ({UserPrincipalName})\r\nor column_ifexists('UserId_s_s', '') in ({UserPrincipalName}) \r\nor column_ifexists('userName', '') in ({UserPrincipalName})\r\nor column_ifexists('UserName', '') in ({UserPrincipalName}) \r\nor column_ifexists('UserName_s', '') in ({UserPrincipalName})\r\nor column_ifexists('userPrincipalName_s', '') in ({UserPrincipalName})\r\nor column_ifexists('UserPrincipalName_s', '') in ({UserPrincipalName})\r\nor column_ifexists('UserPrincipalName', '') in ({UserPrincipalName})\r\n| summarize count() by Table_Name \r\n| project-rename Log_Tables=Table_Name, Logs_Count=count_\r\n| sort by Logs_Count desc\r\n\r\n\r\n\r\n\r\n\r\n ",
                    "size": 1,
                    "showAnalytics": true,
                    "title": "User Logs Summary",
                    "color": "blue",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "timeBrushParameterName": "tbMthlyUsage",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Log_Tables",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Logs_Count",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "greenRed"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "useGrouping": true
                            }
                          }
                        }
                      ],
                      "filter": true
                    },
                    "sortBy": [],
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SigninStatus",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "Count",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "blue"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Trend",
                        "formatter": 9,
                        "formatOptions": {
                          "palette": "green"
                        }
                      },
                      "showBorder": false
                    },
                    "chartSettings": {
                      "seriesLabelSettings": [
                        {
                          "seriesName": "Other",
                          "color": "green"
                        }
                      ],
                      "xSettings": {},
                      "ySettings": {}
                    },
                    "mapSettings": {
                      "locInfo": "CountryRegion",
                      "locInfoColumn": "Location",
                      "latitude": "SourceIPLocation",
                      "longitude": "SourceIPLocation",
                      "sizeSettings": "Location",
                      "sizeAggregation": "Count",
                      "legendMetric": "Location",
                      "legendAggregation": "Count",
                      "itemColorSettings": {
                        "nodeColorField": "Location",
                        "colorAggregation": "Count",
                        "type": "thresholds",
                        "thresholdsGrid": [
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "blueDark"
                          }
                        ]
                      }
                    }
                  },
                  "customWidth": "40",
                  "name": "Results316"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//If query errors for \"where\" statement, comment out respective columns\r\nunion withsource = Table_Name *\r\n| where column_ifexists('AADEmail', '') in ({UserPrincipalName})\r\nor column_ifexists('Account', '') in ({UserPrincipalName})\r\nor column_ifexists('AccountName', '') in ({UserPrincipalName})\r\nor column_ifexists('AccountUpn', '') in ({UserPrincipalName})\r\nor column_ifexists('AccountUPN', '') in ({UserPrincipalName})\r\nor column_ifexists('Caller', '') in ({UserPrincipalName})\r\nor column_ifexists('CompromisedEntity', '') in ({UserPrincipalName})\r\nor column_ifexists('DestinationUserID', '') in ({UserPrincipalName})\r\nor column_ifexists('DestinationUserName', '') in ({UserPrincipalName})\r\nor column_ifexists('DisplayName', '') in ({UserPrincipalName})\r\nor column_ifexists('Email_s', '') in ({UserPrincipalName})\r\nor column_ifexists('FullyQualifiedSubjectUserName', '') in ({UserPrincipalName})\r\nor column_ifexists('InitiatingProcessAccountUpn', '') in ({UserPrincipalName}) \r\nor column_ifexists('MailboxOwnerUPN', '') in ({UserPrincipalName})\r\nor column_ifexists('Owner', '') in ({UserPrincipalName})\r\nor column_ifexists('RecipientEmailAddress', '') in ({UserPrincipalName})\r\nor column_ifexists('RequesterUpn', '') in ({UserPrincipalName})\r\nor column_ifexists('SenderMailFromAddress', '') in ({UserPrincipalName})\r\nor column_ifexists('SourceIdentity', '') in ({UserPrincipalName})\r\nor column_ifexists('SourceUserID', '') in ({UserPrincipalName})\r\nor column_ifexists('SourceUserName', '') in ({UserPrincipalName})\r\nor column_ifexists('SubjectUserName', '') in ({UserPrincipalName})\r\nor column_ifexists('TargetUser', '') in ({UserPrincipalName})\r\nor column_ifexists('TargetUserName', '') in ({UserPrincipalName})\r\nor column_ifexists('Upn', '') in ({UserPrincipalName})\r\nor column_ifexists('User_s', '') in ({UserPrincipalName})\r\nor column_ifexists('UserId', '') in ({UserPrincipalName}) \r\nor column_ifexists('UserId_', '') in ({UserPrincipalName})\r\nor column_ifexists('UserId_s_s', '') in ({UserPrincipalName}) \r\nor column_ifexists('userName', '') in ({UserPrincipalName})\r\nor column_ifexists('UserName', '') in ({UserPrincipalName}) \r\nor column_ifexists('UserName_s', '') in ({UserPrincipalName})\r\nor column_ifexists('userPrincipalName_s', '') in ({UserPrincipalName})\r\nor column_ifexists('UserPrincipalName_s', '') in ({UserPrincipalName})\r\nor column_ifexists('UserPrincipalName', '') in ({UserPrincipalName})\r\n| project-rename Log_Tables=Table_Name\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by Log_Tables\r\n| render areachart\r\n\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "User Behavior Logs over Time",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Logs_Count",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "UserPrincipalName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "city_",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "state_",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blueDark",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue"
                          }
                        }
                      ]
                    },
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SigninStatus",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "Count",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "blue"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Trend",
                        "formatter": 9,
                        "formatOptions": {
                          "palette": "green"
                        }
                      },
                      "showBorder": false
                    },
                    "mapSettings": {
                      "locInfo": "CountryRegion",
                      "locInfoColumn": "Location",
                      "latitude": "SourceIPLocation",
                      "longitude": "SourceIPLocation",
                      "sizeSettings": "Location",
                      "sizeAggregation": "Count",
                      "legendMetric": "Location",
                      "legendAggregation": "Count",
                      "itemColorSettings": {
                        "nodeColorField": "Location",
                        "colorAggregation": "Count",
                        "type": "thresholds",
                        "thresholdsGrid": [
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "blueDark"
                          }
                        ]
                      }
                    }
                  },
                  "customWidth": "60",
                  "name": "Results316b"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityIncident\r\n    | summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n    | mv-expand AlertIds\r\n    | extend AlertId = tostring(AlertIds)\r\n    | join kind= innerunique ( \r\n        SecurityAlert \r\n        )\r\n        on $left.AlertId == $right.SystemAlertId\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| extend Href_ = tostring(parse_json(ExtendedLinks)[0].Href)\r\n| where UPN <> \"\"\r\n| where UPN in ({UserPrincipalName})\r\n| distinct UPN, AlertName, Severity, ProductName, AlertLink, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Security Alerts: Go-To >",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "UPN",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "AlertName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "3",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "ProductName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "uninitialized",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "AlertLink",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Alert >"
                          }
                        },
                        {
                          "columnMatch": "IncidentUrl",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Incident >"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "UserPrincipalName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "resource",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "city_",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "state_",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blueDark",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    },
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SigninStatus",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "Count",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "blue"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Trend",
                        "formatter": 9,
                        "formatOptions": {
                          "palette": "green"
                        }
                      },
                      "showBorder": false
                    },
                    "mapSettings": {
                      "locInfo": "CountryRegion",
                      "locInfoColumn": "Location",
                      "latitude": "SourceIPLocation",
                      "longitude": "SourceIPLocation",
                      "sizeSettings": "Location",
                      "sizeAggregation": "Count",
                      "legendMetric": "Location",
                      "legendAggregation": "Count",
                      "itemColorSettings": {
                        "nodeColorField": "Location",
                        "colorAggregation": "Count",
                        "type": "thresholds",
                        "thresholdsGrid": [
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "blueDark"
                          }
                        ]
                      }
                    }
                  },
                  "name": "Results113f"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityAlert\r\n| where ProductName == \"Microsoft 365 Insider Risk Management\"\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| extend Href_ = tostring(parse_json(ExtendedLinks)[0].Href)\r\n| extend UserPrincipalName = UPN\r\n| where UserPrincipalName in ({UserPrincipalName})\r\n| distinct AlertName, ProductName, Status, AlertLink, UserPrincipalName, Tactics, TimeGenerated\r\n| sort by TimeGenerated desc\r\n| limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Microsoft 365: Insider Risk Management Alert Details",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "AlertName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "3",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "ProductName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "uninitialized",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "AlertLink",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Alert >"
                          }
                        },
                        {
                          "columnMatch": "UserPrincipalName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "red",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "UPN",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "2",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IncidentUrl",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Incident >"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "count_",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "city_",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "state_",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blueDark",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true
                    },
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SigninStatus",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "Count",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "blue"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Trend",
                        "formatter": 9,
                        "formatOptions": {
                          "palette": "green"
                        }
                      },
                      "showBorder": false
                    },
                    "mapSettings": {
                      "locInfo": "CountryRegion",
                      "locInfoColumn": "Location",
                      "latitude": "SourceIPLocation",
                      "longitude": "SourceIPLocation",
                      "sizeSettings": "Location",
                      "sizeAggregation": "Count",
                      "legendMetric": "Location",
                      "legendAggregation": "Count",
                      "itemColorSettings": {
                        "nodeColorField": "Location",
                        "colorAggregation": "Count",
                        "type": "thresholds",
                        "thresholdsGrid": [
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "blueDark"
                          }
                        ]
                      }
                    }
                  },
                  "name": "Microsoft 365: Insider Risk Management Alerts"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let AnomalousSigninActivity = BehaviorAnalytics\r\n    | where ActionType == \"Sign-in\"\r\n    | where (UsersInsights.NewAccount == True or UsersInsights.DormantAccount == True) and (\r\n        ActivityInsights.FirstTimeUserAccessedResource == True and ActivityInsights.ResourceUncommonlyAccessedAmongPeers == True\r\n        or ActivityInsights.FirstTimeUserUsedApp == True and ActivityInsights.AppUncommonlyUsedAmongPeers == False)\r\n    | join (\r\n        SigninLogs | where Status.errorCode == 0 or Status.errorCode == 0 and RiskDetail != \"none\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Successful Sign-in with one or more of the following indications: sign by new or recently dormant accounts and sign in with resource for the first time (while none of their peers did) or to an app for the first time (while none of their peers did) or performed by a user with Risk indicaiton from AAD\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet critical = dynamic(['9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3', 'c4e39bd9-1100-46d3-8c65-fb160da0071f', '158c047a-c907-4556-b7ef-446551a6b5f7', '62e90394-69f5-4237-9190-012177145e10', 'd29b2b05-8046-44ba-8758-1e26182fcf32', '729827e3-9c14-49f7-bb1b-9608f156bbb8', '966707d0-3269-4727-9be2-8c3a10f19b9d', '194ae4cb-b126-40b2-bd5b-6091b380977d', 'fe930be7-5e62-47db-91af-98c3a49a38b1']);\r\nlet high = dynamic(['cf1c38e5-3621-4004-a7cb-879624dced7c', '7495fdc4-34c4-4d15-a289-98788ce399fd', 'aaf43236-0c0d-4d5f-883a-6955382ac081', '3edaf663-341e-4475-9f94-5c398ef6c070', '7698a772-787b-4ac8-901f-60d6b08affd2', 'b1be1c3e-b65d-4f19-8427-f6fa0d97feb9', '9f06204d-73c1-4d4c-880a-6edb90606fd8', '29232cdf-9323-42fd-ade2-1d097af3e4de', 'be2f45a1-457d-42af-a067-6ec1fa63bc45', '7be44c8a-adaf-4e2a-84d6-ab2649e08a13', 'e8611ab8-c189-46e8-94e1-60213ab1f814']);//witdstomstl\r\nlet AnomalousRoleAssignment = AuditLogs\r\n    | where TimeGenerated > ago(28d)\r\n    | where OperationName == \"Add member to role\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target = tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner (\r\n        BehaviorAnalytics\r\n        | where ActionType == \"Add member to role\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend AnomalyName = \"Anomalous Role Assignemt\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access.  The query below generates an output of all high Blast Radius users performing Add member to priveleged role, or ones that add users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let LogOns=materialize(\r\n    BehaviorAnalytics\r\n    | where ActivityType == \"LogOn\");\r\nlet AnomalousResourceAccess = LogOns\r\n    | where ActionType == \"ResourceAccess\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous Resource Access\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversary may be trying to move through the environment. APT29 and APT32, for example, has used PtH & PtT techniques to lateral move around the network. The query below generates an output of all users performing an resource access (4624:3) to devices for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousRDPActivity = LogOns\r\n    | where ActionType == \"RemoteInteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous RDP Activity\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. FIN10, for example, has used RDP to move laterally to systems in the victim environment. The query below generates an output of all users performing a remote interactive logon (4624:10) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousLogintoDevices = LogOns\r\n    | where ActionType == \"InteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | where UsersInsights.DormantAccount == true or DevicesInsights.LocalAdmin == true\r\n    | extend AnomalyName = \"Anomalous Login To Devices\",\r\n        Tactic = \"Privilege Escalation\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access and privilege escalation. The query below generates an output of all administator users performing an interactive logon (4624:2) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousPasswordReset = BehaviorAnalytics\r\n    | where ActionType == \"Reset user password\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == \"True\"\r\n    | join (\r\n        AuditLogs\r\n        | where OperationName == \"Reset user password\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Password Reset\",\r\n        Tactic = \"Impact\",\r\n        Technique = \"Account Access Removal\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. LockerGoga, for example, has been observed changing account passwords and logging off current users. The query below generates an output of all users performing Reset user password for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalousGeoLocationLogon = BehaviorAnalytics\r\n    | where ActionType == \"Sign-in\"\r\n    | where ActivityInsights.FirstTimeUserConnectedFromCountry == True and (ActivityInsights.FirstTimeConnectionFromCountryObservedInTenant == True or ActivityInsights.CountryUncommonlyConnectedFromAmongPeers == True)\r\n    | join (\r\n        SigninLogs\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Initial Access\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access. The query below generates an output of successful Sign-in performed by a user from a new geo location he has never connected from before, and none of his peers as well.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousFailedLogon = BehaviorAnalytics\r\n    | where ActivityType == \"LogOn\"\r\n    | where UsersInsights.BlastRadius == \"High\"\r\n    | join (\r\n        SigninLogs  \r\n        | where Status.errorCode == 50126\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Failed Logon\",\r\n        Tactic = \"Credential Access\",\r\n        Technique = \"Brute Force\",\r\n        SubTechnique = \"Password Guessing\",\r\n        Description = \"Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Emotet, for example, has been observed using a hard coded list of passwords to brute force user accounts. The query below generates an output of all users with 'High' BlastRadius that perform failed Sign-in:Invalid username or password.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousAADAccountManipulation = AuditLogs\r\n    | where OperationName == \"Update user\"\r\n    | mv-expand AdditionalDetails\r\n    | where AdditionalDetails.key == \"UserPrincipalName\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner ( \r\n        BehaviorAnalytics\r\n        | where ActionType == \"Update user\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName) \r\n    | extend AnomalyName = \"Anomalous Account Manipulation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access. The query below generates an output of all high Blast Radius users performing 'Update user' (name change) to priveleged role, or ones that changed users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let AnomalousAADAccountCreation = BehaviorAnalytics\r\n    | where ActionType == \"Add user\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == True or ActivityInsights.FirstTimeActionPerformedInTenant == True or ActivityInsights.ActionUncommonlyPerformedAmongPeers == true\r\n    | join(\r\n        AuditLogs\r\n        | where OperationName == \"Add user\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend DisplayName = tostring(UsersInsights.AccountDisplayName),\r\n        UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Account Creation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Create Account\",\r\n        SubTechnique = \"Cloud Account\",\r\n        Description = \"Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system. The query below generates an output of all the users performing user creation for the first time and the target users that were created.\"\t\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalyTable = union kind=outer AnomalousSigninActivity, AnomalousRoleAssignment, AnomalousResourceAccess, AnomalousRDPActivity, AnomalousPasswordReset, AnomalousLogintoDevices, AnomalousGeoLocationLogon, AnomalousAADAccountManipulation, AnomalousAADAccountCreation, AnomalousFailedLogon;\r\nlet TopUsersByAnomalies = AnomalyTable\r\n    | summarize hint.strategy = shuffle AnomalyCount=count() by UserName, UserPrincipalName, tostring(UsersInsights.OnPremSid), tostring(UsersInsights.AccountObjectId)\r\n    | project Name=tolower(UserName), UPN=tolower(UserPrincipalName), AadUserId=UsersInsights_AccountObjectId, Sid=UsersInsights_OnPremSid, AnomalyCount\r\n    | sort by AnomalyCount desc;\r\nlet TopUsersByIncidents = SecurityIncident\r\n    | summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n    | where Status == \"New\" or Status == \"Active\"\r\n    | mv-expand AlertIds\r\n    | extend AlertId = tostring(AlertIds)\r\n    | join kind= innerunique ( \r\n        SecurityAlert \r\n        )\r\n        on $left.AlertId == $right.SystemAlertId\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n    | union TopUsersByAnomalies\r\n    | extend \r\n        AadPivot = iff(isempty(AadUserId), iff(isempty(Sid), Name, Sid), AadUserId),\r\n        SidPivot = iff(isempty(Sid), iff(isempty(AadUserId), Name, AadUserId), Sid),\r\n        UPNExists = iff(isempty(UPN), false, true),\r\n        NameExists = iff(isempty(Name), false, true),\r\n        SidExists = iff(isempty(Sid), false, true),\r\n        AADExists = iff(isempty(AadUserId), false, true)\r\n    | summarize hint.strategy = shuffle IncidentCount=dcount(IncidentNumber, 4), AlertCount=dcountif(AlertId, isnotempty(AlertId), 4), AnomalyCount=sum(AnomalyCount), any(Title, Severity, Status, StartTime, IncidentNumber, IncidentUrl, Owner), UPNAnchor=anyif(UPN, UPNExists == true), NameAnchor=anyif(Name, NameExists == true), AadAnchor=anyif(AadUserId, AADExists == true), SidAnchor=anyif(Sid, SidExists == true), any(SidPivot) by AadPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), NameAnchor=anyif(NameAnchor, isempty(NameAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_Title, any_Severity, any_StartTime, any_IncidentNumber, any_IncidentUrl) by any_SidPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_any_Title, any_any_Severity, any_any_StartTime, any_any_IncidentNumber, any_any_IncidentUrl) by NameAnchor\r\n    | project [\"UserName\"]=NameAnchor, IncidentCount, AlertCount, AnomalyCount, [\"AadUserId\"]=AadAnchor, [\"OnPremSid\"]=SidAnchor, [\"UserPrincipalName\"]=UPNAnchor;\r\nTopUsersByIncidents\r\n| where UserPrincipalName in ({UserPrincipalName})\r\n| project UserPrincipalName, IncidentCount, AlertCount, AnomalyCount\r\n| sort by AlertCount desc\r\n| limit 250\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "User Entity Behavior Analytics ",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "UserPrincipalName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "IncidentCount",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "redBright"
                          }
                        },
                        {
                          "columnMatch": "AlertCount",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "orange"
                          }
                        },
                        {
                          "columnMatch": "AnomalyCount",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellow"
                          }
                        }
                      ],
                      "filter": true,
                      "sortBy": [
                        {
                          "itemKey": "$gen_heatmap_AlertCount_2",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "$gen_heatmap_AlertCount_2",
                        "sortOrder": 2
                      }
                    ],
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SigninStatus",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "Count",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "blue"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Trend",
                        "formatter": 9,
                        "formatOptions": {
                          "palette": "green"
                        }
                      },
                      "showBorder": false
                    },
                    "mapSettings": {
                      "locInfo": "CountryRegion",
                      "locInfoColumn": "Location",
                      "latitude": "SourceIPLocation",
                      "longitude": "SourceIPLocation",
                      "sizeSettings": "Location",
                      "sizeAggregation": "Count",
                      "legendMetric": "Location",
                      "legendAggregation": "Count",
                      "itemColorSettings": {
                        "nodeColorField": "Location",
                        "colorAggregation": "Count",
                        "type": "thresholds",
                        "thresholdsGrid": [
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "blueDark"
                          }
                        ]
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let UncommonActionVolume = BehaviorAnalytics\r\n| extend UncommonActionVolume = tostring(ActivityInsights.UncommonHighVolumeOfActions)\r\n| where UncommonActionVolume == \"True\"\r\n| summarize count() by UserPrincipalName\r\n| project-rename UncommonActionVolume = count_;\r\nlet UncommonAction = BehaviorAnalytics\r\n| extend UncommonAction = tostring(ActivityInsights.ActionUncommonlyPerformedByUser)\r\n| where UncommonAction == \"True\"\r\n| summarize count() by UserPrincipalName\r\n| project-rename UncommonAction = count_;\r\nlet Uncommon = UncommonActionVolume | join(UncommonAction) on UserPrincipalName;\r\nlet FirstTimeDeviceLogon = BehaviorAnalytics\r\n| extend FirstTimeDeviceLogon = tostring(ActivityInsights.FirstTimeUserLoggedOnToDevice)\r\n| where FirstTimeDeviceLogon == \"True\"\r\n| summarize count() by UserPrincipalName\r\n| project-rename FirstTimeDeviceLogon = count_;\r\nlet FirstTimeUserAction = BehaviorAnalytics\r\n| extend FirstTimeUserAction = tostring(ActivityInsights.FirstTimeUserPerformedAction)\r\n| where FirstTimeUserAction == \"True\"\r\n| summarize count() by UserPrincipalName\r\n| project-rename FirstTimeUserAction = count_;\r\nlet FirstTime = FirstTimeUserAction | join(FirstTimeDeviceLogon) on UserPrincipalName;\r\nUncommon | join kind=fullouter(FirstTime) on UserPrincipalName\r\n| where UserPrincipalName <> \"\"\r\n| where UserPrincipalName in ({UserPrincipalName})\r\n| project UserPrincipalName, UncommonActionVolume, UncommonAction, FirstTimeUserAction, FirstTimeDeviceLogon\r\n| sort by UncommonActionVolume desc \r\n| limit 250\r\n\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "User Anomalies",
                    "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set. ",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "UserPrincipalName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Person",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "UncommonActionVolume",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "redBright"
                          }
                        },
                        {
                          "columnMatch": "UncommonAction",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "FirstTimeUserAction",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "blue"
                          }
                        },
                        {
                          "columnMatch": "FirstTimeDeviceLogon",
                          "formatter": 4,
                          "formatOptions": {
                            "palette": "yellow"
                          }
                        },
                        {
                          "columnMatch": "IncidentCount",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "redBright"
                          }
                        },
                        {
                          "columnMatch": "AlertCount",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "orange"
                          }
                        },
                        {
                          "columnMatch": "AnomalyCount",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "yellow"
                          }
                        }
                      ],
                      "filter": true,
                      "sortBy": [
                        {
                          "itemKey": "$gen_bar_FirstTimeDeviceLogon_4",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "$gen_bar_FirstTimeDeviceLogon_4",
                        "sortOrder": 2
                      }
                    ],
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SigninStatus",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "Count",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "blue"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Trend",
                        "formatter": 9,
                        "formatOptions": {
                          "palette": "green"
                        }
                      },
                      "showBorder": false
                    },
                    "mapSettings": {
                      "locInfo": "CountryRegion",
                      "locInfoColumn": "Location",
                      "latitude": "SourceIPLocation",
                      "longitude": "SourceIPLocation",
                      "sizeSettings": "Location",
                      "sizeAggregation": "Count",
                      "legendMetric": "Location",
                      "legendAggregation": "Count",
                      "itemColorSettings": {
                        "nodeColorField": "Location",
                        "colorAggregation": "Count",
                        "type": "thresholds",
                        "thresholdsGrid": [
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "blueDark"
                          }
                        ]
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL3_6Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "User Behavior Monitoring",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Application Container Security, Operations, and Management ](https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf)\r\n\r\n### Recommended Logs\r\nüî∑ [SecurityRegulatoryCompliance](https://docs.microsoft.com/azure/azure-monitor/reference/tables/securityregulatorycompliance) ‚ú≥Ô∏è [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)<br> \r\n\r\n### References\r\nüí° [Container security in Microsoft Defender for Cloud](https://docs.microsoft.com/azure/defender-for-cloud/container-security)<br>\r\nüí° [Identify vulnerable container images in your CI/CD workflows](https://docs.microsoft.com/azure/defender-for-cloud/defender-for-container-registries-cicd)<br>\r\nüí° [Use Microsoft Defender for container registries to scan your images for vulnerabilities](https://docs.microsoft.com/azure/defender-for-cloud/defender-for-container-registries-usage)<br>\r\nüí° [Introduction to Microsoft Defender for container registries](https://docs.microsoft.com/azure/defender-for-cloud/defender-for-container-registries-introduction)<br>\r\nüí° [Introduction to Microsoft Defender for Kubernetes](https://docs.microsoft.com/azure/defender-for-cloud/defender-for-kubernetes-introduction)<br>\r\n\r\n### Microsoft Portals\r\nüîÄ [Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n"
                  },
                  "customWidth": "50",
                  "name": "LT-1",
                  "styleSettings": {
                    "maxWidth": "50"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Requirements\r\n| <strong> Log Category </strong> | <strong> Required Data </strong> | <strong> Format </strong> | <strong> Criticality </strong> | <strong> Retention Period </strong> | <strong> Page </strong> |    \r\n|:--|:--|:--|:--|:--|:--|:--|\r\n| Application Container Security, Operations, and Management  | Container security and monitoring tools should be integrated with security information and event management (SIEM) tools to ensure container-related events are captured by the enterprise. Alternatively, in cases where the uses and privileges of containers are appropriately constrained by the orchestration layer, agencies may rely on SIEM tools present at that layer. In general, Federal agencies shall ensure that their cyber hunt and incident response teams have appropriate tools and training to identify incidents within a containerized environment. | Log | 3 | 12 Months Active Storage, 18 Months Cold Storage | 10 |"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "value": "",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Status"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Notes <br>\r\n{Notes}"
                        },
                        "name": "text - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend failedResources = toint(properties.failedResources), passedResources = toint(properties.passedResources),skippedResources = toint(properties.skippedResources)\r\n    | where failedResources + passedResources + skippedResources > 0\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationDisplayName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend azurePortalRecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId == \"Azure Security Benchmark\"\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n\t| where RecommendationDisplayName contains \"container\" or RecommendationDisplayName contains \"kubernetes\" or RecommendationDisplayName contains \"pod\"\r\n    | where state == \"Unhealthy\"\r\n    | extend Recommendation = strcat(\"https://\",azurePortalRecommendationLink), ResourceID = resourceId, ResourceType = resourceType, ResourceGroup = resourceGroup1, Severity = severity, State = state, ControlID = controlId\r\n    | project RecommendationDisplayName, ResourceID, ResourceType, ResourceGroup, Severity, State, ControlID, Recommendation\r\n    | limit 250",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Container Security and Monitoring (Microsoft Defender for Cloud)",
                    "noDataMessage": "No Current Recommendations in this Area. Confirm the Azure Security Benchmark Assessment is Enabled in Microsoft Defender for Cloud: Regulatory Compliance Blade.",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RecommendationDisplayName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "warning",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Medium",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Low",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "State",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "ControlID",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Recommendation",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Go to Recommendation >"
                          }
                        }
                      ],
                      "filter": true
                    }
                  },
                  "name": "query - 5"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "isEL3_7Visible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Application Container Security, Operations, and Management ",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEL3Visible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Intermediate Event Logging (EL3)"
    }
  ],
  "fromTemplateId": "sentinel-MaturityModelForEventLogManagement(M2131)",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}